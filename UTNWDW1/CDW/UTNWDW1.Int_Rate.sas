/*TEST*/
/*%LET TESTMSG = - THIS IS A TEST;
%LET RPTLIB = T:\SAS;
%LET LOGLIB = Y:\Batch\Logs;
%LET CODELIB = Y:\Codebase\SAS\CDW;
%LET ODBCFILE = BSYS_TEST;
%LET DB = CDW_test;
%LET ODBCFILE_CSYS = CSYSTest;*/

/*LIVE*/
%LET TESTMSG = - THIS IS LIVE;
%LET RPTLIB = Z:\Batch\FTP;
%LET LOGLIB = Z:\Batch\Logs;
%LET CODELIB = Z:\Codebase\SAS\CDW;
%LET ODBCFILE = BSYS;
%LET DB = CDW;
%LET ODBCFILE_CSYS = CSYS;

%INCLUDE "&CODELIB\UTNWDW1 CDW DAILY UPDATE.FOLDER AND DATABASE.SAS"  ;
%FILECHECK(18);

DATA LN72(drop=trunc);
	INFILE REPORT18 DSD DLM = ',' FIRSTOBS=1 MISSOVER end = eof;
	INPUT DF_SPE_ACC_ID :$10. LN_SEQ :6. LR_ITR :7.3 LR_INT_RDC_PGM_ORG :7.3 LC_ITR_TYP :$2. LD_ITR_EFF_BEG :$10. LD_ITR_EFF_END :$10.;
%TRUNCAT(18);
RUN;
%COPYERROR;
PROC SORT DATA=LN72; BY DF_SPE_ACC_ID LN_SEQ; RUN;
DATA LN72; SET LN72; BY DF_SPE_ACC_ID LN_SEQ; IF LAST.LN_SEQ; RUN;

%ENCHILADA(LN72,LN72_INTERESTRATE,DF_SPE_ACC_ID LN_SEQ,LR_ITR LR_INT_RDC_PGM_ORG LC_ITR_TYP LD_ITR_EFF_BEG LD_ITR_EFF_END,);

%GOODBYE_NULL(LN72_INTERESTRATE,LR_ITR,0);
%GOODBYE_NULL(LN72_INTERESTRATE,LR_INT_RDC_PGM_ORG,0);
%GOODBYE_NULL(LN72_INTERESTRATE,LC_ITR_TYP,'');
%GOODBYE_NULL(LN72_INTERESTRATE,LD_ITR_EFF_BEG,'');
%GOODBYE_NULL(LN72_INTERESTRATE,LD_ITR_EFF_END,'');

%FINISH(SOURCE=Int_rate);
