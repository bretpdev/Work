/*TEST*/
/*%LET TESTMSG = - THIS IS A TEST;
%LET RPTLIB = T:\SAS;
%LET LOGLIB = Y:\Batch\Logs;
%LET CODELIB = Y:\Codebase\SAS\CDW;
%LET ODBCFILE = BSYS_TEST;
%LET DB = CDW_test;
%LET ODBCFILE_CSYS = CSYSTest;*/

/*LIVE*/
%LET TESTMSG = - THIS IS LIVE;
%LET RPTLIB = Z:\Batch\FTP;
%LET LOGLIB = Z:\Batch\Logs;
%LET CODELIB = Z:\Codebase\SAS\CDW;
%LET ODBCFILE = BSYS;
%LET DB = CDW;
%LET ODBCFILE_CSYS = CSYS;

%INCLUDE "&CODELIB\UTNWDW1 CDW DAILY UPDATE.FOLDER AND DATABASE.SAS"  ;
%FILECHECK(11);


DATA LN10(DROP=trunc);
	INFILE REPORT11 DSD DLM = ',' FIRSTOBS=1 MISSOVER end = eof;
	INPUT DF_SPE_ACC_ID :$10. LN_SEQ :6. LC_STA_LON10 :$1. LA_CUR_PRI :10.2 LA_LON_AMT_GTR :10.2 
		LD_END_GRC_PRD :$10. IC_LON_PGM :$6. LD_LON_1_DSB :$10. 
		LD_PIF_RPT :$10. LC_SST_LON10 :$1. LF_LON_CUR_OWN :$8. LF_DOE_SCL_ORG :$8.;
	IF LC_STA_LON10 = 'P' THEN LA_CUR_PRI = 0;
	IF LA_CUR_PRI > 0 THEN FORWARDING = '09';
		ELSE IF LC_SST_LON10 = '4' THEN FORWARDING = '11';
		ELSE IF LC_SST_LON10 = '3' THEN FORWARDING = '12';
		ELSE FORWARDING = '10';
%TRUNCAT(11);
RUN;
%COPYERROR;
PROC SORT DATA=LN10; BY DF_SPE_ACC_ID LN_SEQ; RUN;
DATA LN10; SET LN10; BY DF_SPE_ACC_ID LN_SEQ; IF LAST.LN_SEQ; RUN;

%ENCHILADA(LN10,LN10_LOAN,DF_SPE_ACC_ID LN_SEQ,LC_STA_LON10 LA_CUR_PRI LA_LON_AMT_GTR LD_END_GRC_PRD IC_LON_PGM LD_LON_1_DSB 
	LD_PIF_RPT LC_SST_LON10 FORWARDING LF_LON_CUR_OWN LF_DOE_SCL_ORG,);

%GOODBYE_NULL(LN10_LOAN,LA_CUR_PRI,0);
%GOODBYE_NULL(LN10_LOAN,LA_LON_AMT_GTR,0);
%GOODBYE_NULL(LN10_LOAN,LD_END_GRC_PRD,'');
%GOODBYE_NULL(LN10_LOAN,IC_LON_PGM,'');
%GOODBYE_NULL(LN10_LOAN,LD_LON_1_DSB,'');
%GOODBYE_NULL(LN10_LOAN,LD_PIF_RPT,'');
%GOODBYE_NULL(LN10_LOAN,LC_SST_LON10,'');
%GOODBYE_NULL(LN10_LOAN,FORWARDING,'');
%GOODBYE_NULL(LN10_LOAN,LF_LON_CUR_OWN,'');
%GOODBYE_NULL(LN10_LOAN,LF_DOE_SCL_ORG,'');

%CLEANUP_LOAN(LN20_ENDORSER);
%CLEANUP_LOAN(LN09_REHABILITATION);
%CLEANUP_LOAN(LN83_EFTSTATUS);
%CLEANUP_LOAN(LN55_BENEFIT);
%CLEANUP_LOAN(LN16_DELINQUENCY);
%CLEANUP_LOAN(LN72_INTERESTRATE);
%CLEANUP_LOAN(LN65_REPAYMENTSCHED);
%CLEANUP_LOAN(SD10_SCHOOL);

%FINISH(SOURCE=Loan);
