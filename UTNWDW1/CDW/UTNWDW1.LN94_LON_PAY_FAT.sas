/*TEST*/
/*%LET TESTMSG = - THIS IS A TEST;
%LET RPTLIB = T:\SAS;
%LET LOGLIB = Y:\Batch\Logs;
%LET CODELIB = Y:\Codebase\SAS\CDW;
%LET ODBCFILE = BSYS_TEST;
%LET DB = CDW_test;
%LET ODBCFILE_CSYS = CSYSTest;*/

/*LIVE*/
%LET TESTMSG = - THIS IS LIVE;
%LET RPTLIB = Z:\Batch\FTP;
%LET LOGLIB = Z:\Batch\Logs;
%LET CODELIB = Z:\Codebase\SAS\CDW;
%LET ODBCFILE = BSYS;
%LET DB = CDW;
%LET ODBCFILE_CSYS = CSYS;

%INCLUDE "&CODELIB\UTNWDW1 CDW DAILY UPDATE.FOLDER AND DATABASE.SAS"  ;
%FILECHECK(49);


DATA LN94(drop=trunc);
	INFILE REPORT49 DSD DLM = ',' FIRSTOBS=1 MISSOVER end = eof LRECL = 32767;
	INPUT 
		BF_SSN :$9.
		LN_SEQ :2.
		LN_FAT_SEQ :2.
		LD_RMT_BCH_INI :DATE9.
		LC_RMT_BCH_SRC_IPT :$1.
		LN_RMT_BCH_SEQ :2.
		LN_RMT_SEQ :6.0
		LN_RMT_ITM :3.0
		LN_RMT_ITM_SEQ :2.
		LF_LST_DTS_LN94 :DATETIME25.
	;
	%TRUNCAT1(49, BF_SSN);
RUN;

/*convert SAS dates to SQL Server datetime*/
DATA LN94;
	SET LN94;
		LD_RMT_BCH_INI = LD_RMT_BCH_INI * 86400;
RUN;

%COPYERROR;

%ENCHILADA
	(
		LN94,
		LN94_LON_PAY_FAT,
		BF_SSN  
		LN_SEQ  
		LN_FAT_SEQ  
		LD_RMT_BCH_INI  
		LC_RMT_BCH_SRC_IPT  
		LN_RMT_BCH_SEQ  
		LN_RMT_SEQ  
		LN_RMT_ITM  
		LN_RMT_ITM_SEQ,  
		LF_LST_DTS_LN94  
/*		no filter*/
	);

%FINISH(SOURCE=LN94_LON_PAY_FAT);
