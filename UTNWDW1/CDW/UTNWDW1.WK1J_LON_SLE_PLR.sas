/*TEST*/
/*%LET TESTMSG = - THIS IS A TEST;
%LET RPTLIB = T:\SAS;
%LET LOGLIB = Y:\Batch\Logs;
%LET CODELIB = Y:\Codebase\SAS\CDW;
%LET ODBCFILE = BSYS_TEST;
%LET DB = CDW_test;
%LET ODBCFILE_CSYS = CSYSTest;*/

/*LIVE*/
%LET TESTMSG = - THIS IS LIVE;
%LET RPTLIB = Z:\Batch\FTP;
%LET LOGLIB = Z:\Batch\Logs;
%LET CODELIB = Z:\Codebase\SAS\CDW;
%LET ODBCFILE = BSYS;
%LET DB = CDW;
%LET ODBCFILE_CSYS = CSYS;

%INCLUDE "&CODELIB\UTNWDW1 CDW DAILY UPDATE.FOLDER AND DATABASE.SAS"  ;
%FILECHECK(48);

DATA WK1J(drop=trunc);
	INFILE REPORT48 DSD DLM = ',' FIRSTOBS=1 MISSOVER end = eof LRECL = 32767;
	INPUT 
		IF_LON_SLE :$7.
		ID_LON_SLE_LST_PLR :DATE9.
		IT_SLE_LST_PLR :$8.
		BF_SSN :$9.
		LN_SEQ :2.
		LA_CUR_PRI :8.2
		LA_NSI_OTS :7.2
		LA_LTE_FEE_OTS :7.2
	;
	%TRUNCAT1(48, IF_LON_SLE);
RUN;

/*convert SAS dates to SQL Server datetime*/
DATA WK1J;
	SET WK1J;
		IT_SLE_LST_PLR_Varchar = IT_SLE_LST_PLR;
		ID_LON_SLE_LST_PLR = ID_LON_SLE_LST_PLR * 86400;
RUN;

%COPYERROR;

%ENCHILADA
	(
		WK1J,
		WK1J_LON_SLE_PLR,
		IF_LON_SLE  
		ID_LON_SLE_LST_PLR  
		IT_SLE_LST_PLR_Varchar  
		BF_SSN  
		LN_SEQ, 
		IT_SLE_LST_PLR 
		LA_CUR_PRI  
		LA_NSI_OTS  
		LA_LTE_FEE_OTS  
/*		no filter*/
	);

%FINISH(SOURCE=WK1J_LON_SLE_PLR);
