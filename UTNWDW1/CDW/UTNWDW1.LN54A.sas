/*TEST*/
/*%LET TESTMSG = - THIS IS A TEST;
%LET RPTLIB = T:\SAS;
%LET LOGLIB = Y:\Batch\Logs;
%LET CODELIB = Y:\Codebase\SAS\CDW;
%LET ODBCFILE = BSYS_TEST;
%LET DB = CDW_test;
%LET ODBCFILE_CSYS = CSYSTest;*/

/*LIVE*/
%LET TESTMSG = - THIS IS LIVE;
%LET RPTLIB = Z:\Batch\FTP;
%LET LOGLIB = Z:\Batch\Logs;
%LET CODELIB = Z:\Codebase\SAS\CDW;
%LET ODBCFILE = BSYS;
%LET DB = CDW;
%LET ODBCFILE_CSYS = CSYS;

%INCLUDE "&CODELIB\UTNWDW1 CDW DAILY UPDATE.FOLDER AND DATABASE.SAS";
%FILECHECK(56);


DATA LN54A(drop=trunc);
	INFILE REPORT56 DSD DLM = ',' FIRSTOBS=1 MISSOVER end = eof;
	INPUT 
		BF_SSN :$9.
		LN_SEQ :2.
		PM_BBS_PGM :$3.
		PN_BBS_PGM_SEQ :2.
		LN_LON_BBS_PGM_SEQ :2.
		LD_EFF_BEG_LN54 :DATE9.
		LI_BBS_ITD_LTR_SNT :1.
		LN_BBS_STS_PCV_PAY :3.0
		LC_BBS_REB_MTD :$1.
		LC_STA_LN54 :$1.
		LD_STA_LN54 :DATE9.
		LC_BBT_TYS_ASS :1.
		LC_BBS_DSQ_REA :$2.
		LD_BBS_DSQ :DATE9.
		LC_BBS_ELG :$1.
		LC_BBT_PRC_RBD :$1.
		LD_BBS_RPD_WDO_END :DATE9.
		LC_BBS_BCH_PRC :$1.
		LF_LST_USR_LN54 :$8.
		LF_LST_DTS_LN54 :DATETIME25.
		LN_BBS_PCV_PAY_MOT :2.
		LD_BBS_ICV_REQ :DATE9.
		LD_BBS_DSQ_APL :DATE9.
		LI_BBS_PCV_LTE_PAY :$1.;
%TRUNCAT1(56, BF_SSN);
RUN;
%COPYERROR;

DATA LN54A;
SET LN54A;
	LD_EFF_BEG_LN54 = LD_EFF_BEG_LN54 * 86400;
	LD_STA_LN54 = LD_STA_LN54 * 86400;
	LD_BBS_DSQ = LD_BBS_DSQ * 86400;
	LD_BBS_RPD_WDO_END = LD_BBS_RPD_WDO_END * 86400;
	LD_BBS_ICV_REQ = LD_BBS_ICV_REQ * 86400;
	LD_BBS_DSQ_APL = LD_BBS_DSQ_APL * 86400;
RUN;

PROC SORT DATA=LN54A; BY BF_SSN LN_SEQ PM_BBS_PGM PN_BBS_PGM_SEQ LN_LON_BBS_PGM_SEQ; RUN;

%ENCHILADA(
LN54A,
LN54_LON_BBS,
BF_SSN
LN_SEQ
PM_BBS_PGM
PN_BBS_PGM_SEQ
LN_LON_BBS_PGM_SEQ ,
LD_EFF_BEG_LN54
LI_BBS_ITD_LTR_SNT
LN_BBS_STS_PCV_PAY
LC_BBS_REB_MTD
LC_STA_LN54
LD_STA_LN54
LC_BBT_TYS_ASS
LC_BBS_DSQ_REA
LD_BBS_DSQ
LC_BBS_ELG
LC_BBT_PRC_RBD
LD_BBS_RPD_WDO_END
LC_BBS_BCH_PRC
LF_LST_USR_LN54
LF_LST_DTS_LN54
LN_BBS_PCV_PAY_MOT
LD_BBS_ICV_REQ
LD_BBS_DSQ_APL
LI_BBS_PCV_LTE_PAY
);

%FINISH(SOURCE=LN54A);
