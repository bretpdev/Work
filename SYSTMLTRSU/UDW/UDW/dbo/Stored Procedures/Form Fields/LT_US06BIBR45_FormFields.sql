CREATE PROCEDURE [dbo].[LT_US06BIBR45_FormFields]
	@BF_SSN  VARCHAR(9),
	@IsCoborrower BIT = 0,
	@RN_ATY_SEQ_PRC INT
AS
BEGIN

SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
--Borrower level data.  No LN85 join needed
IF @IsCoborrower = 0
	BEGIN
		SELECT 
			CONVERT(VARCHAR(10),CAST(RS05.BD_ANV_QLF_IBR - 30 AS DATE),101) AS PZSFTDDLNE,
			RS05.BA_PMN_STD_TOT_PAY AS PZPERMSTND,
			CONVERT(VARCHAR(10),CAST(RS05.BD_ANV_QLF_IBR AS DATE),101) AS PZANTDTPAY
		FROM
			RS05_IBR_RPS RS05
		WHERE
			RS05.BF_SSN = @BF_SSN
			AND RS05.BC_STA_RS05 = 'A'
			AND RS05.BA_PMN_STD_TOT_PAY IS NOT NULL
			AND RS05.BD_ANV_QLF_IBR IS NOT NULL
	END
ELSE
	BEGIN
		SELECT DISTINCT
			CONVERT(VARCHAR(10),CAST(RS05.BD_ANV_QLF_IBR - 30 AS DATE),101) AS PZSFTDDLNE,
			RS05.BA_PMN_STD_TOT_PAY AS PZPERMSTND,
			CONVERT(VARCHAR(10),CAST(RS05.BD_ANV_QLF_IBR AS DATE),101) AS PZANTDTPAY
		FROM
			RS05_IBR_RPS RS05
			INNER JOIN LN20_EDS LN20
				ON LN20.BF_SSN = RS05.BF_SSN
		WHERE
			LN20.LF_EDS = @BF_SSN
			AND RS05.BC_STA_RS05 = 'A'
			AND RS05.BA_PMN_STD_TOT_PAY IS NOT NULL
			AND RS05.BD_ANV_QLF_IBR IS NOT NULL
	END
END