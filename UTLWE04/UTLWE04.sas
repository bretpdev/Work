/*UTLWE04 MACU MONTHEND DATA FILE*/

/*PLEASE NOTE: THIS DIRECTORY HAS BEEN CHANGED TO PROGREVW BECAUSE OF THE SIZE OF THE OUTPUT FILE*/
/*LIBNAME DLGSUTWH DB2 DATABASE=DLGSUTWH OWNER=OLWHRM1;*/
/*%LET RPTLIB = /sas/whse/progrevw   ; */
/*FILENAME REPORT2 "&RPTLIB/ULWE04.LWE04R2";*/

LIBNAME  WORKLOCL  REMOTE  SERVER=CYPRUS  SLIBREF=WORK;
RSUBMIT;
PROC SQL;
CONNECT TO DB2 (DATABASE=DLGSUTWH);
CREATE TABLE MACUDF AS
SELECT *
FROM CONNECTION TO DB2 (
SELECT A.BF_SSN 
	,A.WM_BR_LST
	,A.WM_BR_1
	,A.WM_BR_MID
	,B.WX_STR_ADR_1
	,B.WX_STR_ADR_2
	,B.WM_CT
	,B.DC_DOM_ST
	,B.DF_ZIP_CDE
	,RTRIM(B.DN_DOM_PHN_ARA)||''||RTRIM(B.DN_DOM_PHN_XCH)||''||RTRIM(B.DN_DOM_PHN_LCL) AS PHONE
	,A.LF_DOE_SCL_ORG
	,A.LF_STU_SSN
	,A.IF_OWN
	,B.IF_DOE_LDR
	,B.LD_LON_GTR
	,A.IC_LON_PGM
	,B.LA_LON_AMT_GTR
	,B.LF_GTR_RFR
	,A.LD_LON_1_DSB
	,A.WR_ITR_1
	,A.LD_SCL_SPR
	,A.WA_CUR_PRI
	,B.WA_LON_TOT_DSB
	,B.LD_BIL_DU
	,C.LF_LON_ALT
	,C.LN_LON_ALT_SEQ
	,B.DD_BRT 
FROM OLWHRM1.MR5A_MR_LON_MTH_01 A
LEFT OUTER JOIN OLWHRM1.MR5B_MR_LON_MTH_02 B
	 ON A.BF_SSN = B.BF_SSN
	 AND A.LN_SEQ = B.LN_SEQ
	 AND A.IF_OWN = B.IF_OWN
LEFT OUTER JOIN OLWHRM1.LN10_LON C
	 ON A.BF_SSN = C.BF_SSN
	 AND A.LN_SEQ = C.LN_SEQ
WHERE	A.IF_OWN = '817546'
AND 	A.WA_CUR_PRI > 0

);
DISCONNECT FROM DB2;
ENDRSUBMIT;

DATA MACUDF;
SET WORKLOCL.MACUDF;
RUN;

PROC SORT DATA=MACUDF;
BY BF_SSN;
RUN;

DATA _NULL_;
SET  WORK.MACUDF;
FILE 'T:\SAS\ULWE04.LWE04R2' DELIMITER=',' DSD DROPOVER LRECL=32767;
*FILE REPORT2 DELIMITER=',' DSD DROPOVER LRECL=32767;
FORMAT BF_SSN $9. ;
FORMAT WM_BR_LST $23. ;
FORMAT WM_BR_1 $13. ;
FORMAT WM_BR_MID $13. ;
FORMAT WX_STR_ADR_1 $30. ;
FORMAT WX_STR_ADR_2 $30. ;
FORMAT WM_CT $20. ;
FORMAT DC_DOM_ST $2. ;
FORMAT DF_ZIP_CDE $17. ;
FORMAT PHONE $10. ;
FORMAT LF_DOE_SCL_ORG $8. ;
FORMAT LF_STU_SSN $9. ;
FORMAT IF_OWN $8. ;
FORMAT IF_DOE_LDR $8. ;
FORMAT LD_LON_GTR YYMMDDd10. ;
FORMAT IC_LON_PGM $6. ;
FORMAT LA_LON_AMT_GTR 10.2 ;
FORMAT LF_GTR_RFR $12. ;
FORMAT LD_LON_1_DSB YYMMDDd10. ;
FORMAT WR_ITR_1 7.3 ;
FORMAT LD_SCL_SPR YYMMDDd10. ;
FORMAT WA_CUR_PRI 10.2 ;
FORMAT WA_LON_TOT_DSB 10.2 ;
FORMAT LD_BIL_DU YYMMDDd10. ;
FORMAT LF_LON_ALT $17. ;
FORMAT LN_LON_ALT_SEQ 6. ;
FORMAT DD_BRT YYMMDDd10. ;
IF _N_ = 1 THEN        /* WRITE COLUMN NAMES */
DO;
PUT
'BF_SSN'
','
'WM_BR_LST'
','
'WM_BR_1'
','
'WM_BR_MID'
','
'WX_STR_ADR_1'
','
'WX_STR_ADR_2'
','
'WM_CT'
','
'DC_DOM_ST'
','
'DF_ZIP_CDE'
','
'PHONE'
','
'LF_DOE_SCL_ORG'
','
'LF_STU_SSN'
','
'IF_OWN'
','
'IF_DOE_LDR'
','
'LD_LON_GTR'
','
'IC_LON_PGM'
','
'LA_LON_AMT_GTR'
','
'LF_GTR_RFR'
','
'LD_LON_1_DSB'
','
'WR_ITR_1'
','
'LD_SCL_SPR'
','
'WA_CUR_PRI'
','
'WA_LON_TOT_DSB'
','
'LD_BIL_DU'
','
'LF_LON_ALT'
','
'LN_LON_ALT_SEQ'
','
'DD_BRT'
;
END;
DO;
PUT BF_SSN $ @;
PUT WM_BR_LST $ @;
PUT WM_BR_1 $ @;
PUT WM_BR_MID $ @;
PUT WX_STR_ADR_1 $ @;
PUT WX_STR_ADR_2 $ @;
PUT WM_CT $ @;
PUT DC_DOM_ST $ @;
PUT DF_ZIP_CDE $ @;
PUT PHONE $ @;
PUT LF_DOE_SCL_ORG $ @;
PUT LF_STU_SSN $ @;
PUT IF_OWN $ @;
PUT IF_DOE_LDR $ @;
PUT LD_LON_GTR @;
PUT IC_LON_PGM $ @;
PUT LA_LON_AMT_GTR @;
PUT LF_GTR_RFR $ @;
PUT LD_LON_1_DSB @;
PUT WR_ITR_1 @;
PUT LD_SCL_SPR @;
PUT WA_CUR_PRI @;
PUT WA_LON_TOT_DSB @;
PUT LD_BIL_DU @;
PUT LF_LON_ALT $ @;
PUT LN_LON_ALT_SEQ @;
PUT DD_BRT ;
;
END;
RUN;
