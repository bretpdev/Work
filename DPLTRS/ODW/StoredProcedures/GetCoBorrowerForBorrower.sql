CREATE PROCEDURE [dbo].[GetCoBorrowersForBorrower]
(
	@BorrowerSSN CHAR(9)
)
AS

SELECT
	GA01.DF_PRS_ID_EDS AS CoBorrowerSSN,
	PD01.DM_PRS_1 AS FirstName,
	PD01.DM_PRS_MID AS MiddleName,
	PD01.DM_PRS_LST AS LastName,
	PD01.DF_SPE_ACC_ID AS AccountNumber,
	PD01.DI_VLD_ADR AS ValidAddress,
	PD01.DX_STR_ADR_1 AS [Address1],
	PD01.DX_STR_ADR_2 AS [Address2],
	PD01.DM_CT AS City,
	PD01.DC_DOM_ST AS [State],
	PD01.DF_ZIP AS Zip,
	PD01.DM_FGN_CNY AS ForeignCountry,
	GA10.AF_APL_ID AS AF_APL_ID,
	GA10.AF_APL_ID_SFX AS AF_APL_ID_SF,
	GA10.AF_APL_ID + GA10.AF_APL_ID_SFX AS UniqueId
FROM
	ODW..GA01_APP GA01
	INNER JOIN ODW..GA10_LON_APP GA10
		ON GA01.AF_APL_ID = GA10.AF_APL_ID
	INNER JOIN ODW..PD01_PDM_INF PD01
		ON GA01.DF_PRS_ID_EDS = PD01.DF_PRS_ID
		AND PD01.DI_VLD_ADR = 'Y'
WHERE
	GA01.AC_EDS_TYP = 'C'
	AND GA01.DF_PRS_ID_BR = @BorrowerSSN