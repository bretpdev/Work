using System;
using System.Reflection;
using System.Collections.Generic;
using Uheaa.Common.ProcessLogger;
using Uheaa.Common.DataAccess;
using Uheaa.Common.Scripts;
using Uheaa.Common;
using System.Linq;
using System.IO;

namespace FAFSADBLOD
{
    public class IsirLoad
    {
        private const string SCRIPTID = "FAFSADBLOD";
        private List<string> searchPatterns = new List<string>() { "isrf*", "idre*", "igre*", "idap*", "idnr*", "idsa*", "igco*", "ignr*", "igsa*", "igsg*" };
        private static string Root = DataAccessHelper.TestMode ? EnterpriseFileSystem.TempFolder : @"H:\";
        private  string archiveFolder = $@"{Root}UHEAA\DPProject\FAFSA\Archive";
        private  string rootDirectory = $@"{Root}UHEAA\DPProject\FAFSA\ISIR";
        private ProcessLogRun PLR { get; set; }
        private DataAccess DA { get; set; }

        public IsirLoad(ProcessLogRun plr, string[] args)
        {
            PLR = plr;
            DA = new DataAccess(PLR);
            PLR.AddNotification("FAFSADBLOD: Begin script.", NotificationType.ErrorReport, NotificationSeverityType.Informational);
        }

        public int Run()
        {
            List<IsirRecord> records = ParseFiles();
            DA.LoadFiles(records);
            DA.AddSchools();
            DA.AddStudentData();
            PLR.LogEnd();
            return 0;
        }

        private List<IsirRecord> ParseFiles()
        {
            List<IsirRecord> records = new List<IsirRecord>();
            List<string> filesToProcess = new List<string>();
            foreach (string pattern in searchPatterns)
            {
                filesToProcess.AddRange(Directory.GetFiles(rootDirectory, pattern, SearchOption.AllDirectories));
            }

            //Copy directories from root to archive
            List<string> rootDirectories = Directory.EnumerateDirectories(rootDirectory).ToList();
            List<string> newDirectories = new List<string>();
            foreach (string directory in rootDirectories)
            {
                Directory.CreateDirectory(directory.Replace("ISIR", "Archive"));
                newDirectories.Add(directory.Replace("ISIR", "Archive"));
            }

            foreach (string file in filesToProcess)
            {
                using (StreamR sr = new StreamR(file))
                {
                    string line;
                    while ((line = sr.ReadLine()) != null)
                    {
                        IsirRecord record = new IsirRecord();
                        record.YearIndicator = line.SafeSubString(0, 1);
                        record.OriginalSsn = line.SafeSubString(1, 9);
                        record.OriginalNameId = line.SafeSubString(10, 2);
                        record.TransactionNumber = line.SafeSubString(12, 2);
                        record.StudentLastName = line.SafeSubString(14, 16);
                        record.StudentFirstName = line.SafeSubString(30, 12);
                        record.MiddleInitial = line.SafeSubString(42, 1);
                        record.PermanentMailingAddress = line.SafeSubString(43, 35);
                        record.PermanentCity = line.SafeSubString(78, 16);
                        record.PermanentState = line.SafeSubString(94, 2);
                        record.PermanentZipCode = line.SafeSubString(96, 5);
                        record.StudentDateOfBirth = line.SafeSubString(101, 8);
                        record.StudentPermanentPhoneNumber = line.SafeSubString(109, 10);
                        record.StudentDriversLicenseNumber = line.SafeSubString(119, 20);
                        record.StudentDriversLicenseStateCode = line.SafeSubString(139, 2);
                        record.StudentEmailAddress = line.SafeSubString(141, 50);
                        record.StudentCitizenshipStatus = line.SafeSubString(191, 1);
                        record.StudentAlientRegistrationNumber = line.SafeSubString(192, 9);
                        record.StudentMaritalStatus = line.SafeSubString(201, 1);
                        record.StudentMaritalStatusDate = line.SafeSubString(202, 6);
                        record.StudentStateOfLegalResidence = line.SafeSubString(208, 2);
                        record.StudentLegalResidentBefore01012015 = line.SafeSubString(210, 1);
                        record.StudentLegalResidenceDate = line.SafeSubString(211, 6);
                        record.Gender = line.SafeSubString(217, 1);
                        record.SelectiveServiceRegister = line.SafeSubString(218, 1);
                        record.DrugConvictionAffectingEligibility = line.SafeSubString(219, 1);
                        record.Parent1HighestGradeCompleted = line.SafeSubString(220, 1);
                        record.Parent2HighestGradeCompleted = line.SafeSubString(221, 1);
                        record.HighSchoolDiplomaOrEquivalent = line.SafeSubString(222, 1);
                        record.HighSchoolName = line.SafeSubString(223, 50);
                        record.HighSchoolCity = line.SafeSubString(273, 28);
                        record.HighSchoolState = line.SafeSubString(301, 2);
                        record.HighSchoolCode = line.SafeSubString(303, 12);
                        record.FirstBachelorsDegreeBy07012020 = line.SafeSubString(315, 1);
                        record.GradeLevelInCollege = line.SafeSubString(316, 1);
                        record.DegreeCertificate = line.SafeSubString(317, 1);
                        record.InterestInWorkStudy = line.SafeSubString(318, 1);
                        record.Filler1 = line.SafeSubString(319, 50);
                        record.StudentTaxReturnCompleted = line.SafeSubString(369, 1);
                        record.StudentTypeOf2018TaxForm = line.SafeSubString(370, 1);
                        record.StudentTaxReturnFilingStatus = line.SafeSubString(371, 1);
                        record.StudentFiledSchedule1 = line.SafeSubString(372, 1);
                        record.StudentAdjustedGrossIncomeFromIrsForm = line.SafeSubString(373, 7);
                        record.StudentUSIncomeTaxPaid = line.SafeSubString(380, 7);
                        record.StudentIncomeEarnedFromWork = line.SafeSubString(387, 7);
                        record.SpouseIncomeEarnedFromWork = line.SafeSubString(394, 7);
                        record.StudentCashSavingsChecking = line.SafeSubString(401, 7);
                        record.StudentInvestmentNetWorth = line.SafeSubString(408, 7);
                        record.StudentBusinessInvestmentFarmNetWorth = line.SafeSubString(415, 7);
                        record.StudentEducationalCredits = line.SafeSubString(422, 7);
                        record.StudentChildSupportPaid = line.SafeSubString(429, 7);
                        record.StudentNeedBasedEmployment = line.SafeSubString(436, 7);
                        record.StudentGrantScholarshipAid = line.SafeSubString(443, 7);
                        record.StudentCombatPay = line.SafeSubString(450, 7);
                        record.StudentCoopEarnings = line.SafeSubString(457, 7);
                        record.StudentPensionPayments = line.SafeSubString(464, 7);
                        record.StudentIraPayments = line.SafeSubString(471, 7);
                        record.StudentChildSupportReceived = line.SafeSubString(478, 7);
                        record.StudentInterestIncome = line.SafeSubString(485, 7);
                        record.StudentUntaxedPortionOfIraDistributionAndPensions = line.SafeSubString(492, 7);
                        record.StudentMilitaryClergyAllowances = line.SafeSubString(499, 7);
                        record.StudentVeteransNoneducationBenefits = line.SafeSubString(506, 7);
                        record.StudentOtherUntaxedIncome = line.SafeSubString(513, 7);
                        record.StudentOtherNonReportedMoney = line.SafeSubString(520, 7);
                        record.Filler2 = line.SafeSubString(527, 59);
                        record.BornBefore01011997 = line.SafeSubString(586, 1);
                        record.StudentMarried = line.SafeSubString(587, 1);
                        record.WorkingOnMastersOrDoctorate = line.SafeSubString(588, 1);
                        record.ActiveDutyArmedForces = line.SafeSubString(589, 1);
                        record.VeteranArmedForces = line.SafeSubString(590, 1);
                        record.HasChildDependents = line.SafeSubString(591, 1);
                        record.HasDependentsOtherThanSpouseOrChild = line.SafeSubString(592, 1);
                        record.OrphanWardOfCourtFosterCare = line.SafeSubString(593, 1);
                        record.EmancipatedMinor = line.SafeSubString(594, 1);
                        record.LegalGuardianship = line.SafeSubString(595, 1);
                        record.UnaccompaniedYouthSchoolDistrictLiaison = line.SafeSubString(596, 1);
                        record.UnaccompaniedYouthHUD = line.SafeSubString(597, 1);
                        record.RiskOfHomelessness = line.SafeSubString(598, 1);
                        record.Filler3 = line.SafeSubString(599, 5);
                        record.ParentMaritalStatus = line.SafeSubString(604, 1);
                        record.ParentMaritalStatusDate = line.SafeSubString(605, 6);
                        record.Parent1Ssn = line.SafeSubString(611, 9);
                        record.Parent1LastName = line.SafeSubString(620, 16);
                        record.Parent1FirstNameInitial = line.SafeSubString(636, 1);
                        record.Parent1DateOfBirth = line.SafeSubString(637, 8);
                        record.Parent2Ssn = line.SafeSubString(645, 9);
                        record.Parent2LastName = line.SafeSubString(654, 16);
                        record.Parent2FirstNameInitial = line.SafeSubString(670, 1);
                        record.Parent2DateOfBirth = line.SafeSubString(671, 8);
                        record.ParentEmailAddress = line.SafeSubString(679, 50);
                        record.ParentStateOfLegalResidence = line.SafeSubString(729, 2);
                        record.ParentLegalResidentBefore01012015 = line.SafeSubString(731, 1);
                        record.ParentLegalResidenceDate = line.SafeSubString(732, 6);
                        record.ParentNumberOfFamilyMembers = line.SafeSubString(738, 2);
                        record.ParentNumberInCollege = line.SafeSubString(740, 1);
                        record.ParentMedicaidOrSupplementalSecurityIncomeBenefits = line.SafeSubString(741, 1);
                        record.ParentSupplementalNutritionAssistanceProgramBenefits = line.SafeSubString(742, 1);
                        record.ParentFreeOrReducedPriceSchoolLunchBenefits = line.SafeSubString(743, 1);
                        record.ParentTanfBenefits = line.SafeSubString(744, 1);
                        record.ParentWicBenefits = line.SafeSubString(745, 1);
                        record.ParentTaxReturnCompleted = line.SafeSubString(746, 1);
                        record.ParentTypeOf2018TaxForm = line.SafeSubString(747, 1);
                        record.ParentTaxReturnFilingStatus = line.SafeSubString(748, 1);
                        record.ParentFiledSchedule1 = line.SafeSubString(749, 1);
                        record.ParentDislocatedWorker = line.SafeSubString(750, 1);
                        record.ParentAdjustedGrossIncomeFromIrsForm = line.SafeSubString(751, 7);
                        record.ParentUSIncomeTaxPaid = line.SafeSubString(758, 7);
                        record.Parent1IncomeEarnedFromWork = line.SafeSubString(765, 7);
                        record.Parent2IncomeEarnedFromWork = line.SafeSubString(772, 7);
                        record.ParentCashSavingsChecking = line.SafeSubString(779, 7);
                        record.ParentInvestmentNetWorth = line.SafeSubString(786, 7);
                        record.ParentBusinessInvestmentFarmNetWorth = line.SafeSubString(793, 7);
                        record.ParentEducationalCredits = line.SafeSubString(800, 7);
                        record.ParentChildSupportPaid = line.SafeSubString(807, 7);
                        record.ParentNeedBasedEmployment = line.SafeSubString(814, 7);
                        record.ParentGrantScholarshipAid = line.SafeSubString(821, 7);
                        record.ParentCombatPay = line.SafeSubString(828, 7);
                        record.ParentCoopEarnings = line.SafeSubString(835, 7);
                        record.ParentPensionPayments = line.SafeSubString(842, 7);
                        record.ParentIraPayments = line.SafeSubString(849, 7);
                        record.ParentChildSupportReceived = line.SafeSubString(856, 7);
                        record.ParentInterestIncome = line.SafeSubString(863, 7);
                        record.ParentUntaxedPortionsOfIraDistributionAndPensions = line.SafeSubString(870, 7);
                        record.ParentMilitaryClergyAllowances = line.SafeSubString(877, 7);
                        record.ParentVeteransNoneducationBenefits = line.SafeSubString(884, 7);
                        record.ParentOtherUntaxedIncome = line.SafeSubString(891, 7);
                        record.Filler4 = line.SafeSubString(898, 59);
                        record.StudentNumberOfFamilyMembers = line.SafeSubString(957, 2);
                        record.StudentNumberInCollege = line.SafeSubString(959, 1);
                        record.StudentMedicaidOrSupplementalSecurityIncomeBenefits = line.SafeSubString(960, 1);
                        record.StudentSupplementalNutritionAssistanceProgramBenefits = line.SafeSubString(961, 1);
                        record.StudentFreeOrReducedPriceLunchBenefits = line.SafeSubString(962, 1);
                        record.StudentTanfBenefits = line.SafeSubString(963, 1);
                        record.StudentWicBenefits = line.SafeSubString(964, 1);
                        record.StudentSpouseDislocatedWorker = line.SafeSubString(965, 1);
                        record.Filler5 = line.SafeSubString(966, 5);
                        record.FederalSchoolCode1 = line.SafeSubString(971, 6);
                        record.FederalSchoolCode1HousingPlans = line.SafeSubString(977, 1);
                        record.FederalSchoolCode2 = line.SafeSubString(978, 6);
                        record.FederalSchoolCode2HousingPlans = line.SafeSubString(984, 1);
                        record.FederalSchoolCode3 = line.SafeSubString(985, 6);
                        record.FederalSchoolCode3HousingPlans = line.SafeSubString(991, 1);
                        record.FederalSchoolCode4 = line.SafeSubString(992, 6);
                        record.FederalSchoolCode4HousingPlans = line.SafeSubString(998, 1);
                        record.FederalSchoolCode5 = line.SafeSubString(999, 6);
                        record.FederalSchoolCode5HousingPlans = line.SafeSubString(1005, 1);
                        record.FederalSchoolCode6 = line.SafeSubString(1006, 6);
                        record.FederalSchoolCode6HousingPlans = line.SafeSubString(1012, 1);
                        record.FederalSchoolCode7 = line.SafeSubString(1013, 6);
                        record.FederalSchoolCode7HousingPlans = line.SafeSubString(1019, 1);
                        record.FederalSchoolCode8 = line.SafeSubString(1020, 6);
                        record.FederalSchoolCode8HousingPlans = line.SafeSubString(1026, 1);
                        record.FederalSchoolCode9 = line.SafeSubString(1027, 6);
                        record.FederalSchoolCode9HousingPlans = line.SafeSubString(1033, 1);
                        record.FederalSchoolCode10 = line.SafeSubString(1034, 6);
                        record.FederalSchoolCode10HousingPlans = line.SafeSubString(1040, 1);
                        record.Filler6 = line.SafeSubString(1041, 35);
                        record.DateApplicationCompleted = line.SafeSubString(1076, 8);
                        record.SignedBy = line.SafeSubString(1084, 1);
                        record.Filler7 = line.SafeSubString(1085, 5);
                        record.PreparerSsn = line.SafeSubString(1090, 9);
                        record.PreparerEmployeeIdentificationNumber = line.SafeSubString(1099, 9);
                        record.PreparerSignature = line.SafeSubString(1108, 1);
                        record.Filler8 = line.SafeSubString(1109, 10);
                        record.DependencyOverrideIndicator = line.SafeSubString(1119, 1);
                        record.FaaFederalSchoolCode = line.SafeSubString(1120, 6);
                        record.Filler9 = line.SafeSubString(1126, 11);
                        record.DependencyStatus = line.SafeSubString(1137, 1);
                        record.TransactionDataSourceTypeCode = line.SafeSubString(1138, 2);
                        record.TransactionReceiptDate = line.SafeSubString(1140, 8);
                        record.SpecialCircumstancesFlag = line.SafeSubString(1148, 1);
                        record.StudentIrsRequestFlag = line.SafeSubString(1149, 2);
                        record.ParentIrsRequestFlag = line.SafeSubString(1151, 2);
                        record.ParentAssetThresholdExceeded = line.SafeSubString(1153, 1);
                        record.StudentAssetThresholdExceeded = line.SafeSubString(1154, 1);
                        record.StudentIrsAdjustedGrossIncomeDataFieldFlag = line.SafeSubString(1155, 1);
                        record.StudentIrsFederalIncomeTaxDataFieldFlag = line.SafeSubString(1156, 1);
                        record.ParentIrsAdjustedGrossIncomeDataFieldFlag = line.SafeSubString(1157, 1);
                        record.ParentIrsFederalIncomeTaxDataFieldFlag = line.SafeSubString(1158, 1);
                        record.StudentIrsDisplayFlag = line.SafeSubString(1159, 1);
                        record.ParentIrsDisplayFlag = line.SafeSubString(1160, 1);
                        record.StudentIrsTypeOfTaxReturnDataFieldFlag = line.SafeSubString(1161, 1);
                        record.StudentIrsEducationCreditsDataFieldFlag = line.SafeSubString(1162, 1);
                        record.StudentIrsIraPaymentsDataFieldFlag = line.SafeSubString(1163, 1);
                        record.StudentIrsInterestIncomeDataFieldFlag = line.SafeSubString(1164, 1);
                        record.StudentIrsUntaxedPortionsOfIraDistributionAndPensionsDataFieldFlag = line.SafeSubString(1165, 1);
                        record.Filler10 = line.SafeSubString(1166, 1);
                        record.StudentIrsTaxReturnFilingStatusDataFieldFlag = line.SafeSubString(1167, 1);
                        record.Filler11 = line.SafeSubString(1168, 1);
                        record.ParentIrsTypeOfTaxReturnDataFieldFlag = line.SafeSubString(1169, 1);
                        record.ParentIrsEducationCreditsDataFieldFlag = line.SafeSubString(1170, 1);
                        record.ParentIrsIraPaymentsDataFieldFlag = line.SafeSubString(1171, 1);
                        record.ParentIrsInterestIncomeDataFieldFlag = line.SafeSubString(1172, 1);
                        record.ParentIrsUntaxedPortionsOfIraDistributionAndPensionsDataFieldFlag = line.SafeSubString(1173, 1);
                        record.Filler12 = line.SafeSubString(1174, 5);
                        record.ParentIrsTaxReturnFilingStatusDataFieldFlag = line.SafeSubString(1179, 1);
                        record.Filler13 = line.SafeSubString(1180, 1);
                        record.ChildrenOfFallenHeroesIndicator = line.SafeSubString(1181, 1);
                        record.Filler14 = line.SafeSubString(1182, 62);
                        record.AssumptionOverride1 = line.SafeSubString(1244, 1);
                        record.AssumptionOverride2 = line.SafeSubString(1245, 1);
                        record.AssumptionOverride3 = line.SafeSubString(1246, 1);
                        record.AssumptionOverride4 = line.SafeSubString(1247, 1);
                        record.AssumptionOverride5 = line.SafeSubString(1248, 1);
                        record.AssumptionOverride6 = line.SafeSubString(1249, 1);
                        record.ElectronicTransactionIndicatorDestinationNumber = line.SafeSubString(1250, 7);
                        record.RejectOverride3 = line.SafeSubString(1257, 1);
                        record.RejectOverride12 = line.SafeSubString(1258, 1);
                        record.RejectOverride20 = line.SafeSubString(1259, 1);
                        record.RejectOverrideA = line.SafeSubString(1260, 1);
                        record.RejectOverrideB = line.SafeSubString(1261, 1);
                        record.RejectOverrideC = line.SafeSubString(1262, 1);
                        record.RejectOverrideG = line.SafeSubString(1263, 1);
                        record.RejectOverrideJ = line.SafeSubString(1264, 1);
                        record.RejectOverrideK = line.SafeSubString(1265, 1);
                        record.RejectOverrideN = line.SafeSubString(1266, 1);
                        record.RejectOverrideW = line.SafeSubString(1267, 1);
                        record.RejectOverride21 = line.SafeSubString(1268, 1);
                        record.Filler15 = line.SafeSubString(1269, 79);
                        record.StudentCurrentSsn = line.SafeSubString(1348, 9);
                        record.CorrectionAppliedAgainstTransactionNumber = line.SafeSubString(1357, 2);
                        record.Filler16 = line.SafeSubString(1359, 4);
                        record.ProfessionalJudgment = line.SafeSubString(1363, 1);
                        record.Filler17 = line.SafeSubString(1364, 10);
                        record.ApplicationDataSourceTypCode = line.SafeSubString(1374, 2);
                        record.ApplicationReceiptDate = line.SafeSubString(1376, 8);
                        record.AddressOnlyChangeFlag = line.SafeSubString(1384, 1);
                        record.CpsPushedIsirFlag = line.SafeSubString(1385, 1);
                        record.EfcChangeFlag = line.SafeSubString(1386, 1);
                        record.StudentLastNameSsnChangeFlag = line.SafeSubString(1387, 1);
                        record.RejectStatusChangeFlag = line.SafeSubString(1388, 1);
                        record.SarcChangeFlag = line.SafeSubString(1389, 1);
                        record.VerificationSelectionChangeFlag = line.SafeSubString(1390, 1);
                        record.ComputeNumber = line.SafeSubString(1391, 3);
                        record.SourceOfCorrection = line.SafeSubString(1394, 1);
                        record.DuplicateSsnIndicator = line.SafeSubString(1395, 1);
                        record.GraduateFlag = line.SafeSubString(1396, 1);
                        record.PellGrantEligibilityFlag = line.SafeSubString(1397, 1);
                        record.TransactionProcessedDate = line.SafeSubString(1398, 8);
                        record.ProcessedRecordType = line.SafeSubString(1406, 1);
                        record.RejectReasonCodes = line.SafeSubString(1407, 14);
                        record.ReprocessedReasonCode = line.SafeSubString(1421, 2);
                        record.SarcFlag = line.SafeSubString(1423, 1);
                        record.AutomaticZeroEfcIndicator = line.SafeSubString(1424, 1);
                        record.SimplifiedNeedsTest = line.SafeSubString(1425, 1);
                        record.ParentCalculated2018TaxStatus = line.SafeSubString(1426, 1);
                        record.StudentCalculated2018TaxStatus = line.SafeSubString(1427, 1);
                        record.StudentAdditionalFinancialInformationTotalCalculatedByCps = line.SafeSubString(1428, 8);
                        record.StudentUntaxedIncomeTotalCalculatedByCps = line.SafeSubString(1436, 8);
                        record.ParentAdditionalFinancialInformationTotalCalculatedByCps = line.SafeSubString(1444, 8);
                        record.ParentUntaxedIncomeTotalCalculatedByCps = line.SafeSubString(1452, 8);
                        record.HighSchoolFlag = line.SafeSubString(1460, 1);
                        record.Filler18 = line.SafeSubString(1461, 10);
                        record.AssumedCitizenship = line.SafeSubString(1471, 1);
                        record.AssumedStudentMaritalStatus = line.SafeSubString(1472, 1);
                        record.AssumedStudentAgi = line.SafeSubString(1473, 7);
                        record.AssumedStudentUSTaxPaid = line.SafeSubString(1480, 7);
                        record.AssumedStudentIncomeFromWork = line.SafeSubString(1487, 7);
                        record.AssumedSpouseIncomeFromWork = line.SafeSubString(1494, 7);
                        record.AssumedStudentAdditionalFinancialInformationTotal = line.SafeSubString(1501, 8);
                        record.AssumedDateOfBirthPrior = line.SafeSubString(1509, 1);
                        record.AssumedStudentMarriedRemarried = line.SafeSubString(1510, 1);
                        record.AssumedHasChildDependents = line.SafeSubString(1511, 1);
                        record.AssumedHasDependentsOtherThanSpouseOrChild = line.SafeSubString(1512, 1);
                        record.AssumedStudentNumberInFamily = line.SafeSubString(1513, 2);
                        record.AssumedStudentNumberInCollege = line.SafeSubString(1515, 1);
                        record.Filler19 = line.SafeSubString(1516, 3);
                        record.AssumedStudentAssetThresholdExceeded = line.SafeSubString(1519, 1);
                        record.Filler20 = line.SafeSubString(1520, 9);
                        record.AssumedParentMaritalStatus = line.SafeSubString(1529, 1);
                        record.AssumedParent1Ssn = line.SafeSubString(1530, 1);
                        record.AssumedParent2Ssn = line.SafeSubString(1531, 1);
                        record.AssumedParentNumberInFamily = line.SafeSubString(1532, 2);
                        record.AssumedParentNumberInCollege = line.SafeSubString(1534, 1);
                        record.AssumedParentAgi = line.SafeSubString(1535, 7);
                        record.AssumedParentUSTaxPaid = line.SafeSubString(1542, 7);
                        record.AssumedParent1IncomeFromWork = line.SafeSubString(1549, 7);
                        record.AssumedParent2IncomeFromWork = line.SafeSubString(1556, 7);
                        record.AssumedParentAdditionalFinancialInformationTotal = line.SafeSubString(1563, 8);
                        record.AssumedParentAssetThresholdExceeded = line.SafeSubString(1571, 1);
                        record.Filler21 = line.SafeSubString(1572, 9);
                        record.PrimaryEfc = line.SafeSubString(1581, 6);
                        record.SecondaryEfc = line.SafeSubString(1587, 6);
                        record.SignatureRejectEfc = line.SafeSubString(1593, 6);
                        record.PrimaryEfcType = line.SafeSubString(1599, 1);
                        record.SecondaryEfcType = line.SafeSubString(1600, 1);
                        record.PrimaryAlternateMonth1 = line.SafeSubString(1601, 6);
                        record.PrimaryAlternateMonth2 = line.SafeSubString(1607, 6);
                        record.PrimaryAlternateMonth3 = line.SafeSubString(1613, 6);
                        record.PrimaryAlternateMonth4 = line.SafeSubString(1619, 6);
                        record.PrimaryAlternateMonth5 = line.SafeSubString(1625, 6);
                        record.PrimaryAlternateMonth6 = line.SafeSubString(1631, 6);
                        record.PrimaryAlternateMonth7 = line.SafeSubString(1637, 6);
                        record.PrimaryAlternateMonth8 = line.SafeSubString(1643, 6);
                        record.PrimaryAlternateMonth10 = line.SafeSubString(1649, 6);
                        record.PrimaryAlternateMonth11 = line.SafeSubString(1655, 6);
                        record.PrimaryAlternateMonth12 = line.SafeSubString(1661, 6);
                        record.SecondaryAlternateMonth1 = line.SafeSubString(1667, 6);
                        record.SecondaryAlternateMonth2 = line.SafeSubString(1673, 6);
                        record.SecondaryAlternateMonth3 = line.SafeSubString(1679, 6);
                        record.SecondaryAlternateMonth4 = line.SafeSubString(1685, 6);
                        record.SecondaryAlternateMonth5 = line.SafeSubString(1691, 6);
                        record.SecondaryAlternateMonth6 = line.SafeSubString(1697, 6);
                        record.SecondaryAlternateMonth7 = line.SafeSubString(1703, 6);
                        record.SecondaryAlternateMonth8 = line.SafeSubString(1709, 6);
                        record.SecondaryAlternateMonth10 = line.SafeSubString(1715, 6);
                        record.SecondaryAlternateMonth11 = line.SafeSubString(1721, 6);
                        record.SecondaryAlternateMonth12 = line.SafeSubString(1727, 6);
                        record.TotalIncome = line.SafeSubString(1733, 8);
                        record.AllowancesAgainstTotalIncome = line.SafeSubString(1741, 7);
                        record.StateAndOtherTaxAllowance = line.SafeSubString(1748, 7);
                        record.EmploymentAllowance = line.SafeSubString(1755, 7);
                        record.IncomeProtectionAllowance = line.SafeSubString(1762, 7);
                        record.AvailableIncome = line.SafeSubString(1769, 8);
                        record.ContributionFromAvailableIncome = line.SafeSubString(1777, 7);
                        record.DiscretionaryNetWorth = line.SafeSubString(1784, 9);
                        record.NetWorth = line.SafeSubString(1793, 9);
                        record.AssetProtectionAllowance = line.SafeSubString(1802, 9);
                        record.ParentContributionFromAssets = line.SafeSubString(1811, 7);
                        record.AdjustedAvailableIncome = line.SafeSubString(1818, 8);
                        record.TotalStudentContribution = line.SafeSubString(1826, 7);
                        record.TotalParentContribution = line.SafeSubString(1833, 7);
                        record.ParentContribution = line.SafeSubString(1840, 7);
                        record.StudentTotalIncome = line.SafeSubString(1847, 8);
                        record.StudentAllowanceAgainstTotalIncome = line.SafeSubString(1855, 7);
                        record.DependentStudentIncomeContribution = line.SafeSubString(1862, 7);
                        record.StudentDiscretionaryNetWorth = line.SafeSubString(1869, 9);
                        record.StudentContributionFromAssets = line.SafeSubString(1878, 7);
                        record.FisapTotalIncome = line.SafeSubString(1885, 8);
                        record.SecondaryTotalIncome = line.SafeSubString(1893, 8);
                        record.SecondaryAllowancesAgainstTotalIncome = line.SafeSubString(1901, 7);
                        record.SecondaryStateAndOtherTaxAllowance = line.SafeSubString(1908, 7);
                        record.SecondaryEmploymentAllowance = line.SafeSubString(1915, 7);
                        record.SecondaryIncomeProtectionAllowance = line.SafeSubString(1922, 7);
                        record.SecondaryAvailableIncome = line.SafeSubString(1929, 8);
                        record.SecondaryContributionFromAvailableIncome = line.SafeSubString(1937, 7);
                        record.SecondaryDiscretionaryNetWorth = line.SafeSubString(1944, 9);
                        record.SecondaryNetWorth = line.SafeSubString(1953, 9);
                        record.SecondaryAssetProtectionAllowance = line.SafeSubString(1962, 9);
                        record.SecondaryParentContributionFromAssets = line.SafeSubString(1971, 7);
                        record.SecondaryAdjustedAvailableIncome = line.SafeSubString(1978, 8);
                        record.SecondaryTotalStudentContribution = line.SafeSubString(1986, 7);
                        record.SecondaryTotalParentContribution = line.SafeSubString(1993, 7);
                        record.SecondaryParentContribution = line.SafeSubString(2000, 7);
                        record.SecondaryStudentTotalIncome = line.SafeSubString(2007, 8);
                        record.SecondaryStudentAllowanceAgainstTotalIncome = line.SafeSubString(2015, 7);
                        record.SecondaryDependentStudentIncomeContribution = line.SafeSubString(2022, 7);
                        record.SecondaryStudentDiscretionaryNetWorth = line.SafeSubString(2029, 9);
                        record.SecondaryStudentContributionFromAssets = line.SafeSubString(2038, 7);
                        record.SecondaryFisapTotalIncome = line.SafeSubString(2045, 8);
                        record.Filler22 = line.SafeSubString(2053, 50);
                        record.CorrectionFlags = line.SafeSubString(2103, 195);
                        record.Filler23 = line.SafeSubString(2298, 15);
                        record.HighlightFlags = line.SafeSubString(2313, 195);
                        record.Filler24 = line.SafeSubString(2508, 15);
                        record.FafsaDataVerifyFlags = line.SafeSubString(2523, 195);
                        record.Filler25 = line.SafeSubString(2718, 15);
                        record.DhsMatchFlag = line.SafeSubString(2733, 1);
                        record.SecondaryDhsMatchFlag = line.SafeSubString(2734, 1);
                        record.Filler26 = line.SafeSubString(2735, 15);
                        record.DhsVerificationNumber = line.SafeSubString(2750, 15);
                        record.Filler27 = line.SafeSubString(2765, 1);
                        record.NsldsMatchFlag = line.SafeSubString(2766, 1);
                        record.NsldsPostscreeningReasonCode = line.SafeSubString(2767, 6);
                        record.Filler28 = line.SafeSubString(2773, 9);
                        record.Parent1SsnMatchFlag = line.SafeSubString(2782, 1);
                        record.Filler29 = line.SafeSubString(2783, 9);
                        record.Parent2SsnMatchFlag = line.SafeSubString(2792, 1);
                        record.SelectiveServiceMatchFlag = line.SafeSubString(2793, 1);
                        record.SelectiveServiceRegistrationFlag = line.SafeSubString(2794, 1);
                        record.SsaCitizenshipFlag = line.SafeSubString(2795, 1);
                        record.Filler30 = line.SafeSubString(2796, 8);
                        record.SsnMatchFlag = line.SafeSubString(2804, 1);
                        record.VaMatchFlag = line.SafeSubString(2805, 1);
                        record.DepartmentOfDefenseMatchFlag = line.SafeSubString(2806, 1);
                        record.DepartmentOfDefenseParentDateOfDeath = line.SafeSubString(2807, 8);
                        record.Filler31 = line.SafeSubString(2815, 50);
                        record.CommentCodes = line.SafeSubString(2865, 60);
                        record.Filler32 = line.SafeSubString(2925, 15);
                        record.ElectronicFederalSchoolCodeIndicator = line.SafeSubString(2940, 1);
                        record.ElectronicTransactionIndicatorFlag = line.SafeSubString(2941, 1);
                        record.Filler33 = line.SafeSubString(2942, 10);
                        record.Filler34 = line.SafeSubString(2952, 5);
                        record.VerificationTrackingFlag = line.SafeSubString(2957, 4);
                        record.StudentSelectedForVerification = line.SafeSubString(2961, 1);
                        record.Filler35 = line.SafeSubString(2962, 199);
                        record.NsldsTransactionNumber = line.SafeSubString(3161, 2);
                        record.NsldsDatabaseResultsFlag = line.SafeSubString(3163, 1);
                        record.Filler36 = line.SafeSubString(3164, 1);
                        record.NsldsPellOverpaymentFlag = line.SafeSubString(3165, 1);
                        record.NsldsPellOverpaymentContact = line.SafeSubString(3166, 8);
                        record.NsldsSeogOverpaymentFlag = line.SafeSubString(3174, 1);
                        record.NsldsSeogOverpaymentContact = line.SafeSubString(3175, 8);
                        record.NsldsPerkinsOverpaymentFlag = line.SafeSubString(3183, 1);
                        record.NsldsPerkinsOverpaymentContact = line.SafeSubString(3184, 8);
                        record.NsldsTeachOverpaymentFlag = line.SafeSubString(3192, 1);
                        record.NsldsTeachOverpaymentContact = line.SafeSubString(3193, 8);
                        record.NsldsIraqAfghanistanServiceGrantOverpaymentFlag = line.SafeSubString(3201, 1);
                        record.NsldsIraqAfghanistanServiceGrantOverpaymentContact = line.SafeSubString(3202, 8);
                        record.NsldsDefaultedLoanFlag = line.SafeSubString(3210, 1);
                        record.NsldsDischargedLoanFlag = line.SafeSubString(3211, 1);
                        record.NsldsFraudLoanFlag = line.SafeSubString(3212, 1);
                        record.NsldsLoanSatisfactoryRepaymentFlag = line.SafeSubString(3213, 1);
                        record.NsldsActiveBankruptcyFlag = line.SafeSubString(3214, 1);
                        record.NsldsTeachGrantLoanConversionFlag = line.SafeSubString(3215, 1);
                        record.NsldsAggregateSubsidizedOutstandingPrincipalBalance = line.SafeSubString(3216, 6);
                        record.NsldsAggregateUnsubsidizedOutstandingPrincipalBalance = line.SafeSubString(3222, 6);
                        record.NsldsAggregateCombinedOutstandingPrincipalBalance = line.SafeSubString(3228, 6);
                        record.NsldsAggregateUnallocatedConsolidatedOutstandingPrincipalBalance = line.SafeSubString(3234, 6);
                        record.NsldsAggregateTeachLoanPrincipalBalance = line.SafeSubString(3240, 6);
                        record.NsldsAggregateSubsidizedPendingDisbursement = line.SafeSubString(3246, 6);
                        record.NsldsAggregateUnsubsidizedPendingDisbursement = line.SafeSubString(3252, 6);
                        record.NsldsAggregateCombinedPendingDisbursement = line.SafeSubString(3258, 6);
                        record.NsldsAggregateSubsidizedTotal = line.SafeSubString(3264, 6);
                        record.NsldsAggregateUnsubsidizedTotal = line.SafeSubString(3270, 6);
                        record.NsldsAggregateCombinedTotal = line.SafeSubString(3276, 6);
                        record.NsldsUnallocatedConsolidatedTotal = line.SafeSubString(3282, 6);
                        record.NsldsTeachLoanTotal = line.SafeSubString(3288, 6);
                        record.NsldsPerkinsCumulativeDisbursementAmount = line.SafeSubString(3294, 6);
                        record.NsldsPerkinsCurrentYearDisbursementAmount = line.SafeSubString(3300, 6);
                        record.NsldsAggregateTeachUndergraduatePostBaccalaureateDisbursementAmount = line.SafeSubString(3306, 6);
                        record.NsldsAggregateTeachGraduateDisbursementAmount = line.SafeSubString(3312, 6);
                        record.NsldsDefaultedLoanChangeFlag = line.SafeSubString(3318, 1);
                        record.NsldsFraudLoanChangeFlag = line.SafeSubString(3319, 1);
                        record.NsldsDischargedLoanChangeFlag = line.SafeSubString(3320, 1);
                        record.NsldsLoanSatisfactoryRepaymentChangeFlag = line.SafeSubString(3321, 1);
                        record.NsldsActiveBankruptcyChangeFlag = line.SafeSubString(3322, 1);
                        record.NsldsTeachGrantLoanConversionChangeFlag = line.SafeSubString(3323, 1);
                        record.NsldsOverpaymentsChangeFlag = line.SafeSubString(3324, 1);
                        record.NsldsAggregateLoanChangeFlag = line.SafeSubString(3325, 1);
                        record.NsldsPerkinsLoanChangeFlag = line.SafeSubString(3326, 1);
                        record.NsldsPellPaymentChangeFlag = line.SafeSubString(3327, 1);
                        record.NsldsTeachGrantChangeFlag = line.SafeSubString(3328, 1);
                        record.NsldsAdditionalPellFlag = line.SafeSubString(3329, 1);
                        record.NsldsAdditionalLoansFlag = line.SafeSubString(3330, 1);
                        record.NsldsAdditionalTeachGrantFlag = line.SafeSubString(3331, 1);
                        record.NsldsDirectLoanMasterPromNoteFlag = line.SafeSubString(3332, 1);
                        record.NsldsDirectLoanPlusMasterPromNoteFlag = line.SafeSubString(3333, 1);
                        record.NsldsDirectLoanGraduatePlusMasterPromNoteFlag = line.SafeSubString(3334, 1);
                        record.NsldsUndergraduateSubsidizedLoanLimitFlag = line.SafeSubString(3335, 1);
                        record.NsldsUndergraduateCombinedLoanLimitFlag = line.SafeSubString(3336, 1);
                        record.NsldsGraduateSubsidizedLoanLimitFlag = line.SafeSubString(3337, 1);
                        record.NsldsGraduateCombinedLoanLimitFlag = line.SafeSubString(3338, 1);
                        record.NsldsPellLifetimeLimitFlag = line.SafeSubString(3339, 1);
                        record.NsldsPellLifetimeEligibilityUsed = line.SafeSubString(3340, 7);
                        record.NsldsSubsidizedUsageLimitAppliesFlag = line.SafeSubString(3347, 1);
                        record.NsldsSubsidizedUsagePeriod = line.SafeSubString(3348, 6);
                        record.NsldsUnusualEnrollmentHistoryFlag = line.SafeSubString(3354, 1);
                        record.Filler37 = line.SafeSubString(3355, 6);
                        record.NsldsPellSequenceNumber1 = line.SafeSubString(3361, 2);
                        record.NsldsPellVerificationFlag1 = line.SafeSubString(3363, 3);
                        record.NsldsEfc1 = line.SafeSubString(3366, 6);
                        record.NsldsPellSchoolCode1 = line.SafeSubString(3372, 8);
                        record.NsldsPellTransactionNumber1 = line.SafeSubString(3380, 2);
                        record.NsldsPellLastUpdateDate1 = line.SafeSubString(3382, 8);
                        record.NsldsPellScheduledAmount1 = line.SafeSubString(3390, 6);
                        record.NsldsPellAmountPaidToDate1 = line.SafeSubString(3396, 6);
                        record.NsldsPellPercentScheduledAwardUsedByAwardYear1 = line.SafeSubString(3402, 7);
                        record.NsldsPellAwardAmount1 = line.SafeSubString(3409, 6);
                        record.NsldsAdditionalEligibilityIndicator1 = line.SafeSubString(3415, 1);
                        record.Filler38 = line.SafeSubString(3416, 3);
                        record.Filler39 = line.SafeSubString(3419, 4);
                        record.NsldsPellSequenceNumber2 = line.SafeSubString(3423, 2);
                        record.NsldsPellVerificationFlag2 = line.SafeSubString(3425, 3);
                        record.NsldsEfc2 = line.SafeSubString(3428, 6);
                        record.NsldsPellSchoolCode2 = line.SafeSubString(3434, 8);
                        record.NsldsPellTransactionNumber2 = line.SafeSubString(3442, 2);
                        record.NsldsPellLastUpdateDate2 = line.SafeSubString(3444, 8);
                        record.NsldsPellScheduledAmount2 = line.SafeSubString(3452, 6);
                        record.NsldsPellAmountPaidToDate2 = line.SafeSubString(3458, 6);
                        record.NsldsPellPercentScheduledAwardUsedByAwardYear2 = line.SafeSubString(3464, 7);
                        record.NsldsPellAwardAmount2 = line.SafeSubString(3471, 6);
                        record.NsldsAdditionalEligibilityIndicator2 = line.SafeSubString(3477, 1);
                        record.Filler40 = line.SafeSubString(3478, 3);
                        record.Filler41 = line.SafeSubString(3481, 4);
                        record.NsldsPellSequenceNumber3 = line.SafeSubString(3485, 2);
                        record.NsldsPellVerificationFlag3 = line.SafeSubString(3487, 3);
                        record.NsldsEfc3 = line.SafeSubString(3490, 6);
                        record.NsldsPellSchoolCode3 = line.SafeSubString(3496, 8);
                        record.NsldsPellTransactionNumber3 = line.SafeSubString(3504, 2);
                        record.NsldsPellLastUpdateDate3 = line.SafeSubString(3506, 8);
                        record.NsldsPellScheduledAmount3 = line.SafeSubString(3514, 6);
                        record.NsldsPellAmountPaidToDate3 = line.SafeSubString(3520, 6);
                        record.NsldsPellPercentScheduledAwardUsedByAwardYear3 = line.SafeSubString(3526, 7);
                        record.NsldsPellAwardAmount3 = line.SafeSubString(3533, 6);
                        record.NsldsAdditionalEligibilityIndicator3 = line.SafeSubString(3539, 1);
                        record.Filler42 = line.SafeSubString(3540, 3);
                        record.Filler43 = line.SafeSubString(3543, 4);
                        record.NsldsTeachGrantSequenceNumber1 = line.SafeSubString(3547, 2);
                        record.NsldsTeachGrantSchoolCode1 = line.SafeSubString(3549, 8);
                        record.NsldsTeachGrantTransactionNumber1 = line.SafeSubString(3557, 2);
                        record.NsldsTeachGrantLastUpdateDate1 = line.SafeSubString(3559, 8);
                        record.NsldsTeachGrantScheduledAwardAmount1 = line.SafeSubString(3567, 6);
                        record.NsldsTeachGrantAmountPaidToDate1 = line.SafeSubString(3573, 6);
                        record.NsldsTeachGrantAwardAmount1 = line.SafeSubString(3579, 6);
                        record.NsldsTeachGrantAcademicYearLevel1 = line.SafeSubString(3585, 1);
                        record.NsldsTeachGrantCodSequenceCode1 = line.SafeSubString(3586, 3);
                        record.NsldsTeachGrantAwardYear1 = line.SafeSubString(3589, 4);
                        record.NsldsTeachGrantLoanConversionFlag1 = line.SafeSubString(3593, 1);
                        record.NsldsTeachGrantSequenceNumber2 = line.SafeSubString(3594, 2);
                        record.NsldsTeachGrantSchoolCode2 = line.SafeSubString(3596, 8);
                        record.NsldsTeachGrantTransactionNumber2 = line.SafeSubString(3604, 2);
                        record.NsldsTeachGrantLastUpdateDate2 = line.SafeSubString(3606, 8);
                        record.NsldsTeachGrantScheduledAwardAmount2 = line.SafeSubString(3614, 6);
                        record.NsldsTeachGrantAmountPaidToDate2 = line.SafeSubString(3620, 6);
                        record.NsldsTeachGrantAwardAmount2 = line.SafeSubString(3626, 6);
                        record.NsldsTeachGrantAcademicYearLevel2 = line.SafeSubString(3632, 1);
                        record.NsldsTeachGrantCodSequenceCode2 = line.SafeSubString(3633, 3);
                        record.NsldsTeachGrantAwardYear2 = line.SafeSubString(3636, 4);
                        record.NsldsTeachGrantLoanConversionFlag2 = line.SafeSubString(3640, 1);
                        record.NsldsTeachGrantSequenceNumber3 = line.SafeSubString(3641, 2);
                        record.NsldsTeachGrantSchoolCode3 = line.SafeSubString(3643, 8);
                        record.NsldsTeachGrantTransactionNumber3 = line.SafeSubString(3651, 2);
                        record.NsldsTeachGrantLastUpdateDate3 = line.SafeSubString(3653, 8);
                        record.NsldsTeachGrantScheduledAwardAmount3 = line.SafeSubString(3661, 6);
                        record.NsldsTeachGrantAmountPaidToDate3 = line.SafeSubString(3667, 6);
                        record.NsldsTeachGrantAwardAmount3 = line.SafeSubString(3673, 6);
                        record.NsldsTeachGrantAcademicYearLevel3 = line.SafeSubString(3679, 1);
                        record.NsldsTeachGrantCodSequenceCode3 = line.SafeSubString(3680, 3);
                        record.NsldsTeachGrantAwardYear3 = line.SafeSubString(3683, 4);
                        record.NsldsTeachGrantLoanConversionFlag3 = line.SafeSubString(3687, 1);
                        record.NsldsLoanSequenceNumber1 = line.SafeSubString(3688, 2);
                        record.NsldsLoanTypeCode1 = line.SafeSubString(3690, 1);
                        record.NsldsLoanChangeFlag1 = line.SafeSubString(3691, 1);
                        record.NsldsLoanProgramCode1 = line.SafeSubString(3692, 2);
                        record.NsldsLoanNetAmount1 = line.SafeSubString(3694, 6);
                        record.NsldsLoanCurrentStatusCode1 = line.SafeSubString(3700, 2);
                        record.NsldsLoanCurrentStatusDate1 = line.SafeSubString(3702, 8);
                        record.NsldsLoanAggregatePrincipalBalance1 = line.SafeSubString(3710, 6);
                        record.NsldsLoanPrincipalBalanceDate1 = line.SafeSubString(3716, 8);
                        record.NsldsLoanBeginDate1 = line.SafeSubString(3724, 8);
                        record.NsldsLoanEndDate1 = line.SafeSubString(3732, 8);
                        record.NsldsLoanGuarantyAgencyCode1 = line.SafeSubString(3740, 3);
                        record.NsldsLoanContactType1 = line.SafeSubString(3743, 3);
                        record.NsldsLoanSchoolCode1 = line.SafeSubString(3746, 8);
                        record.NsldsLoanContactCode1 = line.SafeSubString(3754, 8);
                        record.NsldsLoanGradeLevel1 = line.SafeSubString(3762, 3);
                        record.NsldsLoanAdditionalUnsubsidizedFlag1 = line.SafeSubString(3765, 1);
                        record.NsldsLoanCapitalizedInterestFlag1 = line.SafeSubString(3766, 1);
                        record.NsldsLoanDisbursementAmount1 = line.SafeSubString(3767, 6);
                        record.NsldsLoanDisbursementDate1 = line.SafeSubString(3773, 8);
                        record.NsldsLoanConfirmedLoanSubsidyStatus1 = line.SafeSubString(3781, 1);
                        record.NsldsLoanSubsidyStatusDate1 = line.SafeSubString(3782, 8);
                        record.NsldsLoanSequenceNumber2 = line.SafeSubString(3790, 2);
                        record.NsldsLoanTypeCode2 = line.SafeSubString(3792, 1);
                        record.NsldsLoanChangeFlag2 = line.SafeSubString(3793, 1);
                        record.NsldsLoanProgramCode2 = line.SafeSubString(3794, 2);
                        record.NsldsLoanNetAmount2 = line.SafeSubString(3796, 6);
                        record.NsldsLoanCurrentStatusCode2 = line.SafeSubString(3802, 2);
                        record.NsldsLoanCurrentStatusDate2 = line.SafeSubString(3804, 8);
                        record.NsldsLoanAggregatePrincipalBalance2 = line.SafeSubString(3812, 6);
                        record.NsldsLoanPrincipalBalanceDate2 = line.SafeSubString(3818, 8);
                        record.NsldsLoanBeginDate2 = line.SafeSubString(3826, 8);
                        record.NsldsLoanEndDate2 = line.SafeSubString(3834, 8);
                        record.NsldsLoanGuarantyAgencyCode2 = line.SafeSubString(3842, 3);
                        record.NsldsLoanContactType2 = line.SafeSubString(3845, 3);
                        record.NsldsLoanSchoolCode2 = line.SafeSubString(3848, 8);
                        record.NsldsLoanContactCode2 = line.SafeSubString(3856, 8);
                        record.NsldsLoanGradeLevel2 = line.SafeSubString(3864, 3);
                        record.NsldsLoanAdditionalUnsubsidizedFlag2 = line.SafeSubString(3867, 1);
                        record.NsldsLoanCapitalizedInterestFlag2 = line.SafeSubString(3868, 1);
                        record.NsldsLoanDisbursementAmount2 = line.SafeSubString(3869, 6);
                        record.NsldsLoanDisbursementDate2 = line.SafeSubString(3875, 8);
                        record.NsldsLoanConfirmedLoanSubsidyStatus2 = line.SafeSubString(3883, 1);
                        record.NsldsLoanSubsidyStatusDate2 = line.SafeSubString(3884, 8);
                        record.NsldsLoanSequenceNumber3 = line.SafeSubString(3892, 2);
                        record.NsldsLoanTypeCode3 = line.SafeSubString(3894, 1);
                        record.NsldsLoanChangeFlag3 = line.SafeSubString(3895, 1);
                        record.NsldsLoanProgramCode3 = line.SafeSubString(3896, 2);
                        record.NsldsLoanNetAmount3 = line.SafeSubString(3898, 6);
                        record.NsldsLoanCurrentStatusCode3 = line.SafeSubString(3904, 2);
                        record.NsldsLoanCurrentStatusDate3 = line.SafeSubString(3906, 8);
                        record.NsldsLoanAggregatePrincipalBalance3 = line.SafeSubString(3914, 6);
                        record.NsldsLoanPrincipalBalanceDate3 = line.SafeSubString(3920, 8);
                        record.NsldsLoanBeginDate3 = line.SafeSubString(3928, 8);
                        record.NsldsLoanEndDate3 = line.SafeSubString(3936, 8);
                        record.NsldsLoanGuarantyAgencyCode3 = line.SafeSubString(3944, 3);
                        record.NsldsLoanContactType3 = line.SafeSubString(3947, 3);
                        record.NsldsLoanSchoolCode3 = line.SafeSubString(3950, 8);
                        record.NsldsLoanContactCode3 = line.SafeSubString(3958, 8);
                        record.NsldsLoanGradeLevel3 = line.SafeSubString(3966, 3);
                        record.NsldsLoanAdditionalUnsubsidizedFlag3 = line.SafeSubString(3969, 1);
                        record.NsldsLoanCapitalizedInterestFlag3 = line.SafeSubString(3970, 1);
                        record.NsldsLoanDisbursementAmount3 = line.SafeSubString(3971, 6);
                        record.NsldsLoanDisbursementDate3 = line.SafeSubString(3977, 8);
                        record.NsldsLoanConfirmedLoanSubsidyStatus3 = line.SafeSubString(3985, 1);
                        record.NsldsLoanSubsidyStatusDate3 = line.SafeSubString(3986, 8);
                        record.NsldsLoanSequenceNumber4 = line.SafeSubString(3994, 2);
                        record.NsldsLoanTypeCode4 = line.SafeSubString(3996, 1);
                        record.NsldsLoanChangeFlag4 = line.SafeSubString(3997, 1);
                        record.NsldsLoanProgramCode4 = line.SafeSubString(3998, 2);
                        record.NsldsLoanNetAmount4 = line.SafeSubString(4000, 6);
                        record.NsldsLoanCurrentStatusCode4 = line.SafeSubString(4006, 2);
                        record.NsldsLoanCurrentStatusDate4 = line.SafeSubString(4008, 8);
                        record.NsldsLoanAggregatePrincipalBalance4 = line.SafeSubString(4016, 6);
                        record.NsldsLoanPrincipalBalanceDate4 = line.SafeSubString(4022, 8);
                        record.NsldsLoanBeginDate4 = line.SafeSubString(4030, 8);
                        record.NsldsLoanEndDate4 = line.SafeSubString(4038, 8);
                        record.NsldsLoanGuarantyAgencyCode4 = line.SafeSubString(4046, 3);
                        record.NsldsLoanContactType4 = line.SafeSubString(4049, 3);
                        record.NsldsLoanSchoolCode4 = line.SafeSubString(4052, 8);
                        record.NsldsLoanContactCode4 = line.SafeSubString(4060, 8);
                        record.NsldsLoanGradeLevel4 = line.SafeSubString(4068, 3);
                        record.NsldsLoanAdditionalUnsubsidizedFlag4 = line.SafeSubString(4071, 1);
                        record.NsldsLoanCapitalizedInterestFlag4 = line.SafeSubString(4072, 1);
                        record.NsldsLoanDisbursementAmount4 = line.SafeSubString(4073, 6);
                        record.NsldsLoanDisbursementDate4 = line.SafeSubString(4079, 8);
                        record.NsldsLoanConfirmedLoanSubsidyStatus4 = line.SafeSubString(4087, 1);
                        record.NsldsLoanSubsidyStatusDate4 = line.SafeSubString(4088, 8);
                        record.NsldsLoanSequenceNumber5 = line.SafeSubString(4096, 2);
                        record.NsldsLoanTypeCode5 = line.SafeSubString(4098, 1);
                        record.NsldsLoanChangeFlag5 = line.SafeSubString(4099, 1);
                        record.NsldsLoanProgramCode5 = line.SafeSubString(4100, 2);
                        record.NsldsLoanNetAmount5 = line.SafeSubString(4102, 6);
                        record.NsldsLoanCurrentStatusCode5 = line.SafeSubString(4108, 2);
                        record.NsldsLoanCurrentStatusDate5 = line.SafeSubString(4110, 8);
                        record.NsldsLoanAggregatePrincipalBalance5 = line.SafeSubString(4118, 6);
                        record.NsldsLoanPrincipalBalanceDate5 = line.SafeSubString(4124, 8);
                        record.NsldsLoanBeginDate5 = line.SafeSubString(4132, 8);
                        record.NsldsLoanEndDate5 = line.SafeSubString(4140, 8);
                        record.NsldsLoanGuarantyAgencyCode5 = line.SafeSubString(4148, 3);
                        record.NsldsLoanContactType5 = line.SafeSubString(4151, 3);
                        record.NsldsLoanSchoolCode5 = line.SafeSubString(4154, 8);
                        record.NsldsLoanContactCode5 = line.SafeSubString(4162, 8);
                        record.NsldsLoanGradeLevel5 = line.SafeSubString(4170, 3);
                        record.NsldsLoanAdditionalUnsubsidizedFlag5 = line.SafeSubString(4173, 1);
                        record.NsldsLoanCapitalizedInterestFlag5 = line.SafeSubString(4174, 1);
                        record.NsldsLoanDisbursementAmount5 = line.SafeSubString(4175, 6);
                        record.NsldsLoanDisbursementDate5 = line.SafeSubString(4181, 8);
                        record.NsldsLoanConfirmedLoanSubsidyStatus5 = line.SafeSubString(4189, 1);
                        record.NsldsLoanSubsidyStatusDate5 = line.SafeSubString(4190, 8);
                        record.NsldsLoanSequenceNumber6 = line.SafeSubString(4198, 2);
                        record.NsldsLoanTypeCode6 = line.SafeSubString(4200, 1);
                        record.NsldsLoanChangeFlag6 = line.SafeSubString(4201, 1);
                        record.NsldsLoanProgramCode6 = line.SafeSubString(4202, 2);
                        record.NsldsLoanNetAmount6 = line.SafeSubString(4204, 6);
                        record.NsldsLoanCurrentStatusCode6 = line.SafeSubString(4210, 2);
                        record.NsldsLoanCurrentStatusDate6 = line.SafeSubString(4212, 8);
                        record.NsldsLoanAggregatePrincipalBalance6 = line.SafeSubString(4220, 6);
                        record.NsldsLoanPrincipalBalanceDate6 = line.SafeSubString(4226, 8);
                        record.NsldsLoanBeginDate6 = line.SafeSubString(4234, 8);
                        record.NsldsLoanEndDate6 = line.SafeSubString(4242, 8);
                        record.NsldsLoanGuarantyAgencyCode6 = line.SafeSubString(4250, 3);
                        record.NsldsLoanContactType6 = line.SafeSubString(4253, 3);
                        record.NsldsLoanSchoolCode6 = line.SafeSubString(4256, 8);
                        record.NsldsLoanContactCode6 = line.SafeSubString(4264, 8);
                        record.NsldsLoanGradeLevel6 = line.SafeSubString(4272, 3);
                        record.NsldsLoanAdditionalUnsubsidizedFlag6 = line.SafeSubString(4275, 1);
                        record.NsldsLoanCapitalizedInterestFlag6 = line.SafeSubString(4276, 1);
                        record.NsldsLoanDisbursementAmount6 = line.SafeSubString(4277, 6);
                        record.NsldsLoanDisbursementDate6 = line.SafeSubString(4283, 8);
                        record.NsldsLoanConfirmedLoanSubsidyStatus6 = line.SafeSubString(4291, 1);
                        record.NsldsLoanSubsidyStatusDate6 = line.SafeSubString(4292, 8);

                        records.Add(record);
                    }
                }
                //Add the file into the archive location and delete from the original location
                FS.Copy(file, file.Replace("ISIR","Archive"), true);
                FS.Delete(file);
            }

            return records;
        }
    }
}
