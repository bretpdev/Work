CREATE PROCEDURE [verforbuh].[BorrowerUsedForbearanceWithinLastYear]
	@Ssn CHAR(9)
AS
SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
SELECT
	CAST(CASE WHEN COUNT(*) > 0 THEN 1 ELSE 0 END AS BIT)
FROM
	FB10_BR_FOR_REQ FB10
	INNER JOIN LN60_BR_FOR_APV LN60 
		ON FB10.BF_SSN = LN60.BF_SSN 
		AND FB10.LF_FOR_CTL_NUM = LN60.LF_FOR_CTL_NUM
WHERE
	FB10.LC_FOR_TYP = '05'
	AND
	(
		LN60.LD_FOR_BEG BETWEEN DATEADD(YEAR, -1, GETDATE()) AND GETDATE()
		OR LN60.LD_FOR_END BETWEEN DATEADD(YEAR, -1, GETDATE()) AND GETDATE()
	)
	AND FB10.LC_FOR_STA = 'A'
    AND LN60. LC_STA_LON60 = 'A'
    AND FB10.LC_FOR_STA = 'A'
	AND FB10.BF_SSN = @Ssn


RETURN 0
