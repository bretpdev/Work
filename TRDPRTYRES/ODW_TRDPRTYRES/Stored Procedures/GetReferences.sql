CREATE PROCEDURE [trdprtyres].[GetReferences]
	@AccountIdentifier VARCHAR(10)
AS
	SELECT
		BR03.DF_PRS_ID_RFR AS ReferenceId,
		CONCAT(RTRIM(BR03.BM_RFR_1), ' ', RTRIM(BR03.BM_RFR_LST)) AS ReferenceName,
		RTRIM(BR03.BM_RFR_1) AS FirstName,
		RTRIM(BR03.BM_RFR_MID) AS MiddleInitial,
		RTRIM(BR03.BM_RFR_LST) AS LastName,
		RTRIM(BR03.BX_RFR_STR_ADR_1) AS Address1,
		RTRIM(BR03.BX_RFR_STR_ADR_2) AS Address2,
		RTRIM(BR03.BM_RFR_CT) AS City,
		RTRIM(BR03.BC_RFR_ST) AS [State],
		RTRIM(BR03.BF_RFR_ZIP) AS ZipCode,
		BR03.BI_VLD_ADR AS IsValidAddress,
		BR03.BN_RFR_DOM_PHN AS HomePhone,
		BR03.BN_RFR_DOM_PHN_XTN AS HomeExt,
		BR03.BN_RFR_ALT_PHN AS AltPhone,
		BR03.BN_RFR_ALT_PHN_XTN AS AltExt,
		ISNULL(RTRIM(BR03.BN_HME_FGN_PHN), '') AS ForeignPhone,
		ISNULL(RTRIM(BR03.BN_HME_FGN_PHN_XTN), '') AS ForeignExt,
		RTRIM(BR03.BX_RFR_EML_ADR) AS EmailAddress,
		RTRIM(BR03.BC_RFR_SRC) AS SourceCode,
		RTRIM(BR03.BC_RFR_REL_BR) AS RelationshipCode
	FROM
		ODW..BR03_BR_REF BR03
		INNER JOIN ODW..PD01_PDM_INF PD01
			ON PD01.DF_PRS_ID = BR03.DF_PRS_ID_BR
	WHERE
		@AccountIdentifier IN (BR03.DF_PRS_ID_BR, PD01.DF_SPE_ACC_ID)