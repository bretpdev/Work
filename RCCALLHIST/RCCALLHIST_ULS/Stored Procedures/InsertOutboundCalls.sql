CREATE PROCEDURE [rccallhist].[InsertOutboundCalls]
(
	@OutboundCalls OutboundCalls READONLY
)
AS
BEGIN
	DELETE FROM _OutboundCalls

	INSERT INTO 
		_OutboundCalls
	SELECT
		RowId,
		CallType,
		ListId,
		CampaignId,
		AccountNumber,
		AreaCode,
		Phone,
		AdditionalStatus,
		[Status],
		AgentId,
		StartTime,
		VoxFileName,
		TimeConnect,
		TimeACW,
		TimeHold,
		AgentHold,
		DialerField1,
		DialerField2,
		DialerField3,
		DialerField4,
		DialerField5,
		DialerField6,
		DialerField7,
		DialerField8,
		DialerField9,
		DialerField10,
		DialerField11,
		DialerField12,
		DialerField13,
		DialerField14,
		DialerField15,
		DialerField16,
		DialerField17,
		DialerField18,
		DialerField19,
		DialerField20,
		DialerField21,
		DialerField22,
		DialerField23,
		DialerField24,
		DialerField25,
		DialerField26
	FROM
		@OutboundCalls

	MERGE rccallhist.OutboundCalls AS [Target]
	USING
	(
		SELECT
			RowId,
			CallType,
			ListId,
			CampaignId,
			AccountNumber,
			AreaCode,
			Phone,
			AdditionalStatus,
			[Status],
			AgentId,
			StartTime,
			VoxFileName,
			TimeConnect,
			TimeACW,
			TimeHold,
			AgentHold,
			DialerField1,
			DialerField2,
			DialerField3,
			DialerField4,
			DialerField5,
			DialerField6,
			DialerField7,
			DialerField8,
			DialerField9,
			DialerField10,
			DialerField11,
			DialerField12,
			DialerField13,
			DialerField14,
			DialerField15,
			DialerField16,
			DialerField17,
			DialerField18,
			DialerField19,
			DialerField20,
			DialerField21,
			DialerField22,
			DialerField23,
			DialerField24,
			DialerField25,
			DialerField26
		FROM
			@OutboundCalls
	) [Source]
	ON
		[Target].RowId = [Source].RowId
	WHEN MATCHED THEN UPDATE SET
		[Target].RowId = [Source].RowId,
		[Target].CallType = [Source].CallType,
		[Target].ListId = [Source].ListId,
		[Target].CampaignId = [Source].CampaignId,
		[Target].AccountNumber = [Source].AccountNumber,
		[Target].AreaCode = [Source].AreaCode,
		[Target].Phone = [Source].Phone,
		[Target].AdditionalStatus = [Source].AdditionalStatus,
		[Target].[Status] = [Source].[Status],
		[Target].AgentId = [Source].AgentId,
		[Target].StartTime = [Source].StartTime,
		[Target].VoxFileName = [Source].VoxFileName,
		[Target].TimeConnect = [Source].TimeConnect,
		[Target].TimeACW = [Source].TimeACW,
		[Target].TimeHold = [Source].TimeHold,
		[Target].AgentHold = [Source].AgentHold,
		[Target].DialerField1 = [Source].DialerField1,
		[Target].DialerField2 = [Source].DialerField2,
		[Target].DialerField3 = [Source].DialerField3,
		[Target].DialerField4 = [Source].DialerField4,
		[Target].DialerField5 = [Source].DialerField5,
		[Target].DialerField6 = [Source].DialerField6,
		[Target].DialerField7 = [Source].DialerField7,
		[Target].DialerField8 = [Source].DialerField8,
		[Target].DialerField9 = [Source].DialerField9,
		[Target].DialerField10 = [Source].DialerField10,
		[Target].DialerField11 = [Source].DialerField11,
		[Target].DialerField12 = [Source].DialerField12,
		[Target].DialerField13 = [Source].DialerField13,
		[Target].DialerField14 = [Source].DialerField14,
		[Target].DialerField15 = [Source].DialerField15,
		[Target].DialerField16 = [Source].DialerField16,
		[Target].DialerField17 = [Source].DialerField17,
		[Target].DialerField18 = [Source].DialerField18,
		[Target].DialerField19 = [Source].DialerField19,
		[Target].DialerField20 = [Source].DialerField20,
		[Target].DialerField21 = [Source].DialerField21,
		[Target].DialerField22 = [Source].DialerField22,
		[Target].DialerField23 = [Source].DialerField23,
		[Target].DialerField24 = [Source].DialerField24,
		[Target].DialerField25 = [Source].DialerField25,
		[Target].DialerField26 = [Source].DialerField26
	WHEN NOT MATCHED THEN INSERT
	(
		RowId,
		CallType,
		ListId,
		CampaignId,
		AccountNumber,
		AreaCode,
		Phone,
		AdditionalStatus,
		[Status],
		AgentId,
		StartTime,
		VoxFileName,
		TimeConnect,
		TimeACW,
		TimeHold,
		AgentHold,
		DialerField1,
		DialerField2,
		DialerField3,
		DialerField4,
		DialerField5,
		DialerField6,
		DialerField7,
		DialerField8,
		DialerField9,
		DialerField10,
		DialerField11,
		DialerField12,
		DialerField13,
		DialerField14,
		DialerField15,
		DialerField16,
		DialerField17,
		DialerField18,
		DialerField19,
		DialerField20,
		DialerField21,
		DialerField22,
		DialerField23,
		DialerField24,
		DialerField25,
		DialerField26
	)
	VALUES
	(
		[Source].RowId,
		[Source].CallType,
		[Source].ListId,
		[Source].CampaignId,
		[Source].AccountNumber,
		[Source].AreaCode,
		[Source].Phone,
		[Source].AdditionalStatus,
		[Source].[Status],
		[Source].AgentId,
		[Source].StartTime,
		[Source].VoxFileName,
		[Source].TimeConnect,
		[Source].TimeACW,
		[Source].TimeHold,
		[Source].AgentHold,
		[Source].DialerField1,
		[Source].DialerField2,
		[Source].DialerField3,
		[Source].DialerField4,
		[Source].DialerField5,
		[Source].DialerField6,
		[Source].DialerField7,
		[Source].DialerField8,
		[Source].DialerField9,
		[Source].DialerField10,
		[Source].DialerField11,
		[Source].DialerField12,
		[Source].DialerField13,
		[Source].DialerField14,
		[Source].DialerField15,
		[Source].DialerField16,
		[Source].DialerField17,
		[Source].DialerField18,
		[Source].DialerField19,
		[Source].DialerField20,
		[Source].DialerField21,
		[Source].DialerField22,
		[Source].DialerField23,
		[Source].DialerField24,
		[Source].DialerField25,
		[Source].DialerField26
	);	
	
	DELETE FROM _OutboundCalls
END
