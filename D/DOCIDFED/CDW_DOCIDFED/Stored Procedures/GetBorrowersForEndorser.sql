CREATE PROCEDURE [docid].[GetBorrowersForEndorser]
	@Endorser VARCHAR(10)
AS
	
	SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED

	DECLARE @EndSsn VARCHAR(9) = @Endorser
	IF LEN(@Endorser) = 10
	BEGIN
		SET @EndSsn = (SELECT DF_PRS_ID FROM PD10_PRS_NME WHERE DF_SPE_ACC_ID = @Endorser)
	END

	DECLARE @IsFederal BIT = NULL
	IF DB_NAME() = 'CDW'
		SET @IsFederal = 1
	IF DB_NAME() = 'UDW'
		SET @IsFederal = 0

	SELECT DISTINCT
		LN20.BF_SSN [AccountIdentifier],
		RTRIM(PD10.DM_PRS_1) + ' ' + RTRIM(PD10.DM_PRS_MID) + ' ' + RTRIM(PD10.DM_PRS_LST) [Name],
		@IsFederal [IsFederal]
	FROM
		LN20_EDS LN20
		INNER JOIN PD10_PRS_NME PD10
			ON LN20.BF_SSN = PD10.DF_PRS_ID
		INNER JOIN LN10_LON LN10
			ON LN20.BF_SSN = LN10.BF_SSN
	WHERE
		LN20.LF_EDS = @EndSsn

RETURN 0