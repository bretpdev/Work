CREATE PROCEDURE [dbo].[GetAddress]
	@DF_SPE_ACC_ID CHAR(10)
AS
	SELECT
		RTRIM(PD10.DM_PRS_1) AS DM_PRS_1,
		RTRIM(PD10.DM_PRS_LST) AS DM_PRS_LST,
		RTRIM(PD10.DM_PRS_1) + ' ' + RTRIM(PD10.DM_PRS_LST) AS Name,
		RTRIM(PD30.DX_STR_ADR_1) AS Address1,
		RTRIM(PD30.DX_STR_ADR_2) AS Address2,
		CASE	
			WHEN LEN(RTRIM(PD30.DF_ZIP_CDE)) = 9 THEN RTRIM(PD30.DM_CT) + ' ' + RTRIM(PD30.DC_DOM_ST) + '  ' + LEFT(RTRIM(PD30.DF_ZIP_CDE), 5) + '-' + RIGHT(RTRIM(PD30.DF_ZIP_CDE), 4)
			ELSE RTRIM(PD30.DM_CT) + ' ' + RTRIM(PD30.DC_DOM_ST) + '  ' + RTRIM(PD30.DF_ZIP_CDE)
		END AS CityStateZip,
		RTRIM(PD30.DM_FGN_ST) as ForeignState,
		RTRIM(PD30.DM_FGN_CNY) as Country,
		CASE PD30.DI_VLD_ADR
			WHEN 'Y' THEN 1
			ELSE 0
		END AS HasValidAddress
	FROM
		UDW..PD10_PRS_NME PD10
		INNER JOIN UDW..PD30_PRS_ADR PD30 ON PD30.DF_PRS_ID = PD10.DF_PRS_ID
	WHERE
		PD10.DF_SPE_ACC_ID =  @DF_SPE_ACC_ID 
RETURN 0
