CREATE PROCEDURE [rtnemlinvf].[GetSsnAndEmailType]
	@Email VARCHAR(254)
AS
	SELECT
		DF_PRS_ID [Ssn],
		DC_ADR_EML [EmailType]
	FROM
		PD32_PRS_ADR_EML
	WHERE
		DX_ADR_EML = @Email
		AND DI_VLD_ADR_EML = 'Y'

		UNION

	SELECT
		PD10.DF_PRS_ID [Ssn],
		'C' [EmailType]
	FROM
		PH05_CNC_EML PH05
		INNER JOIN PD10_PRS_NME PD10
			ON PH05.DF_SPE_ID = PD10.DF_SPE_ACC_ID
	WHERE
		PH05.DX_CNC_EML_ADR = @Email
		AND PH05.DI_VLD_CNC_EML_ADR = 'Y'
RETURN 0