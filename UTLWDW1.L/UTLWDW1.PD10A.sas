/*THIS SPECIFICIES WHAT DIRECTORY TO READ REPORTS FROM AND WHICH DATABASE TO UPDATE.*/
/*LIVE*/
%INCLUDE "X:\Sessions\Local SAS Schedule\UDW\UTLWDW1 UHEAA Data Warehouse Load.Folder and Database.sas";
%LET REPORT = X:\PADD\FTP;

/*TEST*/
/*%INCLUDE "X:\PADU\SAS\UDW\UTLWDW1 UHEAA Data Warehouse Load.Folder and Database.sas" ;
%LET REPORT = T:\SAS;*/

%FILECHECK(62);

DATA PD10A;
	INFILE REPORT62 DSD DLM = ',' FIRSTOBS=1 MISSOVER END = EOF;
	INPUT 
		DF_PRS_ID :$9.
		DD_STA_PRS :DATE9.
		DC_LAG_FGN :$1.
		DC_SEX :$1.
		DD_BRT :DATE9.
		DM_PRS_MID :$13.
		DM_PRS_1 :$13.
		DM_PRS_LST_SFX :$4.
		DM_PRS_LST :$23.
		DD_DRV_LIC_REN :DATE9.
		DC_ST_DRV_LIC :$2.
		DF_DRV_LIC :$20.
		DD_NME_VER_LST :DATE9.
		DI_ORG_HLD :1.
		DF_LST_USR_PD10 :$8.
		DF_ALN_RGS :$9.
		DI_US_CTZ :$1.
		DF_LST_DTS_PD10 :DATETIME25.
		DF_SPE_ACC_ID :$10.
		DF_PRS_LST_4_SSN :$4.
		DI_ATU_FMT :$1.
		DC_ATU_FMT_TYP :$2.
	;
	%TRUNCAT(62, DF_PRS_ID);
RUN;
%copyerror;

DATA PD10A;
SET PD10A;
	DD_STA_PRS = DD_STA_PRS * 86400;
	DD_BRT = DD_BRT * 86400;
	DD_DRV_LIC_REN = DD_DRV_LIC_REN * 86400;
	DD_NME_VER_LST = DD_NME_VER_LST * 86400;
RUN;

PROC SORT DATA=PD10A; BY DF_PRS_ID; RUN;

%ENCHILADA
	(
		PD10A,
		PD10_PRS_NME,
		DF_PRS_ID,  
		DD_STA_PRS  
		DC_LAG_FGN  
		DC_SEX  
		DD_BRT  
		DM_PRS_MID  
		DM_PRS_1  
		DM_PRS_LST_SFX  
		DM_PRS_LST  
		DD_DRV_LIC_REN  
		DC_ST_DRV_LIC  
		DF_DRV_LIC  
		DD_NME_VER_LST  
		DI_ORG_HLD  
		DF_LST_USR_PD10  
		DF_ALN_RGS  
		DI_US_CTZ  
		DF_LST_DTS_PD10  
		DF_SPE_ACC_ID  
		DF_PRS_LST_4_SSN  
		DI_ATU_FMT  
		DC_ATU_FMT_TYP
	)
;

%FINISH;

