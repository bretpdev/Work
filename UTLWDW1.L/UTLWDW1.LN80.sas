/*THIS SPECIFICIES WHAT DIRECTORY TO READ REPORTS FROM AND WHICH DATABASE TO UPDATE.*/
/*LIVE*/
%INCLUDE "X:\Sessions\Local SAS Schedule\UDW\UTLWDW1 UHEAA Data Warehouse Load.Folder and Database.sas";
%LET REPORT = X:\PADD\FTP;

/*TEST*/
/*%INCLUDE "X:\PADU\SAS\UDW\UTLWDW1 UHEAA Data Warehouse Load.Folder and Database.sas" ;
%LET REPORT = T:\SAS;*/

%FILECHECK(40);

DATA LN80;
	INFILE REPORT40 DSD DLM = ',' FIRSTOBS=1 MISSOVER END = EOF;
	INPUT 
		BF_SSN :$9.
		LN_SEQ :2.
		LD_BIL_CRT :DATE9.
		LN_SEQ_BIL_WI_DTE :2.
		LN_BIL_OCC_SEQ :2.
		LA_BIL_CUR_DU :7.2
		LA_BIL_PAS_DU :7.2
		LC_STA_LON80 :$1.
		LA_NSI_BIL :7.2
		LA_CUR_PRN_BIL :8.2
		LC_LON_STA_BIL :$1.
		LR_INT_BIL :5.3
		LD_LST_DTS_LN80 :DATETIME25.
		LI_PSB :$1.
		LD_BIL_DU_LON :DATE9.
		LC_BIL_TYP_LON :$1.
		LI_FNL_BIL_LON :$1.
		LD_STA_LON80 :DATE9.
		LA_BIL_DU_PRT :8.2
		LA_TOT_BIL_STS :7.2
		LA_PCV_BIL_STS :7.2
		LF_DFR_CTL_NUM :$3.
		LF_FOR_CTL_NUM :$3.
		LD_LTE_FEE_ASS :DATE9.
		LA_LTE_FEE_ASS :6.2
		LI_LTE_FEE_OVR :$1.
		LC_LTE_FEE_WAV_REA :$1.
		LD_BIL_STS_RIR_TOL :DATE9.
		LI_BIL_DLQ_OVR_RIR :$1.
		LF_USR_DLQ_OVR_RIR :$8.
		LA_LTE_FEE_OTS_PRT :7.2
		LD_LTE_FEE_WAV :DATE9.
		LD_RP_RTE_2B_DTR :DATE9.
		LC_RPY_OPT_AWD_BIL :$1.
		LN_CU_SEQ :2.
		LC_RPD_RLF_ETR :$1.
		LA_LTE_FEE_EST_BIL :8.2
		LN_DAY_FEE_GRC_BIL :3.0
		LA_INT_PD_2DT_BIL :12.2
		LA_FEE_PD_2DT_BIL :12.2
		LA_PRI_PD_2DT_BIL :12.2
		LI_PSV_FGV_BIL_OVR :$1.
		LA_PIO_BIL_PFH :12.2


	;
	%TRUNCAT(40, BF_SSN);
RUN;
%copyerror;

DATA LN80;
SET LN80;
	LD_BIL_CRT = LD_BIL_CRT * 86400;
	LD_BIL_DU_LON = LD_BIL_DU_LON * 86400;
	LD_STA_LON80 = LD_STA_LON80 * 86400;
	LD_LTE_FEE_ASS = LD_LTE_FEE_ASS * 86400;
	LD_BIL_STS_RIR_TOL = LD_BIL_STS_RIR_TOL * 86400;
	LD_LTE_FEE_WAV = LD_LTE_FEE_WAV * 86400;
	LD_RP_RTE_2B_DTR = LD_RP_RTE_2B_DTR * 86400;

RUN;

PROC SORT DATA=LN80; BY BF_SSN LN_SEQ LD_BIL_CRT LN_SEQ_BIL_WI_DTE LN_BIL_OCC_SEQ; RUN;

%ENCHILADA
	(
		LN80,
		LN80_LON_BIL_CRF,
		BF_SSN  
		LN_SEQ  
		LD_BIL_CRT  
		LN_SEQ_BIL_WI_DTE  
		LN_BIL_OCC_SEQ,  
		LA_BIL_CUR_DU  
		LA_BIL_PAS_DU  
		LC_STA_LON80  
		LA_NSI_BIL  
		LA_CUR_PRN_BIL  
		LC_LON_STA_BIL  
		LR_INT_BIL  
		LD_LST_DTS_LN80  
		LI_PSB  
		LD_BIL_DU_LON  
		LC_BIL_TYP_LON  
		LI_FNL_BIL_LON  
		LD_STA_LON80  
		LA_BIL_DU_PRT  
		LA_TOT_BIL_STS  
		LA_PCV_BIL_STS  
		LF_DFR_CTL_NUM  
		LF_FOR_CTL_NUM  
		LD_LTE_FEE_ASS  
		LA_LTE_FEE_ASS  
		LI_LTE_FEE_OVR  
		LC_LTE_FEE_WAV_REA  
		LD_BIL_STS_RIR_TOL  
		LI_BIL_DLQ_OVR_RIR  
		LF_USR_DLQ_OVR_RIR  
		LA_LTE_FEE_OTS_PRT  
		LD_LTE_FEE_WAV  
		LD_RP_RTE_2B_DTR  
		LC_RPY_OPT_AWD_BIL  
		LN_CU_SEQ  
		LC_RPD_RLF_ETR  
		LA_LTE_FEE_EST_BIL  
		LN_DAY_FEE_GRC_BIL  
		LA_INT_PD_2DT_BIL  
		LA_FEE_PD_2DT_BIL  
		LA_PRI_PD_2DT_BIL  
		LI_PSV_FGV_BIL_OVR  
		LA_PIO_BIL_PFH  

	)
;

%FINISH;
