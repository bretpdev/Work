/*THIS SPECIFICIES WHAT DIRECTORY TO READ REPORTS FROM AND WHICH DATABASE TO UPDATE.*/
/*LIVE*/
%INCLUDE "X:\Sessions\Local SAS Schedule\UDW\UTLWDW1 UHEAA Data Warehouse Load.Folder and Database.sas";
%LET REPORT = X:\PADD\FTP;

/*TEST*/
/*%INCLUDE "X:\PADU\SAS\UDW\UTLWDW1 UHEAA Data Warehouse Load.Folder and Database.sas" ;
%LET REPORT = T:\SAS;*/

%FILECHECK(45);

DATA PD23;
	INFILE REPORT45 DSD DLM = ',' FIRSTOBS=1 MISSOVER END = EOF;
	INPUT 
		DF_PRS_ID :$9.
		DD_DSA_RPT :DATE9.
		IF_GTR :$6.
		DD_DSA_VER :DATE9.
		DD_SBM_CLM_REQ :DATE9.
		DD_DSA_APV :DATE9.
		DI_DSA_XTN_REQ :$1.
		DI_DSA_APV :$1.
		DC_DSA_STA :$2.
		DF_LST_DTS_PD23 :DATETIME25.
		DD_DSA_STA :DATE9.
	;
	%TRUNCAT(45, DF_PRS_ID);
RUN;
%copyerror;

DATA PD23;
SET PD23;
	DD_DSA_RPT = DD_DSA_RPT * 86400;
	DD_DSA_VER = DD_DSA_VER * 86400;
	DD_SBM_CLM_REQ = DD_SBM_CLM_REQ * 86400;
	DD_DSA_APV = DD_DSA_APV * 86400;
	DD_DSA_STA = DD_DSA_STA * 86400;
RUN;

PROC SORT DATA=PD23; BY DF_PRS_ID DD_DSA_RPT IF_GTR; RUN;

%ENCHILADA
	(
		PD23,
		PD23_GTR_DSA,
		DF_PRS_ID  
		DD_DSA_RPT  
		IF_GTR,  
		DD_DSA_VER  
		DD_SBM_CLM_REQ  
		DD_DSA_APV  
		DI_DSA_XTN_REQ  
		DI_DSA_APV  
		DC_DSA_STA  
		DF_LST_DTS_PD23  
		DD_DSA_STA 
	)
;

%FINISH;
