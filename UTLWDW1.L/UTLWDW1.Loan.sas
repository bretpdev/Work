/*THIS SPECIFICIES WHAT DIRECTORY TO READ REPORTS FROM AND WHICH DATABASE TO UPDATE.*/
/*LIVE*/
%INCLUDE "X:\Sessions\Local SAS Schedule\UDW\UTLWDW1 UHEAA Data Warehouse Load.Folder and Database.sas";
%LET REPORT = X:\PADD\FTP;

/*TEST*/
/*%INCLUDE "X:\PADU\SAS\UDW\UTLWDW1 UHEAA Data Warehouse Load.Folder and Database.sas" ;
%LET REPORT = T:\SAS;*/

%FILECHECK(11);

DATA LN10(DROP= B trunc);
	INFILE REPORT11 DSD DLM = ',' FIRSTOBS=1 MISSOVER end = eof;
	INPUT DF_SPE_ACC_ID :$10. LN_SEQ :6. LC_STA_LON10 :$1. LA_CUR_PRI :10.2 LA_LON_AMT_GTR :10.2 
		LD_END_GRC_PRD :$10. IC_LON_PGM :$6. B :MMDDYY10. 
		LD_PIF_RPT :$10. IF_GTR :$6. LR_EFT_RDC :10.2;
	FORMAT RIR_INT $14. RIR_TYP $27.;
	LD_LON_1_DSB = PUT(B,MMDDYY10.);
	IF B < MDY(5,1,2006) THEN DO;
		HEP = 'Y';
	END;
	ELSE HEP = 'N';
	ACH_RATE = LR_EFT_RDC;
	RIR_INT = '';
	RIR_TYP = '';
%TRUNCAT(11,DF_SPE_ACC_ID);
RUN;
%copyerror;

PROC SORT DATA=LN10; BY DF_SPE_ACC_ID LN_SEQ; RUN;
DATA LN10; SET LN10; BY DF_SPE_ACC_ID LN_SEQ; IF LAST.LN_SEQ; RUN;

%ENCHILADA(LN10,LN10_LOAN,DF_SPE_ACC_ID LN_SEQ,LC_STA_LON10 LA_CUR_PRI LA_LON_AMT_GTR LD_END_GRC_PRD IC_LON_PGM LD_LON_1_DSB HEP
	ACH_RATE RIR_INT RIR_TYP LD_PIF_RPT IF_GTR,);

%GOODBYE_NULL(LN10_LOAN,LA_CUR_PRI,0);
%GOODBYE_NULL(LN10_LOAN,LA_LON_AMT_GTR,0);
%GOODBYE_NULL(LN10_LOAN,LD_END_GRC_PRD,'');
%GOODBYE_NULL(LN10_LOAN,IC_LON_PGM,'');
%GOODBYE_NULL(LN10_LOAN,LD_LON_1_DSB,'');
%GOODBYE_NULL(LN10_LOAN,HEP,'');
%GOODBYE_NULL(LN10_LOAN,ACH_RATE,0);
%GOODBYE_NULL(LN10_LOAN,RIR_INT,'');
%GOODBYE_NULL(LN10_LOAN,RIR_TYP,'');
%GOODBYE_NULL(LN10_LOAN,LD_PIF_RPT,'');
%GOODBYE_NULL(LN10_LOAN,IF_GTR,'');

%CLEANUP_LOAN(LN20_ENDORSER);
%CLEANUP_LOAN(LN09_REHABILITATION);
%CLEANUP_LOAN(LN83_EFTSTATUS);
%CLEANUP_LOAN(LN54_ELIGIBILITY);
%CLEANUP_LOAN(LN55_BENEFIT);
%CLEANUP_LOAN(LN16_DELINQUENCY);
%CLEANUP_PARENT(BORR_DELINQUENCY,LN16_DELINQUENCY);
%CLEANUP_LOAN(LN72_INTERESTRATE);
%CLEANUP_LOAN(LN65_REPAYMENTSCHED);
%CLEANUP_PARENT(BORR_REPAYMENT,LN65_REPAYMENTSCHED);
%CLEANUP_LOAN(SD10_SCHOOL);

%FINISH;
