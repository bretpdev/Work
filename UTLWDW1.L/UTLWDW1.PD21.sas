/*THIS SPECIFICIES WHAT DIRECTORY TO READ REPORTS FROM AND WHICH DATABASE TO UPDATE.*/
/*LIVE*/
%INCLUDE "X:\Sessions\Local SAS Schedule\UDW\UTLWDW1 UHEAA Data Warehouse Load.Folder and Database.sas";
%LET REPORT = X:\PADD\FTP;

/*TEST*/
/*%INCLUDE "X:\PADU\SAS\UDW\UTLWDW1 UHEAA Data Warehouse Load.Folder and Database.sas" ;
%LET REPORT = T:\SAS;*/

%FILECHECK(43);

DATA PD21;
	INFILE REPORT43 DSD DLM = ',' FIRSTOBS=1 MISSOVER END = EOF;
	INPUT 
		DF_PRS_ID :$9.
		DD_DTH_NTF :DATE9.
		IF_GTR :$6.
		DD_DTH_VER :DATE9.
		DC_DTH_STA :$2.
		DC_DTH_CER :$2.
		DF_LST_DTS_PD21 :DATETIME25.
		DD_DTH_STA :DATE9.

	;
	%TRUNCAT(43, DF_PRS_ID);
RUN;
%copyerror;

DATA PD21;
SET PD21;
	DD_DTH_NTF = DD_DTH_NTF * 86400;
	DD_DTH_VER = DD_DTH_VER * 86400;
	DD_DTH_STA = DD_DTH_STA * 86400;
RUN;

PROC SORT DATA=PD21; BY DF_PRS_ID DD_DTH_NTF IF_GTR; RUN;

%ENCHILADA
	(
		PD21,
		PD21_GTR_DTH,
		DF_PRS_ID  
		DD_DTH_NTF  
		IF_GTR,  
		DD_DTH_VER  
		DC_DTH_STA  
		DC_DTH_CER  
		DF_LST_DTS_PD21  
		DD_DTH_STA 
	)
;

%FINISH;
