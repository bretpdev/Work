/*UTLWD15 AWG EMPLOYERS NOT RESPONDING-EMPLOYER COMPLAINT*/
/*LIBNAME DLGSUTWH DB2 DATABASE=DLGSUTWH OWNER=OLWHRM1;*/
/*%LET RPTLIB = %SYSGET(reportdir);*/
%LET RPTLIB = T:\SAS;
FILENAME REPORT2 "&RPTLIB/ULWD15.LWD15R2";
LIBNAME  WORKLOCL  REMOTE  SERVER=CYPRUS  SLIBREF=WORK;
RSUBMIT;
PROC SQL;
CONNECT TO DB2 (DATABASE=DLGSUTWH);
CREATE TABLE EMPCMP AS
SELECT *
FROM CONNECTION TO DB2 (
SELECT DISTINCT A.DF_PRS_ID_BR AS SSN
	,RTRIM(B.DM_PRS_LST)||' '||RTRIM(B.DM_PRS_1)||' '|| RTRIM(B.DM_PRS_MID) AS NAME
	,RTRIM(C.IM_IST_FUL) AS INTNAME
	,RTRIM(C.IX_GEN_STR_ADR_1)||' '||RTRIM(C.IM_GEN_CT)||','||RTRIM(C.IC_GEN_ST)||' '||RTRIM(C.IF_GEN_ZIP) AS ADDRESS
	,C.IN_GEN_PHN AS PHNE
	,B.DF_SPE_ACC_ID
FROM OLWHRM1.LA10_LEG_ACT A
INNER JOIN OLWHRM1.PD01_PDM_INF B
	ON A.DF_PRS_ID_BR = B.DF_PRS_ID
INNER JOIN OLWHRM1.IN01_LGS_IDM_MST C
	ON A.IF_IST = C.IF_IST
WHERE A.BC_LEG_ACT_REC_TYP = '1'
AND A.BC_WDR_REA = ''
AND A.BC_INA_REA = ''
AND A.BC_CPT = 'L'
);
DISCONNECT FROM DB2;
ENDRSUBMIT;

DATA EMPCMP;
SET WORKLOCL.EMPCMP;
RUN;

PROC SORT DATA=EMPCMP;
BY SSN;
RUN;

DATA EMPCMP;
SET EMPCMP;
INTNAME2 = TRIM(INTNAME);
ADDRESS2 = TRIM(ADDRESS);
NAME2 = TRIM(NAME);
PHNE2 = TRIM(PHNE);
RUN;

PROC PRINTTO PRINT=REPORT2 NEW;
RUN;
OPTIONS PAGENO=1 LS=126 CENTER;
PROC PRINT SPLIT='/' DATA=EMPCMP WIDTH=MIN;
VAR DF_SPE_ACC_ID
    NAME2
    INTNAME2
   	PHNE
	ADDRESS2;
LABEL   DF_SPE_ACC_ID = 'ACCT #'
		NAME2 = 'BORROWER NAME'
        INTNAME2 = 'EMPLOYER NAME'
        ADDRESS2 = 'EMPLOYER ADDRESS'
        PHNE = 'EMPLOYER PHONE';
TITLE   'EMPLOYERS NOT RESPONDING - EMPLOYER COMPLAINT';
FOOTNOTE  'JOB = UTLWD15     REPORT = ULWD15.LWD15R2';
RUN;
PROC PRINTTO;
RUN;
