


SELECT DISTINCT
	LNXX.BF_SSN,
	LNXX.LN_SEQ,
	FBXX.LC_FOR_TYP,
	LNXX.LD_FOR_BEG,
	LNXX.LD_FOR_END,
	LNXX.LD_DLQ_OCC,
	DWXX.WD_LON_RPD_SR
FROM
	CDW..FBXX_BR_FOR_REQ FBXX
	INNER JOIN CDW..LNXX_BR_FOR_APV LNXX
		ON LNXX.BF_SSN = FBXX.BF_SSN
		AND LNXX.LF_FOR_CTL_NUM = FBXX.LF_FOR_CTL_NUM
	INNER JOIN CDW..LNXX_LON LNXX
		ON LNXX.BF_SSN = LNXX.BF_SSN
		AND LNXX.LN_SEQ = LNXX.LN_SEQ
		AND LNXX.LA_CUR_PRI > X
		AND LNXX.LC_STA_LONXX = 'R'
	INNER JOIN CDW..DWXX_DW_CLC_CLU DWXX
		ON DWXX.BF_SSN = LNXX.BF_SSN
		AND DWXX.LN_SEQ = LNXX.LN_SEQ
	INNER JOIN 
		(
		SELECT DISTINCT
			BF_SSN,
			LN_SEQ,
			LD_DLQ_OCC,
			LD_DLQ_MAX
		FROM
			CDW..LNXX_LON_DLQ_HST LNXX
		WHERE
			LNXX.LC_STA_LONXX = 'X'
	) LNXX
		ON LNXX.BF_SSN = LNXX.BF_SSN
		AND LNXX.LN_SEQ = LNXX.LN_SEQ
WHERE
	LNXX.LC_STA_LONXX = 'A'
	AND FBXX.LC_STA_FORXX = 'A'
	AND FBXX.LC_FOR_STA = 'A' --denied records cant have this active
	AND LNXX.LC_FOR_RSP != 'XXX'
	--AND FBXX.LC_FOR_TYP = 'XX'
	AND CAST(GETDATE() AS DATE) BETWEEN CAST(LNXX.LD_FOR_BEG AS DATE) AND CAST(LNXX.LD_FOR_END AS DATE)


