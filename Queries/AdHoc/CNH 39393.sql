USE CDW

GO

--BEGIN Base forgiveness population
DECLARE @ICRPlan TABLE(BF_SSN CHAR(X), LN_SEQ INT, CurrentActiveSchedule VARCHAR(XX), ScheduleCode VARCHAR(X), PmtQlfy_Level INT, PmtQlfy_LevelPrev INT, PmtQlfy_PreConvIBR INT, PmtQlfy_PreConvICR INT, PmtQlfy_IDR INT, PmtQlfy_IDRPrev INT, PmtQlfy_PermStnd INT, PmtQlfy_PermStndPrev INT, PmtCoveredByEHD INT, Total INT)
DECLARE @IBRPlan TABLE(BF_SSN CHAR(X), LN_SEQ INT, CurrentActiveSchedule VARCHAR(XX), ScheduleCode VARCHAR(X), PmtQlfy_Level INT, PmtQlfy_LevelPrev INT, PmtQlfy_PreConvIBR INT, PmtQlfy_PreConvICR INT, PmtQlfy_IDR INT, PmtQlfy_IDRPrev INT, PmtQlfy_PermStnd INT, PmtQlfy_PermStndPrev INT, PmtCoveredByEHD INT, Total INT)
DECLARE @IBRXXXXPlan TABLE(BF_SSN CHAR(X), LN_SEQ INT, CurrentActiveSchedule VARCHAR(XX), ScheduleCode VARCHAR(X), PmtQlfy_Level INT, PmtQlfy_LevelPrev INT, PmtQlfy_PreConvIBR INT, PmtQlfy_PreConvICR INT, PmtQlfy_IDR INT, PmtQlfy_IDRPrev INT, PmtQlfy_PermStnd INT, PmtQlfy_PermStndPrev INT, PmtCoveredByEHD INT, Total INT)
DECLARE @PAYEPlan TABLE(BF_SSN CHAR(X), LN_SEQ INT, CurrentActiveSchedule VARCHAR(XX), ScheduleCode VARCHAR(X), PmtQlfy_Level INT, PmtQlfy_LevelPrev INT, PmtQlfy_PreConvIBR INT, PmtQlfy_PreConvICR INT, PmtQlfy_IDR INT, PmtQlfy_IDRPrev INT, PmtQlfy_PermStnd INT, PmtQlfy_PermStndPrev INT, PmtCoveredByEHD INT, Total INT)
DECLARE @REPAYEPlan TABLE(BF_SSN CHAR(X), LN_SEQ INT, CurrentActiveSchedule VARCHAR(XX), ScheduleCode VARCHAR(X), PmtQlfy_Level INT, PmtQlfy_LevelPrev INT, PmtQlfy_PreConvIBR INT, PmtQlfy_PreConvICR INT, PmtQlfy_IDR INT, PmtQlfy_IDRPrev INT, PmtQlfy_PermStnd INT, PmtQlfy_PermStndPrev INT, PmtCoveredByEHD INT, Total INT)
DECLARE @OverallPlan TABLE(Projection VARCHAR(XX), BF_SSN CHAR(X), LN_SEQ INT, CurrentActiveSchedule VARCHAR(XX), ScheduleCode VARCHAR(X), PmtQlfy_Level INT, PmtQlfy_LevelPrev INT, PmtQlfy_PreConvIBR INT, PmtQlfy_PreConvICR INT, PmtQlfy_IDR INT, PmtQlfy_IDRPrev INT, PmtQlfy_PermStnd INT, PmtQlfy_PermStndPrev INT, PmtCoveredByEHD INT, Total INT, AprXXTotal INT, OctXXTotal INT, AprXXTotal INT)

INSERT INTO @ICRPlan(BF_SSN, LN_SEQ, CurrentActiveSchedule, ScheduleCode, PmtQlfy_Level, PmtQlfy_LevelPrev, PmtQlfy_PreConvIBR, PmtQlfy_PreConvICR, PmtQlfy_IDR, PmtQlfy_IDRPrev,PmtQlfy_PermStnd, PmtQlfy_PermStndPrev, PmtCoveredByEHD, Total)
EXEC dbo.GetQualifyingIDRForgivenessPayments 'ICR'--,'XXXXXXXXX'
INSERT INTO @IBRPlan(BF_SSN, LN_SEQ, CurrentActiveSchedule, ScheduleCode, PmtQlfy_Level, PmtQlfy_LevelPrev, PmtQlfy_PreConvIBR, PmtQlfy_PreConvICR, PmtQlfy_IDR, PmtQlfy_IDRPrev,PmtQlfy_PermStnd, PmtQlfy_PermStndPrev, PmtCoveredByEHD, Total)
EXEC dbo.GetQualifyingIDRForgivenessPayments 'IBR'--,'XXXXXXXXX'
INSERT INTO @IBRXXXXPlan(BF_SSN, LN_SEQ, CurrentActiveSchedule, ScheduleCode, PmtQlfy_Level, PmtQlfy_LevelPrev, PmtQlfy_PreConvIBR, PmtQlfy_PreConvICR, PmtQlfy_IDR, PmtQlfy_IDRPrev,PmtQlfy_PermStnd, PmtQlfy_PermStndPrev, PmtCoveredByEHD, Total)
EXEC dbo.GetQualifyingIDRForgivenessPayments 'IBR XXXX'--,'XXXXXXXXX'
INSERT INTO @PAYEPlan(BF_SSN, LN_SEQ, CurrentActiveSchedule, ScheduleCode, PmtQlfy_Level, PmtQlfy_LevelPrev, PmtQlfy_PreConvIBR, PmtQlfy_PreConvICR, PmtQlfy_IDR, PmtQlfy_IDRPrev,PmtQlfy_PermStnd, PmtQlfy_PermStndPrev, PmtCoveredByEHD, Total)
EXEC dbo.GetQualifyingIDRForgivenessPayments 'PAYE'--,'XXXXXXXXX'
INSERT INTO @REPAYEPlan(BF_SSN, LN_SEQ, CurrentActiveSchedule, ScheduleCode, PmtQlfy_Level, PmtQlfy_LevelPrev, PmtQlfy_PreConvIBR, PmtQlfy_PreConvICR, PmtQlfy_IDR, PmtQlfy_IDRPrev,PmtQlfy_PermStnd, PmtQlfy_PermStndPrev, PmtCoveredByEHD, Total)
EXEC dbo.GetQualifyingIDRForgivenessPayments 'REPAYE'--,'XXXXXXXXX'


<<<<<<< HEAD
INSERT INTO @OverallPlan(Projection, BF_SSN, LN_SEQ, CurrentActiveSchedule, ScheduleCode, PmtQlfy_Level, PmtQlfy_LevelPrev, PmtQlfy_PreConvIBR, PmtQlfy_PreConvICR, PmtQlfy_IDR, PmtQlfy_IDRPrev,PmtQlfy_PermStnd, PmtQlfy_PermStndPrev, PmtCoveredByEHD, Total, AprXXTotal, OctXXTotal, AprXXTotal)
SELECT 'ICR' AS Projection, *,DATEDIFF(MONTH, GETDATE(), 'XXXX-XX-XX') + Total AS AprXXTotal, DATEDIFF(MONTH, GETDATE(), 'XXXX-XX-XX') + Total AS OctXXTotal, DATEDIFF(MONTH, GETDATE(), 'XXXX-XX-XX') + Total AS AprXXTotal FROM @ICRPlan
UNION ALL
SELECT 'IBR' AS Projection, *,DATEDIFF(MONTH, GETDATE(), 'XXXX-XX-XX') + Total AS AprXXTotal, DATEDIFF(MONTH, GETDATE(), 'XXXX-XX-XX') + Total AS OctXXTotal, DATEDIFF(MONTH, GETDATE(), 'XXXX-XX-XX') + Total AS AprXXTotal FROM @IBRPlan
UNION ALL
SELECT 'IBR XXXX' AS Projection, *,DATEDIFF(MONTH, GETDATE(), 'XXXX-XX-XX') + Total AS AprXXTotal, DATEDIFF(MONTH, GETDATE(), 'XXXX-XX-XX') + Total AS OctXXTotal, DATEDIFF(MONTH, GETDATE(), 'XXXX-XX-XX') + Total AS AprXXTotal FROM @IBRXXXXPlan
UNION ALL
SELECT 'PAYE' AS Projection, *,DATEDIFF(MONTH, GETDATE(), 'XXXX-XX-XX') + Total AS AprXXTotal, DATEDIFF(MONTH, GETDATE(), 'XXXX-XX-XX') + Total AS OctXXTotal, DATEDIFF(MONTH, GETDATE(), 'XXXX-XX-XX') + Total AS AprXXTotal FROM @PAYEPlan
UNION ALL
SELECT 'REPAYE' AS Projection, *,DATEDIFF(MONTH, GETDATE(), 'XXXX-XX-XX') + Total AS AprXXTotal, DATEDIFF(MONTH, GETDATE(), 'XXXX-XX-XX') + Total AS OctXXTotal, DATEDIFF(MONTH, GETDATE(), 'XXXX-XX-XX') + Total AS AprXXTotal FROM @REPAYEPlan
=======
INSERT INTO @OverallPlan(Projection, BF_SSN, LN_SEQ, CurrentActiveSchedule, ScheduleCode, PmtQlfy_Level, PmtQlfy_LevelPrev, PmtQlfy_PreConvIBR, PmtQlfy_PreConvICR, PmtQlfy_IDR, PmtQlfy_IDRPrev,PmtQlfy_PermStnd, PmtQlfy_PermStndPrev, PmtCoveredByEHD, Total, NovXXTotal, MayXXTotal, NovXXTotal)
SELECT 'ICR' AS Projection, *,DATEDIFF(MONTH, GETDATE(), 'XXXX-XX-XX') + Total AS NovXXTotal, DATEDIFF(MONTH, GETDATE(), 'XXXX-XX-XX') + Total AS MayXXTotal, DATEDIFF(MONTH, GETDATE(), 'XXXX-XX-XX') + Total AS NovXXTotal FROM @ICRPlan
UNION ALL
SELECT 'IBR' AS Projection, *,DATEDIFF(MONTH, GETDATE(), 'XXXX-XX-XX') + Total AS NovXXTotal, DATEDIFF(MONTH, GETDATE(), 'XXXX-XX-XX') + Total AS MayXXTotal, DATEDIFF(MONTH, GETDATE(), 'XXXX-XX-XX') + Total AS NovXXTotal FROM @IBRPlan
UNION ALL
SELECT 'IBR XXXX' AS Projection, *,DATEDIFF(MONTH, GETDATE(), 'XXXX-XX-XX') + Total AS NovXXTotal, DATEDIFF(MONTH, GETDATE(), 'XXXX-XX-XX') + Total AS MayXXTotal, DATEDIFF(MONTH, GETDATE(), 'XXXX-XX-XX') + Total AS NovXXTotal FROM @IBRXXXXPlan
UNION ALL
SELECT 'PAYE' AS Projection, *,DATEDIFF(MONTH, GETDATE(), 'XXXX-XX-XX') + Total AS NovXXTotal, DATEDIFF(MONTH, GETDATE(), 'XXXX-XX-XX') + Total AS MayXXTotal, DATEDIFF(MONTH, GETDATE(), 'XXXX-XX-XX') + Total AS NovXXTotal FROM @PAYEPlan
UNION ALL
SELECT 'REPAYE' AS Projection, *,DATEDIFF(MONTH, GETDATE(), 'XXXX-XX-XX') + Total AS NovXXTotal, DATEDIFF(MONTH, GETDATE(), 'XXXX-XX-XX') + Total AS MayXXTotal, DATEDIFF(MONTH, GETDATE(), 'XXXX-XX-XX') + Total AS NovXXTotal FROM @REPAYEPlan
>>>>>>> fcXXcdeeeXXfaXXXXXXXXXXXXXXXeXXXXXdccXbc

SELECT * FROM @OverallPlan order by BF_SSN, LN_SEQ, Projection --For testing
--END Base Population

--BEGIN Forgiveness
IF OBJECT_ID('tempdb..#ForgivenessArcPopulation') IS NOT NULL
BEGIN
  DROP TABLE #ForgivenessArcPopulation
END

-- create temp table with AAP data to be added to CLS.ArcAddProcessing table
SELECT
	LNXX.LN_SEQ,
	X [ArcTypeId], -- by loan
	LNXX.BF_SSN,
	PDXX.DF_SPE_ACC_ID [AccountNumber],
	CASE 
		 WHEN OP.Total >= XXX AND Arcs.HASFSAFM = X AND Arcs.HASIDRFG = X AND OP.ScheduleCode IN('CX','CX','CX','IB','CQ','IL') THEN 'IDRFG' --IBR ICR
		 WHEN OP.Total >= XXX AND Arcs.HASFSAFM = X AND Arcs.HASIDRFG = X AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('A','B','C','D','X','X','X','X','X','XX','XX','XX','XX','XX','XX','XX','XX','XX','XX') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'IDRFG' --REPAYE UNDERGRAD
 		 WHEN OP.Total BETWEEN XXX AND XXX AND Arcs.HASFSAXM = X AND Arcs.HASIDRFP = X AND OP.ScheduleCode IN('CX','CX','CX','IB','CQ','IL') THEN 'IDRFP' --IBR ICR
		 WHEN OP.Total BETWEEN XXX AND XXX AND Arcs.HASFSAXM = X AND Arcs.HASIDRFP = X AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('A','B','C','D','X','X','X','X','X','XX','XX','XX','XX','XX','XX','XX','XX','XX','XX') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'IDRFP' --REPAYE UNDERGRAD
		 WHEN OP.Total >= XXX AND Arcs.HASFSAFM = X AND Arcs.HASIDRFG = X AND OP.ScheduleCode IN('IX','IP','CA','CP') THEN 'IDRFG' --IBR XXXX / PAYE
		 WHEN OP.Total >= XXX AND Arcs.HASFSAFM = X AND Arcs.HASIDRFG = X AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('XX','XX','XX','XX','XX','X','X','X','X') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'IDRFG' --REPAYE GRAD
		 WHEN OP.Total BETWEEN XXX AND XXX AND Arcs.HASFSAXM = X AND Arcs.HASIDRFP = X AND OP.ScheduleCode IN('IX','IP','CA','CP') THEN 'IDRFP' --IBR XXXX / PAYE
		 WHEN OP.Total BETWEEN XXX AND XXX AND Arcs.HASFSAXM = X AND Arcs.HASIDRFP = X AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('XX','XX','XX','XX','XX','X','X','X','X') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'IDRFP' --REPAYE GRAD
		 WHEN OP.Total >= XXX AND(ISNULL(Arcs.HASIDFRF,X) = X OR (Arcs.HASIDFRF = X AND Arcs.HASIDFRT = X AND (Arcs.MaxIDFRFDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate)/*re-do full month review if IDFRT is newer, and more than XX days old*/)) AND OP.ScheduleCode IN('CX','CX','CX','IB','CQ','IL') THEN 'IDFRF' --IBR ICR
		 WHEN OP.Total >= XXX AND(ISNULL(Arcs.HASIDFRF,X) = X OR (Arcs.HASIDFRF = X AND Arcs.HASIDFRT = X AND (Arcs.MaxIDFRFDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate)/*re-do full month review if IDFRT is newer, and more than XX days old*/)) AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('A','B','C','D','X','X','X','X','X','XX','XX','XX','XX','XX','XX','XX','XX','XX','XX') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'IDFRF' --REPAYE UNDERGRAD
<<<<<<< HEAD
		 WHEN OP.Total >= XXX AND ISNULL(Arcs.HASFATXX,X) = X AND(ISNULL(Arcs.HASIDFRF,X) = X OR (Arcs.HASIDFRF = X AND Arcs.HASIDFRT = X AND (Arcs.MaxIDFRFDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate)/*re-do full month review if IDFRT is newer, and more than XX days old*/)) AND OP.ScheduleCode IN('IX','IP','CA','CP') THEN 'IDFRF' --IBR XXXX / PAYE
		 WHEN OP.Total >= XXX AND ISNULL(Arcs.HASFATXX,X) = X AND(ISNULL(Arcs.HASIDFRF,X) = X OR (Arcs.HASIDFRF = X AND Arcs.HASIDFRT = X AND (Arcs.MaxIDFRFDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate)/*re-do full month review if IDFRT is newer, and more than XX days old*/)) AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('XX','XX','XX','XX','XX','X','X','X','X') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'IDFRF' --REPAYE GRAD
		 
		 WHEN OP.AprXXTotal >= XXX AND Arcs.HASFSAFM = X AND Arcs.HASIDRFG = X AND OP.ScheduleCode IN('CX','CX','CX','IB','CQ','IL') THEN 'IDRFG' --IBR ICR
		 WHEN OP.AprXXTotal >= XXX AND Arcs.HASFSAFM = X AND Arcs.HASIDRFG = X AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('A','B','C','D','X','X','X','X','X','XX','XX','XX','XX','XX','XX','XX','XX','XX','XX') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'IDRFG' --REPAYE UNDERGRAD
 		 WHEN OP.AprXXTotal BETWEEN XXX AND XXX AND Arcs.HASFSAXM = X AND Arcs.HASIDRFP = X AND OP.ScheduleCode IN('CX','CX','CX','IB','CQ','IL') THEN 'IDRFP' --IBR ICR
		 WHEN OP.AprXXTotal BETWEEN XXX AND XXX AND Arcs.HASFSAXM = X AND Arcs.HASIDRFP = X AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('A','B','C','D','X','X','X','X','X','XX','XX','XX','XX','XX','XX','XX','XX','XX','XX') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'IDRFP' --REPAYE UNDERGRAD
		 WHEN OP.AprXXTotal >= XXX AND Arcs.HASFSAFM = X AND Arcs.HASIDRFG = X AND OP.ScheduleCode IN('IX','IP','CA','CP') THEN 'IDRFG' --IBR XXXX / PAYE
		 WHEN OP.AprXXTotal >= XXX AND Arcs.HASFSAFM = X AND Arcs.HASIDRFG = X AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('XX','XX','XX','XX','XX','X','X','X','X') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'IDRFG' --REPAYE GRAD
		 WHEN OP.AprXXTotal BETWEEN XXX AND XXX AND Arcs.HASFSAXM = X AND Arcs.HASIDRFP = X AND OP.ScheduleCode IN('IX','IP','CA','CP') THEN 'IDRFP' --IBR XXXX / PAYE
		 WHEN OP.AprXXTotal BETWEEN XXX AND XXX AND Arcs.HASFSAXM = X AND Arcs.HASIDRFP = X AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('XX','XX','XX','XX','XX','X','X','X','X') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'IDRFP' --REPAYE GRAD
		 WHEN OP.AprXXTotal >= XXX AND(ISNULL(Arcs.HASIDFRF,X) = X OR (Arcs.HASIDFRF = X AND Arcs.HASIDFRT = X AND (Arcs.MaxIDFRFDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate)/*re-do full month review if IDFRT is newer, and more than XX days old*/)) AND OP.ScheduleCode IN('CX','CX','CX','IB','CQ','IL') THEN 'IDFRF' --IBR ICR
		 WHEN OP.AprXXTotal >= XXX AND(ISNULL(Arcs.HASIDFRF,X) = X OR (Arcs.HASIDFRF = X AND Arcs.HASIDFRT = X AND (Arcs.MaxIDFRFDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate)/*re-do full month review if IDFRT is newer, and more than XX days old*/)) AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('A','B','C','D','X','X','X','X','X','XX','XX','XX','XX','XX','XX','XX','XX','XX','XX') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'IDFRF' --REPAYE UNDERGRAD
		 WHEN OP.AprXXTotal >= XXX AND ISNULL(Arcs.HASFATXX,X) = X AND(ISNULL(Arcs.HASIDFRF,X) = X OR (Arcs.HASIDFRF = X AND Arcs.HASIDFRT = X AND (Arcs.MaxIDFRFDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate)/*re-do full month review if IDFRT is newer, and more than XX days old*/)) AND OP.ScheduleCode IN('IX','IP','CA','CP') THEN 'IDFRF' --IBR XXXX / PAYE
		 WHEN OP.AprXXTotal >= XXX AND ISNULL(Arcs.HASFATXX,X) = X AND(ISNULL(Arcs.HASIDFRF,X) = X OR (Arcs.HASIDFRF = X AND Arcs.HASIDFRT = X AND (Arcs.MaxIDFRFDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate)/*re-do full month review if IDFRT is newer, and more than XX days old*/)) AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('XX','XX','XX','XX','XX','X','X','X','X') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'IDFRF' --REPAYE GRAD

		 WHEN OP.OctXXTotal >= XXX AND Arcs.HASFSAFM = X AND Arcs.HASIDRFG = X AND OP.ScheduleCode IN('CX','CX','CX','IB','CQ','IL') THEN 'IDRFG' --IBR ICR
		 WHEN OP.OctXXTotal >= XXX AND Arcs.HASFSAFM = X AND Arcs.HASIDRFG = X AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('A','B','C','D','X','X','X','X','X','XX','XX','XX','XX','XX','XX','XX','XX','XX','XX') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'IDRFG' --REPAYE UNDERGRAD
 		 WHEN OP.OctXXTotal BETWEEN XXX AND XXX AND Arcs.HASFSAXM = X AND Arcs.HASIDRFP = X AND OP.ScheduleCode IN('CX','CX','CX','IB','CQ','IL') THEN 'IDRFP' --IBR ICR
		 WHEN OP.OctXXTotal BETWEEN XXX AND XXX AND Arcs.HASFSAXM = X AND Arcs.HASIDRFP = X AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('A','B','C','D','X','X','X','X','X','XX','XX','XX','XX','XX','XX','XX','XX','XX','XX') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'IDRFP' --REPAYE UNDERGRAD
		 WHEN OP.OctXXTotal >= XXX AND Arcs.HASFSAFM = X AND Arcs.HASIDRFG = X AND OP.ScheduleCode IN('IX','IP','CA','CP') THEN 'IDRFG' --IBR XXXX / PAYE
		 WHEN OP.OctXXTotal >= XXX AND Arcs.HASFSAFM = X AND Arcs.HASIDRFG = X AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('XX','XX','XX','XX','XX','X','X','X','X') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'IDRFG' --REPAYE GRAD
		 WHEN OP.OctXXTotal BETWEEN XXX AND XXX AND Arcs.HASFSAXM = X AND Arcs.HASIDRFP = X AND OP.ScheduleCode IN('IX','IP','CA','CP') THEN 'IDRFP' --IBR XXXX / PAYE
		 WHEN OP.OctXXTotal BETWEEN XXX AND XXX AND Arcs.HASFSAXM = X AND Arcs.HASIDRFP = X AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('XX','XX','XX','XX','XX','X','X','X','X') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'IDRFP' --REPAYE GRAD
		 WHEN OP.OctXXTotal >= XXX AND(ISNULL(Arcs.HASIDFRF,X) = X OR (Arcs.HASIDFRF = X AND Arcs.HASIDFRT = X AND (Arcs.MaxIDFRFDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate)/*re-do full month review if IDFRT is newer, and more than XX days old*/)) AND OP.ScheduleCode IN('CX','CX','CX','IB','CQ','IL') THEN 'IDFRF' --IBR ICR
		 WHEN OP.OctXXTotal >= XXX AND(ISNULL(Arcs.HASIDFRF,X) = X OR (Arcs.HASIDFRF = X AND Arcs.HASIDFRT = X AND (Arcs.MaxIDFRFDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate)/*re-do full month review if IDFRT is newer, and more than XX days old*/)) AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('A','B','C','D','X','X','X','X','X','XX','XX','XX','XX','XX','XX','XX','XX','XX','XX') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'IDFRF' --REPAYE UNDERGRAD
		 WHEN OP.OctXXTotal >= XXX AND ISNULL(Arcs.HASFATXX,X) = X AND(ISNULL(Arcs.HASIDFRF,X) = X OR (Arcs.HASIDFRF = X AND Arcs.HASIDFRT = X AND (Arcs.MaxIDFRFDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate)/*re-do full month review if IDFRT is newer, and more than XX days old*/)) AND OP.ScheduleCode IN('IX','IP','CA','CP') THEN 'IDFRF' --IBR XXXX / PAYE
		 WHEN OP.OctXXTotal >= XXX AND ISNULL(Arcs.HASFATXX,X) = X AND(ISNULL(Arcs.HASIDFRF,X) = X OR (Arcs.HASIDFRF = X AND Arcs.HASIDFRT = X AND (Arcs.MaxIDFRFDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate)/*re-do full month review if IDFRT is newer, and more than XX days old*/)) AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('XX','XX','XX','XX','XX','X','X','X','X') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'IDFRF' --REPAYE GRAD

		 WHEN OP.AprXXTotal >= XXX AND Arcs.HASFSAFM = X AND Arcs.HASIDRFG = X AND OP.ScheduleCode IN('CX','CX','CX','IB','CQ','IL') THEN 'IDRFG' --IBR ICR
		 WHEN OP.AprXXTotal >= XXX AND Arcs.HASFSAFM = X AND Arcs.HASIDRFG = X AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('A','B','C','D','X','X','X','X','X','XX','XX','XX','XX','XX','XX','XX','XX','XX','XX') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'IDRFG' --REPAYE UNDERGRAD
 		 WHEN OP.AprXXTotal BETWEEN XXX AND XXX AND Arcs.HASFSAXM = X AND Arcs.HASIDRFP = X AND OP.ScheduleCode IN('CX','CX','CX','IB','CQ','IL') THEN 'IDRFP' --IBR ICR
		 WHEN OP.AprXXTotal BETWEEN XXX AND XXX AND Arcs.HASFSAXM = X AND Arcs.HASIDRFP = X AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('A','B','C','D','X','X','X','X','X','XX','XX','XX','XX','XX','XX','XX','XX','XX','XX') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'IDRFP' --REPAYE UNDERGRAD
		 WHEN OP.AprXXTotal >= XXX AND Arcs.HASFSAFM = X AND Arcs.HASIDRFG = X AND OP.ScheduleCode IN('IX','IP','CA','CP') THEN 'IDRFG' --IBR XXXX / PAYE
		 WHEN OP.AprXXTotal >= XXX AND Arcs.HASFSAFM = X AND Arcs.HASIDRFG = X AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('XX','XX','XX','XX','XX','X','X','X','X') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'IDRFG' --REPAYE GRAD
		 WHEN OP.AprXXTotal BETWEEN XXX AND XXX AND Arcs.HASFSAXM = X AND Arcs.HASIDRFP = X AND OP.ScheduleCode IN('IX','IP','CA','CP') THEN 'IDRFP' --IBR XXXX / PAYE
		 WHEN OP.AprXXTotal BETWEEN XXX AND XXX AND Arcs.HASFSAXM = X AND Arcs.HASIDRFP = X AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('XX','XX','XX','XX','XX','X','X','X','X') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'IDRFP' --REPAYE GRAD
		 WHEN OP.AprXXTotal >= XXX AND(ISNULL(Arcs.HASIDFRF,X) = X OR (Arcs.HASIDFRF = X AND Arcs.HASIDFRT = X AND (Arcs.MaxIDFRFDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate)/*re-do full month review if IDFRT is newer, and more than XX days old*/)) AND OP.ScheduleCode IN('CX','CX','CX','IB','CQ','IL') THEN 'IDFRF' --IBR ICR
		 WHEN OP.AprXXTotal >= XXX AND(ISNULL(Arcs.HASIDFRF,X) = X OR (Arcs.HASIDFRF = X AND Arcs.HASIDFRT = X AND (Arcs.MaxIDFRFDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate)/*re-do full month review if IDFRT is newer, and more than XX days old*/)) AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('A','B','C','D','X','X','X','X','X','XX','XX','XX','XX','XX','XX','XX','XX','XX','XX') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'IDFRF' --REPAYE UNDERGRAD
		 WHEN OP.AprXXTotal >= XXX AND ISNULL(Arcs.HASFATXX,X) = X AND(ISNULL(Arcs.HASIDFRF,X) = X OR (Arcs.HASIDFRF = X AND Arcs.HASIDFRT = X AND (Arcs.MaxIDFRFDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate)/*re-do full month review if IDFRT is newer, and more than XX days old*/)) AND OP.ScheduleCode IN('IX','IP','CA','CP') THEN 'IDFRF' --IBR XXXX / PAYE
		 WHEN OP.AprXXTotal >= XXX AND ISNULL(Arcs.HASFATXX,X) = X AND(ISNULL(Arcs.HASIDFRF,X) = X OR (Arcs.HASIDFRF = X AND Arcs.HASIDFRT = X AND (Arcs.MaxIDFRFDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate)/*re-do full month review if IDFRT is newer, and more than XX days old*/)) AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('XX','XX','XX','XX','XX','X','X','X','X') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'IDFRF' --REPAYE GRAD
=======
 		 WHEN OP.Total BETWEEN XXX AND XXX AND(ISNULL(Arcs.HASMXFRG,X) = X OR (Arcs.HASMXFRG = X AND Arcs.HASIDFRT = X AND (Arcs.MaxMXFRGDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate) /*re-do X month review if IDFRT is newer, and more than XX days old*/) OR (Arcs.HASMXFRG = X AND Arcs.HASFATXX = X AND Arcs.MaxMXFRGDate < Arcs.MaxFATXXDate)) AND OP.ScheduleCode IN('CX','CX','CX','IB','CQ','IL') THEN 'MXFRG' --IBR ICR
		 WHEN OP.Total BETWEEN XXX AND XXX AND(ISNULL(Arcs.HASMXFRG,X) = X OR (Arcs.HASMXFRG = X AND Arcs.HASIDFRT = X AND (Arcs.MaxMXFRGDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate) /*re-do X month review if IDFRT is newer, and more than XX days old*/) OR (Arcs.HASMXFRG = X AND Arcs.HASFATXX = X AND Arcs.MaxMXFRGDate < Arcs.MaxFATXXDate)) AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('A','B','C','D','X','X','X','X','X','XX','XX','XX','XX','XX','XX','XX','XX','XX','XX') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'MXFRG' --REPAYE UNDERGRAD
		 WHEN OP.Total >= XXX AND ISNULL(Arcs.HASFATXX,X) = X AND(ISNULL(Arcs.HASIDFRF,X) = X OR (Arcs.HASIDFRF = X AND Arcs.HASIDFRT = X AND (Arcs.MaxIDFRFDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate)/*re-do full month review if IDFRT is newer, and more than XX days old*/)) AND OP.ScheduleCode IN('IX','IP','CA','CP') THEN 'IDFRF' --IBR XXXX / PAYE
		 WHEN OP.Total >= XXX AND ISNULL(Arcs.HASFATXX,X) = X AND(ISNULL(Arcs.HASIDFRF,X) = X OR (Arcs.HASIDFRF = X AND Arcs.HASIDFRT = X AND (Arcs.MaxIDFRFDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate)/*re-do full month review if IDFRT is newer, and more than XX days old*/)) AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('XX','XX','XX','XX','XX','X','X','X','X') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'IDFRF' --REPAYE GRAD
		 WHEN OP.Total BETWEEN XXX AND XXX AND ISNULL(Arcs.HASFATXX,X) = X AND(ISNULL(Arcs.HASMXFRG,X) = X OR (Arcs.HASMXFRG = X AND Arcs.HASIDFRT = X AND (Arcs.MaxMXFRGDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate)/*re-do X month review if IDFRT is newer, and more than XX days old*/)) AND OP.ScheduleCode IN('IX','IP','CA','CP') THEN 'MXFRG' --IBR XXXX / PAYE
		 WHEN OP.Total BETWEEN XXX AND XXX AND ISNULL(Arcs.HASFATXX,X) = X AND(ISNULL(Arcs.HASMXFRG,X) = X OR (Arcs.HASMXFRG = X AND Arcs.HASIDFRT = X AND (Arcs.MaxMXFRGDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate)/*re-do X month review if IDFRT is newer, and more than XX days old*/)) AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('XX','XX','XX','XX','XX','X','X','X','X') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'MXFRG' --REPAYE GRAD

		 WHEN OP.NovXXTotal >= XXX AND Arcs.HASFSAFM = X AND Arcs.HASIDRFG = X AND OP.ScheduleCode IN('CX','CX','CX','IB','CQ','IL') THEN 'IDRFG' --IBR ICR
		 WHEN OP.NovXXTotal >= XXX AND Arcs.HASFSAFM = X AND Arcs.HASIDRFG = X AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('A','B','C','D','X','X','X','X','X','XX','XX','XX','XX','XX','XX','XX','XX','XX','XX') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'IDRFG' --REPAYE UNDERGRAD
 		 WHEN OP.NovXXTotal BETWEEN XXX AND XXX AND Arcs.HASFSAXM = X AND Arcs.HASIDRFP = X AND OP.ScheduleCode IN('CX','CX','CX','IB','CQ','IL') THEN 'IDRFP' --IBR ICR
		 WHEN OP.NovXXTotal BETWEEN XXX AND XXX AND Arcs.HASFSAXM = X AND Arcs.HASIDRFP = X AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('A','B','C','D','X','X','X','X','X','XX','XX','XX','XX','XX','XX','XX','XX','XX','XX') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'IDRFP' --REPAYE UNDERGRAD
		 WHEN OP.NovXXTotal >= XXX AND Arcs.HASFSAFM = X AND Arcs.HASIDRFG = X AND OP.ScheduleCode IN('IX','IP','CA','CP') THEN 'IDRFG' --IBR XXXX / PAYE
		 WHEN OP.NovXXTotal >= XXX AND Arcs.HASFSAFM = X AND Arcs.HASIDRFG = X AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('XX','XX','XX','XX','XX','X','X','X','X') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'IDRFG' --REPAYE GRAD
		 WHEN OP.NovXXTotal BETWEEN XXX AND XXX AND Arcs.HASFSAXM = X AND Arcs.HASIDRFP = X AND OP.ScheduleCode IN('IX','IP','CA','CP') THEN 'IDRFP' --IBR XXXX / PAYE
		 WHEN OP.NovXXTotal BETWEEN XXX AND XXX AND Arcs.HASFSAXM = X AND Arcs.HASIDRFP = X AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('XX','XX','XX','XX','XX','X','X','X','X') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'IDRFP' --REPAYE GRAD
		 WHEN OP.NovXXTotal >= XXX AND(ISNULL(Arcs.HASIDFRF,X) = X OR (Arcs.HASIDFRF = X AND Arcs.HASIDFRT = X AND (Arcs.MaxIDFRFDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate)/*re-do full month review if IDFRT is newer, and more than XX days old*/)) AND OP.ScheduleCode IN('CX','CX','CX','IB','CQ','IL') THEN 'IDFRF' --IBR ICR
		 WHEN OP.NovXXTotal >= XXX AND(ISNULL(Arcs.HASIDFRF,X) = X OR (Arcs.HASIDFRF = X AND Arcs.HASIDFRT = X AND (Arcs.MaxIDFRFDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate)/*re-do full month review if IDFRT is newer, and more than XX days old*/)) AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('A','B','C','D','X','X','X','X','X','XX','XX','XX','XX','XX','XX','XX','XX','XX','XX') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'IDFRF' --REPAYE UNDERGRAD
 		 WHEN OP.NovXXTotal BETWEEN XXX AND XXX AND(ISNULL(Arcs.HASMXFRG,X) = X OR (Arcs.HASMXFRG = X AND Arcs.HASIDFRT = X AND (Arcs.MaxMXFRGDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate) /*re-do X month review if IDFRT is newer, and more than XX days old*/) OR (Arcs.HASMXFRG = X AND Arcs.HASFATXX = X AND Arcs.MaxMXFRGDate < Arcs.MaxFATXXDate)) AND OP.ScheduleCode IN('CX','CX','CX','IB','CQ','IL') THEN 'MXFRG' --IBR ICR
		 WHEN OP.NovXXTotal BETWEEN XXX AND XXX AND(ISNULL(Arcs.HASMXFRG,X) = X OR (Arcs.HASMXFRG = X AND Arcs.HASIDFRT = X AND (Arcs.MaxMXFRGDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate) /*re-do X month review if IDFRT is newer, and more than XX days old*/) OR (Arcs.HASMXFRG = X AND Arcs.HASFATXX = X AND Arcs.MaxMXFRGDate < Arcs.MaxFATXXDate)) AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('A','B','C','D','X','X','X','X','X','XX','XX','XX','XX','XX','XX','XX','XX','XX','XX') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'MXFRG' --REPAYE UNDERGRAD
		 WHEN OP.NovXXTotal >= XXX AND ISNULL(Arcs.HASFATXX,X) = X AND(ISNULL(Arcs.HASIDFRF,X) = X OR (Arcs.HASIDFRF = X AND Arcs.HASIDFRT = X AND (Arcs.MaxIDFRFDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate)/*re-do full month review if IDFRT is newer, and more than XX days old*/)) AND OP.ScheduleCode IN('IX','IP','CA','CP') THEN 'IDFRF' --IBR XXXX / PAYE
		 WHEN OP.NovXXTotal >= XXX AND ISNULL(Arcs.HASFATXX,X) = X AND(ISNULL(Arcs.HASIDFRF,X) = X OR (Arcs.HASIDFRF = X AND Arcs.HASIDFRT = X AND (Arcs.MaxIDFRFDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate)/*re-do full month review if IDFRT is newer, and more than XX days old*/)) AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('XX','XX','XX','XX','XX','X','X','X','X') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'IDFRF' --REPAYE GRAD
		 WHEN OP.NovXXTotal BETWEEN XXX AND XXX AND ISNULL(Arcs.HASFATXX,X) = X AND(ISNULL(Arcs.HASMXFRG,X) = X OR (Arcs.HASMXFRG = X AND Arcs.HASIDFRT = X AND (Arcs.MaxMXFRGDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate)/*re-do X month review if IDFRT is newer, and more than XX days old*/)) AND OP.ScheduleCode IN('IX','IP','CA','CP') THEN 'MXFRG' --IBR XXXX / PAYE
		 WHEN OP.NovXXTotal BETWEEN XXX AND XXX AND ISNULL(Arcs.HASFATXX,X) = X AND(ISNULL(Arcs.HASMXFRG,X) = X OR (Arcs.HASMXFRG = X AND Arcs.HASIDFRT = X AND (Arcs.MaxMXFRGDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate)/*re-do X month review if IDFRT is newer, and more than XX days old*/)) AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('XX','XX','XX','XX','XX','X','X','X','X') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'MXFRG' --REPAYE GRAD

		 WHEN OP.MayXXTotal >= XXX AND Arcs.HASFSAFM = X AND Arcs.HASIDRFG = X AND OP.ScheduleCode IN('CX','CX','CX','IB','CQ','IL') THEN 'IDRFG' --IBR ICR
		 WHEN OP.MayXXTotal >= XXX AND Arcs.HASFSAFM = X AND Arcs.HASIDRFG = X AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('A','B','C','D','X','X','X','X','X','XX','XX','XX','XX','XX','XX','XX','XX','XX','XX') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'IDRFG' --REPAYE UNDERGRAD
 		 WHEN OP.MayXXTotal BETWEEN XXX AND XXX AND Arcs.HASFSAXM = X AND Arcs.HASIDRFP = X AND OP.ScheduleCode IN('CX','CX','CX','IB','CQ','IL') THEN 'IDRFP' --IBR ICR
		 WHEN OP.MayXXTotal BETWEEN XXX AND XXX AND Arcs.HASFSAXM = X AND Arcs.HASIDRFP = X AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('A','B','C','D','X','X','X','X','X','XX','XX','XX','XX','XX','XX','XX','XX','XX','XX') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'IDRFP' --REPAYE UNDERGRAD
		 WHEN OP.MayXXTotal >= XXX AND Arcs.HASFSAFM = X AND Arcs.HASIDRFG = X AND OP.ScheduleCode IN('IX','IP','CA','CP') THEN 'IDRFG' --IBR XXXX / PAYE
		 WHEN OP.MayXXTotal >= XXX AND Arcs.HASFSAFM = X AND Arcs.HASIDRFG = X AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('XX','XX','XX','XX','XX','X','X','X','X') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'IDRFG' --REPAYE GRAD
		 WHEN OP.MayXXTotal BETWEEN XXX AND XXX AND Arcs.HASFSAXM = X AND Arcs.HASIDRFP = X AND OP.ScheduleCode IN('IX','IP','CA','CP') THEN 'IDRFP' --IBR XXXX / PAYE
		 WHEN OP.MayXXTotal BETWEEN XXX AND XXX AND Arcs.HASFSAXM = X AND Arcs.HASIDRFP = X AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('XX','XX','XX','XX','XX','X','X','X','X') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'IDRFP' --REPAYE GRAD
		 WHEN OP.MayXXTotal >= XXX AND(ISNULL(Arcs.HASIDFRF,X) = X OR (Arcs.HASIDFRF = X AND Arcs.HASIDFRT = X AND (Arcs.MaxIDFRFDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate)/*re-do full month review if IDFRT is newer, and more than XX days old*/)) AND OP.ScheduleCode IN('CX','CX','CX','IB','CQ','IL') THEN 'IDFRF' --IBR ICR
		 WHEN OP.MayXXTotal >= XXX AND(ISNULL(Arcs.HASIDFRF,X) = X OR (Arcs.HASIDFRF = X AND Arcs.HASIDFRT = X AND (Arcs.MaxIDFRFDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate)/*re-do full month review if IDFRT is newer, and more than XX days old*/)) AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('A','B','C','D','X','X','X','X','X','XX','XX','XX','XX','XX','XX','XX','XX','XX','XX') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'IDFRF' --REPAYE UNDERGRAD
 		 WHEN OP.MayXXTotal BETWEEN XXX AND XXX AND(ISNULL(Arcs.HASMXFRG,X) = X OR (Arcs.HASMXFRG = X AND Arcs.HASIDFRT = X AND (Arcs.MaxMXFRGDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate) /*re-do X month review if IDFRT is newer, and more than XX days old*/) OR (Arcs.HASMXFRG = X AND Arcs.HASFATXX = X AND Arcs.MaxMXFRGDate < Arcs.MaxFATXXDate)) AND OP.ScheduleCode IN('CX','CX','CX','IB','CQ','IL') THEN 'MXFRG' --IBR ICR
		 WHEN OP.MayXXTotal BETWEEN XXX AND XXX AND(ISNULL(Arcs.HASMXFRG,X) = X OR (Arcs.HASMXFRG = X AND Arcs.HASIDFRT = X AND (Arcs.MaxMXFRGDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate) /*re-do X month review if IDFRT is newer, and more than XX days old*/) OR (Arcs.HASMXFRG = X AND Arcs.HASFATXX = X AND Arcs.MaxMXFRGDate < Arcs.MaxFATXXDate)) AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('A','B','C','D','X','X','X','X','X','XX','XX','XX','XX','XX','XX','XX','XX','XX','XX') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'MXFRG' --REPAYE UNDERGRAD
		 WHEN OP.MayXXTotal >= XXX AND ISNULL(Arcs.HASFATXX,X) = X AND(ISNULL(Arcs.HASIDFRF,X) = X OR (Arcs.HASIDFRF = X AND Arcs.HASIDFRT = X AND (Arcs.MaxIDFRFDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate)/*re-do full month review if IDFRT is newer, and more than XX days old*/)) AND OP.ScheduleCode IN('IX','IP','CA','CP') THEN 'IDFRF' --IBR XXXX / PAYE
		 WHEN OP.MayXXTotal >= XXX AND ISNULL(Arcs.HASFATXX,X) = X AND(ISNULL(Arcs.HASIDFRF,X) = X OR (Arcs.HASIDFRF = X AND Arcs.HASIDFRT = X AND (Arcs.MaxIDFRFDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate)/*re-do full month review if IDFRT is newer, and more than XX days old*/)) AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('XX','XX','XX','XX','XX','X','X','X','X') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'IDFRF' --REPAYE GRAD
		 WHEN OP.MayXXTotal BETWEEN XXX AND XXX AND ISNULL(Arcs.HASFATXX,X) = X AND(ISNULL(Arcs.HASMXFRG,X) = X OR (Arcs.HASMXFRG = X AND Arcs.HASIDFRT = X AND (Arcs.MaxMXFRGDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate)/*re-do X month review if IDFRT is newer, and more than XX days old*/)) AND OP.ScheduleCode IN('IX','IP','CA','CP') THEN 'MXFRG' --IBR XXXX / PAYE
		 WHEN OP.MayXXTotal BETWEEN XXX AND XXX AND ISNULL(Arcs.HASFATXX,X) = X AND(ISNULL(Arcs.HASMXFRG,X) = X OR (Arcs.HASMXFRG = X AND Arcs.HASIDFRT = X AND (Arcs.MaxMXFRGDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate)/*re-do X month review if IDFRT is newer, and more than XX days old*/)) AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('XX','XX','XX','XX','XX','X','X','X','X') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'MXFRG' --REPAYE GRAD

		 WHEN OP.NovXXTotal >= XXX AND Arcs.HASFSAFM = X AND Arcs.HASIDRFG = X AND OP.ScheduleCode IN('CX','CX','CX','IB','CQ','IL') THEN 'IDRFG' --IBR ICR
		 WHEN OP.NovXXTotal >= XXX AND Arcs.HASFSAFM = X AND Arcs.HASIDRFG = X AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('A','B','C','D','X','X','X','X','X','XX','XX','XX','XX','XX','XX','XX','XX','XX','XX') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'IDRFG' --REPAYE UNDERGRAD
 		 WHEN OP.NovXXTotal BETWEEN XXX AND XXX AND Arcs.HASFSAXM = X AND Arcs.HASIDRFP = X AND OP.ScheduleCode IN('CX','CX','CX','IB','CQ','IL') THEN 'IDRFP' --IBR ICR
		 WHEN OP.NovXXTotal BETWEEN XXX AND XXX AND Arcs.HASFSAXM = X AND Arcs.HASIDRFP = X AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('A','B','C','D','X','X','X','X','X','XX','XX','XX','XX','XX','XX','XX','XX','XX','XX') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'IDRFP' --REPAYE UNDERGRAD
		 WHEN OP.NovXXTotal >= XXX AND Arcs.HASFSAFM = X AND Arcs.HASIDRFG = X AND OP.ScheduleCode IN('IX','IP','CA','CP') THEN 'IDRFG' --IBR XXXX / PAYE
		 WHEN OP.NovXXTotal >= XXX AND Arcs.HASFSAFM = X AND Arcs.HASIDRFG = X AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('XX','XX','XX','XX','XX','X','X','X','X') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'IDRFG' --REPAYE GRAD
		 WHEN OP.NovXXTotal BETWEEN XXX AND XXX AND Arcs.HASFSAXM = X AND Arcs.HASIDRFP = X AND OP.ScheduleCode IN('IX','IP','CA','CP') THEN 'IDRFP' --IBR XXXX / PAYE
		 WHEN OP.NovXXTotal BETWEEN XXX AND XXX AND Arcs.HASFSAXM = X AND Arcs.HASIDRFP = X AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('XX','XX','XX','XX','XX','X','X','X','X') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'IDRFP' --REPAYE GRAD
		 WHEN OP.NovXXTotal >= XXX AND(ISNULL(Arcs.HASIDFRF,X) = X OR (Arcs.HASIDFRF = X AND Arcs.HASIDFRT = X AND (Arcs.MaxIDFRFDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate)/*re-do full month review if IDFRT is newer, and more than XX days old*/)) AND OP.ScheduleCode IN('CX','CX','CX','IB','CQ','IL') THEN 'IDFRF' --IBR ICR
		 WHEN OP.NovXXTotal >= XXX AND(ISNULL(Arcs.HASIDFRF,X) = X OR (Arcs.HASIDFRF = X AND Arcs.HASIDFRT = X AND (Arcs.MaxIDFRFDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate)/*re-do full month review if IDFRT is newer, and more than XX days old*/)) AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('A','B','C','D','X','X','X','X','X','XX','XX','XX','XX','XX','XX','XX','XX','XX','XX') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'IDFRF' --REPAYE UNDERGRAD
 		 WHEN OP.NovXXTotal BETWEEN XXX AND XXX AND(ISNULL(Arcs.HASMXFRG,X) = X OR (Arcs.HASMXFRG = X AND Arcs.HASIDFRT = X AND (Arcs.MaxMXFRGDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate) /*re-do X month review if IDFRT is newer, and more than XX days old*/) OR (Arcs.HASMXFRG = X AND Arcs.HASFATXX = X AND Arcs.MaxMXFRGDate < Arcs.MaxFATXXDate)) AND OP.ScheduleCode IN('CX','CX','CX','IB','CQ','IL') THEN 'MXFRG' --IBR ICR
		 WHEN OP.NovXXTotal BETWEEN XXX AND XXX AND(ISNULL(Arcs.HASMXFRG,X) = X OR (Arcs.HASMXFRG = X AND Arcs.HASIDFRT = X AND (Arcs.MaxMXFRGDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate) /*re-do X month review if IDFRT is newer, and more than XX days old*/) OR (Arcs.HASMXFRG = X AND Arcs.HASFATXX = X AND Arcs.MaxMXFRGDate < Arcs.MaxFATXXDate)) AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('A','B','C','D','X','X','X','X','X','XX','XX','XX','XX','XX','XX','XX','XX','XX','XX') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'MXFRG' --REPAYE UNDERGRAD
		 WHEN OP.NovXXTotal >= XXX AND ISNULL(Arcs.HASFATXX,X) = X AND(ISNULL(Arcs.HASIDFRF,X) = X OR (Arcs.HASIDFRF = X AND Arcs.HASIDFRT = X AND (Arcs.MaxIDFRFDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate)/*re-do full month review if IDFRT is newer, and more than XX days old*/)) AND OP.ScheduleCode IN('IX','IP','CA','CP') THEN 'IDFRF' --IBR XXXX / PAYE
		 WHEN OP.NovXXTotal >= XXX AND ISNULL(Arcs.HASFATXX,X) = X AND(ISNULL(Arcs.HASIDFRF,X) = X OR (Arcs.HASIDFRF = X AND Arcs.HASIDFRT = X AND (Arcs.MaxIDFRFDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate)/*re-do full month review if IDFRT is newer, and more than XX days old*/)) AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('XX','XX','XX','XX','XX','X','X','X','X') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'IDFRF' --REPAYE GRAD
		 WHEN OP.NovXXTotal BETWEEN XXX AND XXX AND ISNULL(Arcs.HASFATXX,X) = X AND(ISNULL(Arcs.HASMXFRG,X) = X OR (Arcs.HASMXFRG = X AND Arcs.HASIDFRT = X AND (Arcs.MaxMXFRGDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate)/*re-do X month review if IDFRT is newer, and more than XX days old*/)) AND OP.ScheduleCode IN('IX','IP','CA','CP') THEN 'MXFRG' --IBR XXXX / PAYE
		 WHEN OP.NovXXTotal BETWEEN XXX AND XXX AND ISNULL(Arcs.HASFATXX,X) = X AND(ISNULL(Arcs.HASMXFRG,X) = X OR (Arcs.HASMXFRG = X AND Arcs.HASIDFRT = X AND (Arcs.MaxMXFRGDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate)/*re-do X month review if IDFRT is newer, and more than XX days old*/)) AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('XX','XX','XX','XX','XX','X','X','X','X') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'MXFRG' --REPAYE GRAD
>>>>>>> fcXXcdeeeXXfaXXXXXXXXXXXXXXXeXXXXXdccXbc

		 ELSE 'You broke it'
	END [ARC],
	'IDRFRGVNS' [ScriptId],
	GETDATE() [ProcessOn],
<<<<<<< HEAD
	CASE 
		 WHEN OP.Total >= XXX AND Arcs.HASFSAFM = X AND Arcs.HASIDRFG = X AND OP.ScheduleCode IN('CX','CX','CX','IB','CQ','IL') THEN 'Borrower approved in full forgiveness review. Trigger TSXXBIDRFG letter. XX year plan'
=======
	CASE WHEN OP.Total >= XXX AND Arcs.HASFSAFM = X AND Arcs.HASIDRFG = X AND OP.ScheduleCode IN('CX','CX','CX','IB','CQ','IL') THEN 'Borrower approved in full forgiveness review. Trigger TSXXBIDRFG letter. XX year plan'
>>>>>>> fcXXcdeeeXXfaXXXXXXXXXXXXXXXeXXXXXdccXbc
		 WHEN OP.Total >= XXX AND Arcs.HASFSAFM = X AND Arcs.HASIDRFG = X AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('A','B','C','D','X','X','X','X','X','XX','XX','XX','XX','XX','XX','XX','XX','XX','XX') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'Borrower approved in full forgiveness review. Trigger TSXXBIDRFG letter. XX year plan'
		 WHEN OP.Total BETWEEN XXX AND XXX AND Arcs.HASFSAXM = X AND Arcs.HASIDRFP = X AND OP.ScheduleCode IN('CX','CX','CX','IB','CQ','IL') THEN 'Borrower approved in X month forgiveness review. Trigger TSXXBIDRFP letter. XX year plan'
		 WHEN OP.Total BETWEEN XXX AND XXX AND Arcs.HASFSAXM = X AND Arcs.HASIDRFP = X AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('A','B','C','D','X','X','X','X','X','XX','XX','XX','XX','XX','XX','XX','XX','XX','XX') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'Borrower approved in X month forgiveness review. Trigger TSXXBIDRFP letter. XX year plan'
	     WHEN OP.Total >= XXX AND Arcs.HASFSAFM = X AND Arcs.HASIDRFG = X AND OP.ScheduleCode IN('IX','IP','CA','CP') THEN 'Borrower approved in full forgiveness review. Trigger TSXXBIDRFG letter. XX year plan'
		 WHEN OP.Total >= XXX AND Arcs.HASFSAFM = X AND Arcs.HASIDRFG = X AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('XX','XX','XX','XX','XX','X','X','X','X') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'Borrower approved in full forgiveness review. Trigger TSXXBIDRFG letter. XX year plan'
		 WHEN OP.Total BETWEEN XXX AND XXX AND Arcs.HASFSAXM = X AND Arcs.HASIDRFP = X AND OP.ScheduleCode IN('IX','IP','CA','CP') THEN 'Borrower approved in X month forgiveness review. Trigger TSXXBIDRFP letter. XX year plan'
		 WHEN OP.Total BETWEEN XXX AND XXX AND Arcs.HASFSAXM = X AND Arcs.HASIDRFP = X AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('XX','XX','XX','XX','XX','X','X','X','X') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'Borrower approved in X month forgiveness review. Trigger TSXXBIDRFP letter. XX year plan'
		 WHEN OP.Total >= XXX AND(ISNULL(HASIDFRF,X) = X OR (Arcs.HASIDFRF = X AND Arcs.HASIDFRT = X AND (Arcs.MaxIDFRFDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate)/*re-do full month review if IDFRT is newer, and more than XX days old*/)) AND OP.ScheduleCode IN('CX','CX','CX','IB','CQ','IL') THEN 'Borrower requires full eligibility forgiveness review. XX year plan'	
		 WHEN OP.Total >= XXX AND(ISNULL(HASIDFRF,X) = X OR (Arcs.HASIDFRF = X AND Arcs.HASIDFRT = X AND (Arcs.MaxIDFRFDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate)/*re-do full month review if IDFRT is newer, and more than XX days old*/)) AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('A','B','C','D','X','X','X','X','X','XX','XX','XX','XX','XX','XX','XX','XX','XX','XX') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'Borrower requires full eligibility forgiveness review. XX year plan'	
<<<<<<< HEAD
		 WHEN OP.Total >= XXX AND ISNULL(HASFATXX,X) = X AND(ISNULL(Arcs.HASIDFRF,X) = X OR (Arcs.HASIDFRF = X AND Arcs.HASIDFRT = X AND (Arcs.MaxIDFRFDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate)/*re-do full month review if IDFRT is newer, and more than XX days old*/)) AND OP.ScheduleCode IN('IX','IP','CA','CP') THEN 'Borrower requires full eligibility forgiveness review. XX year plan'
		 WHEN OP.Total >= XXX AND ISNULL(HASFATXX,X) = X AND(ISNULL(Arcs.HASIDFRF,X) = X OR (Arcs.HASIDFRF = X AND Arcs.HASIDFRT = X AND (Arcs.MaxIDFRFDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate)/*re-do full month review if IDFRT is newer, and more than XX days old*/)) AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('XX','XX','XX','XX','XX','X','X','X','X') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'Borrower requires full eligibility forgiveness review. XX year plan'

		 WHEN OP.AprXXTotal >= XXX AND Arcs.HASFSAFM = X AND Arcs.HASIDRFG = X AND OP.ScheduleCode IN('CX','CX','CX','IB','CQ','IL') THEN 'Borrower approved in full forgiveness review. Trigger TSXXBIDRFG letter. XX year plan'
		 WHEN OP.AprXXTotal >= XXX AND Arcs.HASFSAFM = X AND Arcs.HASIDRFG = X AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('A','B','C','D','X','X','X','X','X','XX','XX','XX','XX','XX','XX','XX','XX','XX','XX') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'Borrower approved in full forgiveness review. Trigger TSXXBIDRFG letter. XX year plan'
		 WHEN OP.AprXXTotal BETWEEN XXX AND XXX AND Arcs.HASFSAXM = X AND Arcs.HASIDRFP = X AND OP.ScheduleCode IN('CX','CX','CX','IB','CQ','IL') THEN 'Borrower approved in X month forgiveness review. Trigger TSXXBIDRFP letter. XX year plan'
		 WHEN OP.AprXXTotal BETWEEN XXX AND XXX AND Arcs.HASFSAXM = X AND Arcs.HASIDRFP = X AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('A','B','C','D','X','X','X','X','X','XX','XX','XX','XX','XX','XX','XX','XX','XX','XX') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'Borrower approved in X month forgiveness review. Trigger TSXXBIDRFP letter. XX year plan'
	     WHEN OP.AprXXTotal >= XXX AND Arcs.HASFSAFM = X AND Arcs.HASIDRFG = X AND OP.ScheduleCode IN('IX','IP','CA','CP') THEN 'Borrower approved in full forgiveness review. Trigger TSXXBIDRFG letter. XX year plan'
		 WHEN OP.AprXXTotal >= XXX AND Arcs.HASFSAFM = X AND Arcs.HASIDRFG = X AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('XX','XX','XX','XX','XX','X','X','X','X') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'Borrower approved in full forgiveness review. Trigger TSXXBIDRFG letter. XX year plan'
		 WHEN OP.AprXXTotal BETWEEN XXX AND XXX AND Arcs.HASFSAXM = X AND Arcs.HASIDRFP = X AND OP.ScheduleCode IN('IX','IP','CA','CP') THEN 'Borrower approved in X month forgiveness review. Trigger TSXXBIDRFP letter. XX year plan'
		 WHEN OP.AprXXTotal BETWEEN XXX AND XXX AND Arcs.HASFSAXM = X AND Arcs.HASIDRFP = X AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('XX','XX','XX','XX','XX','X','X','X','X') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'Borrower approved in X month forgiveness review. Trigger TSXXBIDRFP letter. XX year plan'
		 WHEN OP.AprXXTotal >= XXX AND(ISNULL(HASIDFRF,X) = X OR (Arcs.HASIDFRF = X AND Arcs.HASIDFRT = X AND (Arcs.MaxIDFRFDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate)/*re-do full month review if IDFRT is newer, and more than XX days old*/)) AND OP.ScheduleCode IN('CX','CX','CX','IB','CQ','IL') THEN 'Borrower requires full eligibility forgiveness review. XX year plan'	
		 WHEN OP.AprXXTotal >= XXX AND(ISNULL(HASIDFRF,X) = X OR (Arcs.HASIDFRF = X AND Arcs.HASIDFRT = X AND (Arcs.MaxIDFRFDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate)/*re-do full month review if IDFRT is newer, and more than XX days old*/)) AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('A','B','C','D','X','X','X','X','X','XX','XX','XX','XX','XX','XX','XX','XX','XX','XX') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'Borrower requires full eligibility forgiveness review. XX year plan'	
		 WHEN OP.AprXXTotal >= XXX AND ISNULL(HASFATXX,X) = X AND(ISNULL(Arcs.HASIDFRF,X) = X OR (Arcs.HASIDFRF = X AND Arcs.HASIDFRT = X AND (Arcs.MaxIDFRFDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate)/*re-do full month review if IDFRT is newer, and more than XX days old*/)) AND OP.ScheduleCode IN('IX','IP','CA','CP') THEN 'Borrower requires full eligibility forgiveness review. XX year plan'
		 WHEN OP.AprXXTotal >= XXX AND ISNULL(HASFATXX,X) = X AND(ISNULL(Arcs.HASIDFRF,X) = X OR (Arcs.HASIDFRF = X AND Arcs.HASIDFRT = X AND (Arcs.MaxIDFRFDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate)/*re-do full month review if IDFRT is newer, and more than XX days old*/)) AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('XX','XX','XX','XX','XX','X','X','X','X') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'Borrower requires full eligibility forgiveness review. XX year plan'

		 WHEN OP.OctXXTotal >= XXX AND Arcs.HASFSAFM = X AND Arcs.HASIDRFG = X AND OP.ScheduleCode IN('CX','CX','CX','IB','CQ','IL') THEN 'Borrower approved in full forgiveness review. Trigger TSXXBIDRFG letter. XX year plan'
		 WHEN OP.OctXXTotal >= XXX AND Arcs.HASFSAFM = X AND Arcs.HASIDRFG = X AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('A','B','C','D','X','X','X','X','X','XX','XX','XX','XX','XX','XX','XX','XX','XX','XX') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'Borrower approved in full forgiveness review. Trigger TSXXBIDRFG letter. XX year plan'
		 WHEN OP.OctXXTotal BETWEEN XXX AND XXX AND Arcs.HASFSAXM = X AND Arcs.HASIDRFP = X AND OP.ScheduleCode IN('CX','CX','CX','IB','CQ','IL') THEN 'Borrower approved in X month forgiveness review. Trigger TSXXBIDRFP letter. XX year plan'
		 WHEN OP.OctXXTotal BETWEEN XXX AND XXX AND Arcs.HASFSAXM = X AND Arcs.HASIDRFP = X AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('A','B','C','D','X','X','X','X','X','XX','XX','XX','XX','XX','XX','XX','XX','XX','XX') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'Borrower approved in X month forgiveness review. Trigger TSXXBIDRFP letter. XX year plan'
	     WHEN OP.OctXXTotal >= XXX AND Arcs.HASFSAFM = X AND Arcs.HASIDRFG = X AND OP.ScheduleCode IN('IX','IP','CA','CP') THEN 'Borrower approved in full forgiveness review. Trigger TSXXBIDRFG letter. XX year plan'
		 WHEN OP.OctXXTotal >= XXX AND Arcs.HASFSAFM = X AND Arcs.HASIDRFG = X AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('XX','XX','XX','XX','XX','X','X','X','X') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'Borrower approved in full forgiveness review. Trigger TSXXBIDRFG letter. XX year plan'
		 WHEN OP.OctXXTotal BETWEEN XXX AND XXX AND Arcs.HASFSAXM = X AND Arcs.HASIDRFP = X AND OP.ScheduleCode IN('IX','IP','CA','CP') THEN 'Borrower approved in X month forgiveness review. Trigger TSXXBIDRFP letter. XX year plan'
		 WHEN OP.OctXXTotal BETWEEN XXX AND XXX AND Arcs.HASFSAXM = X AND Arcs.HASIDRFP = X AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('XX','XX','XX','XX','XX','X','X','X','X') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'Borrower approved in X month forgiveness review. Trigger TSXXBIDRFP letter. XX year plan'
		 WHEN OP.OctXXTotal >= XXX AND(ISNULL(HASIDFRF,X) = X OR (Arcs.HASIDFRF = X AND Arcs.HASIDFRT = X AND (Arcs.MaxIDFRFDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate)/*re-do full month review if IDFRT is newer, and more than XX days old*/)) AND OP.ScheduleCode IN('CX','CX','CX','IB','CQ','IL') THEN 'Borrower requires full eligibility forgiveness review. XX year plan'	
		 WHEN OP.OctXXTotal >= XXX AND(ISNULL(HASIDFRF,X) = X OR (Arcs.HASIDFRF = X AND Arcs.HASIDFRT = X AND (Arcs.MaxIDFRFDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate)/*re-do full month review if IDFRT is newer, and more than XX days old*/)) AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('A','B','C','D','X','X','X','X','X','XX','XX','XX','XX','XX','XX','XX','XX','XX','XX') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'Borrower requires full eligibility forgiveness review. XX year plan'	
		 WHEN OP.OctXXTotal >= XXX AND ISNULL(HASFATXX,X) = X AND(ISNULL(Arcs.HASIDFRF,X) = X OR (Arcs.HASIDFRF = X AND Arcs.HASIDFRT = X AND (Arcs.MaxIDFRFDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate)/*re-do full month review if IDFRT is newer, and more than XX days old*/)) AND OP.ScheduleCode IN('IX','IP','CA','CP') THEN 'Borrower requires full eligibility forgiveness review. XX year plan'
		 WHEN OP.OctXXTotal >= XXX AND ISNULL(HASFATXX,X) = X AND(ISNULL(Arcs.HASIDFRF,X) = X OR (Arcs.HASIDFRF = X AND Arcs.HASIDFRT = X AND (Arcs.MaxIDFRFDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate)/*re-do full month review if IDFRT is newer, and more than XX days old*/)) AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('XX','XX','XX','XX','XX','X','X','X','X') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'Borrower requires full eligibility forgiveness review. XX year plan'

		 WHEN OP.AprXXTotal >= XXX AND Arcs.HASFSAFM = X AND Arcs.HASIDRFG = X AND OP.ScheduleCode IN('CX','CX','CX','IB','CQ','IL') THEN 'Borrower approved in full forgiveness review. Trigger TSXXBIDRFG letter. XX year plan'
		 WHEN OP.AprXXTotal >= XXX AND Arcs.HASFSAFM = X AND Arcs.HASIDRFG = X AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('A','B','C','D','X','X','X','X','X','XX','XX','XX','XX','XX','XX','XX','XX','XX','XX') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'Borrower approved in full forgiveness review. Trigger TSXXBIDRFG letter. XX year plan'
		 WHEN OP.AprXXTotal BETWEEN XXX AND XXX AND Arcs.HASFSAXM = X AND Arcs.HASIDRFP = X AND OP.ScheduleCode IN('CX','CX','CX','IB','CQ','IL') THEN 'Borrower approved in X month forgiveness review. Trigger TSXXBIDRFP letter. XX year plan'
		 WHEN OP.AprXXTotal BETWEEN XXX AND XXX AND Arcs.HASFSAXM = X AND Arcs.HASIDRFP = X AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('A','B','C','D','X','X','X','X','X','XX','XX','XX','XX','XX','XX','XX','XX','XX','XX') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'Borrower approved in X month forgiveness review. Trigger TSXXBIDRFP letter. XX year plan'
	     WHEN OP.AprXXTotal >= XXX AND Arcs.HASFSAFM = X AND Arcs.HASIDRFG = X AND OP.ScheduleCode IN('IX','IP','CA','CP') THEN 'Borrower approved in full forgiveness review. Trigger TSXXBIDRFG letter. XX year plan'
		 WHEN OP.AprXXTotal >= XXX AND Arcs.HASFSAFM = X AND Arcs.HASIDRFG = X AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('XX','XX','XX','XX','XX','X','X','X','X') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'Borrower approved in full forgiveness review. Trigger TSXXBIDRFG letter. XX year plan'
		 WHEN OP.AprXXTotal BETWEEN XXX AND XXX AND Arcs.HASFSAXM = X AND Arcs.HASIDRFP = X AND OP.ScheduleCode IN('IX','IP','CA','CP') THEN 'Borrower approved in X month forgiveness review. Trigger TSXXBIDRFP letter. XX year plan'
		 WHEN OP.AprXXTotal BETWEEN XXX AND XXX AND Arcs.HASFSAXM = X AND Arcs.HASIDRFP = X AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('XX','XX','XX','XX','XX','X','X','X','X') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'Borrower approved in X month forgiveness review. Trigger TSXXBIDRFP letter. XX year plan'
		 WHEN OP.AprXXTotal >= XXX AND(ISNULL(HASIDFRF,X) = X OR (Arcs.HASIDFRF = X AND Arcs.HASIDFRT = X AND (Arcs.MaxIDFRFDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate)/*re-do full month review if IDFRT is newer, and more than XX days old*/)) AND OP.ScheduleCode IN('CX','CX','CX','IB','CQ','IL') THEN 'Borrower requires full eligibility forgiveness review. XX year plan'	
		 WHEN OP.AprXXTotal >= XXX AND(ISNULL(HASIDFRF,X) = X OR (Arcs.HASIDFRF = X AND Arcs.HASIDFRT = X AND (Arcs.MaxIDFRFDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate)/*re-do full month review if IDFRT is newer, and more than XX days old*/)) AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('A','B','C','D','X','X','X','X','X','XX','XX','XX','XX','XX','XX','XX','XX','XX','XX') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'Borrower requires full eligibility forgiveness review. XX year plan'	
		 WHEN OP.AprXXTotal >= XXX AND ISNULL(HASFATXX,X) = X AND(ISNULL(Arcs.HASIDFRF,X) = X OR (Arcs.HASIDFRF = X AND Arcs.HASIDFRT = X AND (Arcs.MaxIDFRFDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate)/*re-do full month review if IDFRT is newer, and more than XX days old*/)) AND OP.ScheduleCode IN('IX','IP','CA','CP') THEN 'Borrower requires full eligibility forgiveness review. XX year plan'
		 WHEN OP.AprXXTotal >= XXX AND ISNULL(HASFATXX,X) = X AND(ISNULL(Arcs.HASIDFRF,X) = X OR (Arcs.HASIDFRF = X AND Arcs.HASIDFRT = X AND (Arcs.MaxIDFRFDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate)/*re-do full month review if IDFRT is newer, and more than XX days old*/)) AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('XX','XX','XX','XX','XX','X','X','X','X') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'Borrower requires full eligibility forgiveness review. XX year plan'
=======
		 WHEN OP.Total BETWEEN XXX AND XXX AND(ISNULL(HASMXFRG,X) = X OR (Arcs.HASMXFRG = X AND Arcs.HASIDFRT = X AND (Arcs.MaxMXFRGDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate)/*re-do X month review if IDFRT is newer, and more than XX days old*/) OR (Arcs.HASMXFRG = X AND Arcs.HASFATXX = X AND Arcs.MaxMXFRGDate < Arcs.MaxFATXXDate)) AND OP.ScheduleCode IN('CX','CX','CX','IB','CQ','IL') THEN 'Borrower requires X month forgiveness review. XX year plan'
		 WHEN OP.Total BETWEEN XXX AND XXX AND(ISNULL(HASMXFRG,X) = X OR (Arcs.HASMXFRG = X AND Arcs.HASIDFRT = X AND (Arcs.MaxMXFRGDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate)/*re-do X month review if IDFRT is newer, and more than XX days old*/) OR (Arcs.HASMXFRG = X AND Arcs.HASFATXX = X AND Arcs.MaxMXFRGDate < Arcs.MaxFATXXDate)) AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('A','B','C','D','X','X','X','X','X','XX','XX','XX','XX','XX','XX','XX','XX','XX','XX') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'Borrower requires X month forgiveness review. XX year plan'
		 WHEN OP.Total >= XXX AND ISNULL(HASFATXX,X) = X AND(ISNULL(Arcs.HASIDFRF,X) = X OR (Arcs.HASIDFRF = X AND Arcs.HASIDFRT = X AND (Arcs.MaxIDFRFDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate)/*re-do full month review if IDFRT is newer, and more than XX days old*/)) AND OP.ScheduleCode IN('IX','IP','CA','CP') THEN 'Borrower requires full eligibility forgiveness review. XX year plan'
		 WHEN OP.Total >= XXX AND ISNULL(HASFATXX,X) = X AND(ISNULL(Arcs.HASIDFRF,X) = X OR (Arcs.HASIDFRF = X AND Arcs.HASIDFRT = X AND (Arcs.MaxIDFRFDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate)/*re-do full month review if IDFRT is newer, and more than XX days old*/)) AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('XX','XX','XX','XX','XX','X','X','X','X') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'Borrower requires full eligibility forgiveness review. XX year plan'
		 WHEN OP.Total BETWEEN XXX AND XXX AND ISNULL(HASFATXX,X) = X AND(ISNULL(Arcs.HASMXFRG,X) = X OR (Arcs.HASMXFRG = X AND Arcs.HASIDFRT = X AND (Arcs.MaxMXFRGDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate)/*re-do X month review if IDFRT is newer, and more than XX days old*/)) AND OP.ScheduleCode IN('IX','IP','CA','CP') THEN 'Borrower requires X month forgiveness review. XX year plan'
		 WHEN OP.Total BETWEEN XXX AND XXX AND ISNULL(HASFATXX,X) = X AND(ISNULL(Arcs.HASMXFRG,X) = X OR (Arcs.HASMXFRG = X AND Arcs.HASIDFRT = X AND (Arcs.MaxMXFRGDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate)/*re-do X month review if IDFRT is newer, and more than XX days old*/)) AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('XX','XX','XX','XX','XX','X','X','X','X') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'Borrower requires X month forgiveness review. XX year plan'

		 WHEN OP.NovXXTotal >= XXX AND Arcs.HASFSAFM = X AND Arcs.HASIDRFG = X AND OP.ScheduleCode IN('CX','CX','CX','IB','CQ','IL') THEN 'Borrower approved in full forgiveness review. Trigger TSXXBIDRFG letter. XX year plan'
		 WHEN OP.NovXXTotal >= XXX AND Arcs.HASFSAFM = X AND Arcs.HASIDRFG = X AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('A','B','C','D','X','X','X','X','X','XX','XX','XX','XX','XX','XX','XX','XX','XX','XX') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'Borrower approved in full forgiveness review. Trigger TSXXBIDRFG letter. XX year plan'
		 WHEN OP.NovXXTotal BETWEEN XXX AND XXX AND Arcs.HASFSAXM = X AND Arcs.HASIDRFP = X AND OP.ScheduleCode IN('CX','CX','CX','IB','CQ','IL') THEN 'Borrower approved in X month forgiveness review. Trigger TSXXBIDRFP letter. XX year plan'
		 WHEN OP.NovXXTotal BETWEEN XXX AND XXX AND Arcs.HASFSAXM = X AND Arcs.HASIDRFP = X AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('A','B','C','D','X','X','X','X','X','XX','XX','XX','XX','XX','XX','XX','XX','XX','XX') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'Borrower approved in X month forgiveness review. Trigger TSXXBIDRFP letter. XX year plan'
	     WHEN OP.NovXXTotal >= XXX AND Arcs.HASFSAFM = X AND Arcs.HASIDRFG = X AND OP.ScheduleCode IN('IX','IP','CA','CP') THEN 'Borrower approved in full forgiveness review. Trigger TSXXBIDRFG letter. XX year plan'
		 WHEN OP.NovXXTotal >= XXX AND Arcs.HASFSAFM = X AND Arcs.HASIDRFG = X AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('XX','XX','XX','XX','XX','X','X','X','X') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'Borrower approved in full forgiveness review. Trigger TSXXBIDRFG letter. XX year plan'
		 WHEN OP.NovXXTotal BETWEEN XXX AND XXX AND Arcs.HASFSAXM = X AND Arcs.HASIDRFP = X AND OP.ScheduleCode IN('IX','IP','CA','CP') THEN 'Borrower approved in X month forgiveness review. Trigger TSXXBIDRFP letter. XX year plan'
		 WHEN OP.NovXXTotal BETWEEN XXX AND XXX AND Arcs.HASFSAXM = X AND Arcs.HASIDRFP = X AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('XX','XX','XX','XX','XX','X','X','X','X') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'Borrower approved in X month forgiveness review. Trigger TSXXBIDRFP letter. XX year plan'
		 WHEN OP.NovXXTotal >= XXX AND(ISNULL(HASIDFRF,X) = X OR (Arcs.HASIDFRF = X AND Arcs.HASIDFRT = X AND (Arcs.MaxIDFRFDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate)/*re-do full month review if IDFRT is newer, and more than XX days old*/)) AND OP.ScheduleCode IN('CX','CX','CX','IB','CQ','IL') THEN 'Borrower requires full eligibility forgiveness review. XX year plan'	
		 WHEN OP.NovXXTotal >= XXX AND(ISNULL(HASIDFRF,X) = X OR (Arcs.HASIDFRF = X AND Arcs.HASIDFRT = X AND (Arcs.MaxIDFRFDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate)/*re-do full month review if IDFRT is newer, and more than XX days old*/)) AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('A','B','C','D','X','X','X','X','X','XX','XX','XX','XX','XX','XX','XX','XX','XX','XX') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'Borrower requires full eligibility forgiveness review. XX year plan'	
		 WHEN OP.NovXXTotal BETWEEN XXX AND XXX AND(ISNULL(HASMXFRG,X) = X OR (Arcs.HASMXFRG = X AND Arcs.HASIDFRT = X AND (Arcs.MaxMXFRGDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate)/*re-do X month review if IDFRT is newer, and more than XX days old*/) OR (Arcs.HASMXFRG = X AND Arcs.HASFATXX = X AND Arcs.MaxMXFRGDate < Arcs.MaxFATXXDate)) AND OP.ScheduleCode IN('CX','CX','CX','IB','CQ','IL') THEN 'Borrower requires X month forgiveness review. XX year plan'
		 WHEN OP.NovXXTotal BETWEEN XXX AND XXX AND(ISNULL(HASMXFRG,X) = X OR (Arcs.HASMXFRG = X AND Arcs.HASIDFRT = X AND (Arcs.MaxMXFRGDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate)/*re-do X month review if IDFRT is newer, and more than XX days old*/) OR (Arcs.HASMXFRG = X AND Arcs.HASFATXX = X AND Arcs.MaxMXFRGDate < Arcs.MaxFATXXDate)) AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('A','B','C','D','X','X','X','X','X','XX','XX','XX','XX','XX','XX','XX','XX','XX','XX') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'Borrower requires X month forgiveness review. XX year plan'
		 WHEN OP.NovXXTotal >= XXX AND ISNULL(HASFATXX,X) = X AND(ISNULL(Arcs.HASIDFRF,X) = X OR (Arcs.HASIDFRF = X AND Arcs.HASIDFRT = X AND (Arcs.MaxIDFRFDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate)/*re-do full month review if IDFRT is newer, and more than XX days old*/)) AND OP.ScheduleCode IN('IX','IP','CA','CP') THEN 'Borrower requires full eligibility forgiveness review. XX year plan'
		 WHEN OP.NovXXTotal >= XXX AND ISNULL(HASFATXX,X) = X AND(ISNULL(Arcs.HASIDFRF,X) = X OR (Arcs.HASIDFRF = X AND Arcs.HASIDFRT = X AND (Arcs.MaxIDFRFDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate)/*re-do full month review if IDFRT is newer, and more than XX days old*/)) AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('XX','XX','XX','XX','XX','X','X','X','X') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'Borrower requires full eligibility forgiveness review. XX year plan'
		 WHEN OP.NovXXTotal BETWEEN XXX AND XXX AND ISNULL(HASFATXX,X) = X AND(ISNULL(Arcs.HASMXFRG,X) = X OR (Arcs.HASMXFRG = X AND Arcs.HASIDFRT = X AND (Arcs.MaxMXFRGDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate)/*re-do X month review if IDFRT is newer, and more than XX days old*/)) AND OP.ScheduleCode IN('IX','IP','CA','CP') THEN 'Borrower requires X month forgiveness review. XX year plan'

		 WHEN OP.MayXXTotal >= XXX AND Arcs.HASFSAFM = X AND Arcs.HASIDRFG = X AND OP.ScheduleCode IN('CX','CX','CX','IB','CQ','IL') THEN 'Borrower approved in full forgiveness review. Trigger TSXXBIDRFG letter. XX year plan'
		 WHEN OP.MayXXTotal >= XXX AND Arcs.HASFSAFM = X AND Arcs.HASIDRFG = X AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('A','B','C','D','X','X','X','X','X','XX','XX','XX','XX','XX','XX','XX','XX','XX','XX') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'Borrower approved in full forgiveness review. Trigger TSXXBIDRFG letter. XX year plan'
		 WHEN OP.MayXXTotal BETWEEN XXX AND XXX AND Arcs.HASFSAXM = X AND Arcs.HASIDRFP = X AND OP.ScheduleCode IN('CX','CX','CX','IB','CQ','IL') THEN 'Borrower approved in X month forgiveness review. Trigger TSXXBIDRFP letter. XX year plan'
		 WHEN OP.MayXXTotal BETWEEN XXX AND XXX AND Arcs.HASFSAXM = X AND Arcs.HASIDRFP = X AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('A','B','C','D','X','X','X','X','X','XX','XX','XX','XX','XX','XX','XX','XX','XX','XX') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'Borrower approved in X month forgiveness review. Trigger TSXXBIDRFP letter. XX year plan'
	     WHEN OP.MayXXTotal >= XXX AND Arcs.HASFSAFM = X AND Arcs.HASIDRFG = X AND OP.ScheduleCode IN('IX','IP','CA','CP') THEN 'Borrower approved in full forgiveness review. Trigger TSXXBIDRFG letter. XX year plan'
		 WHEN OP.MayXXTotal >= XXX AND Arcs.HASFSAFM = X AND Arcs.HASIDRFG = X AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('XX','XX','XX','XX','XX','X','X','X','X') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'Borrower approved in full forgiveness review. Trigger TSXXBIDRFG letter. XX year plan'
		 WHEN OP.MayXXTotal BETWEEN XXX AND XXX AND Arcs.HASFSAXM = X AND Arcs.HASIDRFP = X AND OP.ScheduleCode IN('IX','IP','CA','CP') THEN 'Borrower approved in X month forgiveness review. Trigger TSXXBIDRFP letter. XX year plan'
		 WHEN OP.MayXXTotal BETWEEN XXX AND XXX AND Arcs.HASFSAXM = X AND Arcs.HASIDRFP = X AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('XX','XX','XX','XX','XX','X','X','X','X') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'Borrower approved in X month forgiveness review. Trigger TSXXBIDRFP letter. XX year plan'
		 WHEN OP.MayXXTotal >= XXX AND(ISNULL(HASIDFRF,X) = X OR (Arcs.HASIDFRF = X AND Arcs.HASIDFRT = X AND (Arcs.MaxIDFRFDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate)/*re-do full month review if IDFRT is newer, and more than XX days old*/)) AND OP.ScheduleCode IN('CX','CX','CX','IB','CQ','IL') THEN 'Borrower requires full eligibility forgiveness review. XX year plan'	
		 WHEN OP.MayXXTotal >= XXX AND(ISNULL(HASIDFRF,X) = X OR (Arcs.HASIDFRF = X AND Arcs.HASIDFRT = X AND (Arcs.MaxIDFRFDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate)/*re-do full month review if IDFRT is newer, and more than XX days old*/)) AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('A','B','C','D','X','X','X','X','X','XX','XX','XX','XX','XX','XX','XX','XX','XX','XX') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'Borrower requires full eligibility forgiveness review. XX year plan'	
		 WHEN OP.MayXXTotal BETWEEN XXX AND XXX AND(ISNULL(HASMXFRG,X) = X OR (Arcs.HASMXFRG = X AND Arcs.HASIDFRT = X AND (Arcs.MaxMXFRGDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate)/*re-do X month review if IDFRT is newer, and more than XX days old*/) OR (Arcs.HASMXFRG = X AND Arcs.HASFATXX = X AND Arcs.MaxMXFRGDate < Arcs.MaxFATXXDate)) AND OP.ScheduleCode IN('CX','CX','CX','IB','CQ','IL') THEN 'Borrower requires X month forgiveness review. XX year plan'
		 WHEN OP.MayXXTotal BETWEEN XXX AND XXX AND(ISNULL(HASMXFRG,X) = X OR (Arcs.HASMXFRG = X AND Arcs.HASIDFRT = X AND (Arcs.MaxMXFRGDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate)/*re-do X month review if IDFRT is newer, and more than XX days old*/) OR (Arcs.HASMXFRG = X AND Arcs.HASFATXX = X AND Arcs.MaxMXFRGDate < Arcs.MaxFATXXDate)) AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('A','B','C','D','X','X','X','X','X','XX','XX','XX','XX','XX','XX','XX','XX','XX','XX') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'Borrower requires X month forgiveness review. XX year plan'
		 WHEN OP.MayXXTotal >= XXX AND ISNULL(HASFATXX,X) = X AND(ISNULL(Arcs.HASIDFRF,X) = X OR (Arcs.HASIDFRF = X AND Arcs.HASIDFRT = X AND (Arcs.MaxIDFRFDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate)/*re-do full month review if IDFRT is newer, and more than XX days old*/)) AND OP.ScheduleCode IN('IX','IP','CA','CP') THEN 'Borrower requires full eligibility forgiveness review. XX year plan'
		 WHEN OP.MayXXTotal >= XXX AND ISNULL(HASFATXX,X) = X AND(ISNULL(Arcs.HASIDFRF,X) = X OR (Arcs.HASIDFRF = X AND Arcs.HASIDFRT = X AND (Arcs.MaxIDFRFDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate)/*re-do full month review if IDFRT is newer, and more than XX days old*/)) AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('XX','XX','XX','XX','XX','X','X','X','X') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'Borrower requires full eligibility forgiveness review. XX year plan'
		 WHEN OP.MayXXTotal BETWEEN XXX AND XXX AND ISNULL(HASFATXX,X) = X AND(ISNULL(Arcs.HASMXFRG,X) = X OR (Arcs.HASMXFRG = X AND Arcs.HASIDFRT = X AND (Arcs.MaxMXFRGDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate)/*re-do X month review if IDFRT is newer, and more than XX days old*/)) AND OP.ScheduleCode IN('IX','IP','CA','CP') THEN 'Borrower requires X month forgiveness review. XX year plan'

		 WHEN OP.NovXXTotal >= XXX AND Arcs.HASFSAFM = X AND Arcs.HASIDRFG = X AND OP.ScheduleCode IN('CX','CX','CX','IB','CQ','IL') THEN 'Borrower approved in full forgiveness review. Trigger TSXXBIDRFG letter. XX year plan'
		 WHEN OP.NovXXTotal >= XXX AND Arcs.HASFSAFM = X AND Arcs.HASIDRFG = X AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('A','B','C','D','X','X','X','X','X','XX','XX','XX','XX','XX','XX','XX','XX','XX','XX') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'Borrower approved in full forgiveness review. Trigger TSXXBIDRFG letter. XX year plan'
		 WHEN OP.NovXXTotal BETWEEN XXX AND XXX AND Arcs.HASFSAXM = X AND Arcs.HASIDRFP = X AND OP.ScheduleCode IN('CX','CX','CX','IB','CQ','IL') THEN 'Borrower approved in X month forgiveness review. Trigger TSXXBIDRFP letter. XX year plan'
		 WHEN OP.NovXXTotal BETWEEN XXX AND XXX AND Arcs.HASFSAXM = X AND Arcs.HASIDRFP = X AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('A','B','C','D','X','X','X','X','X','XX','XX','XX','XX','XX','XX','XX','XX','XX','XX') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'Borrower approved in X month forgiveness review. Trigger TSXXBIDRFP letter. XX year plan'
	     WHEN OP.NovXXTotal >= XXX AND Arcs.HASFSAFM = X AND Arcs.HASIDRFG = X AND OP.ScheduleCode IN('IX','IP','CA','CP') THEN 'Borrower approved in full forgiveness review. Trigger TSXXBIDRFG letter. XX year plan'
		 WHEN OP.NovXXTotal >= XXX AND Arcs.HASFSAFM = X AND Arcs.HASIDRFG = X AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('XX','XX','XX','XX','XX','X','X','X','X') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'Borrower approved in full forgiveness review. Trigger TSXXBIDRFG letter. XX year plan'
		 WHEN OP.NovXXTotal BETWEEN XXX AND XXX AND Arcs.HASFSAXM = X AND Arcs.HASIDRFP = X AND OP.ScheduleCode IN('IX','IP','CA','CP') THEN 'Borrower approved in X month forgiveness review. Trigger TSXXBIDRFP letter. XX year plan'
		 WHEN OP.NovXXTotal BETWEEN XXX AND XXX AND Arcs.HASFSAXM = X AND Arcs.HASIDRFP = X AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('XX','XX','XX','XX','XX','X','X','X','X') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'Borrower approved in X month forgiveness review. Trigger TSXXBIDRFP letter. XX year plan'
		 WHEN OP.NovXXTotal >= XXX AND(ISNULL(HASIDFRF,X) = X OR (Arcs.HASIDFRF = X AND Arcs.HASIDFRT = X AND (Arcs.MaxIDFRFDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate)/*re-do full month review if IDFRT is newer, and more than XX days old*/)) AND OP.ScheduleCode IN('CX','CX','CX','IB','CQ','IL') THEN 'Borrower requires full eligibility forgiveness review. XX year plan'	
		 WHEN OP.NovXXTotal >= XXX AND(ISNULL(HASIDFRF,X) = X OR (Arcs.HASIDFRF = X AND Arcs.HASIDFRT = X AND (Arcs.MaxIDFRFDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate)/*re-do full month review if IDFRT is newer, and more than XX days old*/)) AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('A','B','C','D','X','X','X','X','X','XX','XX','XX','XX','XX','XX','XX','XX','XX','XX') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'Borrower requires full eligibility forgiveness review. XX year plan'	
		 WHEN OP.NovXXTotal BETWEEN XXX AND XXX AND(ISNULL(HASMXFRG,X) = X OR (Arcs.HASMXFRG = X AND Arcs.HASIDFRT = X AND (Arcs.MaxMXFRGDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate)/*re-do X month review if IDFRT is newer, and more than XX days old*/) OR (Arcs.HASMXFRG = X AND Arcs.HASFATXX = X AND Arcs.MaxMXFRGDate < Arcs.MaxFATXXDate)) AND OP.ScheduleCode IN('CX','CX','CX','IB','CQ','IL') THEN 'Borrower requires X month forgiveness review. XX year plan'
		 WHEN OP.NovXXTotal BETWEEN XXX AND XXX AND(ISNULL(HASMXFRG,X) = X OR (Arcs.HASMXFRG = X AND Arcs.HASIDFRT = X AND (Arcs.MaxMXFRGDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate)/*re-do X month review if IDFRT is newer, and more than XX days old*/) OR (Arcs.HASMXFRG = X AND Arcs.HASFATXX = X AND Arcs.MaxMXFRGDate < Arcs.MaxFATXXDate)) AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('A','B','C','D','X','X','X','X','X','XX','XX','XX','XX','XX','XX','XX','XX','XX','XX') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'Borrower requires X month forgiveness review. XX year plan'
		 WHEN OP.NovXXTotal >= XXX AND ISNULL(HASFATXX,X) = X AND(ISNULL(Arcs.HASIDFRF,X) = X OR (Arcs.HASIDFRF = X AND Arcs.HASIDFRT = X AND (Arcs.MaxIDFRFDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate)/*re-do full month review if IDFRT is newer, and more than XX days old*/)) AND OP.ScheduleCode IN('IX','IP','CA','CP') THEN 'Borrower requires full eligibility forgiveness review. XX year plan'
		 WHEN OP.NovXXTotal >= XXX AND ISNULL(HASFATXX,X) = X AND(ISNULL(Arcs.HASIDFRF,X) = X OR (Arcs.HASIDFRF = X AND Arcs.HASIDFRT = X AND (Arcs.MaxIDFRFDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate)/*re-do full month review if IDFRT is newer, and more than XX days old*/)) AND OP.ScheduleCode IN('IX','IA') AND (LNXX.LC_ACA_GDE_LEV IN('XX','XX','XX','XX','XX','X','X','X','X') OR LNXX.IC_LON_PGM IN('CNSLDN','DLCNSL','DLPCNS','DLSCCN','DLSCNS','DLSCPG','DLSCPL','DLSCSC','DLSCSL','DLSCST','DLSCUC','DLSCUN','DLSPCN','DLSSPL','DLUCNS','DLUSPL','DSCON','DUCON','SUBCNS','SUBSPC','UNSPC','UNCNS')) THEN 'Borrower requires full eligibility forgiveness review. XX year plan'
		 WHEN OP.NovXXTotal BETWEEN XXX AND XXX AND ISNULL(HASFATXX,X) = X AND(ISNULL(Arcs.HASMXFRG,X) = X OR (Arcs.HASMXFRG = X AND Arcs.HASIDFRT = X AND (Arcs.MaxMXFRGDate < Arcs.MaxIDFRTDate AND GETDATE() - XX > Arcs.MaxIDFRTDate)/*re-do X month review if IDFRT is newer, and more than XX days old*/)) AND OP.ScheduleCode IN('IX','IP','CA','CP') THEN 'Borrower requires X month forgiveness review. XX year plan'
>>>>>>> fcXXcdeeeXXfaXXXXXXXXXXXXXXXeXXXXXdccXbc

	     ELSE 'You broke it'
	END [Comment],
	X [IsReference],
	X [IsEndorser],
	OP.Total,
<<<<<<< HEAD
	OP.AprXXTotal,
	OP.OctXXTotal,
	OP.AprXXTotal
=======
	OP.NovXXTotal,
	OP.MayXXTotal,
	OP.NovXXTotal
>>>>>>> fcXXcdeeeXXfaXXXXXXXXXXXXXXXeXXXXXdccXbc
INTO
	#ForgivenessArcPopulation
FROM
	@OverallPlan OP
	INNER JOIN CDW..PDXX_PRS_NME PDXX
		ON PDXX.DF_PRS_ID = OP.BF_SSN
	INNER JOIN CDW..LNXX_LON LNXX 
		ON LNXX.BF_SSN = OP.BF_SSN
		AND LNXX.LN_SEQ = OP.LN_SEQ
	INNER JOIN CDW..LNXX_LON_RPS LNXX 
		ON LNXX.BF_SSN = LNXX.BF_SSN 
		AND LNXX.LN_SEQ = LNXX.LN_SEQ
		AND	LNXX.LC_STA_LONXX = 'A' -- active
		AND	LNXX.LC_TYP_SCH_DIS IN ('CA','CP', 'CX', 'CX', 'CX', 'CQ', 'IB', 'IL', 'IX', 'IP', 'IX')--removed IA because they cant get forgiveness until moving back to IX
	LEFT JOIN CDW..WQXX_TSK_QUE WQXX
		ON WQXX.BF_SSN = LNXX.BF_SSN
		AND WQXX.WF_QUE = 'BO'
		AND WQXX.WC_STA_WQUEXX NOT IN('X','C') --Has an open queue
	LEFT JOIN
	( 
		SELECT DISTINCT
			AYXX.BF_SSN,
			LNXX.LN_SEQ,
			SUM(CASE WHEN ArcExists.BF_SSN IS NOT NULL AND AYXX.PF_REQ_ACT = 'FATXX' THEN X ELSE X END) OVER (PARTITION BY AYXX.BF_SSN, LNXX.LN_SEQ) AS HASFATXX,
			SUM(CASE WHEN ArcExists.BF_SSN IS NOT NULL AND AYXX.PF_REQ_ACT = 'FSAXM' THEN X ELSE X END) OVER (PARTITION BY AYXX.BF_SSN, LNXX.LN_SEQ) AS HASFSAXM,
			SUM(CASE WHEN ArcExists.BF_SSN IS NOT NULL AND AYXX.PF_REQ_ACT = 'FSAFM' THEN X ELSE X END) OVER (PARTITION BY AYXX.BF_SSN, LNXX.LN_SEQ) AS HASFSAFM,
			SUM(CASE WHEN ArcExists.BF_SSN IS NOT NULL AND AYXX.PF_REQ_ACT = 'IDFRT' THEN X ELSE X END) OVER (PARTITION BY AYXX.BF_SSN, LNXX.LN_SEQ) AS HASIDFRT,
<<<<<<< HEAD
			SUM(CASE WHEN ArcExists.BF_SSN IS NOT NULL AND AYXX.PF_REQ_ACT = 'IDFRF' THEN X ELSE X END) OVER (PARTITION BY AYXX.BF_SSN, LNXX.LN_SEQ) AS HASIDFRF,
			SUM(CASE WHEN ArcExists.BF_SSN IS NOT NULL AND AYXX.PF_REQ_ACT = 'IDRFG' THEN X ELSE X END) OVER (PARTITION BY AYXX.BF_SSN, LNXX.LN_SEQ) AS HASIDRFG,
			SUM(CASE WHEN ArcExists.BF_SSN IS NOT NULL AND AYXX.PF_REQ_ACT = 'IDRFP' THEN X ELSE X END) OVER (PARTITION BY AYXX.BF_SSN, LNXX.LN_SEQ) AS HASIDRFP,
=======
			SUM(CASE WHEN ArcExists.BF_SSN IS NOT NULL AND AYXX.PF_REQ_ACT = 'MXFRG' THEN X ELSE X END) OVER (PARTITION BY AYXX.BF_SSN, LNXX.LN_SEQ) AS HASMXFRG,
			SUM(CASE WHEN ArcExists.BF_SSN IS NOT NULL AND AYXX.PF_REQ_ACT = 'IDFRF' THEN X ELSE X END) OVER (PARTITION BY AYXX.BF_SSN, LNXX.LN_SEQ) AS HASIDFRF,
			SUM(CASE WHEN ArcExists.BF_SSN IS NOT NULL AND AYXX.PF_REQ_ACT = 'IDRFG' THEN X ELSE X END) OVER (PARTITION BY AYXX.BF_SSN, LNXX.LN_SEQ) AS HASIDRFG,
			SUM(CASE WHEN ArcExists.BF_SSN IS NOT NULL AND AYXX.PF_REQ_ACT = 'IDRFP' THEN X ELSE X END) OVER (PARTITION BY AYXX.BF_SSN, LNXX.LN_SEQ) AS HASIDRFP,
			MAX(CASE WHEN ArcExists.BF_SSN IS NOT NULL AND AYXX.PF_REQ_ACT = 'MXFRG' THEN ArcExists.LD_ATY_REQ_RCV ELSE NULL END) OVER (PARTITION BY AYXX.BF_SSN, LNXX.LN_SEQ) AS MaxMXFRGDate,
>>>>>>> fcXXcdeeeXXfaXXXXXXXXXXXXXXXeXXXXXdccXbc
			MAX(CASE WHEN ArcExists.BF_SSN IS NOT NULL AND AYXX.PF_REQ_ACT = 'IDFRF' THEN ArcExists.LD_ATY_REQ_RCV ELSE NULL END) OVER (PARTITION BY AYXX.BF_SSN, LNXX.LN_SEQ) AS MaxIDFRFDate,
			MAX(CASE WHEN ArcExists.BF_SSN IS NOT NULL AND AYXX.PF_REQ_ACT = 'IDFRT' THEN ArcExists.LD_ATY_REQ_RCV ELSE NULL END) OVER (PARTITION BY AYXX.BF_SSN, LNXX.LN_SEQ) AS MaxIDFRTDate,
			MAX(CASE WHEN ArcExists.BF_SSN IS NOT NULL AND AYXX.PF_REQ_ACT = 'FATXX' THEN ArcExists.LD_ATY_REQ_RCV ELSE NULL END) OVER (PARTITION BY AYXX.BF_SSN, LNXX.LN_SEQ) AS MaxFATXXDate
		FROM
			CDW..AYXX_BR_LON_ATY AYXX
			INNER JOIN CDW..LNXX_LON_ATY LNXX
				ON LNXX.BF_SSN = AYXX.BF_SSN
				AND LNXX.LN_ATY_SEQ = AYXX.LN_ATY_SEQ
			LEFT JOIN
			(
				SELECT
					AYXX.BF_SSN,
					LNXX.LN_SEQ,
					AYXX.LN_ATY_SEQ,
					AYXX.PF_REQ_ACT,
					MAX(CAST(AYXX.LD_ATY_REQ_RCV AS DATE)) OVER(PARTITION BY AYXX.BF_SSN, LNXX.LN_SEQ, AYXX.PF_REQ_ACT) AS LD_ATY_REQ_RCV
				FROM
					CDW..AYXX_BR_LON_ATY AYXX
					INNER JOIN CDW..LNXX_LON_ATY LNXX 
						ON LNXX.BF_SSN = AYXX.BF_SSN 
						AND LNXX.LN_ATY_SEQ = AYXX.LN_ATY_SEQ
				WHERE
<<<<<<< HEAD
					AYXX.PF_REQ_ACT IN('IDFRT','FATXX','FSAXM','FSAFM','IDFRF','IDRFG','IDRFP')
=======
					AYXX.PF_REQ_ACT IN('IDFRT','FATXX','FSAXM','FSAFM','MXFRG','IDFRF','IDRFG','IDRFP')
>>>>>>> fcXXcdeeeXXfaXXXXXXXXXXXXXXXeXXXXXdccXbc
					AND AYXX.LC_STA_ACTYXX = 'A'
			) ArcExists
				ON ArcExists.BF_SSN = AYXX.BF_SSN
				AND ArcExists.LN_SEQ = LNXX.LN_SEQ
				AND ArcExists.LN_ATY_SEQ = AYXX.LN_ATY_SEQ
				AND ArcExists.PF_REQ_ACT = AYXX.PF_REQ_ACT
		WHERE
<<<<<<< HEAD
			AYXX.PF_REQ_ACT IN ('IDFRT','FATXX','FSAXM','FSAFM','IDFRF','IDRFG','IDRFP')
=======
			AYXX.PF_REQ_ACT IN ('IDFRT','FATXX','FSAXM','FSAFM','MXFRG','IDFRF','IDRFG','IDRFP')
>>>>>>> fcXXcdeeeXXfaXXXXXXXXXXXXXXXeXXXXXdccXbc
	) Arcs 
		ON Arcs.BF_SSN = LNXX.BF_SSN 
		AND Arcs.LN_SEQ = LNXX.LN_SEQ
	LEFT JOIN 
	( -- prevent duplicate inserts
		SELECT
			AccountNumber,
			ALSS.LoanSequence,
			AAP.ARC
		FROM
			CLS..ArcAddProcessing AAP 
			INNER JOIN CLS..ArcLoanSequenceSelection ALSS
				ON ALSS.ArcAddProcessingId = AAP.ArcAddProcessingId 
		WHERE
			AAP.ScriptId = 'IDRFRGVNS'
			AND	AAP.ArcTypeId = X --by loan type
			AND	CAST(AAP.CreatedAt AS DATE) <= CAST(GETDATE() AS DATE)
			AND AAP.ProcessedAt IS NULL
			AND
			(
				(
<<<<<<< HEAD
=======
					AAP.Comment IN('Borrower requires X month forgiveness review. XX year plan','Borrower requires X month forgiveness review. XX year plan')
					AND AAP.ARC = 'MXFRG'
				)
				OR
				(
>>>>>>> fcXXcdeeeXXfaXXXXXXXXXXXXXXXeXXXXXdccXbc
					AAP.Comment IN('Borrower approved in X month forgiveness review. Trigger TSXXBIDRFP letter. XX year plan','Borrower approved in X month forgiveness review. Trigger TSXXBIDRFP letter. XX year plan')
					AND AAP.ARC = 'IDRFP'
				)
				OR
				(
					AAP.Comment IN('Borrower requires full eligibility forgiveness review. XX year plan','Borrower requires full eligibility forgiveness review. XX year plan')
					AND AAP.ARC = 'IDFRF'
				)
				OR
				(
					AAP.Comment IN('Borrower approved in full forgiveness review. Trigger TSXXBIDRFG letter. XX year plan','Borrower approved in full forgiveness review. Trigger TSXXBIDRFG letter. XX year plan')
					AND AAP.ARC = 'IDRFG'
				)
			)			
	) AAP
		ON AAP.AccountNumber = PDXX.DF_SPE_ACC_ID
		AND AAP.LoanSequence = LNXX.LN_SEQ
WHERE
	LNXX.LA_CUR_PRI > X.XX
	AND OP.CurrentActiveSchedule IS NOT NULL -- dont drop arcs on non active people
	AND	AAP.LoanSequence IS NULL -- prevent duplicate inserts in the event the script is run multiple times before a warehouse refresh completes
	AND WQXX.BF_SSN IS NULL -- No open BO queue
	AND OP.Projection + ' - ' + LNXX.LC_TYP_SCH_DIS = OP.CurrentActiveSchedule

SELECT DISTINCT
	AD.ArcTypeId,
	AD.AccountNumber,
	AD.ARC,
	AD.ScriptId,
	AD.ProcessOn,
	AD.Comment,
	AD.IsReference,
	AD.IsEndorser,
	AD.Total,
<<<<<<< HEAD
	AD.AprXXTotal,
	AD.OctXXTotal,
	AD.AprXXTotal
=======
	AD.NovXXTotal,
	AD.MayXXTotal,
	AD.NovXXTotal
>>>>>>> fcXXcdeeeXXfaXXXXXXXXXXXXXXXeXXXXXdccXbc
FROM
	#ForgivenessArcPopulation AD
WHERE
	AD.ARC != 'You broke it'
	AND AD.Comment != 'You broke it'
