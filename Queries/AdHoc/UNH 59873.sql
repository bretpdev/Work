USE UDW
GO
SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
SELECT DISTINCT
	PD10.DF_SPE_ACC_ID,
	AY10.LD_ATY_REQ_RCV AS DateOfActivity,
	AY10.PF_REQ_ACT AS ARC
FROM
	UDW..PD10_PRS_NME PD10
	INNER JOIN UDW..LN10_LON LN10
		ON LN10.BF_SSN = PD10.DF_PRS_ID
	INNER JOIN UDW..AY10_BR_LON_ATY AY10
		ON AY10.BF_SSN = LN10.BF_SSN
		AND AY10.LC_STA_ACTY10 = 'A'
	INNER JOIN UDW..AY20_ATY_TXT AY20
		ON AY10.BF_SSN = AY20.BF_SSN
		AND AY10.LN_ATY_SEQ = AY20.LN_ATY_SEQ
		AND 
		(
			AY20.LX_ATY LIKE '%forgiveness%'
			OR AY20.LX_ATY LIKE '%military%'
			OR AY20.LX_ATY LIKE '%teach%'
			OR AY20.LX_ATY LIKE '%benefit%'
			OR AY20.LX_ATY LIKE '%pslf%'
			OR AY20.LX_ATY LIKE '%public service%'
		)
WHERE
	LN10.IC_LON_PGM != 'TILP'
