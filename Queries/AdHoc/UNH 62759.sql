--*********************LN65_Delete Tab***************************

DECLARE @LN65_Delete AS TABLE (BF_SSN varchar(9), LN_SEQ int, LN_RPS_SEQ int);

INSERT INTO @LN65_Delete (BF_SSN,LN_SEQ,LN_RPS_SEQ)
VALUES
	('032584581',2,8),
	('062744744',1,17),
	('062744744',2,17),
	('062744744',3,17),
	('062744744',4,17),
	('064480348',1,8),
	('064480348',2,8),
	('073640588',1,9),
	('073640588',2,9),
	('081489029',1,9),
	('084722149',1,8),
	('084722149',2,8),
	('084722149',3,8),
	('134668887',1,6),
	('195682542',1,8),
	('195682542',2,8),
	('326725437',5,11),
	('326725437',6,11),
	('395966203',1,7),
	('395966203',2,7),
	('403119763',1,11),
	('431253458',1,6),
	('431253458',2,6),
	('431253458',3,6),
	('431253458',4,6),
	('446644972',1,11),
	('446644972',2,11),
	('446644972',3,11),
	('450413082',1,9),
	('450413082',2,9),
	('458292724',1,5),
	('459733953',1,7),
	('465170895',5,22),
	('465170895',6,22),
	('474111663',1,7),
	('474111663',2,7),
	('482311983',1,12),
	('482311983',2,12),
	('488061963',1,8),
	('488061963',2,8),
	('488907593',1,6),
	('493024084',1,6),
	('500025085',1,5),
	('502689214',1,15),
	('502689214',2,15),
	('502689214',3,15),
	('505066827',3,17),
	('505066827',4,17),
	('517527030',2,11),
	('518153411',1,12),
	('518153411',2,12),
	('519027937',4,15),
	('519027937',5,15),
	('523742535',12,23),
	('523742535',13,23),
	('525192945',4,11),
	('528257756',1,25),
	('528257756',2,25),
	('528257756',3,25),
	('528257756',4,25),
	('528257756',5,25),
	('528257756',6,25),
	('528258703',9,12),
	('528258703',10,12),
	('528412000',5,26),
	('528412000',6,26),
	('528412000',7,26),
	('528435349',6,11),
	('528435349',7,11),
	('528511263',11,22),
	('528511263',12,22),
	('528511263',13,22),
	('528511263',14,22),
	('528511263',15,22),
	('528570409',1,14),
	('528570409',3,14),
	('528570409',4,14),
	('528576323',5,18),
	('528576323',6,19),
	('528586015',1,35),
	('528586015',2,35),
	('528586015',3,35),
	('528691462',1,11),
	('528691462',2,11),
	('528752318',8,20),
	('528752318',9,20),
	('528793305',6,11),
	('528793305',7,11),
	('528796224',7,12),
	('528796224',8,12),
	('528796224',9,12),
	('529043631',9,16),
	('529043631',10,16),
	('529111323',11,19),
	('529111323',12,19),
	('529455578',6,27),
	('529492280',1,7),
	('529492280',2,7),
	('529492280',3,7),
	('529651622',1,20),
	('529651622',2,20),
	('529675297',1,16),
	('529675297',2,16),
	('529675297',3,16),
	('529675297',4,16),
	('529675297',5,16),
	('529739689',1,24),
	('529739689',2,24),
	('529775588',6,32),
	('529777638',7,16),
	('529832311',13,15),
	('529832311',14,15),
	('529832311',15,15),
	('529832311',16,15),
	('529855949',1,10),
	('529892550',1,8),
	('529892550',2,8),
	('529892550',3,8),
	('537944093',1,25),
	('537944093',2,25),
	('537944093',3,25),
	('537944093',4,25),
	('537944093',5,25),
	('537944093',6,25),
	('537944093',7,25),
	('537944093',8,25),
	('537944093',9,25),
	('537944093',10,25),
	('537944093',11,25),
	('546239879',1,6),
	('547852674',1,12),
	('547852674',2,12),
	('547987099',1,11),
	('547987099',2,11),
	('547987099',3,11),
	('547987099',4,11),
	('547987099',5,11),
	('547987099',6,11),
	('550816833',1,8),
	('550816833',4,8),
	('550816833',2,9),
	('550816833',3,9),
	('550816833',5,9),
	('550816833',6,9),
	('559552668',1,7),
	('559552668',2,7),
	('566416380',1,9),
	('566416380',2,9),
	('566416380',3,9),
	('572577627',1,6),
	('572577627',2,6),
	('572577627',3,6),
	('573271085',1,14),
	('573271085',2,14),
	('573271085',3,14),
	('573271085',4,14),
	('573920010',1,7),
	('573920010',2,7),
	('576215427',4,12),
	('580076477',1,8),
	('581411225',1,8),
	('581411225',2,8),
	('591952063',1,7),
	('591952063',2,7),
	('592322985',1,20),
	('600267831',2,18),
	('600267831',3,18),
	('600267831',4,18),
	('604503268',1,11),
	('604503268',2,11),
	('604503268',3,11),
	('604503268',4,11),
	('605220121',10,21),
	('610389801',1,11),
	('615076455',1,13),
	('615076455',2,13),
	('617462129',1,12),
	('623057795',5,11),
	('626051088',1,7),
	('626051088',2,7),
	('626189379',5,11),
	('626189379',6,11),
	('627145276',1,5),
	('627269004',1,7),
	('637201728',1,8),
	('637201728',2,8),
	('647091138',13,13),
	('647091138',14,13),
	('647091138',15,13),
	('647091138',16,13)


-- should return 190 to verify all loans from the spreadsheet are included
SELECT COUNT(*)  
FROM
	@LN65_Delete LN65
	INNER JOIN UDW..LN10_LON LN10
		ON LN65.BF_SSN = LN10.BF_SSN
		AND LN65.LN_SEQ = LN10.LN_SEQ

--LN66 dump for [LN65 Delete] tab
SELECT
	'LN65 Delete' AS TAB,
	'LN66' AS TBL,
	LN65.BF_SSN AS XL_BF_SSN,
	LN65.LN_SEQ AS XL_LN_SEQ,
	LN65.LN_RPS_SEQ AS XL_LN_RPS_SEQ,
	LN66.*
FROM
	@LN65_Delete LN65
	LEFT JOIN UDW..LN66_LON_RPS_SPF LN66
		ON LN65. BF_SSN = LN66.BF_SSN
		AND LN65.LN_SEQ = LN66.LN_SEQ
		and ln65.LN_RPS_SEQ = LN66.LN_RPS_SEQ
ORDER BY
	LN65.BF_SSN,
	LN65.LN_SEQ

--RS10 dump for [LN65 Delete] tab
SELECT
	'LN65 Delete' AS TAB,
	'RS10' AS TBL,
	LN65.BF_SSN AS XL_BF_SSN,
	LN65.LN_SEQ AS XL_LN_SEQ,
	LN65.LN_RPS_SEQ AS XL_LN_RPS_SEQ,
	RS10.*
FROM
	@LN65_Delete LN65
	LEFT JOIN UDW..RS10_BR_RPD RS10
		ON LN65.BF_SSN = RS10.BF_SSN
		AND LN65.LN_RPS_SEQ = RS10.LN_RPS_SEQ

--LN10 dump for [LN65 Delete] tab
SELECT
	'LN65 Delete' AS TAB,
	'LN10' AS TBL,
	LN65.BF_SSN AS XL_BF_SSN,
	LN65.LN_SEQ AS XL_LN_SEQ,
	LN65.LN_RPS_SEQ AS XL_LN_RPS_SEQ,
	LN10.*
FROM
	@LN65_Delete LN65
	LEFT JOIN UDW..LN10_LON LN10
		ON LN65.BF_SSN = LN10.BF_SSN
		AND LN65.LN_SEQ = LN10.LN_SEQ



--*********************LN65_Update Tab***************************

DECLARE @LN65_Update AS TABLE (BF_SSN varchar(9), LN_SEQ int, LN_RPS_SEQ int);

INSERT INTO @LN65_Update (BF_SSN,LN_SEQ,LN_RPS_SEQ)
VALUES
('100586018',1,6),
('100586018',2,6),
('101646446',1,6),
('101646446',2,6),
('117783506',1,5),
('250810815',1,7),
('296648126',9,11),
('296648126',10,11),
('335446479',7,16),
('335446479',8,16),
('369044486',9,19),
('369044486',10,19),
('385704532',1,7),
('385704532',2,7),
('385704532',3,7),
('427216569',1,6),
('427216569',2,6),
('430049538',1,6),
('430049538',2,6),
('504081426',2,10),
('518198241',1,4),
('520643823',1,4),
('520767234',1,7),
('522375812',1,7),
('522375812',2,7),
('527991594',1,6),
('527991594',2,6),
('527991594',3,6),
('527991594',4,6),
('527991594',5,6),
('527991594',6,6),
('527991594',7,6),
('527991594',8,6),
('528083310',7,4),
('528379123',1,13),
('528379123',2,13),
('528913664',1,9),
('529158395',14,11),
('529158395',15,11),
('529696045',8,23),
('529696045',9,23),
('529811847',4,13),
('529811847',5,13),
('529894329',1,12),
('529894329',2,12),
('529894329',3,12),
('535192641',3,19),
('535192641',4,19),
('535192641',5,19),
('540116694',1,8),
('564635515',9,5),
('564635515',10,5),
('569950243',1,9),
('569950243',2,9),
('569950243',3,9),
('569950243',4,9),
('574687327',1,6),
('574687327',2,6),
('592804721',9,11),
('592804721',10,11),
('592804721',11,11),
('592804721',12,11),
('595641600',1,4),
('595641600',2,4),
('595642840',1,9),
('595642840',2,10),
('595642840',3,10),
('595642840',4,10),
('601942868',1,9),
('601942868',2,9),
('620097794',1,5),
('628282786',1,4),
('641055927',1,8),
('641055927',2,9),
('641055927',3,9),
('647261521',5,20),
('647261521',6,20)


-- should return 77 to verify all loans from the spreadsheet are included
SELECT COUNT(*)  
FROM
	@LN65_Update LN65
	INNER JOIN UDW..LN10_LON LN10
		ON LN65.BF_SSN = LN10.BF_SSN
		AND LN65.LN_SEQ = LN10.LN_SEQ

--LN66 dump for [LN65 Update] tab
SELECT
	'LN65 Update' AS TAB,
	'LN66' AS TBL,
	LN65.BF_SSN AS XL_BF_SSN,
	LN65.LN_SEQ AS XL_LN_SEQ,
	LN65.LN_RPS_SEQ AS XL_LN_RPS_SEQ,
	LN66.*
FROM
	@LN65_Update LN65
	LEFT JOIN UDW..LN66_LON_RPS_SPF LN66
		ON LN65. BF_SSN = LN66.BF_SSN
		AND LN65.LN_SEQ = LN66.LN_SEQ
		and ln65.LN_RPS_SEQ = LN66.LN_RPS_SEQ
ORDER BY
	LN65.BF_SSN,
	LN65.LN_SEQ

--RS10 dump for [LN65 Update] tab
SELECT
	'LN65 Update' AS TAB,
	'RS10' AS TBL,
	LN65.BF_SSN AS XL_BF_SSN,
	LN65.LN_SEQ AS XL_LN_SEQ,
	LN65.LN_RPS_SEQ AS XL_LN_RPS_SEQ,
	RS10.*
FROM
	@LN65_Update LN65
	LEFT JOIN UDW..RS10_BR_RPD RS10
		ON LN65.BF_SSN = RS10.BF_SSN
		AND LN65.LN_RPS_SEQ = RS10.LN_RPS_SEQ

--LN10 dump for [LN65 Update] tab
SELECT
	'LN65 Update' AS TAB,
	'LN10' AS TBL,
	LN65.BF_SSN AS XL_BF_SSN,
	LN65.LN_SEQ AS XL_LN_SEQ,
	LN65.LN_RPS_SEQ AS XL_LN_RPS_SEQ,
	LN10.*
FROM
	@LN65_Update LN65
	LEFT JOIN UDW..LN10_LON LN10
		ON LN65.BF_SSN = LN10.BF_SSN
		AND LN65.LN_SEQ = LN10.LN_SEQ

