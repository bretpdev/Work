/*Requesting a query of all CAM tasks completed between 1/1/2021 and present.

List of CAM task queues:
24-01
30-02 through 29,
32-02 through 29
3A-02 through -29
3B-02 through 29
3I-02 through 29
3K-02 through 29
3L-02 through 29
3W-02 through 29
3X-02 through 29
3Z-02 through 29

Requested output: account number, date completed, type of task. Requested by COB 3/8/2021.*/
SELECT
	PD10.DF_SPE_ACC_ID,
	WQ20.WD_ACT_REQ,
	WQ20.WF_QUE,
	WQ20.WF_SUB_QUE,
	WQ20.WC_STA_WQUE20,
	CAST(WQ20.WF_LST_DTS_WQ20 AS DATE) AS CompleteDate
FROM
	UDW..WQ20_TSK_QUE WQ20
	INNER JOIN UDW..PD10_PRS_NME PD10
		ON PD10.DF_PRS_ID = WQ20.BF_SSN
WHERE
	CAST(WQ20.WF_LST_DTS_WQ20 AS DATE) >= '2021-01-01'
	AND
	(
	(WQ20.WF_QUE = '24' AND WQ20.WF_SUB_QUE = '01')
	OR (WQ20.WF_QUE = '30' AND WQ20.WF_SUB_QUE IN('02','03','04','05','06','07','08','09','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29'))
	OR (WQ20.WF_QUE = '32' AND WQ20.WF_SUB_QUE IN('02','03','04','05','06','07','08','09','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29'))
	OR (WQ20.WF_QUE = '3A' AND WQ20.WF_SUB_QUE IN('02','03','04','05','06','07','08','09','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29'))
	OR (WQ20.WF_QUE = '3B' AND WQ20.WF_SUB_QUE IN('02','03','04','05','06','07','08','09','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29'))
	OR (WQ20.WF_QUE = '3I' AND WQ20.WF_SUB_QUE IN('02','03','04','05','06','07','08','09','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29'))
	OR (WQ20.WF_QUE = '3K' AND WQ20.WF_SUB_QUE IN('02','03','04','05','06','07','08','09','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29'))
	OR (WQ20.WF_QUE = '3L' AND WQ20.WF_SUB_QUE IN('02','03','04','05','06','07','08','09','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29'))
	OR (WQ20.WF_QUE = '3W' AND WQ20.WF_SUB_QUE IN('02','03','04','05','06','07','08','09','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29'))
	OR (WQ20.WF_QUE = '3X' AND WQ20.WF_SUB_QUE IN('02','03','04','05','06','07','08','09','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29'))
	OR (WQ20.WF_QUE = '3Z' AND WQ20.WF_SUB_QUE IN('02','03','04','05','06','07','08','09','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29'))
	)

SELECT
	PD10.DF_SPE_ACC_ID,
	WQ21.WD_ACT_REQ AS RequestDate,
	WQ21.WF_QUE,
	WQ21.WF_SUB_QUE,
	WQ21.WC_STA_WQUE20,
	CAST(WQ21.WF_LST_DTS_WQ20 AS DATE) AS CompleteDate
FROM
	UDW..WQ21_TSK_QUE_HST WQ21
	INNER JOIN UDW..PD10_PRS_NME PD10
		ON PD10.DF_PRS_ID = WQ21.BF_SSN
WHERE
	CAST(WQ21.WF_LST_DTS_WQ20 AS DATE) >= '2021-01-01'
	AND WQ21.WC_STA_WQUE20 IN ('X','C')
	AND
	(
	(WQ21.WF_QUE = '24' AND WQ21.WF_SUB_QUE = '01')
	OR (WQ21.WF_QUE = '30' AND WQ21.WF_SUB_QUE IN('02','03','04','05','06','07','08','09','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29'))
	OR (WQ21.WF_QUE = '32' AND WQ21.WF_SUB_QUE IN('02','03','04','05','06','07','08','09','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29'))
	OR (WQ21.WF_QUE = '3A' AND WQ21.WF_SUB_QUE IN('02','03','04','05','06','07','08','09','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29'))
	OR (WQ21.WF_QUE = '3B' AND WQ21.WF_SUB_QUE IN('02','03','04','05','06','07','08','09','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29'))
	OR (WQ21.WF_QUE = '3I' AND WQ21.WF_SUB_QUE IN('02','03','04','05','06','07','08','09','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29'))
	OR (WQ21.WF_QUE = '3K' AND WQ21.WF_SUB_QUE IN('02','03','04','05','06','07','08','09','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29'))
	OR (WQ21.WF_QUE = '3L' AND WQ21.WF_SUB_QUE IN('02','03','04','05','06','07','08','09','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29'))
	OR (WQ21.WF_QUE = '3W' AND WQ21.WF_SUB_QUE IN('02','03','04','05','06','07','08','09','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29'))
	OR (WQ21.WF_QUE = '3X' AND WQ21.WF_SUB_QUE IN('02','03','04','05','06','07','08','09','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29'))
	OR (WQ21.WF_QUE = '3Z' AND WQ21.WF_SUB_QUE IN('02','03','04','05','06','07','08','09','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29'))
	)