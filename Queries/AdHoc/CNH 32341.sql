/*
CNH XXXXX

Open = LNXX.LA_CUR_PRI > X
Released = LNXX.LC_STA_LONXX = R
repayment schedule type =  LNXX.LC_TYP_SCH_DIS = CA, CP, CQ, CX, CX, CX, IB, IL, IP, IS, IX, IX, 

loan status = DWXX.WC_DW_LON_STA = XX
*/

SELECT
	COUNT(DISTINCT LNXX.BF_SSN) [In Repayment]
FROM
	LNXX_LON LNXX
	INNER JOIN DWXX_DW_CLC_CLU DWXX ON DWXX.BF_SSN = LNXX.BF_SSN AND DWXX.LN_SEQ = LNXX.LN_SEQ
	LEFT JOIN LNXX_LON_RPS LNXX ON LNXX.BF_SSN = LNXX.BF_SSN AND LNXX.LN_SEQ = LNXX.LN_SEQ
WHERE
	DWXX.WC_DW_LON_STA = 'XX'
ORDER BY
	LNXX.BF_SSN


SELECT
	COUNT(DISTINCT LNXX.BF_SSN) [In repayment and on IDR]
FROM
	LNXX_LON LNXX
	INNER JOIN DWXX_DW_CLC_CLU DWXX ON DWXX.BF_SSN = LNXX.BF_SSN AND DWXX.LN_SEQ = LNXX.LN_SEQ
	LEFT JOIN LNXX_LON_RPS LNXX ON LNXX.BF_SSN = LNXX.BF_SSN AND LNXX.LN_SEQ = LNXX.LN_SEQ
WHERE
	DWXX.WC_DW_LON_STA = 'XX'
	AND
	LNXX.LC_TYP_SCH_DIS IN ('CA', 'CP', 'CQ', 'CX', 'CX', 'CX', 'IB', 'IL', 'IP', 'IS', 'IX', 'IX')
	AND
	LNXX.LC_STA_LONXX = 'A'

--In repayment: XXX,XXX
--In repayment and on IDR: XX,XXX

