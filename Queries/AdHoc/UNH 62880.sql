SELECT * FROM UDW..LN90_FIN_ATY WHERE BF_SSN = '140905459'

--SELECT * FROM OPENQUERY (DUSTER,'
--SELECT 
--				LN90A.BF_SSN 
--				,LN90A.PC_FAT_TYP||LN90A.PC_FAT_SUB_TYP AS TX_TYP
--				,LN90A.LD_FAT_EFF 
--				,ABS(SUM(LN90A.LA_FAT_CUR_PRI)) AS LA_FAT_CUR_PRI
--				,ABS(SUM(LN90A.LA_FAT_NSI)) AS LA_FAT_NSI
--				,ABS(SUM(LN90A.LA_FAT_LTE_FEE)) AS LA_FAT_LTE_FEE
--			FROM 
--				OLWHRM1.LN90_FIN_ATY LN90A
--				INNER JOIN 
--				(
--					SELECT 
--						BF_SSN
--						,MAX(LD_FAT_EFF) AS LD_FAT_EFF
--					FROM 
--						OLWHRM1.LN90_FIN_ATY 
--					WHERE 
--						LC_FAT_REV_REA = ''''
--						AND LC_STA_LON90 = ''A''
--						AND PC_FAT_TYP = ''10''
--						AND PC_FAT_SUB_TYP IN (''10'',''11'',''12'',''41'')
--					GROUP BY 
--						BF_SSN
--				) LN90B
--				ON LN90A.BF_SSN = LN90B.BF_SSN
--				AND LN90A.LD_FAT_EFF = LN90B.LD_FAT_EFF
--			WHERE 
--				LN90A.PC_FAT_TYP = ''10''
--				AND LN90A.PC_FAT_SUB_TYP IN (''10'',''11'',''12'',''41'')
--				AND LN90A.LC_FAT_REV_REA = '' '' 
--				AND LN90A.LC_STA_LON90 = ''A''
--/*				USE FOR TESTING*/
--/*				AND LN90A.BF_SSN IN (&SSN)*/

--				AND LN90A.BF_SSN = ''140905459''
--			GROUP BY 
--				LN90A.BF_SSN
--				,LN90A.PC_FAT_TYP
--				,LN90A.PC_FAT_SUB_TYP
--				,LN90A.LD_FAT_EFF 


				
--				');


SELECT * FROM OPENQUERY (DUSTER,'
SELECT 
				BF_SSN
				,LN_SEQ
			    ,LN_FAT_SEQ
				,PC_FAT_TYP||PC_FAT_SUB_TYP AS TYP
			    ,ABS(COALESCE(LA_FAT_CUR_PRI,0)) AS LA_FAT_CUR_PRI
				,ABS(COALESCE(LA_FAT_NSI,0)) AS LA_FAT_NSI
				,ABS(COALESCE(LA_FAT_LTE_FEE,0)) AS LA_FAT_LTE_FEE /*cumulative late fees paid*/
				,ABS(COALESCE(LA_FAT_CUR_PRI,0) + COALESCE(LA_FAT_NSI,0) + COALESCE(LA_FAT_LTE_FEE,0)) AS LA_FAT_PRI_NSI
			FROM 
				OLWHRM1.LN90_FIN_ATY
			WHERE 
				PC_FAT_TYP = ''10''
				--AND LC_FAT_REV_REA = ''''
				AND LC_STA_LON90 = ''A''

				AND BF_SSN = ''140905459''
				
				');


SELECT * FROM OPENQUERY (DUSTER,'
SELECT 
				BF_SSN
				,LN_SEQ
			    ,LN_FAT_SEQ
				,PC_FAT_TYP||PC_FAT_SUB_TYP AS TYP
			    ,ABS(COALESCE(LA_FAT_CUR_PRI,0)) AS LA_FAT_CUR_PRI
				,ABS(COALESCE(LA_FAT_NSI,0)) AS LA_FAT_NSI
				,ABS(COALESCE(LA_FAT_LTE_FEE,0)) AS LA_FAT_LTE_FEE /*cumulative late fees paid*/
				,ABS(COALESCE(LA_FAT_CUR_PRI,0) + COALESCE(LA_FAT_NSI,0) + COALESCE(LA_FAT_LTE_FEE,0)) AS LA_FAT_PRI_NSI
			FROM 
				OLWHRM1.LN90_FIN_ATY
			WHERE 
				PC_FAT_TYP = ''10''
				--AND COALESCE(TRIM(LC_FAT_REV_REA),'''') = '''' /*not reversed*/
				AND LC_STA_LON90 = ''A''


						AND BF_SSN = ''140905459''
				');



