USE CDW
GO

SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED

SELECT DISTINCT
	PDXX.DF_SPE_ACC_ID,
	LTRIM(RTRIM(PDXX.DM_PRS_X)) AS "FIRST NAME",
	LTRIM(RTRIM(PDXX.DM_PRS_LST)) AS "LAST NAME",
	GRXX.LD_SCL_SPR AS "GRACE BEGIN",
	LNXX.LD_END_GRC_PRD AS "GRACE END",
	DWXX.WD_LON_RPD_SR AS "REPAYMENT START DATE"
FROM
	PDXX_PRS_NME PDXX
	INNER JOIN CDW..GRXX_RPT_LON_APL GRXX
		ON GRXX.BF_SSN = PDXX.DF_PRS_ID
	INNER JOIN CDW..DWXX_DW_CLC_CLU DWXX
		ON DWXX.BF_SSN = GRXX.BF_SSN
		AND DWXX.LN_SEQ = GRXX.LN_SEQ
	INNER JOIN CDW..LNXX_LON LNXX
		ON LNXX.BF_SSN = DWXX.BF_SSN
		AND LNXX.LN_SEQ = DWXX.LN_SEQ
WHERE
	DWXX.WC_DW_LON_STA = 'XX'
ORDER BY 
	PDXX.DF_SPE_ACC_ID