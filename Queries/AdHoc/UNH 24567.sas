/*%LET RPTLIB = %SYSGET(reportdir);*/
%LET RPTLIB = T:\SAS;
FILENAME REPORTZ "&RPTLIB/ULWAB1.LWAB1RZ";
FILENAME REPORT2 "&RPTLIB/ULWAB1.LWAB1R2";
LIBNAME  DUSTER  REMOTE  SERVER=DUSTER  SLIBREF=WORK;
RSUBMIT;
/*LIBNAME OLWHRM1 DB2 DATABASE=DLGSUTWH OWNER=OLWHRM1;*/

%MACRO SQLCHECK ;
  %IF  &SQLXRC NE 0  %THEN  %DO  ;
    DATA _NULL_  ;
            FILE REPORTZ NOTITLES  ;
            PUT @01 " ********************************************************************* "
              / @01 " ****  THE SQL CODE ABOVE HAS EXPERIENCED AN ERROR.               **** "
              / @01 " ****  THE SAS SHOULD BE REVIEWED.                                **** "       
              / @01 " ********************************************************************* "
              / @01 " ****  THE SQL ERROR CODE IS  &SQLXRC  AND THE SQL ERROR MESSAGE  **** "
              / @01 " ****  &SQLXMSG   **** "
              / @01 " ********************************************************************* "
            ;
         RUN  ;
  %END  ;
%MEND  ;

PROC SQL;
	CONNECT TO DB2 (DATABASE=DLGSUTWH);

	CREATE TABLE DEMO AS
		SELECT 
			*
		FROM 
			CONNECTION TO DB2 
				(
					SELECT
						LN10.*
					FROM	
						OLWHRM1.LN10_LON LN10
						JOIN OLWHRM1.PD10_PRS_NME PD10
							ON LN10.BF_SSN = PD10.DF_PRS_ID
					WHERE (PD10.DF_SPE_ACC_ID = '4588843699' AND LN10.LN_SEQ = 2)
OR (PD10.DF_SPE_ACC_ID = '5336494015' AND LN10.LN_SEQ = 6)
OR (PD10.DF_SPE_ACC_ID = '0091498525' AND LN10.LN_SEQ = 1)
OR (PD10.DF_SPE_ACC_ID = '4219026663' AND LN10.LN_SEQ = 6)
OR (PD10.DF_SPE_ACC_ID = '5300647632' AND LN10.LN_SEQ = 2)
OR (PD10.DF_SPE_ACC_ID = '5787702776' AND LN10.LN_SEQ = 7)
OR (PD10.DF_SPE_ACC_ID = '4961495305' AND LN10.LN_SEQ = 8)
OR (PD10.DF_SPE_ACC_ID = '5274848725' AND LN10.LN_SEQ = 3)
OR (PD10.DF_SPE_ACC_ID = '8782008837' AND LN10.LN_SEQ = 7)
OR (PD10.DF_SPE_ACC_ID = '5102343103' AND LN10.LN_SEQ = 2)
OR (PD10.DF_SPE_ACC_ID = '6369231424' AND LN10.LN_SEQ = 9)
OR (PD10.DF_SPE_ACC_ID = '4680100228' AND LN10.LN_SEQ = 10)
OR (PD10.DF_SPE_ACC_ID = '5831245384' AND LN10.LN_SEQ = 4)
OR (PD10.DF_SPE_ACC_ID = '5292117632' AND LN10.LN_SEQ = 4)
OR (PD10.DF_SPE_ACC_ID = '7631868113' AND LN10.LN_SEQ = 6)
OR (PD10.DF_SPE_ACC_ID = '8568289705' AND LN10.LN_SEQ = 3)
OR (PD10.DF_SPE_ACC_ID = '7265809452' AND LN10.LN_SEQ = 8)
OR (PD10.DF_SPE_ACC_ID = '7265809452' AND LN10.LN_SEQ = 11)
OR (PD10.DF_SPE_ACC_ID = '5832806285' AND LN10.LN_SEQ = 1)
OR (PD10.DF_SPE_ACC_ID = '4812845478' AND LN10.LN_SEQ = 1)
OR (PD10.DF_SPE_ACC_ID = '4731469518' AND LN10.LN_SEQ = 5)
OR (PD10.DF_SPE_ACC_ID = '5742149674' AND LN10.LN_SEQ = 1)
OR (PD10.DF_SPE_ACC_ID = '0545745763' AND LN10.LN_SEQ = 8)
OR (PD10.DF_SPE_ACC_ID = '4895799451' AND LN10.LN_SEQ = 2)
OR (PD10.DF_SPE_ACC_ID = '2530521772' AND LN10.LN_SEQ = 7)
OR (PD10.DF_SPE_ACC_ID = '8996687252' AND LN10.LN_SEQ = 5)
OR (PD10.DF_SPE_ACC_ID = '6653942314' AND LN10.LN_SEQ = 4)
OR (PD10.DF_SPE_ACC_ID = '0209695043' AND LN10.LN_SEQ = 3)
OR (PD10.DF_SPE_ACC_ID = '5342180389' AND LN10.LN_SEQ = 3)
OR (PD10.DF_SPE_ACC_ID = '5382361661' AND LN10.LN_SEQ = 3)
OR (PD10.DF_SPE_ACC_ID = '8605744713' AND LN10.LN_SEQ = 3)
OR (PD10.DF_SPE_ACC_ID = '5499589151' AND LN10.LN_SEQ = 4)
OR (PD10.DF_SPE_ACC_ID = '4682534998' AND LN10.LN_SEQ = 9)
OR (PD10.DF_SPE_ACC_ID = '5151239447' AND LN10.LN_SEQ = 2)
OR (PD10.DF_SPE_ACC_ID = '5670039634' AND LN10.LN_SEQ = 6)
OR (PD10.DF_SPE_ACC_ID = '4279350921' AND LN10.LN_SEQ = 1)
OR (PD10.DF_SPE_ACC_ID = '4404750093' AND LN10.LN_SEQ = 3)
OR (PD10.DF_SPE_ACC_ID = '4773416998' AND LN10.LN_SEQ = 1)
OR (PD10.DF_SPE_ACC_ID = '2079690212' AND LN10.LN_SEQ = 7)
OR (PD10.DF_SPE_ACC_ID = '4651743295' AND LN10.LN_SEQ = 7)
OR (PD10.DF_SPE_ACC_ID = '5077065443' AND LN10.LN_SEQ = 4)
OR (PD10.DF_SPE_ACC_ID = '2707627314' AND LN10.LN_SEQ = 5)
OR (PD10.DF_SPE_ACC_ID = '4255907000' AND LN10.LN_SEQ = 2)
OR (PD10.DF_SPE_ACC_ID = '4698185861' AND LN10.LN_SEQ = 2)
OR (PD10.DF_SPE_ACC_ID = '5700892010' AND LN10.LN_SEQ = 1)
OR (PD10.DF_SPE_ACC_ID = '5517149028' AND LN10.LN_SEQ = 1)
OR (PD10.DF_SPE_ACC_ID = '5237076146' AND LN10.LN_SEQ = 1)
OR (PD10.DF_SPE_ACC_ID = '5201494100' AND LN10.LN_SEQ = 4)
OR (PD10.DF_SPE_ACC_ID = '5828652812' AND LN10.LN_SEQ = 7)
OR (PD10.DF_SPE_ACC_ID = '4946175688' AND LN10.LN_SEQ = 2)
OR (PD10.DF_SPE_ACC_ID = '5358300745' AND LN10.LN_SEQ = 7)
OR (PD10.DF_SPE_ACC_ID = '5045256065' AND LN10.LN_SEQ = 9)
OR (PD10.DF_SPE_ACC_ID = '4435580173' AND LN10.LN_SEQ = 1)
OR (PD10.DF_SPE_ACC_ID = '5319808263' AND LN10.LN_SEQ = 1)
OR (PD10.DF_SPE_ACC_ID = '5319808263' AND LN10.LN_SEQ = 4)
OR (PD10.DF_SPE_ACC_ID = '4536830041' AND LN10.LN_SEQ = 2)
OR (PD10.DF_SPE_ACC_ID = '8813260423' AND LN10.LN_SEQ = 4)
OR (PD10.DF_SPE_ACC_ID = '5747261390' AND LN10.LN_SEQ = 4)
OR (PD10.DF_SPE_ACC_ID = '5028319155' AND LN10.LN_SEQ = 4)
OR (PD10.DF_SPE_ACC_ID = '9948404450' AND LN10.LN_SEQ = 1)
OR (PD10.DF_SPE_ACC_ID = '5741937690' AND LN10.LN_SEQ = 1)
OR (PD10.DF_SPE_ACC_ID = '6740706155' AND LN10.LN_SEQ = 8)
OR (PD10.DF_SPE_ACC_ID = '7535967777' AND LN10.LN_SEQ = 6)
OR (PD10.DF_SPE_ACC_ID = '4658081147' AND LN10.LN_SEQ = 2)
OR (PD10.DF_SPE_ACC_ID = '4847309375' AND LN10.LN_SEQ = 8)
OR (PD10.DF_SPE_ACC_ID = '4192042074' AND LN10.LN_SEQ = 4)
OR (PD10.DF_SPE_ACC_ID = '5018596784' AND LN10.LN_SEQ = 4)
OR (PD10.DF_SPE_ACC_ID = '4207316854' AND LN10.LN_SEQ = 5)
OR (PD10.DF_SPE_ACC_ID = '5679514693' AND LN10.LN_SEQ = 3)
OR (PD10.DF_SPE_ACC_ID = '4772703910' AND LN10.LN_SEQ = 3)
OR (PD10.DF_SPE_ACC_ID = '4206998628' AND LN10.LN_SEQ = 2)
OR (PD10.DF_SPE_ACC_ID = '4856365439' AND LN10.LN_SEQ = 10)
OR (PD10.DF_SPE_ACC_ID = '5471621258' AND LN10.LN_SEQ = 1)
OR (PD10.DF_SPE_ACC_ID = '4727314247' AND LN10.LN_SEQ = 2)
OR (PD10.DF_SPE_ACC_ID = '5435243670' AND LN10.LN_SEQ = 3)
OR (PD10.DF_SPE_ACC_ID = '5435243670' AND LN10.LN_SEQ = 6)
OR (PD10.DF_SPE_ACC_ID = '4575818483' AND LN10.LN_SEQ = 4)
OR (PD10.DF_SPE_ACC_ID = '4734420431' AND LN10.LN_SEQ = 1)
OR (PD10.DF_SPE_ACC_ID = '4772969303' AND LN10.LN_SEQ = 3)
OR (PD10.DF_SPE_ACC_ID = '4902587629' AND LN10.LN_SEQ = 1)
OR (PD10.DF_SPE_ACC_ID = '1484537677' AND LN10.LN_SEQ = 8)
OR (PD10.DF_SPE_ACC_ID = '9390826972' AND LN10.LN_SEQ = 3)
OR (PD10.DF_SPE_ACC_ID = '5426318009' AND LN10.LN_SEQ = 12)
OR (PD10.DF_SPE_ACC_ID = '5627558092' AND LN10.LN_SEQ = 5)
OR (PD10.DF_SPE_ACC_ID = '5826364129' AND LN10.LN_SEQ = 9)
OR (PD10.DF_SPE_ACC_ID = '5219252809' AND LN10.LN_SEQ = 7)
OR (PD10.DF_SPE_ACC_ID = '4286206904' AND LN10.LN_SEQ = 9)
OR (PD10.DF_SPE_ACC_ID = '4686328793' AND LN10.LN_SEQ = 7)
OR (PD10.DF_SPE_ACC_ID = '5235756183' AND LN10.LN_SEQ = 4)
OR (PD10.DF_SPE_ACC_ID = '4859946262' AND LN10.LN_SEQ = 2)
OR (PD10.DF_SPE_ACC_ID = '4989987365' AND LN10.LN_SEQ = 6)
OR (PD10.DF_SPE_ACC_ID = '5349691144' AND LN10.LN_SEQ = 5)
OR (PD10.DF_SPE_ACC_ID = '5261556840' AND LN10.LN_SEQ = 5)
OR (PD10.DF_SPE_ACC_ID = '4724233279' AND LN10.LN_SEQ = 2)
OR (PD10.DF_SPE_ACC_ID = '5358368496' AND LN10.LN_SEQ = 1)
OR (PD10.DF_SPE_ACC_ID = '4272924996' AND LN10.LN_SEQ = 7)
OR (PD10.DF_SPE_ACC_ID = '5189691457' AND LN10.LN_SEQ = 1)
OR (PD10.DF_SPE_ACC_ID = '5522180108' AND LN10.LN_SEQ = 1)
OR (PD10.DF_SPE_ACC_ID = '4370271997' AND LN10.LN_SEQ = 1)
OR (PD10.DF_SPE_ACC_ID = '4621931708' AND LN10.LN_SEQ = 5)
OR (PD10.DF_SPE_ACC_ID = '5538113446' AND LN10.LN_SEQ = 7)
OR (PD10.DF_SPE_ACC_ID = '4582824882' AND LN10.LN_SEQ = 3)
OR (PD10.DF_SPE_ACC_ID = '4472419592' AND LN10.LN_SEQ = 3)
OR (PD10.DF_SPE_ACC_ID = '5380695234' AND LN10.LN_SEQ = 4)
OR (PD10.DF_SPE_ACC_ID = '4281845083' AND LN10.LN_SEQ = 3)
OR (PD10.DF_SPE_ACC_ID = '4178855097' AND LN10.LN_SEQ = 3)
OR (PD10.DF_SPE_ACC_ID = '5255424824' AND LN10.LN_SEQ = 2)
OR (PD10.DF_SPE_ACC_ID = '5101862954' AND LN10.LN_SEQ = 1)
OR (PD10.DF_SPE_ACC_ID = '4271252320' AND LN10.LN_SEQ = 2)
OR (PD10.DF_SPE_ACC_ID = '5311690467' AND LN10.LN_SEQ = 2)
OR (PD10.DF_SPE_ACC_ID = '5580332176' AND LN10.LN_SEQ = 3)
OR (PD10.DF_SPE_ACC_ID = '5580332176' AND LN10.LN_SEQ = 6)
OR (PD10.DF_SPE_ACC_ID = '8076165655' AND LN10.LN_SEQ = 4)
OR (PD10.DF_SPE_ACC_ID = '8782957883' AND LN10.LN_SEQ = 3)
OR (PD10.DF_SPE_ACC_ID = '8782957883' AND LN10.LN_SEQ = 6)
OR (PD10.DF_SPE_ACC_ID = '4562800392' AND LN10.LN_SEQ = 4)
OR (PD10.DF_SPE_ACC_ID = '4351102885' AND LN10.LN_SEQ = 9)
OR (PD10.DF_SPE_ACC_ID = '5824410280' AND LN10.LN_SEQ = 1)
OR (PD10.DF_SPE_ACC_ID = '4267705964' AND LN10.LN_SEQ = 2)
OR (PD10.DF_SPE_ACC_ID = '4713846100' AND LN10.LN_SEQ = 2)
OR (PD10.DF_SPE_ACC_ID = '4652485222' AND LN10.LN_SEQ = 8)
OR (PD10.DF_SPE_ACC_ID = '4197421190' AND LN10.LN_SEQ = 10)
OR (PD10.DF_SPE_ACC_ID = '4366950797' AND LN10.LN_SEQ = 5)
OR (PD10.DF_SPE_ACC_ID = '5443590815' AND LN10.LN_SEQ = 1)
OR (PD10.DF_SPE_ACC_ID = '4921638744' AND LN10.LN_SEQ = 6)
OR (PD10.DF_SPE_ACC_ID = '5804658979' AND LN10.LN_SEQ = 6)
OR (PD10.DF_SPE_ACC_ID = '4542350021' AND LN10.LN_SEQ = 6)
OR (PD10.DF_SPE_ACC_ID = '4693206554' AND LN10.LN_SEQ = 1)
OR (PD10.DF_SPE_ACC_ID = '5169366756' AND LN10.LN_SEQ = 2)

					FOR READ ONLY WITH UR
				)
	;

	DISCONNECT FROM DB2;

	/*%PUT  SQLXRC= >>> &SQLXRC <<< ||| SQLXMSG= >>> &SQLXMSG >>> ;  ** INCLUDES ERROR MESSAGES TO SAS LOG  ;*/
	/*%SQLCHECK;*/
QUIT;

ENDRSUBMIT;


DATA DEMO;
	SET DUSTER.DEMO;
RUN;


/*export to Excel spreadsheet*/
PROC EXPORT DATA = WORK.DEMO 
            OUTFILE = "T:\SAS\NH 24567.xlsx" 
            DBMS = EXCEL
			REPLACE;
     SHEET="A"; 
RUN;

/*PROC SORT DATA=DEMO;*/
/*	BY SSN;*/
/*RUN;*/
/*PROC PRINTTO PRINT=REPORT2 NEW;*/
/*RUN;*/
/*/*FOR LANDSCAPE REPORTS:*/*/
/*OPTIONS ORIENTATION = LANDSCAPE;*/
/*OPTIONS PS=39 LS=127;*/
/*/*FOR PORTRAIT REPORTS;*/*/
/*OPTIONS ORIENTATION = PORTRAIT;*/
/*OPTIONS PS=52 LS=96;*/
/*TITLE 'TITLE ONE';*/
/*TITLE2	"RUNDATE &RUNDT";*/
/*FOOTNOTE1  	"THIS DOCUMENT MAY CONTAIN BORROWERS' SENSITIVE INFORMATION THAT UHEAA HAS PLEDGED TO PROTECT.";*/
/*FOOTNOTE2	'PLEASE TAKE APPROPRIATE PRECAUTIONS TO SAFEGUARD THIS INFORMATION.';*/
/*FOOTNOTE3	;*/
/*FOOTNOTE4   'JOB = UTLWAB1  	 REPORT = ULWAB1.LWAB1R2';*/
/**/
/*PROC CONTENTS DATA=DEMO OUT=EMPTYSET NOPRINT;*/
/*DATA _NULL_;*/
/*	SET EMPTYSET;*/
/*	FILE PRINT;*/
/**/
/*	IF  NOBS=0 AND _N_ =1 THEN */
/*		DO;*/
/*			PUT // 132*'-';*/
/*			PUT      //////*/
/*				@51 '**** NO OBSERVATIONS FOUND ****';*/
/*			PUT //////*/
/*				@57 '-- END OF REPORT --';*/
/*			PUT //////////////*/
/*				@46 "JOB = UTLWAB1  	 REPORT = ULWAB1.LWAB1R2";*/
/*		END;*/
/*	RETURN;*/
/*RUN;*/
/**/
/*PROC PRINT NOOBS SPLIT='/' DATA=DEMO WIDTH=UNIFORM WIDTH=MIN LABEL;*/
/*	FORMAT ;*/
/*	VAR ;*/
/*	LABEL*/
/*		BF_SSN = 'SSN'*/
/*		LN_SEQ = 'LN SEQ'*/
/*		LF_LON_CUR_OWN = 'CURRENT OWNER'*/
/*		LD_DSB = 'DISBURSEMENT DATE'*/
/*		LD_FAT_PST = 'TRANSACTION POSTED DATE'*/
/*		LA_FAT_CUR_PRI = 'DISBURSEMENT AMOUNT'*/
/*		TXTYP = 'TRANSACTION TYPE'*/
/*		LC_LDR_DSB_MDM = 'DISB MEDIUM CODE'*/
/*	;*/
/*RUN;*/
/**/
/*PROC PRINTTO;*/
/*RUN;*/
/**/
/**/
/*/*write to comma delimited file*/*/
/*DATA _NULL_;*/
/*	SET  WORK.DEMO;*/
/*	FILE 'T:\SAS\ACH_not_pulled.txt' delimiter=',' DSD DROPOVER lrecl=32767;*/
/**/
/*	FORMAT DF_SPE_ACC_ID $10. ;*/
/*	FORMAT LD_BIL_CRT YYMMDDd10. ;*/
/**/
/*	IF _N_ = 1 THEN        /* write column names */*/
/*		DO;*/
/*			PUT*/
/*			'DF_SPE_ACC_ID'*/
/*			','*/
/*			'LD_BIL_CRT';*/
/*		END;*/
/**/
/*	DO;*/
/*		PUT DF_SPE_ACC_ID $ @;*/
/*		PUT LD_BIL_CRT;*/
/*		;*/
/*	END;*/
/*RUN;*/
/**/
/*/*write to file for queue builder*/*/
/*DATA _NULL_;*/
/*	SET  WORK.S60; */
/*	FILE REPORT2 DELIMITER=',' DSD DROPOVER LRECL=32767;*/
/**/
/*	ARC_NAME = 'CL055';*/
/*	FROM_DATE = '';*/
/*	TO_DATE = '';*/
/*	NEEDED_BY_DATE = '';*/
/*	RECIPIENT_ID = '';*/
/*	REGARDS_TO_CODE = '';*/
/*	REGARDS_TO_ID = '';*/
/*	LOAN_SEQ = 'ALL';*/
/*	FORMAT COMMENTS $200. ;*/
/*	COMMENTS = 'Review MOC and Pacer for Chapter 13';*/
/**/
/*	DO;*/
/*		PUT DF_SPE_ACC_ID $ @;*/
/*		PUT ARC_NAME $ @;*/
/*		PUT FROM_DATE @;*/
/*		PUT TO_DATE @;*/
/*		PUT NEEDED_BY_DATE @;*/
/*		PUT RECIPIENT_ID @;*/
/*		PUT REGARDS_TO_CODE @;*/
/*		PUT REGARDS_TO_ID @;*/
/*		PUT LOAN_SEQ @;*/
/*		PUT COMMENTS $ ;*/
/*	END;*/
/*RUN;*/


