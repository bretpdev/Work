SELECT DISTINCT
	PC_STA_LPDXX AS 'LPD STATUS',
	IC_LON_PGM AS 'LOAN PROGRAM',
	PF_RGL_CAT AS 'REG CAT',
	PX_SHO_DSC_RGL_CAT AS 'REG CAT DESCRIPTION',
	PD_RGL_CAT_EFF AS 'REG CAT EFF DATE',
	IF_GTR AS 'GUARANTOR',
	IF_OWN AS 'OWNER',
	IF_BND_ISS AS 'BOND ISSUE',
	PC_ITR_TYP AS 'INTEREST TYPE',
	PR_ITR_MAX AS 'MAX INTEREST RATE',
	PR_ITR_MIN AS 'MIN INTEREST RATE',
	PD_EFF_SR_LPDXX AS 'INTEREST RATE BEGIN DATE',
	PD_EFF_END_LPDXX AS 'INTEREST RATE END DATE'
FROM
	OPENQUERY (LEGEND, 
	'
		SELECT
			LPXX.PC_STA_LPDXX
			,LPXX.IC_LON_PGM
			,LPXX.PF_RGL_CAT
			,RGXX.PX_SHO_DSC_RGL_CAT
			,RGXX.PD_RGL_CAT_EFF
			,LPXX.IF_GTR
			,LPXX.IF_OWN
			,LPXX.IF_BND_ISS
			,LPXX.PC_ITR_TYP
			,LPXX.PR_ITR_MAX
			,LPXX.PR_ITR_MIN
			,LPXX.PD_EFF_SR_LPDXX
			,LPXX.PD_EFF_END_LPDXX
		FROM
			PKUB.LPXX_ITR_AND_TYP LPXX
			INNER JOIN PKUB.RGXX_RGL_CAT RGXX
				ON LPXX.IC_LON_PGM = RGXX.IC_LON_PGM
				AND LPXX.PF_RGL_CAT = RGXX.PF_RGL_CAT
			INNER JOIN PKUB.RGXX_RGL_CAT_PAR RGXX
				ON LPXX.IC_LON_PGM = RGXX.IC_LON_PGM
				AND LPXX.PF_RGL_CAT = RGXX.PF_RGL_CAT
		WHERE 
			(
			   LPXX.PC_STA_LPDXX = ''A''
				AND LPXX.PC_ITR_TYP NOT IN (''CX'', ''CX'', ''SV'', ''FX'')
				AND LPXX.PD_EFF_END_LPDXX = (''XXXX-XX-XX'')
			)
			OR
			(
				LPXX.PC_STA_LPDXX = ''A''
				AND LPXX.PC_ITR_TYP IN (''CX'', ''CX'', ''SV'', ''FX'')
				AND LPXX.PD_EFF_SR_LPDXX = (''XXXX-XX-XX'') 
				AND LPXX.PD_EFF_END_LPDXX = (''XXXX-XX-XX'')
			)
	');