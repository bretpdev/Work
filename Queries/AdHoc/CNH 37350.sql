
SELECT  -- count of borrowers with a consolidation loan disbursed after X/X/XXXX
	COUNT (DISTINCT LNXX.BF_SSN) AS TTL_BRWS
FROM
	CDW..LNXX_LON LNXX
	INNER JOIN CDW..LNXX_DSB LNXX
		ON LNXX.BF_SSN = LNXX.BF_SSN
		AND LNXX.LN_SEQ = LNXX.LN_SEQ
WHERE
	LNXX.IC_LON_PGM IN ('DLCNSL', 'DLSCCN', 'DLSCNS', 'DLSCSC', 'DLSCSL', 'DLSCST', 'DLSCUC', 'DLSCUN', 'DLSPCN', 'DLSSPL', 'DLUCNS', 'DLUSPL', 'DSCON')
	AND LNXX.LD_DSB > 'XXXX-XX-XX'

SELECT  -- count of borrowers with a consolidation loan disbursed after X/X/XXXX with loans originally serviced by CornerStone
	COUNT (DISTINCT LNXX.BF_SSN) AS CS_BRWS
FROM
	CDW..LNXX_LON LNXX
	INNER JOIN CDW..LNXX_DSB LNXX
		ON LNXX.BF_SSN = LNXX.BF_SSN
		AND LNXX.LN_SEQ = LNXX.LN_SEQ
	INNER JOIN CDW..GRSP_NDS_LON_RSP CS
		ON LNXX.BF_SSN = CS.DF_PRS_ID
WHERE
	LNXX.IC_LON_PGM IN ('DLCNSL', 'DLSCCN', 'DLSCNS', 'DLSCSC', 'DLSCSL', 'DLSCST', 'DLSCUC', 'DLSCUN', 'DLSPCN', 'DLSSPL', 'DLUCNS', 'DLUSPL', 'DSCON')
	AND LNXX.LD_DSB > 'XXXX-XX-XX'
	AND CS.LF_ORG_SER = 'XXX'

SELECT  -- count of borrowers with a consolidation loan disbursed after X/X/XXXX with loans originally serviced by a servicer other than CornerStone
	COUNT (DISTINCT LNXX.BF_SSN) AS NON_CS_BWRS
FROM
	CDW..LNXX_LON LNXX
	INNER JOIN CDW..LNXX_DSB LNXX
		ON LNXX.BF_SSN = LNXX.BF_SSN
		AND LNXX.LN_SEQ = LNXX.LN_SEQ
	INNER JOIN CDW..GRSP_NDS_LON_RSP CS
		ON LNXX.BF_SSN = CS.DF_PRS_ID
WHERE
	LNXX.IC_LON_PGM IN ('DLCNSL', 'DLSCCN', 'DLSCNS', 'DLSCSC', 'DLSCSL', 'DLSCST', 'DLSCUC', 'DLSCUN', 'DLSPCN', 'DLSSPL', 'DLUCNS', 'DLUSPL', 'DSCON')
	AND LNXX.LD_DSB > 'XXXX-XX-XX'
	AND CS.LF_ORG_SER != 'XXX'