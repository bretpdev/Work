SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED

SELECT DISTINCT
	LNXX.BF_SSN,
	LNXX.LN_SEQ,
	COALESCE(LNXX.LA_CUR_PRI,X) + COALESCE(DWXX.WA_TOT_BRI_OTS,X) AS PRI_INT
FROM
	CDW..LNXX_LON LNXX
	INNER JOIN CDW..DWXX_DW_CLC_CLU DWXX
		ON LNXX.BF_SSN = DWXX.BF_SSN
		AND LNXX.LN_SEQ = DWXX.LN_SEQ
		AND LNXX.LC_STA_LONXX = 'R'
		AND LNXX.LA_CUR_PRI > X.XXX
	INNER JOIN CDW..PDXX_PRS_ADR PDXX
		ON LNXX.BF_SSN = PDXX.DF_PRS_ID
WHERE
	PDXX.DC_DOM_ST = 'IL'
ORDER BY
	LNXX.BF_SSN,
	LNXX.LN_SEQ


SELECT DISTINCT
	COUNT(CONCAT(LNXX.BF_SSN, FORMAT (LNXX.LN_SEQ, 'XX'))) AS LOANS,
	SUM(COALESCE(LNXX.LA_CUR_PRI,X) + COALESCE(DWXX.WA_TOT_BRI_OTS,X)) AS PRI_INT
FROM
	CDW..LNXX_LON LNXX
	INNER JOIN CDW..DWXX_DW_CLC_CLU DWXX
		ON LNXX.BF_SSN = DWXX.BF_SSN
		AND LNXX.LN_SEQ = DWXX.LN_SEQ
		AND LNXX.LC_STA_LONXX = 'R'
		AND LNXX.LA_CUR_PRI > X.XXX
	INNER JOIN CDW..PDXX_PRS_ADR PDXX
		ON LNXX.BF_SSN = PDXX.DF_PRS_ID
WHERE
	PDXX.DC_DOM_ST = 'IL'


SELECT
	COUNT(DISTINCT LNXX.BF_SSN) AS BORROWERS
FROM
	CDW..LNXX_LON LNXX
	INNER JOIN CDW..DWXX_DW_CLC_CLU DWXX
		ON LNXX.BF_SSN = DWXX.BF_SSN
		AND LNXX.LN_SEQ = DWXX.LN_SEQ
		AND LNXX.LC_STA_LONXX = 'R'
		AND LNXX.LA_CUR_PRI > X.XXX
	INNER JOIN CDW..PDXX_PRS_ADR PDXX
		ON LNXX.BF_SSN = PDXX.DF_PRS_ID
WHERE
	PDXX.DC_DOM_ST = 'IL'

	SELECT
	DISTINCT LNXX.BF_SSN
FROM
	CDW..LNXX_LON LNXX
	INNER JOIN CDW..DWXX_DW_CLC_CLU DWXX
		ON LNXX.BF_SSN = DWXX.BF_SSN
		AND LNXX.LN_SEQ = DWXX.LN_SEQ
		AND LNXX.LC_STA_LONXX = 'R'
		AND LNXX.LA_CUR_PRI > X.XXX
	INNER JOIN CDW..PDXX_PRS_ADR PDXX
		ON LNXX.BF_SSN = PDXX.DF_PRS_ID
WHERE
	PDXX.DC_DOM_ST = 'IL'