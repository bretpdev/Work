USE [CDW]
GO
/****** Object:  StoredProcedure [dbo].[BorrowersSearch]    Script Date: X/XX/XXXX X:XX:XX AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
ALTER PROCEDURE [dbo].[BorrowersSearch]
	@FirstName VARCHAR(XX) = NULL,
	@LastName VARCHAR(XX) = NULL,
	@MiddleInitial VARCHAR(X) = NULL,
	@DOB VARCHAR(XX) = NULL,
	@Address VARCHAR(XX) = null,
	@City VARCHAR(XX) = null,
	@StateCode VARCHAR(X) = null,
	@Zip VARCHAR(XX) = null,
	@Phone VARCHAR(XX) = null,
	@Email VARCHAR(XXX) = null,
	@AccountIdentifier VARCHAR(XX) = null
AS

SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED

DECLARE 
	@PDXX BIT = X,
	@PDXX BIT = X,
	@PDXX BIT = X,
	@PDXX BIT = X

IF @FirstName IS NOT NULL
BEGIN
	SET @PDXX = X
END
IF @LastName IS NOT NULL
BEGIN
	SET @PDXX = X
END
IF @DOB IS NOT NULL
BEGIN
	SET @PDXX = X
END
IF @MiddleInitial IS NOT NULL
BEGIN
	SET @PDXX = X
END
IF @Address IS NOT NULL
BEGIN
	SET @PDXX = X
END
IF @City IS NOT NULL
BEGIN
	SET @PDXX = X
END
IF @StateCode IS NOT NULL
BEGIN
	SET @PDXX = X
END
IF @Zip IS NOT NULL
BEGIN
	SET @PDXX = X
END
IF @Phone IS NOT NULL
BEGIN
	SET @PDXX = X
END
IF @Email IS NOT NULL
BEGIN
	SET @PDXX = X
END

DECLARE @MatchingSSNs TABLE (SSN CHAR(X))
IF @AccountIdentifier IS NOT NULL
BEGIN
	INSERT INTO @MatchingSSNs
	SELECT DISTINCT 
		PDXX.DF_PRS_ID 
	FROM 
		PDXX_PRS_NME PDXX 
	WHERE 
		DF_SPE_ACC_ID = @AccountIdentifier
		OR
		DF_PRS_ID = @AccountIdentifier
END
--X
ELSE IF @PDXX = X AND @PDXX = X AND @PDXX = X AND @PDXX = X
BEGIN
	INSERT INTO @MatchingSSNs
	SELECT DISTINCT 
		PDXX.DF_PRS_ID 
	FROM 
		PDXX_PRS_NME PDXX 
	WHERE 
		(@FirstName IS NULL OR PDXX.DM_PRS_X LIKE @FirstName) 
		AND (@LastName IS NULL OR PDXX.DM_PRS_LST LIKE @LastName) 
		AND (@MiddleInitial IS NULL OR PDXX.DM_PRS_MID LIKE @MiddleInitial) 
		AND (@DOB IS NULL OR PDXX.DD_BRT =  REPLACE(@DOB, '%', '')) 
		AND	SUBSTRING(PDXX.DF_PRS_ID,X,X) != 'P' 
END
--X
ELSE IF @PDXX = X AND @PDXX = X AND @PDXX = X AND @PDXX = X
BEGIN
	INSERT INTO @MatchingSSNs
	SELECT DISTINCT 
		PDXX.DF_PRS_ID 
	FROM 
		PDXX_PRS_NME PDXX
		INNER JOIN PDXX_PRS_ADR PDXX
			ON PDXX.DF_PRS_ID = PDXX.DF_PRS_ID
	WHERE 
		(@FirstName IS NULL OR PDXX.DM_PRS_X LIKE @FirstName) 
		AND (@LastName IS NULL OR PDXX.DM_PRS_LST LIKE @LastName) 
		AND (@MiddleInitial IS NULL OR PDXX.DM_PRS_MID LIKE @MiddleInitial) 
		AND (@DOB IS NULL OR PDXX.DD_BRT =  REPLACE(@DOB, '%', '')) 
		AND (@Address IS NULL OR PDXX.DX_STR_ADR_X LIKE @Address OR PDXX.DX_STR_ADR_X LIKE @Address)
		AND (@City IS NULL OR PDXX.DM_CT LIKE @City) 
		AND (@StateCode IS NULL OR PDXX.DC_DOM_ST LIKE @StateCode) 
		AND (@Zip IS NULL OR PDXX.DF_ZIP_CDE LIKE @Zip) 
		AND	SUBSTRING(PDXX.DF_PRS_ID,X,X) != 'P' 
END
--X
ELSE IF @PDXX = X AND @PDXX = X AND @PDXX = X AND @PDXX = X
BEGIN
	INSERT INTO @MatchingSSNs
	SELECT DISTINCT 
		PDXX.DF_PRS_ID 
	FROM 
		PDXX_PRS_NME PDXX
		INNER JOIN PDXX_PRS_ADR_EML PDXX
			ON PDXX.DF_PRS_ID = PDXX.DF_PRS_ID
	WHERE 
		(@FirstName IS NULL OR PDXX.DM_PRS_X LIKE @FirstName) 
		AND (@LastName IS NULL OR PDXX.DM_PRS_LST LIKE @LastName) 
		AND (@MiddleInitial IS NULL OR PDXX.DM_PRS_MID LIKE @MiddleInitial) 
		AND (@DOB IS NULL OR PDXX.DD_BRT =  REPLACE(@DOB, '%', ''))
		AND (@Email IS NULL OR PDXX.DX_ADR_EML LIKE @Email)
		AND	SUBSTRING(PDXX.DF_PRS_ID,X,X) != 'P' 
END
--X
ELSE IF @PDXX = X AND @PDXX = X AND @PDXX = X AND @PDXX = X
BEGIN
	INSERT INTO @MatchingSSNs
	SELECT DISTINCT 
		PDXX.DF_PRS_ID 
	FROM 
		PDXX_PRS_NME PDXX
		INNER JOIN PDXX_PRS_PHN PDXX
			ON PDXX.DF_PRS_ID = PDXX.DF_PRS_ID
	WHERE 
		(@FirstName IS NULL OR PDXX.DM_PRS_X LIKE @FirstName) 
		AND (@LastName IS NULL OR PDXX.DM_PRS_LST LIKE @LastName) 
		AND (@MiddleInitial IS NULL OR PDXX.DM_PRS_MID LIKE @MiddleInitial) 
		AND (@DOB IS NULL OR PDXX.DD_BRT =  REPLACE(@DOB, '%', ''))
		AND (@Phone IS NULL OR PDXX.DN_DOM_PHN_ARA + PDXX.DN_DOM_PHN_XCH + PDXX.DN_DOM_PHN_LCL LIKE @Phone OR PDXX.DN_FGN_PHN_CNY + PDXX.DN_FGN_PHN_CT + PDXX.DN_FGN_PHN_LCL LIKE @Phone) 
		AND	SUBSTRING(PDXX.DF_PRS_ID,X,X) != 'P' 
END
--X
ELSE IF @PDXX = X AND @PDXX = X AND @PDXX = X AND @PDXX = X
BEGIN
	INSERT INTO @MatchingSSNs
	SELECT DISTINCT 
		PDXX.DF_PRS_ID 
	FROM 
		PDXX_PRS_NME PDXX
		INNER JOIN PDXX_PRS_ADR PDXX
			ON PDXX.DF_PRS_ID = PDXX.DF_PRS_ID
		INNER JOIN PDXX_PRS_ADR_EML PDXX
			ON PDXX.DF_PRS_ID = PDXX.DF_PRS_ID
	WHERE 
		(@FirstName IS NULL OR PDXX.DM_PRS_X LIKE @FirstName) 
		AND (@LastName IS NULL OR PDXX.DM_PRS_LST LIKE @LastName) 
		AND (@MiddleInitial IS NULL OR PDXX.DM_PRS_MID LIKE @MiddleInitial) 
		AND (@DOB IS NULL OR PDXX.DD_BRT =  REPLACE(@DOB, '%', '')) 
		AND (@Address IS NULL OR PDXX.DX_STR_ADR_X LIKE @Address OR PDXX.DX_STR_ADR_X LIKE @Address)
		AND (@City IS NULL OR PDXX.DM_CT LIKE @City) 
		AND (@StateCode IS NULL OR PDXX.DC_DOM_ST LIKE @StateCode) 
		AND (@Zip IS NULL OR PDXX.DF_ZIP_CDE LIKE @Zip)
		AND (@Email IS NULL OR PDXX.DX_ADR_EML LIKE @Email)
		AND	SUBSTRING(PDXX.DF_PRS_ID,X,X) != 'P' 
END
--X
ELSE IF @PDXX = X AND @PDXX = X AND @PDXX = X AND @PDXX = X
BEGIN
	INSERT INTO @MatchingSSNs
	SELECT DISTINCT 
		PDXX.DF_PRS_ID 
	FROM 
		PDXX_PRS_NME PDXX
		INNER JOIN PDXX_PRS_ADR_EML PDXX
			ON PDXX.DF_PRS_ID = PDXX.DF_PRS_ID
		INNER JOIN PDXX_PRS_PHN PDXX
			ON PDXX.DF_PRS_ID = PDXX.DF_PRS_ID
	WHERE 
		(@FirstName IS NULL OR PDXX.DM_PRS_X LIKE @FirstName) 
		AND (@LastName IS NULL OR PDXX.DM_PRS_LST LIKE @LastName) 
		AND (@MiddleInitial IS NULL OR PDXX.DM_PRS_MID LIKE @MiddleInitial) 
		AND (@DOB IS NULL OR PDXX.DD_BRT =  REPLACE(@DOB, '%', '')) 
		AND (@Email IS NULL OR PDXX.DX_ADR_EML LIKE @Email)
		AND (@Phone IS NULL OR PDXX.DN_DOM_PHN_ARA + PDXX.DN_DOM_PHN_XCH + PDXX.DN_DOM_PHN_LCL LIKE @Phone OR PDXX.DN_FGN_PHN_CNY + PDXX.DN_FGN_PHN_CT + PDXX.DN_FGN_PHN_LCL LIKE @Phone) 
		AND	SUBSTRING(PDXX.DF_PRS_ID,X,X) != 'P' 
END
--X
ELSE IF @PDXX = X AND @PDXX = X AND @PDXX = X AND @PDXX = X
BEGIN
	INSERT INTO @MatchingSSNs
	SELECT DISTINCT 
		PDXX.DF_PRS_ID 
	FROM 
		PDXX_PRS_NME PDXX
		INNER JOIN PDXX_PRS_ADR PDXX
			ON PDXX.DF_PRS_ID = PDXX.DF_PRS_ID
		INNER JOIN PDXX_PRS_PHN PDXX
			ON PDXX.DF_PRS_ID = PDXX.DF_PRS_ID
	WHERE 
		(@FirstName IS NULL OR PDXX.DM_PRS_X LIKE @FirstName) 
		AND (@LastName IS NULL OR PDXX.DM_PRS_LST LIKE @LastName) 
		AND (@MiddleInitial IS NULL OR PDXX.DM_PRS_MID LIKE @MiddleInitial) 
		AND (@DOB IS NULL OR PDXX.DD_BRT =  REPLACE(@DOB, '%', '')) 
		AND (@Address IS NULL OR PDXX.DX_STR_ADR_X LIKE @Address OR PDXX.DX_STR_ADR_X LIKE @Address)
		AND (@City IS NULL OR PDXX.DM_CT LIKE @City) 
		AND (@StateCode IS NULL OR PDXX.DC_DOM_ST LIKE @StateCode) 
		AND (@Zip IS NULL OR PDXX.DF_ZIP_CDE LIKE @Zip)
		AND (@Phone IS NULL OR PDXX.DN_DOM_PHN_ARA + PDXX.DN_DOM_PHN_XCH + PDXX.DN_DOM_PHN_LCL LIKE @Phone OR PDXX.DN_FGN_PHN_CNY + PDXX.DN_FGN_PHN_CT + PDXX.DN_FGN_PHN_LCL LIKE @Phone) 
		AND	SUBSTRING(PDXX.DF_PRS_ID,X,X) != 'P' 
END
--X
ELSE IF @PDXX = X AND @PDXX = X AND @PDXX = X AND @PDXX = X
BEGIN
	INSERT INTO @MatchingSSNs
	SELECT DISTINCT 
		PDXX.DF_PRS_ID 
	FROM 
		PDXX_PRS_NME PDXX
		INNER JOIN PDXX_PRS_ADR PDXX
			ON PDXX.DF_PRS_ID = PDXX.DF_PRS_ID
		INNER JOIN PDXX_PRS_ADR_EML PDXX
			ON PDXX.DF_PRS_ID = PDXX.DF_PRS_ID
		INNER JOIN PDXX_PRS_PHN PDXX
			ON PDXX.DF_PRS_ID = PDXX.DF_PRS_ID
	WHERE 
		(@FirstName IS NULL OR PDXX.DM_PRS_X LIKE @FirstName) 
		AND (@LastName IS NULL OR PDXX.DM_PRS_LST LIKE @LastName) 
		AND (@MiddleInitial IS NULL OR PDXX.DM_PRS_MID LIKE @MiddleInitial) 
		AND (@DOB IS NULL OR PDXX.DD_BRT =  REPLACE(@DOB, '%', '')) 
		AND (@Address IS NULL OR PDXX.DX_STR_ADR_X LIKE @Address OR PDXX.DX_STR_ADR_X LIKE @Address)
		AND (@City IS NULL OR PDXX.DM_CT LIKE @City) 
		AND (@StateCode IS NULL OR PDXX.DC_DOM_ST LIKE @StateCode) 
		AND (@Zip IS NULL OR PDXX.DF_ZIP_CDE LIKE @Zip)
		AND (@Email IS NULL OR PDXX.DX_ADR_EML LIKE @Email)
		AND (@Phone IS NULL OR PDXX.DN_DOM_PHN_ARA + PDXX.DN_DOM_PHN_XCH + PDXX.DN_DOM_PHN_LCL LIKE @Phone OR PDXX.DN_FGN_PHN_CNY + PDXX.DN_FGN_PHN_CT + PDXX.DN_FGN_PHN_LCL LIKE @Phone) 
		AND	SUBSTRING(PDXX.DF_PRS_ID,X,X) != 'P' 
END
--X
ELSE IF @PDXX = X AND @PDXX = X AND @PDXX = X AND @PDXX = X
BEGIN
	INSERT INTO @MatchingSSNs
	SELECT DISTINCT 
		PDXX.DF_PRS_ID 
	FROM 
		PDXX_PRS_ADR PDXX
	WHERE 
		(@Address IS NULL OR PDXX.DX_STR_ADR_X LIKE @Address OR PDXX.DX_STR_ADR_X LIKE @Address)
		AND (@City IS NULL OR PDXX.DM_CT LIKE @City) 
		AND (@StateCode IS NULL OR PDXX.DC_DOM_ST LIKE @StateCode) 
		AND (@Zip IS NULL OR PDXX.DF_ZIP_CDE LIKE @Zip)
		AND	SUBSTRING(PDXX.DF_PRS_ID,X,X) != 'P' 
END
--XX
ELSE IF @PDXX = X AND @PDXX = X AND @PDXX = X AND @PDXX = X
BEGIN
	INSERT INTO @MatchingSSNs
	SELECT DISTINCT 
		PDXX.DF_PRS_ID 
	FROM 
		PDXX_PRS_ADR PDXX
		INNER JOIN PDXX_PRS_ADR_EML PDXX
			ON PDXX.DF_PRS_ID = PDXX.DF_PRS_ID
	WHERE 
		(@Address IS NULL OR PDXX.DX_STR_ADR_X LIKE @Address OR PDXX.DX_STR_ADR_X LIKE @Address)
		AND (@City IS NULL OR PDXX.DM_CT LIKE @City) 
		AND (@StateCode IS NULL OR PDXX.DC_DOM_ST LIKE @StateCode) 
		AND (@Zip IS NULL OR PDXX.DF_ZIP_CDE LIKE @Zip)
		AND (@Email IS NULL OR PDXX.DX_ADR_EML LIKE @Email)
		AND	SUBSTRING(PDXX.DF_PRS_ID,X,X) != 'P' 
END
--XX
ELSE IF @PDXX = X AND @PDXX = X AND @PDXX = X AND @PDXX = X
BEGIN
	INSERT INTO @MatchingSSNs
	SELECT DISTINCT 
		PDXX.DF_PRS_ID 
	FROM 
		PDXX_PRS_ADR PDXX
		INNER JOIN PDXX_PRS_PHN PDXX
			ON PDXX.DF_PRS_ID = PDXX.DF_PRS_ID
	WHERE 
		(@Address IS NULL OR PDXX.DX_STR_ADR_X LIKE @Address OR PDXX.DX_STR_ADR_X LIKE @Address)
		AND (@City IS NULL OR PDXX.DM_CT LIKE @City) 
		AND (@StateCode IS NULL OR PDXX.DC_DOM_ST LIKE @StateCode) 
		AND (@Zip IS NULL OR PDXX.DF_ZIP_CDE LIKE @Zip)
		AND (@Phone IS NULL OR PDXX.DN_DOM_PHN_ARA + PDXX.DN_DOM_PHN_XCH + PDXX.DN_DOM_PHN_LCL LIKE @Phone OR PDXX.DN_FGN_PHN_CNY + PDXX.DN_FGN_PHN_CT + PDXX.DN_FGN_PHN_LCL LIKE @Phone) 
		AND	SUBSTRING(PDXX.DF_PRS_ID,X,X) != 'P' 
END
--XX
ELSE IF @PDXX = X AND @PDXX = X AND @PDXX = X AND @PDXX = X
BEGIN
	INSERT INTO @MatchingSSNs
	SELECT DISTINCT 
		PDXX.DF_PRS_ID 
	FROM 
		PDXX_PRS_ADR PDXX
		INNER JOIN PDXX_PRS_ADR_EML PDXX
			ON PDXX.DF_PRS_ID = PDXX.DF_PRS_ID
		INNER JOIN PDXX_PRS_PHN PDXX
			ON PDXX.DF_PRS_ID = PDXX.DF_PRS_ID
	WHERE 
		(@Address IS NULL OR PDXX.DX_STR_ADR_X LIKE @Address OR PDXX.DX_STR_ADR_X LIKE @Address)
		AND (@City IS NULL OR PDXX.DM_CT LIKE @City) 
		AND (@StateCode IS NULL OR PDXX.DC_DOM_ST LIKE @StateCode) 
		AND (@Zip IS NULL OR PDXX.DF_ZIP_CDE LIKE @Zip)
		AND (@Email IS NULL OR PDXX.DX_ADR_EML LIKE @Email)
		AND (@Phone IS NULL OR PDXX.DN_DOM_PHN_ARA + PDXX.DN_DOM_PHN_XCH + PDXX.DN_DOM_PHN_LCL LIKE @Phone OR PDXX.DN_FGN_PHN_CNY + PDXX.DN_FGN_PHN_CT + PDXX.DN_FGN_PHN_LCL LIKE @Phone) 
		AND	SUBSTRING(PDXX.DF_PRS_ID,X,X) != 'P' 
END
--XX
ELSE IF @PDXX = X AND @PDXX = X AND @PDXX = X AND @PDXX = X
BEGIN
	INSERT INTO @MatchingSSNs
	SELECT DISTINCT 
		PDXX.DF_PRS_ID 
	FROM 
		PDXX_PRS_ADR_EML PDXX
	WHERE 
		(@Email IS NULL OR PDXX.DX_ADR_EML LIKE @Email)
		AND	SUBSTRING(PDXX.DF_PRS_ID,X,X) != 'P' 
END
--XX
ELSE IF @PDXX = X AND @PDXX = X AND @PDXX = X AND @PDXX = X
BEGIN
	INSERT INTO @MatchingSSNs
	SELECT DISTINCT 
		PDXX.DF_PRS_ID 
	FROM 
		PDXX_PRS_ADR_EML PDXX
		INNER JOIN PDXX_PRS_PHN PDXX
			ON PDXX.DF_PRS_ID = PDXX.DF_PRS_ID
	WHERE 
		(@Email IS NULL OR PDXX.DX_ADR_EML LIKE @Email)
		AND (@Phone IS NULL OR PDXX.DN_DOM_PHN_ARA + PDXX.DN_DOM_PHN_XCH + PDXX.DN_DOM_PHN_LCL LIKE @Phone OR PDXX.DN_FGN_PHN_CNY + PDXX.DN_FGN_PHN_CT + PDXX.DN_FGN_PHN_LCL LIKE @Phone) 
		AND	SUBSTRING(PDXX.DF_PRS_ID,X,X) != 'P' 
END
--XX
ELSE IF @PDXX = X AND @PDXX = X AND @PDXX = X AND @PDXX = X
BEGIN
	INSERT INTO @MatchingSSNs
	SELECT DISTINCT 
		PDXX.DF_PRS_ID 
	FROM 
		PDXX_PRS_PHN PDXX
	WHERE 
		(@Phone IS NULL OR PDXX.DN_DOM_PHN_ARA + PDXX.DN_DOM_PHN_XCH + PDXX.DN_DOM_PHN_LCL LIKE @Phone OR PDXX.DN_FGN_PHN_CNY + PDXX.DN_FGN_PHN_CT + PDXX.DN_FGN_PHN_LCL LIKE @Phone) 
		AND	SUBSTRING(PDXX.DF_PRS_ID,X,X) != 'P' 
END


SELECT 
	PDXX.DF_PRS_ID AS SSN, 
    MAX(LTRIM(RTRIM(PDXX.DM_PRS_X))) AS FirstName, 
    MAX(LTRIM(RTRIM(PDXX.DM_PRS_LST))) AS LastName, 
    MAX(LTRIM(RTRIM(PDXX.DM_PRS_MID))) AS MiddleInitial,  
    MAX(PDXX.DD_BRT) AS DOB, 
    MAX(PDXX.DX_STR_ADR_X) AS AddressX, 
    MAX(PDXX.DX_STR_ADR_X) AS AddressX, 
    MAX(PDXX.DM_CT) AS City,
    MAX(PDXX.DC_DOM_ST) AS StateCode, 
    MAX(PDXX.DF_ZIP_CDE) AS Zip, 
	MAX(CASE WHEN PDXX.DC_PHN = 'H' THEN ISNULL(NULLIF(PDXX.DN_DOM_PHN_ARA + ' ' + PDXX.DN_DOM_PHN_XCH + ' ' + PDXX.DN_DOM_PHN_LCL, '  '), NULLIF(DN_FGN_PHN_CNY + ' ' + DN_FGN_PHN_CT + ' ' + DN_FGN_PHN_LCL, '  ')) END) AS HomePhone,
	MAX(CASE WHEN PDXX.DC_PHN = 'H' AND PDXX.DC_ALW_ADL_PHN IN ('L','P','X')  THEN 'Y' ELSE 'N' END) AS HomePhoneConsent,
	MAX(CASE WHEN PDXX.DC_PHN = 'W' THEN ISNULL(NULLIF(PDXX.DN_DOM_PHN_ARA + ' ' + PDXX.DN_DOM_PHN_XCH + ' ' + PDXX.DN_DOM_PHN_LCL, '  '), NULLIF(DN_FGN_PHN_CNY + ' ' + DN_FGN_PHN_CT + ' ' + DN_FGN_PHN_LCL, '  ')) END) AS WorkPhone,
	MAX(CASE WHEN PDXX.DC_PHN = 'W'  AND PDXX.DC_ALW_ADL_PHN IN ('L','P','X')  THEN 'Y' ELSE 'N' END) AS WorkPhoneConsent,
	MAX(CASE WHEN PDXX.DC_PHN = 'A' THEN ISNULL(NULLIF(PDXX.DN_DOM_PHN_ARA + ' ' + PDXX.DN_DOM_PHN_XCH + ' ' + PDXX.DN_DOM_PHN_LCL, '  '), NULLIF(DN_FGN_PHN_CNY + ' ' + DN_FGN_PHN_CT + ' ' + DN_FGN_PHN_LCL, '  ')) END) AS AlternatePhone,
	MAX(CASE WHEN PDXX.DC_PHN = 'A'  AND PDXX.DC_ALW_ADL_PHN IN ('L','P','X')  THEN 'Y' ELSE 'N' END) AS AlternatePhoneConsent,
    MAX(CASE WHEN PDXX.DC_ADR_EML = 'H' THEN PDXX.DX_ADR_EML END) AS HomeEmail,
    MAX(CASE WHEN PDXX.DC_ADR_EML = 'W' THEN PDXX.DX_ADR_EML END) AS WorkEmail,
    MAX(CASE WHEN PDXX.DC_ADR_EML = 'A' THEN PDXX.DX_ADR_EML END) AS AlternateEmail
FROM
	@MatchingSSNs S
	INNER JOIN PDXX_PRS_NME PDXX
		ON PDXX.DF_PRS_ID = S.SSN
	LEFT JOIN PDXX_PRS_ADR PDXX 
		ON PDXX.DF_PRS_ID = PDXX.DF_PRS_ID
	LEFT JOIN PDXX_PRS_ADR_EML PDXX 
		ON PDXX.DF_PRS_ID = PDXX.DF_PRS_ID
	LEFT JOIN PDXX_PRS_PHN PDXX 
		ON PDXX.DF_PRS_ID = PDXX.DF_PRS_ID
 GROUP BY 
	PDXX.DF_PRS_ID

