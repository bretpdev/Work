SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
SELECT
	*
FROM OPENQUERY(DUSTER,
'
SELECT DISTINCT
	Sub.BF_SSN,
	Sub.LN_SEQ AS SubLoan,
	Unsub.LN_SEQ AS UnsubLoan,
	Sub.LF_LON_CUR_OWN AS SubOwner,
	Unsub.LF_LON_CUR_OWN AS UnsubOwner,
	Sub.LF_GTR_RFR AS SubGuarantor,
	Unsub.LF_GTR_RFR AS UnsubGuarantor
FROM
	OLWHRM1.LN10_LON Sub
	INNER JOIN OLWHRM1.LN10_LON Unsub
		ON Unsub.BF_SSN = Sub.BF_SSN
		AND Unsub.LN_SEQ != Sub.LN_SEQ
		AND Unsub.LD_LON_1_DSB = Sub.LD_LON_1_DSB
	INNER JOIN OLWHRM1.GR10_RPT_LON_APL SubGR10
		ON SubGR10.BF_SSN = Sub.BF_SSN
		AND SubGR10.LN_SEQ = Sub.LN_SEQ
	INNER JOIN OLWHRM1.GR10_RPT_LON_APL UnsubGR10
		ON UnsubGR10.BF_SSN = Unsub.BF_SSN
		AND UnsubGR10.LN_SEQ = Unsub.LN_SEQ	
WHERE
	Sub.IC_LON_PGM IN(''SUBCNS'',''SUBSPC'')
	AND Unsub.IC_LON_PGM IN(''UNCNS'',''UNSPC'')
	AND SubGR10.LF_LON_GRP_WI_BR = UnsubGR10.LF_LON_GRP_WI_BR
	AND SubGR10.LI_BR_GRP_RLP != ''Y''
	AND UnsubGR10.LI_BR_GRP_RLP != ''Y''
')