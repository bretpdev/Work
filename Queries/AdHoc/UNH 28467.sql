--R2 fixed loans
SELECT * FROM OPENQUERY (DUSTER,'
	SELECT DISTINCT 
		LN10.BF_SSN				AS SSN
		,PD10.DF_SPE_ACC_ID		AS ACCT
		,LN10.LN_SEQ			AS LOAN
		--,''82976901''			AS OWNER
		,LN10.LF_LON_CUR_OWN	AS OWNER
		,LN10.LD_LON_EFF_ADD	AS PCV_DECON
		,LN10.LD_LON_ACL_ADD	AS CONVERTED	
		,NULL					AS ACH_ADD
		,ln72.lr_itr
		,''0.25''				AS ACH_RIR
		,LN72.LR_ITR - 0.25		AS NEW_RATE
		,ln72.ld_itr_eff_beg
		,ln72.lc_itr_typ
	FROM
		OLWHRM1.LN10_LON LN10
		INNER JOIN OLWHRM1.PD10_PRS_NME PD10
			ON LN10.BF_SSN = PD10.DF_PRS_ID
		INNER JOIN 
			(
				SELECT DISTINCT 
					A.BF_SSN
					,A.LN_SEQ
					,A.LR_ITR
					,A.LC_ITR_TYP
					,B.LD_ITR_EFF_BEG
				FROM
					OLWHRM1.LN72_INT_RTE_HST A
				INNER JOIN
					(
						SELECT DISTINCT
							BF_SSN
							,LN_SEQ
							,MAX(LD_ITR_EFF_BEG) AS LD_ITR_EFF_BEG
						FROM
							OLWHRM1.LN72_INT_RTE_HST
						WHERE 
							LC_STA_LON72 = ''A''   
							AND LC_ITR_TYP NOT IN (''C1'', ''C2'', ''F2'', ''SV'')
							AND DAYS(LD_ITR_EFF_BEG) < DAYS(''09/06/2016'')
						GROUP BY
							BF_SSN
							,LN_SEQ
					) B
					ON A.BF_SSN = B.BF_SSN
					AND A.LN_SEQ = B.LN_SEQ
					AND A.LD_ITR_EFF_BEG = B.LD_ITR_EFF_BEG
				WHERE 
					LC_STA_LON72 = ''A''  
			) LN72
			ON LN10.BF_SSN = LN72.BF_SSN
			AND LN10.LN_SEQ = LN72.LN_SEQ
	WHERE
		LN10.LF_LON_CUR_OWN = ''82976901''
');

--R3 variable loans
SELECT * FROM OPENQUERY (DUSTER,'
	SELECT DISTINCT 
		LN10.BF_SSN				AS SSN
		,PD10.DF_SPE_ACC_ID		AS ACCT
		,LN10.LN_SEQ			AS LOAN
		--,''82976901''			AS OWNER
		,LN10.LF_LON_CUR_OWN	AS OWNER
		,LN10.LD_LON_EFF_ADD	AS PCV_DECON
		,LN10.LD_LON_ACL_ADD	AS CONVERTED	
		,NULL					AS ACH_ADD
		,ln72.lr_itr
		,''0.25''				AS ACH_RIR
		,LN72.LR_ITR - 0.25		AS NEW_RATE
		,ln72.ld_itr_eff_beg
		,ln72.lc_itr_typ
	FROM
		OLWHRM1.LN10_LON LN10
		INNER JOIN OLWHRM1.PD10_PRS_NME PD10
			ON LN10.BF_SSN = PD10.DF_PRS_ID
		INNER JOIN 
			(
				SELECT DISTINCT 
					A.BF_SSN
					,A.LN_SEQ
					,A.LR_ITR
					,A.LC_ITR_TYP
					,B.LD_ITR_EFF_BEG
				FROM
					OLWHRM1.LN72_INT_RTE_HST A
				INNER JOIN
					(
						SELECT DISTINCT
							BF_SSN
							,LN_SEQ
							,MAX(LD_ITR_EFF_BEG) AS LD_ITR_EFF_BEG
						FROM
							OLWHRM1.LN72_INT_RTE_HST
						WHERE 
							LC_STA_LON72 = ''A''   
							AND LC_ITR_TYP IN (''C1'', ''C2'', ''F2'', ''SV'')
							AND DAYS(LD_ITR_EFF_BEG) < DAYS(''07/01/2016'')
						GROUP BY
							BF_SSN
							,LN_SEQ
					) B
					ON A.BF_SSN = B.BF_SSN
					AND A.LN_SEQ = B.LN_SEQ
					AND A.LD_ITR_EFF_BEG = B.LD_ITR_EFF_BEG
				WHERE 
					LC_STA_LON72 = ''A''  
			) LN72
			ON LN10.BF_SSN = LN72.BF_SSN
			AND LN10.LN_SEQ = LN72.LN_SEQ
	WHERE
		LN10.LF_LON_CUR_OWN = ''82976901''
');

--R4 variable loans
SELECT * FROM OPENQUERY (DUSTER,'
	SELECT DISTINCT 
		LN10.BF_SSN				AS SSN
		,PD10.DF_SPE_ACC_ID		AS ACCT
		,LN10.LN_SEQ			AS LOAN
		--,''82976901''			AS OWNER
		,LN10.LF_LON_CUR_OWN	AS OWNER
		,LN10.LD_LON_EFF_ADD	AS PCV_DECON
		,LN10.LD_LON_ACL_ADD	AS CONVERTED	
		,NULL					AS ACH_ADD
		,ln72.lr_itr
		,''0.25''				AS ACH_RIR
		,LN72.LR_ITR - 0.25		AS NEW_RATE
		,ln72.ld_itr_eff_beg
		,ln72.lc_itr_typ
	FROM
		OLWHRM1.LN10_LON LN10
		INNER JOIN OLWHRM1.PD10_PRS_NME PD10
			ON LN10.BF_SSN = PD10.DF_PRS_ID
		INNER JOIN 
			(
				SELECT DISTINCT 
					A.BF_SSN
					,A.LN_SEQ
					,A.LR_ITR
					,A.LC_ITR_TYP
					,B.LD_ITR_EFF_BEG
				FROM
					OLWHRM1.LN72_INT_RTE_HST A
				INNER JOIN
					(
						SELECT DISTINCT
							BF_SSN
							,LN_SEQ
							,MAX(LD_ITR_EFF_BEG) AS LD_ITR_EFF_BEG
						FROM
							OLWHRM1.LN72_INT_RTE_HST
						WHERE 
							LC_STA_LON72 = ''A''   
							AND LC_ITR_TYP IN (''C1'', ''C2'', ''F2'', ''SV'')
							AND DAYS(LD_ITR_EFF_BEG) < DAYS(''09/06/2016'')
						GROUP BY
							BF_SSN
							,LN_SEQ
					) B
					ON A.BF_SSN = B.BF_SSN
					AND A.LN_SEQ = B.LN_SEQ
					AND A.LD_ITR_EFF_BEG = B.LD_ITR_EFF_BEG
				WHERE 
					LC_STA_LON72 = ''A''  
			) LN72
			ON LN10.BF_SSN = LN72.BF_SSN
			AND LN10.LN_SEQ = LN72.LN_SEQ
	WHERE
		LN10.LF_LON_CUR_OWN = ''82976901''
');