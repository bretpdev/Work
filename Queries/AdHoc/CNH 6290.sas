LIBNAME LEGEND REMOTE SERVER=LEGEND SLIBREF=WORK;
LIBNAME XL 'T:\FHP XXXX - XXXX transactions.XLSX';

DATA LEGEND.SOURCE (KEEP=BF_SSN LN_SEQ);
	SET XL._TENXX;
RUN;

RSUBMIT;
LIBNAME PKUB DBX DATABASE=DNFPUTDL OWNER=PKUB;
PROC SQL;
	CREATE TABLE ADXX_FAT AS
		SELECT
			ADXX.*
		FROM
			SOURCE SRC
			JOIN PKUB.ADXX_PCV_ATY_ADJ ADXX
				ON SRC.BF_SSN = ADXX.BF_SSN
				AND SRC.LN_SEQ = ADXX.LN_SEQ
		WHERE
			ADXX.PC_FAT_TYP = 'XX' 
			AND ADXX.PC_FAT_SUB_TYP = 'XX'
	;

	CREATE TABLE ADXX_WOF AS
		SELECT
			ADXX.*
		FROM
			SOURCE SRC
			JOIN PKUB.ADXX_PCV_ATY_ADJ ADXX
				ON SRC.BF_SSN = ADXX.BF_SSN
				AND SRC.LN_SEQ = ADXX.LN_SEQ
		WHERE
			ADXX.LC_WOF_WUP_REA IN ('A', 'K', 'L', 'M', 'Q', 'V')
	;
QUIT;
ENDRSUBMIT;

DATA ADXX_FAT; SET LEGEND.ADXX_FAT; RUN;
DATA ADXX_WOF; SET LEGEND.ADXX_WOF; RUN;

PROC EXPORT
		DATA=ADXX_FAT
		OUTFILE='T:\ADXX Table Dump.XLSX'
		REPLACE;
RUN;

PROC EXPORT
		DATA=ADXX_WOF
		OUTFILE='T:\ADXX Table Dump.XLSX'
		REPLACE;
RUN;

