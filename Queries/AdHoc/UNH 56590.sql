USE UDW



SELECT DISTINCT
	PD10.DF_SPE_ACC_ID AS ACCOUNT_NUMBER
	,LN10.LN_SEQ --added for 10/29/2020 run
FROM
	LN10_LON LN10
	INNER JOIN LN60_BR_FOR_APV LN60
		ON LN10.BF_SSN = LN60.BF_SSN
		AND LN10.LN_SEQ = LN60.LN_SEQ
	INNER JOIN FB10_BR_FOR_REQ FB10
		ON LN60.BF_SSN = FB10.BF_SSN
		AND LN60.LF_FOR_CTL_NUM = FB10.LF_FOR_CTL_NUM
	INNER JOIN PD10_PRS_NME PD10
		ON LN10.BF_SSN = PD10.DF_PRS_ID
WHERE
	LN10.IC_LON_PGM IN ('SUBCNS', 'UNCNS', 'SPCNSL', 'SUBSPC', 'UNSPC') -- change for 10/29/2020 run
--	LN10.IC_LON_PGM IN ('SUBCNS', 'UNCNS',           'SUBSPC', 'UNSPC') -- original code
	AND LN10.LA_CUR_PRI > 0
	AND LN10.LC_STA_LON10 = 'R' --added for 10/29/2020 run
	AND FB10.LC_FOR_TYP = '15'
--active flags below added fror 10/29/2020 run
	AND FB10.LC_FOR_STA = 'A'
	AND FB10.LC_STA_FOR10 = 'A'
	AND LN60.LC_STA_LON60 = 'A'
	AND LN60.LC_FOR_RSP != '003'
--lines below were commented out when code was opened from repository for 10/29/2020 run
	AND CAST(LN60.LD_FOR_BEG AS DATE) <= CAST(GETDATE() AS DATE) -- changed to <= for 10/29/2020 run
	AND CAST(LN60.LD_FOR_END AS DATE) >= CAST(GETDATE() AS DATE) -- changed to >= for 10/29/2020 run
ORDER BY
	PD10.DF_SPE_ACC_ID
	,LN10.LN_SEQ -- added for 10/29/2020 run
