SELECT DISTINCT
	PDXX.DF_PRS_ID,
	LTRIM(RTRIM(PDXX.DM_PRS_X)) AS DM_PRS_X,
	LTRIM(RTRIM(PDXX.DM_PRS_LST)) AS DM_PRS_LST
FROM
	CDW..LNXX_BR_DFR_APV LNXX
	INNER JOIN CDW..PDXX_PRS_NME PDXX
		ON PDXX.DF_PRS_ID = LNXX.BF_SSN
	INNER JOIN CDW..DFXX_BR_DFR_REQ DFXX
		ON DFXX.BF_SSN = LNXX.BF_SSN
		AND DFXX.LF_DFR_CTL_NUM = LNXX.LF_DFR_CTL_NUM
WHERE
	LNXX.LC_STA_LONXX = 'A'
	AND DFXX.LC_DFR_STA = 'A'
	AND DFXX.LC_STA_DFRXX = 'A'
	AND LNXX.LC_DFR_RSP != 'XXX'
	AND DFXX.LC_DFR_TYP = 'XX'
	AND DFXX.LD_CRT_REQ_DFR BETWEEN 'XX/XX/XXXX' AND 'XX/XX/XXXX'

SELECT DISTINCT
	PDXX.DF_PRS_ID,
	LTRIM(RTRIM(PDXX.DM_PRS_X)) AS DM_PRS_X,
	LTRIM(RTRIM(PDXX.DM_PRS_LST)) AS DM_PRS_LST
FROM
	CDW..LNXX_BR_DFR_APV LNXX
	INNER JOIN CDW..PDXX_PRS_NME PDXX
		ON PDXX.DF_PRS_ID = LNXX.BF_SSN
	INNER JOIN CDW..DFXX_BR_DFR_REQ DFXX
		ON DFXX.BF_SSN = LNXX.BF_SSN
		AND DFXX.LF_DFR_CTL_NUM = LNXX.LF_DFR_CTL_NUM
WHERE
	
	(LC_DFR_STA != 'a' or LC_DFR_RSP ='XXX')
	and DFXX.LC_DFR_TYP = 'XX'
	AND DFXX.LD_CRT_REQ_DFR BETWEEN 'XX/XX/XXXX' AND 'XX/XX/XXXX'