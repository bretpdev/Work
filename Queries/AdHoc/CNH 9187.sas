PROC IMPORT OUT= WORK.FIFTH
            DATAFILE= "T:\CS Letter-ARC.xlsx" 
            DBMS=EXCEL REPLACE;
     RANGE="XTH$"; 
     GETNAMES=YES;
     MIXED=NO;
     SCANTEXT=YES;
     USEDATE=YES;
     SCANTIME=YES;
RUN;

PROC IMPORT OUT= WORK.SIX
            DATAFILE= "T:\CS Letter-ARC.xlsx" 
            DBMS=EXCEL REPLACE;
     RANGE="XTH$"; 
     GETNAMES=YES;
     MIXED=NO;
     SCANTEXT=YES;
     USEDATE=YES;
     SCANTIME=YES;
RUN;

PROC IMPORT OUT= WORK.SEVEN
            DATAFILE= "T:\CS Letter-ARC.xlsx" 
            DBMS=EXCEL REPLACE;
     RANGE="XTH$"; 
     GETNAMES=YES;
     MIXED=NO;
     SCANTEXT=YES;
     USEDATE=YES;
     SCANTIME=YES;
RUN;

PROC IMPORT OUT= WORK.EIGHTH
            DATAFILE= "T:\CS Letter-ARC.xlsx" 
            DBMS=EXCEL REPLACE;
     RANGE="XTH$"; 
     GETNAMES=YES;
     MIXED=NO;
     SCANTEXT=YES;
     USEDATE=YES;
     SCANTIME=YES;
RUN;

PROC IMPORT OUT= WORK.NINTH
            DATAFILE= "T:\CS Letter-ARC.xlsx" 
            DBMS=EXCEL REPLACE;
     RANGE="XTH$"; 
     GETNAMES=YES;
     MIXED=NO;
     SCANTEXT=YES;
     USEDATE=YES;
     SCANTIME=YES;
RUN;

PROC IMPORT OUT= WORK.TWELVE
            DATAFILE= "T:\CS Letter-ARC.xlsx" 
            DBMS=EXCEL REPLACE;
     RANGE="XXTH$"; 
     GETNAMES=YES;
     MIXED=NO;
     SCANTEXT=YES;
     USEDATE=YES;
     SCANTIME=YES;
RUN;

PROC IMPORT OUT= WORK.ELEVENTH
            DATAFILE= "T:\CS Letter-ARC.xlsx" 
            DBMS=EXCEL REPLACE;
     RANGE="XXTH$"; 
     GETNAMES=YES;
     MIXED=NO;
     SCANTEXT=YES;
     USEDATE=YES;
     SCANTIME=YES;
RUN;

LIBNAME  LEGEND  REMOTE  SERVER=LEGEND SLIBREF=WORK;
DATA LEGEND.FIFTH; *Send data to Duster;
SET FIFTH;
RUN;

DATA LEGEND.SIX; *Send data to Duster;
SET SIX;
RUN;

DATA LEGEND.SEVEN; *Send data to Duster;
SET SEVEN;
RUN;

DATA LEGEND.EIGHTH; *Send data to Duster;
SET EIGHTH;
RUN;

DATA LEGEND.NINTH; *Send data to Duster;
SET NINTH;
RUN;

DATA LEGEND.ELEVENTH; *Send data to Duster;
SET ELEVENTH;
RUN;

DATA LEGEND.TWELVE; *Send data to Duster;
SET TWELVE;
RUN;

RSUBMIT;
LIBNAME PKUB DBX DATABASE=DNFPUTDL OWNER=PKUB;
PROC SQL;
	CREATE TABLE FIFTH_REMOTE AS
		SELECT DISTINCT
			DF_SPE_ACC_ID,
			BF_SSN,
			LD_ATY_REQ_RCV,
			D.LETTERID,
			D.ARC
		FROM
			 FIFTH D
		INNER JOIN PKUB.AYXX_BR_LON_ATY AYXX
			ON AYXX.PF_REQ_ACT = D.ARC
			AND AYXX.LD_ATY_REQ_RCV = INPUT('XX/XX/XXXX', MMDDYYXX.) 
		INNER JOIN PKUB.PDXX_PRS_NME PDXX
			ON PDXX.DF_PRS_ID = AYXX.BF_SSN
;
QUIT;

PROC SQL;
	CREATE TABLE SIX_REMOTE AS
		SELECT DISTINCT
			DF_SPE_ACC_ID,
			BF_SSN,
			LD_ATY_REQ_RCV,
			D.LETTERID,
			D.ARC
		FROM
			 SIX D
		INNER JOIN PKUB.AYXX_BR_LON_ATY AYXX
			ON AYXX.PF_REQ_ACT = D.ARC
			AND AYXX.LD_ATY_REQ_RCV = INPUT('XX/XX/XXXX', MMDDYYXX.) 
		INNER JOIN PKUB.PDXX_PRS_NME PDXX
			ON PDXX.DF_PRS_ID = AYXX.BF_SSN
;
QUIT;

PROC SQL;
	CREATE TABLE SEVEN_REMOTE AS
		SELECT DISTINCT
			DF_SPE_ACC_ID,
			BF_SSN,
			LD_ATY_REQ_RCV,
			D.LETTERID,
			D.ARC
		FROM
			 SEVEN D
		INNER JOIN PKUB.AYXX_BR_LON_ATY AYXX
			ON AYXX.PF_REQ_ACT = D.ARC
			AND AYXX.LD_ATY_REQ_RCV = INPUT('XX/XX/XXXX', MMDDYYXX.) 
		INNER JOIN PKUB.PDXX_PRS_NME PDXX
			ON PDXX.DF_PRS_ID = AYXX.BF_SSN
;
QUIT;

PROC SQL;
	CREATE TABLE EIGHTH_REMOTE AS
		SELECT DISTINCT
			DF_SPE_ACC_ID,
			BF_SSN,
			LD_ATY_REQ_RCV,
			D.LETTERID,
			D.ARC
		FROM
			 EIGHTH D
		INNER JOIN PKUB.AYXX_BR_LON_ATY AYXX
			ON AYXX.PF_REQ_ACT = D.ARC
			AND AYXX.LD_ATY_REQ_RCV = INPUT('XX/XX/XXXX', MMDDYYXX.) 
		INNER JOIN PKUB.PDXX_PRS_NME PDXX
			ON PDXX.DF_PRS_ID = AYXX.BF_SSN
;
QUIT;

PROC SQL;
	CREATE TABLE NINTH_REMOTE AS
		SELECT DISTINCT
			DF_SPE_ACC_ID,
			BF_SSN,
			LD_ATY_REQ_RCV,
			D.LETTERID,
			D.ARC
		FROM
			 NINTH D
		INNER JOIN PKUB.AYXX_BR_LON_ATY AYXX
			ON AYXX.PF_REQ_ACT = D.ARC
			AND AYXX.LD_ATY_REQ_RCV = INPUT('XX/XX/XXXX', MMDDYYXX.) 
		INNER JOIN PKUB.PDXX_PRS_NME PDXX
			ON PDXX.DF_PRS_ID = AYXX.BF_SSN
;
QUIT;

PROC SQL;
	CREATE TABLE ELEVENTH_REMOTE AS
		SELECT DISTINCT
			DF_SPE_ACC_ID,
			BF_SSN,
			LD_ATY_REQ_RCV,
			D.LETTERID,
			D.ARC
		FROM
			 ELEVENTH D
		INNER JOIN PKUB.AYXX_BR_LON_ATY AYXX
			ON AYXX.PF_REQ_ACT = D.ARC
			AND AYXX.LD_ATY_REQ_RCV = INPUT('XX/XX/XXXX', MMDDYYXX.) 
		INNER JOIN PKUB.PDXX_PRS_NME PDXX
			ON PDXX.DF_PRS_ID = AYXX.BF_SSN
;
QUIT;

PROC SQL;
	CREATE TABLE TWELEVE_REMOTE AS
		SELECT DISTINCT
			DF_SPE_ACC_ID,
			BF_SSN,
			LD_ATY_REQ_RCV,
			D.LETTERID,
			D.ARC
		FROM
			 TWELVE D
		INNER JOIN PKUB.AYXX_BR_LON_ATY AYXX
			ON AYXX.PF_REQ_ACT = D.ARC
			AND AYXX.LD_ATY_REQ_RCV = INPUT('XX/XX/XXXX', MMDDYYXX.) 
		INNER JOIN PKUB.PDXX_PRS_NME PDXX
			ON PDXX.DF_PRS_ID = AYXX.BF_SSN
;
QUIT;
ENDRSUBMIT;

DATA FIFTH_REMOTE;
SET LEGEND.FIFTH_REMOTE;
RUN;

DATA SIX_REMOTE;
SET LEGEND.SIX_REMOTE;
RUN;

DATA SEVEN_REMOTE;
SET LEGEND.SEVEN_REMOTE;
RUN;

DATA EIGHTH_REMOTE;
SET LEGEND.EIGHTH_REMOTE;
RUN;

DATA NINTH_REMOTE;
SET LEGEND.NINTH_REMOTE;
RUN;

DATA ELEVENTH_REMOTE;
SET LEGEND.ELEVENTH_REMOTE;
RUN;

DATA TWELEVE_REMOTE;
SET LEGEND.TWELEVE_REMOTE;
RUN;

DATA FINAL;
SET FIFTH_REMOTE SIX_REMOTE SEVEN_REMOTE EIGHTH_REMOTE NINTH_REMOTE ELEVENTH_REMOTE TWELEVE_REMOTE;
RUN;

%LET CDW = %STR(REQUIRED="FILEDSN=X:\PADR\ODBC\CDW.dsn; update_lock_typ=nolock; bl_keepnulls=no");
LIBNAME CDW ODBC &CDW ;

PROC SQL;
	INSERT INTO CDW.LTXX_LetterRequests (DF_SPE_ACC_ID, RT_RUN_SRT_PRC, RN_SEQ_LTR_CRT_PRC, RN_SEQ_REC_PRC, RM_DSC_LTR_PRC,RF_SBJ_PRC,RX_REQ_ARA_X_PRC)
	SELECT
		DF_SPE_ACC_ID,
		'XX-XX-XXXX',
		X,
		X,
		LETTERID,
		BF_SSN,
		''
	FROM
		FINAL
;
QUIT;


/**/
/*PROC EXPORT DATA = WORK.FIFTH_REMOTE */
/*            OUTFILE = "T:\NH XXXX.xlsx" */
/*            DBMS = EXCEL*/
/*			REPLACE;*/
/*     SHEET="XTH"; */
/*RUN;*/
/**/
/*PROC EXPORT DATA = WORK.SIX_REMOTE */
/*            OUTFILE = "T:\NH XXXX.xlsx" */
/*            DBMS = EXCEL*/
/*			REPLACE;*/
/*     SHEET="XTH"; */
/*RUN;*/
/**/
/*PROC EXPORT DATA = WORK.SEVEN_REMOTE */
/*            OUTFILE = "T:\NH XXXX.xlsx" */
/*            DBMS = EXCEL*/
/*			REPLACE;*/
/*     SHEET="XTH"; */
/*RUN;*/
/**/
/*PROC EXPORT DATA = WORK.EIGHTH_REMOTE */
/*            OUTFILE = "T:\NH XXXX.xlsx" */
/*            DBMS = EXCEL*/
/*			REPLACE;*/
/*     SHEET="XTH"; */
/*RUN;*/
/**/
/*PROC EXPORT DATA = WORK.NINTH_REMOTE */
/*            OUTFILE = "T:\NH XXXX.xlsx" */
/*            DBMS = EXCEL*/
/*			REPLACE;*/
/*     SHEET="XTH"; */
/*RUN;*/
/*PROC EXPORT DATA = WORK.ELEVENTH_REMOTE */
/*            OUTFILE = "T:\NH XXXX.xlsx" */
/*            DBMS = EXCEL*/
/*			REPLACE;*/
/*     SHEET="XXTH"; */
/*RUN;*/
/*PROC EXPORT DATA = WORK.TWELEVE_REMOTE */
/*            OUTFILE = "T:\NH XXXX.xlsx" */
/*            DBMS = EXCEL*/
/*			REPLACE;*/
/*     SHEET="XXTH"; */
/*RUN;*/
/**/
/**/
/*LIBNAME  LEGEND  REMOTE  SERVER=LEGEND SLIBREF=work  ;*/
/*RSUBMIT LEGEND;*/
/*/*%let DB = DNFPRQUT;  *This is test;*/*/
/*/*%let DB = DNFPRUUT;  *This is VUKX test;*/*/
/*%let DB = DNFPUTDL;  *This is live;*/
/**/
/*LIBNAME PKUB DBX DATABASE=&DB OWNER=PKUB;*/
/**/
/*PROC SQL;*/
/*	CONNECT TO DBX (DATABASE=&DB);*/
/**/
/*	CREATE TABLE DEMO AS*/
/*		SELECT	*/
/*			**/
/*		FROM	*/
/*			CONNECTION TO DBX */
/*				(*/
/*					SELECT DISTINCT*/
/*						AYXX.BF_SSN,*/
/*						AYXX.PF_REQ_ACT,*/
/*						AYXX.LD_ATY_REQ_RCV,*/
/*						ACXX.PF_LTR*/
/*					FROM*/
/*						PKUB.AYXX_BR_LON_ATY AYXX*/
/*						INNER JOIN PKUB.ACXX_ACT_REQ_LTR ACXX*/
/*							ON ACXX.PF_REQ_ACT = AYXX.PF_REQ_ACT*/
/*					WHERE*/
/*						DAYS(AYXX.LD_ATY_REQ_RCV) BETWEEN DAYS('XX/XX/XXXX') AND DAYS('XX/XX/XXXX')*/
/**/
/*					FOR READ ONLY WITH UR*/
/*				)*/
/*	;*/
/**/
/*	DISCONNECT FROM DBX;*/
/**/
/*	/*%PUT  SQLXRC= >>> &SQLXRC <<< ||| SQLXMSG= >>> &SQLXMSG >>> ;  ** INCLUDES ERROR MESSAGES TO SAS LOG  ;*/*/
/*	/*%SQLCHECK;*/*/
/*QUIT;*/
/*ENDRSUBMIT;*/
/**/
/*DATA DEMO;*/
/*SET LEGEND.DEMO;*/
/*RUN;*/
/**/
/**/
