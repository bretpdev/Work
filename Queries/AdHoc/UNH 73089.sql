DECLARE @TEMP TABLE(SSN VARCHAR(9), LastName VARCHAR(50), FirstName VARCHAR(50), MiddleName VARCHAR(50))
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('006863952','HANSEN','ERIK','L')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('018641354','SEPULVEDA','ERIKA','')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('036546056','GREENE','KRISTIN','A')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('038527316','COMELLA','MEGAN','E')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('072600061','JANICKE','ANGELA','')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('082687845','HART','JENNIFER','')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('136767360','HERNANDEZ','RICARDO','')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('149389547','HOLLIS','KERRY','')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('223619269','O''NEAL','DYAN','C')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('225278796','BROWN','JARED','J')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('240434700','PATE','NATHAN','')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('254512165','DAY','STEPHEN','M')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('268924567','JENSEN','LAURA','')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('284865302','FISHER','JEREMY','K')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('356802373','MILLER','AMANDA','B')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('402234066','HARDY','TERRILYNN','L')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('440983084','KER','JESSICA','')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('450551329','JOHNSON','WENDY','')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('460710136','WERDER','BRANDI','M')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('471046611','RYAN','GRETCHEN','A')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('514903494','FALKINBURG','KRYSTAL','L')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('516902036','WIMBER','STEPHANIE','H')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('518087031','MARTIN','TYLER','B')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('519880487','MITCHELL','JESSICA','')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('524418261','KELTNER','MARTALIE','')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('526717051','JERRY','SHARLINDA','')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('528252257','BUCKNER','CHRIS','')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('528337651','ANDERSON','CASEY','M')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('528390729','BAILEY','MARIANNE','')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('528493051','WATKINS','CODY','JUSTIN')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('528517070','ANDERSON','ANDREA','')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('528575132','JOHNSON','CHRISTOPHER','K')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('528611514','MILLER','JESSE','')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('528790950','OWENS','CARLY','D')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('528791983','WALKER','GARETT','R')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('528798276','LEIFSON','NATHAN','')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('528816669','DAVIS','CHRISTINA','')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('528817481','SMITH','CELESTE','R')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('528837649','PETTINGILL','JOANN','L')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('528895630','SUNDBERG','JOSHUA','')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('528958760','JONES','ETHAN','S')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('529049493','ROBERTS','PRISCILLA','')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('529236610','HARMON','PAT','')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('529359569','CAMPBELL','NICHOLE','')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('529394226','FARMER','DARLA','C')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('529394866','HEAPS','NATASHA','L')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('529435095','HUMISTON','WARREN','J')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('529453771','QUILTER','CHRISTOPHER','M')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('529488267','ROMYN','FRED','')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('529532154','THORPE','STEWART','N')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('529775860','ANDERSON','MITCHELL','K')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('529779419','SPENCER','AVERY','R')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('529796444','HICKEN','CHRISTI','A')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('529857112','LINDOW','JOSHUA','M')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('529918562','MILLS','KRISTINA','')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('529918872','FLYNN','JENNIFER','C')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('529948136','COOK','CHERYL','A')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('530772932','BOEMIO','TARA','P')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('531151347','HEISS','STEVEN','P')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('533116216','CHRISTENSEN','JOSHUA','J')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('545155662','GALYEAN','LINDA','D')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('547732011','MALUNGAHU','JAMIE','T')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('549577354','HARP','JENIFER','')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('556855623','NINEFELDT','ROBIN','L')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('562990548','MACIAS','CASSANDRA','M')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('564470880',NULL,'HANDY','')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('564789295','SWAYZE','DEIRDRE','A')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('567936618','LASHBROOK','KRISTEN','M')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('570878113','BURK','MONICA','L')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('574629919','SMITH','CHARLEY','L')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('574805133','SCOTT','JODI','L')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('575418912','NGATUVAI','LUSE','')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('585636456','BROWN','MEGAN','L')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('600179142','WOOD','NICOLE','L')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('601388118','SENZIG','LILIANA','Z')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('601444261','NUTTALL','SARAH','')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('601601520','COLBERT','HELEN','')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('609166876','SANDOVAL','JOEL','')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('619366666','MEYST','SILVIA','')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('620269249','BERNARDY','MATTHEW','D')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('623053793','EAKENS','JENNIFER','')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('624366326','GERY','MEGAN','')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('625095941','BRYANT','MICHAEL','L')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('637074192','KILLGORE','JOANNA','M')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('646050701','LEAVITT','RYAN','M')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('646144948','PARE','ANGELICA','')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('646385662','SHAHSAVAR','MOJAN','P')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('647325665','NIKNAM','RUTH','')
INSERT INTO @TEMP(SSN, LastName, FirstName, MiddleName) VALUES('647606792','LOW','ANDREW','A')

SELECT 
	T.SSN,
	CASE WHEN LTRIM(RTRIM(ISNULL(PD01.DM_PRS_1,''))) != LTRIM(RTRIM(ISNULL(T.FirstName,''))) THEN 'FirstNameMismatch'
	     WHEN LTRIM(RTRIM(ISNULL(PD01.DM_PRS_LST,''))) != LTRIM(RTRIM(ISNULL(T.LastName,''))) THEN 'LastNameMismatch'
		 WHEN LTRIM(RTRIM(ISNULL(PD01.DM_PRS_MID,''))) != LTRIM(RTRIM(ISNULL(T.MiddleName,''))) THEN 'MidNameMismatch'
		 ELSE 'No Difference'
	END AS Difference,
	CASE WHEN LTRIM(RTRIM(ISNULL(PD01.DM_PRS_1,''))) != LTRIM(RTRIM(ISNULL(T.FirstName,''))) THEN 2
	     WHEN LTRIM(RTRIM(ISNULL(PD01.DM_PRS_LST,''))) != LTRIM(RTRIM(ISNULL(T.LastName,''))) THEN 3
		 WHEN LTRIM(RTRIM(ISNULL(PD01.DM_PRS_MID,''))) != LTRIM(RTRIM(ISNULL(T.MiddleName,''))) THEN 4
		 ELSE 1
	END AS OrderField,
	LTRIM(RTRIM(ISNULL(PD01.DM_PRS_1,''))) AS SystemFirstName,
	LTRIM(RTRIM(ISNULL(T.FirstName,''))) AS FsaFirstName,
	LTRIM(RTRIM(ISNULL(PD01.DM_PRS_LST,''))) AS SystemLastName,
	LTRIM(RTRIM(ISNULL(T.LastName,''))) AS FsaLastName,
	LTRIM(RTRIM(ISNULL(PD01.DM_PRS_MID,''))) AS SystemMiddleName,
	LTRIM(RTRIM(ISNULL(T.MiddleName,''))) AS FsaMiddleName
FROM 
	ODW..PD01_PDM_INF PD01 
	INNER JOIN @TEMP T 
		ON T.SSN = PD01.DF_PRS_ID
ORDER BY
	OrderField

