LIBNAME DUSTER REMOTE SERVER=DUSTER SLIBREF=WORK;
RSUBMIT;
LIBNAME OLWHRM1 DB2 DATABASE=DLGSUTWH OWNER=OLWHRM1;

PROC SQL;
	CREATE TABLE DEMO AS
		SELECT DISTINCT	
			A.BF_SSN
		FROM	
			OLWHRM1.LN10_LON A
			INNER JOIN OLWHRM1.PD10_PRS_NME B
				ON A.BF_SSN = B.DF_PRS_ID
			INNER JOIN OLWHRM1.DW01_DW_CLC_CLU C
				ON A.BF_SSN = C.BF_SSN
				AND A.LN_SEQ = C.LN_SEQ
		WHERE	
			A.LC_STA_LON10 = 'R'
			AND A.LA_CUR_PRI > 0
			AND	C.WC_DW_LON_STA IN ('03','07','09','10','11','13','14','15','23','98')
			AND A.IC_LON_PGM NOT IN ('DLUCNS', 'DLSCNS', 'CNSLDN', 'DSCON', 'DLUSPL', 'DUCON', 'SPCNSL', 
							'SUBCNS', 'SUBSPC', 'UNCNS', 'DLSPCN', 'DLSSPL', 'DLCNSL', 'DLPCNS', 
							'UNSPC', 'DLSCST', 'DLSCUN', 'DLSCPL', 'DLSCPG', 'DLSCSL', 'DLSCSC', 'DLSCUC', 'DLSCCN')
	;
ENDRSUBMIT;

DATA DEMO; SET DUSTER.DEMO; RUN;

PROC EXPORT DATA= WORK.DEMO
            OUTFILE= "T:\SAS\NH 19589.xlsx" 
            DBMS=EXCEL REPLACE;
RUN;
