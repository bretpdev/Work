--borrowers with at least one loan in active PFH
SELECT * FROM OPENQUERY (DUSTER,'
	SELECT DISTINCT
		LN65.*
	FROM
		OLWHRM1.LN65_LON_RPS LN65
		INNER JOIN OLWHRM1.LN10_LON LN10
			ON LN65.BF_SSN = LN10.BF_SSN
			AND LN65.LN_SEQ = LN10.LN_SEQ
	WHERE
		LN65.LC_TYP_SCH_DIS = ''IB''
		AND LN65.LC_STA_LON65 = ''A''
		AND LN10.LA_CUR_PRI > 0
		AND LN10.LC_STA_LON10 = ''R''
');

SELECT * FROM OPENQUERY (DUSTER,'
	SELECT 
		COUNT(DISTINCT LN65.BF_SSN) AS PFH_COUNT
	FROM
		OLWHRM1.LN65_LON_RPS LN65
		INNER JOIN OLWHRM1.LN10_LON LN10
			ON LN65.BF_SSN = LN10.BF_SSN
			AND LN65.LN_SEQ = LN10.LN_SEQ
	WHERE
		LN65.LC_TYP_SCH_DIS = ''IB''
		AND LN65.LC_STA_LON65 = ''A''
		AND LN10.LA_CUR_PRI > 0
		AND LN10.LC_STA_LON10 = ''R''
');

--borrowers with at least one loan in active PERM STAND
SELECT * FROM OPENQUERY (DUSTER,'
	SELECT DISTINCT
		LN65.*
	FROM
		OLWHRM1.LN65_LON_RPS LN65
		INNER JOIN OLWHRM1.LN10_LON LN10
			ON LN65.BF_SSN = LN10.BF_SSN
			AND LN65.LN_SEQ = LN10.LN_SEQ
	WHERE
		LN65.LC_TYP_SCH_DIS = ''IL''
		AND LN65.LC_STA_LON65 = ''A''
		AND LN10.LA_CUR_PRI > 0
		AND LN10.LC_STA_LON10 = ''R''
');

SELECT * FROM OPENQUERY (DUSTER,'
	SELECT
		COUNT(DISTINCT LN65.BF_SSN) AS PERMSTAND_COUNT
	FROM
		OLWHRM1.LN65_LON_RPS LN65
		INNER JOIN OLWHRM1.LN10_LON LN10
			ON LN65.BF_SSN = LN10.BF_SSN
			AND LN65.LN_SEQ = LN10.LN_SEQ
	WHERE
		LN65.LC_TYP_SCH_DIS = ''IL''
		AND LN65.LC_STA_LON65 = ''A''
		AND LN10.LA_CUR_PRI > 0
		AND LN10.LC_STA_LON10 = ''R''
');