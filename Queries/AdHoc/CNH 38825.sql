SELECT DISTINCT
	PDXX.DF_SPE_ACC_ID,
	WQXX.WF_QUE,
	WQXX.WF_SUB_QUE,
	WQXX.WD_ACT_REQ AS TaskRequestDate,
	WQXX.WF_USR_ASN_BY_TSK AS TaskRequesterId,
	FBXX.LC_FOR_TYP AS ForbearanceType,
	CONVERT(DATE,LNXX.LD_FOR_APL) AS LD_FOR_APL,
	CONVERT(DATE,LNXX.LD_FOR_BEG) AS LD_FOR_BEG,
	CONVERT(DATE,LNXX.LD_FOR_END) AS LD_FOR_END,
	FBXX.LF_USR_CRT_REQ_FOR AS ForbearanceRequesterId
FROM
	CDW..FBXX_BR_FOR_REQ FBXX
	INNER JOIN CDW..LNXX_BR_FOR_APV LNXX
		ON FBXX.BF_SSN = LNXX.BF_SSN
		AND FBXX.LF_FOR_CTL_NUM = LNXX.LF_FOR_CTL_NUM
	INNER JOIN CDW..PDXX_PRS_NME PDXX
		ON PDXX.DF_PRS_ID = FBXX.BF_SSN
	INNER JOIN CDW..WQXX_TSK_QUE WQXX
		ON WQXX.BF_SSN = FBXX.BF_SSN
WHERE
	WQXX.WF_QUE = 'VB'
	AND WQXX.WF_SUB_QUE = 'FB'
	AND WQXX.WC_STA_WQUEXX NOT IN ('X','C')
	AND CAST(LNXX.LD_FOR_APL AS DATE) >= CAST(WQXX.WF_CRT_DTS_WQXX AS DATE)
	AND LNXX.LC_FOR_RSP != 'XXX'
	AND LNXX.LC_STA_LONXX = 'A'
	AND FBXX.LC_FOR_STA = 'A'
	AND FBXX.LC_STA_FORXX = 'A'
	AND FBXX.LC_FOR_TYP IN ('XX','XX')
ORDER BY
	PDXX.DF_SPE_ACC_ID,
	TaskRequestDate,
	LD_FOR_BEG,
	LD_FOR_END
;

