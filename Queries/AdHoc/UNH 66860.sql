--select * from uls.dasforbfed.Disasters
select 
	FORB.*
	--PQ.* 
from 
	uls.dasforbfed.ProcessQueue pq
	INNER JOIN 
	(
		SELECT DISTINCT
			FB10.BF_SSN,
			FB10.LF_FOR_CTL_NUM,
			FB10.LC_FOR_TYP AS OLD_LC_FOR_TYP,
			'40' AS NEW_LC_FOR_TYP,
			'CURRENT DATETIME' AS LF_LST_DTS_FB10,
			PD10.DF_SPE_ACC_ID
		FROM
			UDW..FB10_BR_FOR_REQ FB10
			INNER JOIN UDW..PD10_PRS_NME PD10
				ON PD10.DF_PRS_ID = FB10.BF_SSN
			INNER JOIN UDW..LN60_BR_FOR_APV LN60
				ON LN60.BF_SSN = FB10.BF_SSN
				AND LN60.LF_FOR_CTL_NUM = FB10.LF_FOR_CTL_NUM
			INNER JOIN UDW..LN10_LON LN10
				ON LN10.BF_SSN = LN60.BF_SSN
				AND LN10.LN_SEQ = LN60.LN_SEQ
				AND LN10.LA_CUR_PRI > 0
				AND LN10.LC_STA_LON10 = 'R'
		WHERE
			LN60.LC_STA_LON60 = 'A'
			AND FB10.LC_STA_FOR10 = 'A'
			AND FB10.LC_FOR_STA = 'A' --denied records cant have this active
			AND LN60.LC_FOR_RSP != '003'
			AND FB10.LC_FOR_TYP = '39'
			AND CAST(GETDATE() AS DATE)  BETWEEN CAST(LN60.LD_FOR_BEG AS DATE) AND CAST(LN60.LD_FOR_END AS DATE)
			AND LF_USR_CRT_REQ_FOR   IN (
			'UT01886',
'UT01887',
'UT01888',
'UT01889',
'UT01890',
'UT01891',
'UT01892',
'UT01893',
'UT01894',
'UT01895',
'UT01896',
'UT01897',
'UT01898',
'UT01899',
'UT01900',
'UT01901',
'UT01902',
'UT01903',
'UT01904',
'UT01885',
'UT01648',
'UT01649',
'UT01650',
'UT01651',
'UT01652',
'UT00204',
'UT00205',
'UT00221',
'UT00314',
'UT00553',
'UT00554',
'UT00555',
'UT00564',
'UT00801',
'UT00802',
'UT00803',
'UT00804',
'UT00805',
'UT00806',
'UT00807',
'UT00808',
'UT00809',
'UT00810')
	) FORB
		ON FORB.DF_SPE_ACC_ID = PQ.AccountNumber
		
where 
	DisasterId in 
	(
		32,
		33,
		34,
		35,
		36,
		37,
		38,
		39,
		40,
		41,
		42,
		43
	)