--run on UHEAASQLDB
USE ULS
GO

BEGIN TRY
	BEGIN TRANSACTION;

		DECLARE @ROWCOUNT INT = 0
				,@ExpectedRowCount INT = 3305 --# of distinct zips + 1 disaster forb
				,@Disaster VARCHAR(100) = 'COVID-19 Pandemic WA/CA (DR-4481/4482)'
				,@BeginDate DATE = CONVERT(DATE,'20200322') --INCIDENT start date (not declaration date!)
				,@AddedBy VARCHAR(50) = 'UNH 66752' --change to current NH ticket
				,@DisasterID_initial INT = (SELECT MAX(DisasterId)+1 FROM dasforbfed.Disasters);

		--SET IDENTITY_INSERT [dasforbfed].[Disasters] ON; --OPSDEV ONLY

			INSERT INTO [dasforbfed].[Disasters] (DisasterId, Disaster, BeginDate, EndDate, MaxEndDate, Active, AddedBy)
			VALUES(@DisasterID_initial, @Disaster, @BeginDate, DATEADD(DAY, 89, @BeginDate), DATEADD(DAY, 89, @BeginDate), 1, @AddedBy);--1
			-- Save/Set the row count from the previously executed statement
			SELECT @ROWCOUNT = @@ROWCOUNT;		
		
		--SET IDENTITY_INSERT [dasforbfed].[Disasters] OFF; --OPSDEV ONLY
		
		--Affected zip codes:
		DECLARE @DisasterID INT = (SELECT DisasterId FROM dasforbfed.Disasters WHERE Disaster = @Disaster);
	
		DECLARE @Zips1 TABLE (ZipCode VARCHAR(5));
		INSERT INTO @Zips1 (ZipCode) VALUES
('99006'),
('98239'),
('98251'),
('98398'),
('98141'),
('98370'),
('98029'),
('98158'),
('98925'),
('98395'),
('99322'),
('98256'),
('99114'),
('98058'),
('99141'),
('98245'),
('98859'),
('98597'),
('99252'),
('98283'),
('98331'),
('98402'),
('98406'),
('98605'),
('98267'),
('98565'),
('98292'),
('98144'),
('98006'),
('98213'),
('98022'),
('98376'),
('98231'),
('99020'),
('98846'),
('98122'),
('98055'),
('98411'),
('98191'),
('98378'),
('98941'),
('98664'),
('99204'),
('98125'),
('98233'),
('98566'),
('98009'),
('98546'),
('98004'),
('98108'),
('98907'),
('99161'),
('98499'),
('99203'),
('98511'),
('98544'),
('98637'),
('98647'),
('99156'),
('98277'),
('99027'),
('98101'),
('99371'),
('99338'),
('98530'),
('99131'),
('99207'),
('98508'),
('99228'),
('99220'),
('98015'),
('98008'),
('99124'),
('98903'),
('98028'),
('98536'),
('98845'),
('98621'),
('98849'),
('99155'),
('98939'),
('99160'),
('98481'),
('99401'),
('98332'),
('99143'),
('98114'),
('98107'),
('98837'),
('98002'),
('99352'),
('98812'),
('98168'),
('98071'),
('99147'),
('98668'),
('99118'),
('99003'),
('98466'),
('98843'),
('98294'),
('99004'),
('98161'),
('98165'),
('98606'),
('98591'),
('98339'),
('98498'),
('98127'),
('98522'),
('98264'),
('98134'),
('98343'),
('99335'),
('98539'),
('98338'),
('98626'),
('98274'),
('99354'),
('98560'),
('98131'),
('98031'),
('98366'),
('98685'),
('98258'),
('99039'),
('98007'),
('98934'),
('98342'),
('99171'),
('99159'),
('99217'),
('98365'),
('98115'),
('98045'),
('98541'),
('98490'),
('99164'),
('98052'),
('98207'),
('99402'),
('98650'),
('98674'),
('98346'),
('98113'),
('98686'),
('98337'),
('99321'),
('99139'),
('99324'),
('98046'),
('99169'),
('98252'),
('99363'),
('98509'),
('98943'),
('98409'),
('98145'),
('98535'),
('99034'),
('98226'),
('98512'),
('98229'),
('99260'),
('99211'),
('98524'),
('98237'),
('99215'),
('99151'),
('98133'),
('99218'),
('98559'),
('99110'),
('98403'),
('99216'),
('98310'),
('98335'),
('99019'),
('98001'),
('98675'),
('98190'),
('98198'),
('99040'),
('98589'),
('98109'),
('98327'),
('99117'),
('98329'),
('99320'),
('98155'),
('99032'),
('99025'),
('98290'),
('99223'),
('98330'),
('98516'),
('98619'),
('98124'),
('98392'),
('98005'),
('98935'),
('98641'),
('98407'),
('98464'),
('98568'),
('98572'),
('98030'),
('98571'),
('98362'),
('98569'),
('98199'),
('98013'),
('98382'),
('98431'),
('99323'),
('98349'),
('99350'),
('99016'),
('99302'),
('99123'),
('98230'),
('99208'),
('98802'),
('98575'),
('99109'),
('99022'),
('98340'),
('98416'),
('99224'),
('98552'),
('99119'),
('98116'),
('98532'),
('98816'),
('98412'),
('98240'),
('98801'),
('98817'),
('99301'),
('98391'),
('98829'),
('98201'),
('99343'),
('99213'),
('98024'),
('98576'),
('98670'),
('98270'),
('98595'),
('98640'),
('99135'),
('98663'),
('98821'),
('98946'),
('98082'),
('98249'),
('98062'),
('98814'),
('98609'),
('98404'),
('98043'),
('98932'),
('98059'),
('98238'),
('98257'),
('98629'),
('99031'),
('98505'),
('98447'),
('98303'),
('98065'),
('98063'),
('98920'),
('98164'),
('98682'),
('99009'),
('99138'),
('98419'),
('98548'),
('98823'),
('98448'),
('98129'),
('98438'),
('98351'),
('98297'),
('98507'),
('98280'),
('98387'),
('98540'),
('98139'),
('98072'),
('98639'),
('98104'),
('99256'),
('98588'),
('98952'),
('98413'),
('99103'),
('98276'),
('98531'),
('98263'),
('98901'),
('99023'),
('98295'),
('99330'),
('98556'),
('98938'),
('98023'),
('98581'),
('99166'),
('98344'),
('98533'),
('98645'),
('98381'),
('98502'),
('99105'),
('98909'),
('98852'),
('99113'),
('98822'),
('98557'),
('99361'),
('99345'),
('99258'),
('98937'),
('98042'),
('99134'),
('98235'),
('98003'),
('98146'),
('98148'),
('99012'),
('98415'),
('98930'),
('98592'),
('98604'),
('98418'),
('99205'),
('98933'),
('98590'),
('99328'),
('98359'),
('98110'),
('98848'),
('99137'),
('98602'),
('99163'),
('99014'),
('98278'),
('98019'),
('98596'),
('99008'),
('98324'),
('98354'),
('98020'),
('99128'),
('98203'),
('98367'),
('99140'),
('98323'),
('98550'),
('98272'),
('98430'),
('98064'),
('98288'),
('98073'),
('98390'),
('98904'),
('98612'),
('99005'),
('98244'),
('98666'),
('98279'),
('98840'),
('98547'),
('98026'),
('98538'),
('98011'),
('98497'),
('98648'),
('99344'),
('98601'),
('98126'),
('99116'),
('98255'),
('98356'),
('99360'),
('99029'),
('98616'),
('99336'),
('99148'),
('98858'),
('98068'),
('99150'),
('98138'),
('98673'),
('98121'),
('98687'),
('98520'),
('98396'),
('98862'),
('98111'),
('98034'),
('98320'),
('98610'),
('98951'),
('99212'),
('98940'),
('98643'),
('99013'),
('98358'),
('98092'),
('98185'),
('98247'),
('99149'),
('99011'),
('99251'),
('98177'),
('98847'),
('99102'),
('98841'),
('98421'),
('98010'),
('98625'),
('98353'),
('98325'),
('99201'),
('98194'),
('98439'),
('98372'),
('98321'),
('98355'),
('98942'),
('98014'),
('98375'),
('98649'),
('98038'),
('98051'),
('99036'),
('99348'),
('98282'),
('98644'),
('98397'),
('99214'),
('98117'),
('98661'),
('98286'),
('98844'),
('98232'),
('98208'),
('98037'),
('99158'),
('99125'),
('98384'),
('98225'),
('99347'),
('98564'),
('98296'),
('98228'),
('98204'),
('98305'),
('98635'),
('99018'),
('98227'),
('99111'),
('98089'),
('98253'),
('99021'),
('99173'),
('98947'),
('99219'),
('98271'),
('98811'),
('98326'),
('98284'),
('99136'),
('98293'),
('99181'),
('98241'),
('98813'),
('98922'),
('99126'),
('98388'),
('99037'),
('98599'),
('98178'),
('98260'),
('98856'),
('98660'),
('98394'),
('98368'),
('98446'),
('99403'),
('98417'),
('98315'),
('98047'),
('98348'),
('98833'),
('98386'),
('98579'),
('99209'),
('99101'),
('98948'),
('98057'),
('99133'),
('98857'),
('98836'),
('98281'),
('98851'),
('98224'),
('98119'),
('98465'),
('98262'),
('98620'),
('98683'),
('99185'),
('98424'),
('98584'),
('98445'),
('99180'),
('98188'),
('98401'),
('99026'),
('99346'),
('98385'),
('98364'),
('98855'),
('98665'),
('98360'),
('98503'),
('98075'),
('98259'),
('98371'),
('99202'),
('98056'),
('98827'),
('98103'),
('98570'),
('98291'),
('98950'),
('99210'),
('99152'),
('98250'),
('98170'),
('98222'),
('98587'),
('99337'),
('98526'),
('99167'),
('98350'),
('98607'),
('98311'),
('98850'),
('98041'),
('98671'),
('98077'),
('99144'),
('98672'),
('98815'),
('98527'),
('98074'),
('98373'),
('98496'),
('98819'),
('98361'),
('99017'),
('99104'),
('99170'),
('98345'),
('99206'),
('98032'),
('98050'),
('98562'),
('98166'),
('98087'),
('98853'),
('98555'),
('98083'),
('98393'),
('98467'),
('98422'),
('98617'),
('98583'),
('98333'),
('99146'),
('98651'),
('98926'),
('98807'),
('98542'),
('98611'),
('98444'),
('98093'),
('98628'),
('98266'),
('99153'),
('98506'),
('98614'),
('98471'),
('98586'),
('98613'),
('98027'),
('98582'),
('98585'),
('98944'),
('98243'),
('98501'),
('98314'),
('98921'),
('99326'),
('98642'),
('98443'),
('98624'),
('98336'),
('98830'),
('98033'),
('99121'),
('99122'),
('98322'),
('98287'),
('98195'),
('99341'),
('99174'),
('98638'),
('98012'),
('98561'),
('98832'),
('98352'),
('98261'),
('98563'),
('98493'),
('98684'),
('98433'),
('99356'),
('98377'),
('98220'),
('99154'),
('98061'),
('98860'),
('99362'),
('98206'),
('98136'),
('98374'),
('98580'),
('98902'),
('98632'),
('98312'),
('98593'),
('98408'),
('98328'),
('98363'),
('98622'),
('99115'),
('98221'),
('99030'),
('98036'),
('99359'),
('98174'),
('98558'),
('98380'),
('98035'),
('98554'),
('99329'),
('99353'),
('98824'),
('98908'),
('98304'),
('98603'),
('98118'),
('98273'),
('98160'),
('99157'),
('98039'),
('98021'),
('99333'),
('99129'),
('98662'),
('98834'),
('99001'),
('98528'),
('98175'),
('98537'),
('98923'),
('98623'),
('98405'),
('98936'),
('98070'),
('99349'),
('98831'),
('98826'),
('98275'),
('98102'),
('98040'),
('98248'),
('98953'),
('98223'),
('99357'),
('98631'),
('98383'),
('98181'),
('98513'),
('98577'),
('98053'),
('98106'),
('99130'),
('98828'),
('98504'),
('99176'),
('99033'),
('98357'),
('98236'),
('98105'),
('98112'),
('98025'),
('98154'),
('99179'),
('91426'),
('93301'),
('91706'),
('93121'),
('95639'),
('92882'),
('91604'),
('93563'),
('95327'),
('94127'),
('94974'),
('95547'),
('92009'),
('96076'),
('93044'),
('95011'),
('95134'),
('96003'),
('91008'),
('92220'),
('90010'),
('92028'),
('93108'),
('92347'),
('95436'),
('93953'),
('94517'),
('95236'),
('93202'),
('92832'),
('90069'),
('93042'),
('91775'),
('91804'),
('95426'),
('92649'),
('94999'),
('92120'),
('95018'),
('94925'),
('90212'),
('95303'),
('95930'),
('95382'),
('90293'),
('93219'),
('95045'),
('91007'),
('94403'),
('92616'),
('96126'),
('95065'),
('90189'),
('95860'),
('94950'),
('96119'),
('93307'),
('95615'),
('90086'),
('96146'),
('90733'),
('91731'),
('91708'),
('91345'),
('94497'),
('94306'),
('91185'),
('95741'),
('95620'),
('95554'),
('96161'),
('94123'),
('94133'),
('96122'),
('95697'),
('92614'),
('95354'),
('95010'),
('92516'),
('96061'),
('92060'),
('90606'),
('95433'),
('91755'),
('93640'),
('95699'),
('92366'),
('95360'),
('92546'),
('93106'),
('90746'),
('91747'),
('92502'),
('94042'),
('96054'),
('95641'),
('95866'),
('94080'),
('95009'),
('92375'),
('95014'),
('94522'),
('92837'),
('94536'),
('92501'),
('95451'),
('95831'),
('95936'),
('96142'),
('95131'),
('95713'),
('95458'),
('95373'),
('91614'),
('94074'),
('95312'),
('92277'),
('95126'),
('92395'),
('95115'),
('91766'),
('96137'),
('95215'),
('90274'),
('95946'),
('92153'),
('94028'),
('95587'),
('95821'),
('91023'),
('93030'),
('95659'),
('96141'),
('93528'),
('92335'),
('95201'),
('90239'),
('95609'),
('95073'),
('92683'),
('95307'),
('92122'),
('93455'),
('95037'),
('90748'),
('92310'),
('96052'),
('94287'),
('96035'),
('94550'),
('92389'),
('95632'),
('90671'),
('95001'),
('91732'),
('90401'),
('92586'),
('94589'),
('96090'),
('91740'),
('94537'),
('94979'),
('92822'),
('94965'),
('94111'),
('95519'),
('91913'),
('95254'),
('92115'),
('96124'),
('92637'),
('91360'),
('96056'),
('91506'),
('93502'),
('95062'),
('93453'),
('92385'),
('94402'),
('90620'),
('95412'),
('92831'),
('91915'),
('93705'),
('91916'),
('95981'),
('93714'),
('93599'),
('94621'),
('95721'),
('95610'),
('94401'),
('95532'),
('92257'),
('95953'),
('95986'),
('90094'),
('95388'),
('93943'),
('95514'),
('95625'),
('91307'),
('94088'),
('92843'),
('90095'),
('95106'),
('95993'),
('91224'),
('95759'),
('95665'),
('93240'),
('95982'),
('93061'),
('92038'),
('94618'),
('94245'),
('96143'),
('92175'),
('93723'),
('90245'),
('94592'),
('92701'),
('96140'),
('94567'),
('90029'),
('92602'),
('94512'),
('90044'),
('91789'),
('92135'),
('94948'),
('92804'),
('90804'),
('90240'),
('91709'),
('95538'),
('92551'),
('96129'),
('90051'),
('90713'),
('91944'),
('92037'),
('92652'),
('94205'),
('91722'),
('95525'),
('91066'),
('96051'),
('91611'),
('90631'),
('90624'),
('92554'),
('95671'),
('91607'),
('93636'),
('92572')
;
		DECLARE @Zips2 TABLE (ZipCode VARCHAR(5));
		INSERT INTO @Zips2 (ZipCode) VALUES
('92301'),
('95223'),
('95310'),
('91522'),
('90605'),
('96063'),
('93275'),
('94085'),
('93665'),
('95555'),
('92556'),
('93105'),
('93012'),
('93066'),
('92607'),
('91017'),
('94975'),
('94207'),
('93646'),
('91701'),
('93908'),
('95148'),
('92648'),
('95537'),
('92163'),
('91325'),
('95021'),
('91802'),
('94563'),
('90039'),
('90004'),
('94614'),
('95967'),
('95046'),
('94530'),
('90633'),
('93208'),
('91214'),
('92697'),
('95971'),
('95383'),
('95257'),
('92861'),
('93609'),
('95951'),
('95191'),
('95899'),
('94146'),
('95819'),
('95225'),
('92281'),
('93282'),
('95151'),
('90311'),
('95569'),
('92883'),
('94599'),
('90249'),
('95453'),
('95747'),
('93140'),
('94066'),
('92358'),
('91710'),
('90507'),
('93554'),
('91785'),
('92240'),
('92075'),
('91618'),
('94119'),
('92592'),
('94087'),
('95691'),
('90017'),
('92261'),
('91505'),
('91714'),
('93118'),
('92129'),
('93433'),
('92384'),
('91615'),
('96040'),
('93660'),
('94803'),
('92403'),
('91910'),
('91412'),
('92617'),
('94514'),
('92273'),
('93727'),
('94037'),
('93888'),
('94938'),
('92318'),
('92865'),
('95852'),
('91041'),
('92816'),
('93932'),
('91909'),
('90071'),
('90290'),
('95319'),
('95464'),
('94070'),
('92620'),
('94560'),
('92275'),
('92363'),
('95969'),
('92809'),
('93006'),
('91770'),
('93256'),
('91702'),
('94309'),
('94954'),
('92509'),
('90061'),
('94108'),
('92123'),
('95318'),
('96024'),
('91124'),
('93668'),
('95023'),
('95677'),
('91792'),
('95425'),
('93451'),
('94294'),
('92834'),
('96087'),
('92357'),
('93725'),
('95325'),
('95684'),
('93101'),
('95159'),
('93225'),
('95405'),
('90704'),
('93653'),
('93515'),
('90260'),
('95419'),
('95742'),
('91386'),
('93631'),
('94605'),
('95722'),
('93517'),
('95054'),
('93623'),
('91024'),
('95323'),
('92278'),
('92286'),
('95559'),
('92615'),
('92505'),
('93065'),
('95661'),
('94538'),
('94553'),
('94805'),
('94604'),
('92160'),
('92690'),
('94129'),
('95251'),
('92170'),
('90306'),
('95894'),
('95468'),
('92071'),
('93116'),
('95454'),
('92393'),
('94083'),
('94208'),
('91406'),
('93637'),
('94588'),
('96065'),
('91009'),
('95117'),
('92377'),
('92024'),
('93033'),
('96110'),
('95690'),
('95381'),
('90082'),
('90062'),
('94161'),
('95420'),
('95825'),
('92023'),
('92004'),
('95682'),
('93309'),
('95101'),
('94804'),
('92325'),
('96107'),
('90294'),
('92885'),
('95570'),
('91902'),
('95601'),
('95374'),
('91355'),
('92128'),
('93458'),
('95321'),
('93750'),
('96114'),
('95653'),
('93915'),
('95044'),
('95030'),
('90093'),
('95919'),
('96121'),
('94505'),
('96156'),
('90662'),
('91030'),
('93004'),
('95428'),
('95347'),
('93741'),
('92235'),
('92587'),
('93639'),
('92267'),
('92564'),
('92197'),
('95196'),
('95304'),
('96057'),
('95358'),
('91765'),
('95013'),
('92624'),
('92841'),
('91901'),
('95726'),
('92386'),
('94546'),
('92199'),
('92105'),
('90847'),
('94125'),
('93633'),
('94571'),
('93662'),
('95442'),
('92085'),
('93218'),
('93444'),
('91331'),
('95247'),
('95645'),
('93016'),
('95369'),
('95039'),
('91409'),
('92307'),
('94511'),
('93292'),
('92119'),
('91404'),
('92869'),
('95799'),
('95226'),
('92655'),
('91205'),
('90014'),
('95066'),
('91790'),
('93408'),
('91343'),
('90067'),
('95338'),
('96132'),
('92688'),
('91184'),
('91313'),
('95954'),
('93445'),
('94020'),
('92049'),
('95457'),
('94026'),
('92248'),
('91306'),
('90074'),
('91110'),
('92147'),
('95386'),
('93060'),
('91745'),
('95063'),
('95313'),
('92657'),
('92057'),
('93546'),
('91734'),
('92320'),
('94232'),
('91387'),
('92840'),
('94040'),
('93465'),
('94540'),
('94299'),
('93794'),
('93220'),
('92112'),
('95724'),
('96160'),
('90808'),
('91616'),
('93199'),
('94622'),
('93553'),
('91772'),
('93014'),
('91115'),
('95245'),
('92202'),
('93561'),
('91768'),
('94024'),
('95735'),
('95595'),
('96088'),
('91715'),
('92069'),
('95227'),
('90241'),
('95355'),
('91385'),
('92539'),
('95867'),
('93203'),
('93005'),
('92399'),
('93773'),
('93254'),
('93518'),
('91352'),
('93535'),
('93844'),
('95481'),
('90262'),
('94929'),
('92132'),
('91358'),
('95306'),
('90028'),
('93302'),
('95679'),
('90250'),
('94206'),
('91381'),
('92692'),
('94937'),
('95465'),
('95943'),
('94016'),
('94609'),
('90230'),
('92264'),
('93584'),
('96089'),
('94590'),
('95330'),
('92627'),
('90043'),
('92674'),
('92258'),
('94931'),
('95051'),
('92014'),
('95466'),
('93605'),
('95378'),
('92887'),
('91980'),
('93791'),
('92413'),
('93645'),
('95660'),
('95326'),
('90703'),
('91759'),
('95356'),
('96017'),
('92285'),
('94541'),
('93003'),
('95910'),
('95435'),
('94662'),
('92782'),
('95958'),
('96099'),
('95053'),
('93409'),
('91327'),
('94562'),
('94122'),
('94559'),
('91502'),
('92225'),
('90801'),
('92867'),
('90702'),
('91763'),
('92411'),
('94955'),
('92276'),
('94297'),
('95664'),
('96150'),
('95829'),
('96101'),
('90018'),
('95827'),
('94598'),
('95352'),
('94704'),
('93406'),
('90090'),
('94284'),
('93715'),
('93235'),
('92675'),
('94807'),
('90047'),
('92590'),
('90743'),
('93649'),
('93274'),
('93724'),
('94404'),
('93237'),
('94966'),
('92593'),
('95979'),
('94121'),
('95036'),
('95402'),
('93666'),
('95546'),
('94933'),
('90247'),
('94015'),
('95812'),
('95432'),
('96079'),
('91371'),
('92549'),
('90008'),
('92114'),
('94558'),
('93291'),
('92372'),
('96067'),
('91117'),
('94089'),
('91733'),
('95675'),
('92799'),
('90707'),
('93283'),
('90601'),
('93648'),
('90747'),
('91329'),
('90638'),
('93529'),
('95633'),
('95348'),
('93313'),
('92836'),
('93424'),
('92022'),
('93247'),
('94282'),
('92260'),
('92323'),
('92623'),
('95337'),
('95157'),
('92052'),
('93638'),
('91408'),
('93661'),
('92259'),
('95564'),
('94022'),
('94531'),
('95914'),
('94576'),
('94941'),
('91340'),
('93709'),
('91504'),
('95621'),
('93790'),
('91773'),
('94914'),
('92059'),
('92013'),
('92140'),
('96104'),
('96162'),
('93717'),
('96029'),
('95798'),
('94549'),
('91129'),
('93613'),
('92136'),
('94279'),
('92728'),
('90805'),
('95624'),
('92064'),
('92107'),
('96038'),
('92401'),
('91031'),
('95736'),
('95834'),
('93772'),
('90211'),
('95571'),
('93534'),
('92346'),
('90853'),
('95991'),
('95341'),
('95962'),
('95709'),
('94608'),
('90050'),
('90623'),
('92679'),
('91353'),
('94702'),
('95485'),
('91526'),
('95154'),
('96075'),
('95111'),
('93287'),
('96155'),
('94271'),
('95543'),
('93388'),
('94005'),
('94188'),
('93562'),
('95497'),
('93921'),
('95446'),
('92027'),
('92252'),
('90026'),
('95075'),
('95837'),
('95814'),
('92708'),
('93034'),
('95851'),
('93390'),
('94976'),
('90012'),
('92239'),
('93435'),
('95637'),
('95915'),
('96154'),
('91208'),
('93150'),
('90706'),
('92684'),
('92557'),
('93777'),
('92369'),
('95644'),
('95125'),
('91496'),
('93244'),
('93257'),
('93531'),
('92070'),
('92373'),
('94114'),
('90710'),
('93280'),
('91109'),
('94041'),
('94613'),
('94145'),
('93721'),
('91911'),
('90810'),
('91322'),
('92242'),
('95234'),
('94597'),
('96039'),
('92864'),
('90650'),
('95320'),
('96013'),
('92344'),
('90001'),
('96021'),
('92350'),
('93314'),
('95112'),
('93901'),
('93626'),
('94002'),
('94258'),
('93222'),
('93954'),
('96007'),
('92109'),
('95150'),
('94524'),
('91934'),
('91189'),
('93407'),
('92712'),
('90307'),
('90056'),
('90502'),
('93246'),
('95511'),
('92711'),
('96112'),
('95560'),
('90755'),
('96115'),
('90020'),
('93512'),
('92341'),
('91921'),
('95567'),
('94014'),
('91896'),
('91407'),
('93702'),
('94580'),
('93930'),
('92078'),
('95501'),
('94603'),
('91103'),
('95630'),
('92801'),
('92142'),
('92544'),
('94203'),
('92322'),
('95379'),
('95228'),
('95212'),
('95246'),
('92280'),
('91764'),
('95603'),
('92108'),
('94710'),
('95685'),
('95050'),
('96151'),
('90721'),
('92702'),
('94555'),
('95663'),
('94566'),
('92117'),
('93021'),
('95232'),
('95336'),
('93103'),
('92143'),
('95002'),
('91903'),
('92196'),
('91741'),
('91778'),
('91750'),
('95368'),
('92518'),
('95712'),
('95391'),
('90809'),
('92660'),
('91021'),
('90404'),
('92118'),
('94977'),
('93102'),
('92321'),
('95190'),
('91311'),
('95456'),
('95836'),
('92036'),
('94109'),
('93558'),
('92137'),
('95672'),
('95335'),
('93422'),
('91350'),
('92211'),
('93775'),
('90248'),
('94027'),
('92193'),
('94126'),
('93673'),
('96093'),
('92394'),
('92704'),
('95903'),
('90660'),
('93955'),
('90073'),
('92698'),
('95430'),
('93423'),
('95008'),
('92536'),
('91201'),
('91376'),
('91609'),
('91987'),
('93442'),
('92835'),
('95214'),
('94610'),
('96078'),
('94525'),
('95431'),
('94552'),
('92838'),
('94720'),
('92243'),
('95132'),
('94617'),
('91945'),
('94144'),
('92158'),
('95602'),
('92051'),
('94290'),
('96011'),
('95635'),
('93002'),
('90022'),
('92823'),
('95842'),
('95410'),
('92192'),
('95015'),
('95640'),
('93011'),
('92879'),
('90409'),
('95135'),
('91793'),
('94151'),
('95207'),
('95322'),
('96157'),
('94660'),
('96049'),
('95813'),
('94545'),
('91606'),
('90712'),
('92693'),
('91943'),
('93550'),
('92833'),
('90006'),
('95526'),
('95628'),
('94086'),
('95221'),
('95333'),
('93627'),
('92404'),
('95460'),
('92802'),
('96015'),
('91724'),
('95611'),
('93643'),
('94139'),
('90242'),
('94529'),
('94256'),
('95205'),
('91301'),
('95824'),
('91210'),
('93380'),
('95473'),
('93448'),
('96080'),
('96044'),
('95361'),
('93652'),
('91495'),
('90052'),
('95231'),
('90291'),
('92067'),
('95128'),
('91309'),
('93099'),
('92161'),
('95005'),
('93206'),
('90309'),
('95160'),
('93701'),
('95056'),
('93013'),
('95607'),
('92659'),
('94211'),
('91523'),
('93720'),
('91711'),
('92530'),
('93277'),
('93906'),
('94273'),
('92058'),
('94296'),
('91612'),
('93227'),
('93624'),
('93020'),
('90209'),
('93245'),
('93441'),
('95424'),
('95626'),
('93634'),
('95963'),
('93747'),
('91390'),
('90622'),
('92311'),
('94237'),
('93475'),
('95949'),
('94956'),
('93704'),
('91507'),
('95363'),
('92116'),
('94585'),
('92371'),
('96048'),
('95662'),
('96020'),
('93447'),
('96113'),
('93232'),
('95110'),
('96096'),
('95229'),
('90604'),
('95934'),
('92807'),
('93527'),
('95642'),
('94542'),
('96106'),
('92563'),
('96109'),
('90057'),
('90033'),
('92364'),
('94305'),
('93457'),
('92571'),
('94557'),
('95309'),
('94570'),
('93009'),
('95017'),
('90720'),
('96133'),
('94957'),
('95494'),
('90661'),
('96118'),
('94061'),
('92673'),
('93035'),
('95429'),
('95375'),
('95720'),
('93505'),
('92056'),
('91121'),
('90834'),
('95033'),
('92101'),
('90815'),
('92328'),
('92079'),
('93924'),
('95835'),
('91786'),
('92230'),
('92514'),
('91935'),
('95340'),
('93450'),
('95119'),
('90078'),
('92167'),
('94044'),
('93608'),
('90607'),
('91402'),
('95654'),
('90732'),
('90009'),
('93389'),
('92507'),
('92247'),
('91372'),
('95638'),
('93501'),
('91977'),
('92808'),
('91334'),
('92331'),
('90054'),
('93252'),
('93403'),
('91333'),
('95448'),
('95417'),
('94263'),
('95192'),
('93268'),
('95925'),
('94280'),
('93239'),
('95444'),
('96105'),
('94963'),
('95492'),
('94913'),
('93430'),
('92427'),
('95449'),
('93387'),
('90016'),
('95961'),
('95758'),
('95422'),
('95965'),
('90030'),
('94709'),
('92274'),
('90233'),
('90506'),
('94021'),
('91767'),
('95822'),
('94539'),
('95563'),
('92174')
;
		DECLARE @Zips3 TABLE (ZipCode VARCHAR(5));
		INSERT INTO @Zips3 (ZipCode) VALUES
('95945'),
('90220'),
('90715'),
('94596'),
('94230'),
('93614'),
('92312'),
('91351'),
('95129'),
('94131'),
('90742'),
('90308'),
('94923'),
('92172'),
('95076'),
('93926'),
('94250'),
('95203'),
('95975'),
('93437'),
('95357'),
('93711'),
('95955'),
('90267'),
('92619'),
('94612'),
('95694'),
('94920'),
('96019'),
('90402'),
('94248'),
('93745'),
('93405'),
('91362'),
('91308'),
('93793'),
('90270'),
('92658'),
('91328'),
('91423'),
('90510'),
('94267'),
('93656'),
('90603'),
('95024'),
('92263'),
('90045'),
('91978'),
('92096'),
('95406'),
('95012'),
('94602'),
('93032'),
('96148'),
('95452'),
('95765'),
('91716'),
('94940'),
('93261'),
('95269'),
('93619'),
('93618'),
('93650'),
('95253'),
('95818'),
('95650'),
('91305'),
('93130'),
('92805'),
('94581'),
('90277'),
('94583'),
('93094'),
('91906'),
('94513'),
('92329'),
('91470'),
('93410'),
('90403'),
('93386'),
('94302'),
('95669'),
('94820'),
('95350'),
('95407'),
('94134'),
('93616'),
('91202'),
('92591'),
('92327'),
('92603'),
('94163'),
('93428'),
('92186'),
('94501'),
('90840'),
('90222'),
('90231'),
('90272'),
('93402'),
('90503'),
('95487'),
('91012'),
('90096'),
('90848'),
('95071'),
('96055'),
('95521'),
('95646'),
('92629'),
('95210'),
('92106'),
('92169'),
('92863'),
('94274'),
('95673'),
('92646'),
('94808'),
('90831'),
('92025'),
('91020'),
('95124'),
('96158'),
('94115'),
('91102'),
('92561'),
('91209'),
('90060'),
('92519'),
('93776'),
('95604'),
('96033'),
('93530'),
('95370'),
('90099'),
('92654'),
('94509'),
('92856'),
('90639'),
('90055'),
('95864'),
('95296'),
('94112'),
('91114'),
('93615'),
('96064'),
('92583'),
('95055'),
('95618'),
('90264'),
('90899'),
('92653'),
('94947'),
('92392'),
('90042'),
('96123'),
('95540'),
('91357'),
('92811'),
('95589'),
('90303'),
('95688'),
('96006'),
('91107'),
('96016'),
('92007'),
('92110'),
('93117'),
('93922'),
('93440'),
('92241'),
('93276'),
('95715'),
('91941'),
('94017'),
('93285'),
('93212'),
('93062'),
('91010'),
('95623'),
('96085'),
('92168'),
('95932'),
('93635'),
('93928'),
('91946'),
('90021'),
('94547'),
('93443'),
('90802'),
('93549'),
('93306'),
('95820'),
('93483'),
('94240'),
('95267'),
('94951'),
('90680'),
('92868'),
('93716'),
('93960'),
('94295'),
('95376'),
('95674'),
('96120'),
('92081'),
('91899'),
('91905'),
('90027'),
('93654'),
('92149'),
('93250'),
('90895'),
('94038'),
('95912'),
('94543'),
('92040'),
('94659'),
('96125'),
('90806'),
('95224'),
('93706'),
('91730'),
('92222'),
('95944'),
('92227'),
('91116'),
('90041'),
('92316'),
('92046'),
('94574'),
('95328'),
('95418'),
('96111'),
('93001'),
('95695'),
('90075'),
('95387'),
('95108'),
('94572'),
('92030'),
('93944'),
('95404'),
('92010'),
('92408'),
('93920'),
('95763'),
('93064'),
('91354'),
('94526'),
('90213'),
('93449'),
('94998'),
('94970'),
('92176'),
('95052'),
('93383'),
('94291'),
('92850'),
('92859'),
('92251'),
('92150'),
('95204'),
('93962'),
('95922'),
('90081'),
('95364'),
('95233'),
('92814'),
('92195'),
('95616'),
('95667'),
('93429'),
('96041'),
('94030'),
('92254'),
('91771'),
('90740'),
('92735'),
('95652'),
('93729'),
('92584'),
('92026'),
('95038'),
('96008'),
('92308'),
('93710'),
('94904'),
('93708'),
('94130'),
('95443'),
('92548'),
('94519'),
('95670'),
('94535'),
('95172'),
('94502'),
('93590'),
('95983'),
('93581'),
('94507'),
('91776'),
('95317'),
('93592'),
('96071'),
('96031'),
('96097'),
('91108'),
('91123'),
('94649'),
('92339'),
('95656'),
('94952'),
('91394'),
('90632'),
('96068'),
('91948'),
('93160'),
('91337'),
('92860'),
('92066'),
('90312'),
('90296'),
('95503'),
('92065'),
('90038'),
('90064'),
('96134'),
('95545'),
('90501'),
('91912'),
('91206'),
('95372'),
('96086'),
('93536'),
('90302'),
('92262'),
('95158'),
('90083'),
('93221'),
('92103'),
('92513'),
('92008'),
('95984'),
('92093'),
('95116'),
('95542'),
('93630'),
('91914'),
('90407'),
('92166'),
('95019'),
('94544'),
('93190'),
('90266'),
('93722'),
('95140'),
('92256'),
('94587'),
('92282'),
('95367'),
('92678'),
('93036'),
('92284'),
('91403'),
('94568'),
('95558'),
('92685'),
('95614'),
('94288'),
('92145'),
('90088'),
('92552'),
('91413'),
('90701'),
('90261'),
('91042'),
('90731'),
('95427'),
('94257'),
('94582'),
('92691'),
('90408'),
('94964'),
('93556'),
('90822'),
('94018'),
('92630'),
('90304'),
('93642'),
('92582'),
('92871'),
('94903'),
('90637'),
('96116'),
('93927'),
('92651'),
('93249'),
('95968'),
('94556'),
('92610'),
('95815'),
('94523'),
('90711'),
('96108'),
('90411'),
('95826'),
('93024'),
('91603'),
('92506'),
('93007'),
('95297'),
('94102'),
('90080'),
('93670'),
('91384'),
('93223'),
('96092'),
('90024'),
('96023'),
('95351'),
('95403'),
('90406'),
('93063'),
('90734'),
('94949'),
('94060'),
('93270'),
('96069'),
('90305'),
('93421'),
('95130'),
('95077'),
('94569'),
('95901'),
('95377'),
('95935'),
('93107'),
('93238'),
('90046'),
('95329'),
('93272'),
('93308'),
('93760'),
('93728'),
('92562'),
('91356'),
('91411'),
('95980'),
('92521'),
('95031'),
('95634'),
('95258'),
('90835'),
('91203'),
('95957'),
('95830'),
('93604'),
('94915'),
('93041'),
('95562'),
('93555'),
('94615'),
('90608'),
('95138'),
('93644'),
('91739'),
('90505'),
('94960'),
('96034'),
('90749'),
('93205'),
('90224'),
('94850'),
('91320'),
('93923'),
('93022'),
('95113'),
('95612'),
('90714'),
('95947'),
('95118'),
('90037'),
('95397'),
('92606'),
('93234'),
('92337'),
('95966'),
('95524'),
('91003'),
('93514'),
('93778'),
('95316'),
('95041'),
('92121'),
('95061'),
('95913'),
('91743'),
('93434'),
('94301'),
('91932'),
('92356'),
('95389'),
('95680'),
('91803'),
('93740'),
('95613'),
('90036'),
('91752'),
('94924'),
('91762'),
('91006'),
('95459'),
('95249'),
('91723'),
('93454'),
('92625'),
('92815'),
('93522'),
('95136'),
('92091'),
('92198'),
('93201'),
('93510'),
('96070'),
('95937'),
('92124'),
('91204'),
('95823'),
('91482'),
('93542'),
('92039'),
('90034'),
('90025'),
('93241'),
('93384'),
('95441'),
('95042'),
('94611'),
('90813'),
('92508'),
('95155'),
('96059'),
('91326'),
('94515'),
('95992'),
('90210'),
('95007'),
('96002'),
('94025'),
('94043'),
('93596'),
('91917'),
('95619'),
('90015'),
('95970'),
('93603'),
('94508'),
('92033'),
('95920'),
('91602'),
('94926'),
('95696'),
('94172'),
('90084'),
('92191'),
('90049'),
('92705'),
('93266'),
('94110'),
('93210'),
('95070'),
('95550'),
('95193'),
('93933'),
('93420'),
('93023'),
('95353'),
('90254'),
('93286'),
('95493'),
('95606'),
('95161'),
('95153'),
('96145'),
('94283'),
('95534'),
('94147'),
('92173'),
('91510'),
('95423'),
('92599'),
('92354'),
('90310'),
('92155'),
('90717'),
('92086'),
('93765'),
('94234'),
('93523'),
('95648'),
('93606'),
('91499'),
('94105'),
('93602'),
('93110'),
('94277'),
('91344'),
('92074'),
('92165'),
('93267'),
('95122'),
('93737'),
('92333'),
('94293'),
('92152'),
('92618'),
('95209'),
('93067'),
('92177'),
('93718'),
('93730'),
('92352'),
('93621'),
('95941'),
('95693'),
('90814'),
('90072'),
('95757'),
('92313'),
('91364'),
('92088'),
('91125'),
('91225'),
('95311'),
('96025'),
('95853'),
('95728'),
('91199'),
('95445'),
('92134'),
('92253'),
('92378'),
('93516'),
('90508'),
('92250'),
('96095'),
('94064'),
('94204'),
('92817'),
('93427'),
('94579'),
('91011'),
('96117'),
('91383'),
('90003'),
('95211'),
('95926'),
('90652'),
('92305'),
('92304'),
('90807'),
('95461'),
('94707'),
('95918'),
('91601'),
('94159'),
('95469'),
('91046'),
('91105'),
('91077'),
('96027'),
('92545'),
('94289'),
('96022'),
('90070'),
('94132'),
('90610'),
('94143'),
('95924'),
('93526'),
('95415'),
('93519'),
('90295'),
('95315'),
('95972'),
('95127'),
('93243'),
('96037'),
('92626'),
('95948'),
('91788'),
('95703'),
('91359'),
('95255'),
('95681'),
('94039'),
('96128'),
('91304'),
('94945'),
('91303'),
('95689'),
('91342'),
('94548'),
('94304'),
('96014'),
('94278'),
('92410'),
('95988'),
('93942'),
('90832'),
('95843'),
('95345'),
('93675'),
('93905'),
('90063'),
('91101'),
('92061'),
('96010'),
('95701'),
('92104'),
('92406'),
('93312'),
('92423'),
('95437'),
('90031'),
('90263'),
('92178'),
('90066'),
('90005'),
('95683'),
('92845'),
('92336'),
('92309'),
('95170'),
('93545'),
('94601'),
('91962'),
('90077'),
('95120'),
('94971'),
('92589'),
('92567'),
('92368'),
('91979'),
('95832'),
('94521'),
('92082'),
('95305'),
('95324'),
('92223'),
('95668'),
('95343'),
('92340'),
('94124'),
('90019'),
('94620'),
('94128'),
('93207'),
('96009'),
('91316'),
('94209'),
('91405'),
('94262'),
('93043'),
('95605'),
('95692'),
('93258'),
('94116'),
('92382'),
('95220'),
('92203'),
('95334'),
('95746'),
('93224'),
('90670'),
('90602'),
('95401'),
('91380'),
('92543'),
('92268'),
('92054'),
('96094'),
('92365'),
('91761'),
('91976'),
('93278'),
('90058'),
('94712'),
('96028'),
('94607'),
('95631'),
('91341'),
('92585'),
('92397'),
('91729'),
('94177'),
('92283'),
('94575'),
('91395'),
('90833'),
('92072'),
('91737'),
('91748'),
('91963'),
('95103'),
('91118'),
('95109'),
('90023'),
('94701'),
('92661'),
('95060'),
('90609'),
('90068'),
('93620'),
('95416'),
('95938'),
('95133'),
('92338'),
('96032'),
('93707'),
('94252'),
('92596'),
('94533'),
('95248'),
('92138'),
('94703'),
('95940'),
('96058'),
('94164'),
('92055'),
('93544'),
('90201'),
('95472'),
('90053'),
('93109'),
('93260'),
('92398'),
('95156'),
('91749'),
('93601'),
('93436'),
('93464'),
('92018'),
('95549'),
('96047'),
('93625'),
('94268'),
('92662'),
('91393'),
('92812'),
('92131'),
('94516'),
('93586'),
('94534'),
('95548'),
('95552'),
('94930'),
('91950'),
('95502'),
('92234'),
('94922'),
('92324'),
('92612'),
('92886'),
('90275'),
('94573'),
('95450'),
('92647'),
('93607'),
('95164'),
('93610'),
('94120'),
('93902'),
('94247'),
('94518'),
('93271'),
('92866'),
('94706'),
('93504'),
('91746'),
('93541'),
('95252'),
('95476'),
('95152'),
('92233'),
('93792'),
('92083'),
('95206'),
('90640'),
('92236'),
('92780'),
('94561'),
('91605'),
('95141'),
('95678'),
('95973'),
('94946'),
('92503'),
('93230'),
('95032'),
('95035'),
('95658'),
('96135'),
('92878'),
('90202'),
('91756'),
('91791'),
('91608'),
('95536'),
('91908'),
('95230'),
('94503'),
('90002'),
('95651'),
('92210'),
('95840'),
('92857'),
('93940'),
('94973'),
('91104'),
('94104'),
('92407'),
('94010'),
('91758'),
('93532'),
('95365'),
('91346'),
('92130'),
('92315'),
('94942'),
('93426'),
('95608'),
('96091'),
('92003'),
('94259'),
('90504'),
('95222'),
('92270'),
('95942'),
('94118'),
('92182'),
('95928'),
('92609'),
('94107'),
('96046'),
('95006'),
('91226'),
('95518'),
('93446'),
('94551'),
('91221'),
('94142'),
('94591'),
('91521'),
('92127'),
('91335'),
('90405'),
('91780'),
('90716'),
('95486'),
('92021'),
('94062'),
('92231'),
('92019'),
('93513'),
('93040'),
('92504'),
('90232'),
('91025'),
('92374'),
('91182'),
('95488'),
('95004'),
('92656'),
('92880'),
('92391'),
('93432'),
('94261'),
('95344'),
('92415'),
('96001'),
('95960'),
('93761'),
('95686'),
('92084'),
('92676'),
('92672'),
('93401'),
('92226'),
('93311'),
('91801'),
('93290'),
('92345'),
('93265'),
('93242'),
('95833')
;
		DECLARE @Zips4 TABLE (ZipCode VARCHAR(5));
		INSERT INTO @Zips4 (ZipCode) VALUES
('92877'),
('91436'),
('94140'),
('95551'),
('92154'),
('95421'),
('96084'),
('95064'),
('91016'),
('95490'),
('91617'),
('92677'),
('95139'),
('91321'),
('90059'),
('93539'),
('92359'),
('95585'),
('94801'),
('91610'),
('92029'),
('93460'),
('93703'),
('90621'),
('95471'),
('95121'),
('94254'),
('90280'),
('93591'),
('95828'),
('93612'),
('95987'),
('94586'),
('94063'),
('92068'),
('93251'),
('92011'),
('92899'),
('95123'),
('95380'),
('90087'),
('90079'),
('91365'),
('92531'),
('95916'),
('95202'),
('94065'),
('96103'),
('95237'),
('91001'),
('95956'),
('91324'),
('95762'),
('91126'),
('92881'),
('92604'),
('93255'),
('95242'),
('94520'),
('95409'),
('90292'),
('92201'),
('95714'),
('90223'),
('91330'),
('95020'),
('92781'),
('93771'),
('95366'),
('95617'),
('93774'),
('91319'),
('90035'),
('94011'),
('93262'),
('94901'),
('92650'),
('93712'),
('93641'),
('93907'),
('93452'),
('95531'),
('94229'),
('94527'),
('90803'),
('90842'),
('94023'),
('91410'),
('90846'),
('95346'),
('95978'),
('92862'),
('93279'),
('94158'),
('91222'),
('93552'),
('92825'),
('90745'),
('94953'),
('95213'),
('95939'),
('95173'),
('92522'),
('95977'),
('95463'),
('93524'),
('91784'),
('91744'),
('95043'),
('95003'),
('92595'),
('92842'),
('91396'),
('92694'),
('94137'),
('95301'),
('90410'),
('91382'),
('92159'),
('93215'),
('92113'),
('93764'),
('92517'),
('94661'),
('92126'),
('95666'),
('94624'),
('93543'),
('93551'),
('90048'),
('95439'),
('93647'),
('95573'),
('91043'),
('91508'),
('92232'),
('92342'),
('94298'),
('95462'),
('94269'),
('93925'),
('94141'),
('95929'),
('92803'),
('94606'),
('95480'),
('93463'),
('96127'),
('95553'),
('93786'),
('93560'),
('94705'),
('94578'),
('93657'),
('94912'),
('90076'),
('93667'),
('91106'),
('91735'),
('92020'),
('93305'),
('92553'),
('95687'),
('94506'),
('90744'),
('94160'),
('93664'),
('95959'),
('96136'),
('93611'),
('92663'),
('90301'),
('93950'),
('92171'),
('92332'),
('91769'),
('92376'),
('95556'),
('94978'),
('92605'),
('93412'),
('92402'),
('90630'),
('95817'),
('93120'),
('91942'),
('94103'),
('92405'),
('92092'),
('90065'),
('91754'),
('94239'),
('92266'),
('94806'),
('90040'),
('90278'),
('91188'),
('91392'),
('92314'),
('93622'),
('95698'),
('95565'),
('92628'),
('94619'),
('94972'),
('90007'),
('92806'),
('94235'),
('94236'),
('92844'),
('91367'),
('91931'),
('91933'),
('93385'),
('92570'),
('94666'),
('94708'),
('91207'),
('95865'),
('92870'),
('94939'),
('95976'),
('90255'),
('94595'),
('92249'),
('95816'),
('93204'),
('92102'),
('95838'),
('90221'),
('94927'),
('94244'),
('93628'),
('90251'),
('91503'),
('94928'),
('91377'),
('95470'),
('93744'),
('92581'),
('95776'),
('95917'),
('92821'),
('94035'),
('95219'),
('95241'),
('92706'),
('92255'),
('94802'),
('92187'),
('90091'),
('93912'),
('96074'),
('93461'),
('92846'),
('93755'),
('95927'),
('91361'),
('93438'),
('93031'),
('96130'),
('94285'),
('93651'),
('95067'),
('95482'),
('96152'),
('92244'),
('95636'),
('93015'),
('92555'),
('96073'),
('95923'),
('90651'),
('93456'),
('93010'),
('91951'),
('92532'),
('91302'),
('94019'),
('90032'),
('94623'),
('90723'),
('95208'),
('93669'),
('95950'),
('95717'),
('95385'),
('93726'),
('92139'),
('92317'),
('93303'),
('91401'),
('95527'),
('93216'),
('91416'),
('90134'),
('93304'),
('90265'),
('92707'),
('96050'),
('95974'),
('90509'),
('91310'),
('94249'),
('95568'),
('94528'),
('95629'),
('93226'),
('90089'),
('94117'),
('93263'),
('95655'),
('92179'),
('92703'),
('96062'),
('95194'),
('94510'),
('94577'),
('90013'),
('93111'),
('90844'),
('94564'),
('92418'),
('91040'),
('95676'),
('95627'),
('92111'),
('93779'),
('92334'),
('95467'),
('95240'),
('91501'),
('95841'),
('95528'),
('95811'),
('94303'),
('95026'),
('90011'),
('94565')
;

--SELECT * FROM @ZIPS1 
--UNION ALL
--SELECT * FROM @ZIPS2 
--UNION ALL
--SELECT * FROM @ZIPS3
--UNION ALL
--SELECT * FROM @ZIPS4
--;

	--select count(ZipCode) as all_zips from 
	--(
	--		SELECT * FROM @ZIPS1 
	--		UNION ALL
	--		SELECT * FROM @ZIPS2 
	--		UNION ALL
	--		SELECT * FROM @ZIPS3
	--		UNION ALL
	--		SELECT * FROM @ZIPS4
	--)z
	----3304

	--select count(distinct ZipCode) as distinct_zips from
	--(
	--		SELECT * FROM @ZIPS1 
	--		UNION ALL
	--		SELECT * FROM @ZIPS2 
	--		UNION ALL
	--		SELECT * FROM @ZIPS3
	--		UNION ALL
	--		SELECT * FROM @ZIPS4
	--)z
	----3304

		IF NOT EXISTS 
		(
			SELECT 
				ZipId 
			FROM 
				[dasforbfed].[Zips] Z1
				INNER JOIN 
				(
					SELECT * FROM @ZIPS1 
					UNION ALL
					SELECT * FROM @ZIPS2 
					UNION ALL
					SELECT * FROM @ZIPS3 			
					UNION ALL
					SELECT * FROM @ZIPS4
				) Z2
					ON Z1.ZipCode = Z2.ZipCode
			WHERE
				Z1.DisasterId = @DisasterID
		)
		BEGIN
			INSERT INTO 
				[dasforbfed].[Zips]	(ZipCode, DisasterId)
			SELECT DISTINCT
				ZipCode
				,@DisasterID 
			FROM 
				(
					SELECT * FROM @ZIPS1 
					UNION ALL
					SELECT * FROM @ZIPS2 
					UNION ALL
					SELECT * FROM @ZIPS3
					UNION ALL
					SELECT * FROM @ZIPS4
				)z
		END;

		-- Save/Set the row count from the previously executed statement
		SELECT @ROWCOUNT = @ROWCOUNT + @@ROWCOUNT;

	IF @ROWCOUNT = @ExpectedRowCount
		BEGIN
			PRINT 'Transaction committed.'
			COMMIT TRANSACTION
			--ROLLBACK TRANSACTION
		END
	ELSE
		BEGIN
			PRINT 'Transaction NOT committed.';
			PRINT 'Expected row count not met. Expecting ' +  CAST(@ExpectedRowCount AS VARCHAR(10)) + ' rows, but returned ' + CAST(@ROWCOUNT AS VARCHAR(10))+ ' rows.';
			ROLLBACK TRANSACTION;
		END
END TRY
BEGIN CATCH
	PRINT 'Transaction NOT committed. Errors found in SQL statement.';
	ROLLBACK TRANSACTION;
	THROW;
END CATCH;
