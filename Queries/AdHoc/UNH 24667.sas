PROC IMPORT OUT= WORK.Source
            DATAFILE= "T:\BANA Guarantor-School-Loan Type.xlsx" 
            DBMS=EXCEL REPLACE;
     RANGE="Sheet1$"; 
     GETNAMES=YES;
     MIXED=NO;
     SCANTEXT=YES;
     USEDATE=YES;
     SCANTIME=YES;
RUN;


PROC SQL;
	CREATE TABLE OUTPUT AS 
		SELECT
			CATS(SCHOOL_CODE, '00') AS SCHOOL_ID,
			LOAN_TYPE,
			CATS('000',GUARANTOR) AS GUARANTOR,
			'B' AS TX10_APPROVAL,
			'E' AS TX13_APPROVAL,
			'11/08/65' AS APPROVAL_DATE
		FROM
			SOURCE
;
QUIT;

DATA FINAL (DROP=LOAN_TYPE);
	SET OUTPUT;
	TYPE = '      ';
IF LOAN_TYPE = 'STFFRD/UNSTFD' THEN DO;
TYPE = 'STFFRD';
OUTPUT;
TYPE = 'UNSTFD';
OUTPUT;
END;
ELSE IF LOAN_TYPE = 'CNSLDN/SUBCNS/SUBSPC/UNCNS/UNSPC' THEN DO;
TYPE = 'CNSLDN';
OUTPUT;
TYPE = 'SUBCNS';
OUTPUT;
TYPE = 'SUBSPC';
OUTPUT;
TYPE = 'UNCNS';
OUTPUT;
TYPE = 'UNSPC';
OUTPUT;
END;
ELSE
	DO;
	TYPE = LOAN_TYPE;
	OUTPUT;
	END;

RUN;

PROC SQL;
	CREATE TABLE FINAL_OUTPUT AS 
		SELECT
			SCHOOL_ID,
			TYPE AS LOAN_PROGRAM,
			GUARANTOR,
			TX10_APPROVAL,
			TX13_APPROVAL,
			APPROVAL_DATE
		FROM FINAL
;
QUIT;

PROC EXPORT DATA = WORK.FINAL_OUTPUT 
            OUTFILE = "T:\NH 24667.CSV" 
            DBMS = CSV 
			REPLACE;
     PUTNAMES = YES;
RUN;
