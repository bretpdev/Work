USE ULS
GO

BEGIN TRANSACTION
	DECLARE @ERROR INT = 0
	DECLARE @ROWCOUNT INT = 0
	DECLARE @ExpectedRowCount INT = 2

INSERT INTO uls.[print].FileHeaders(FileHeader, StateIndex, AccountNumberIndex, CostCenterCodeIndex)
VALUES('BF_SSN,DF_SPE_ACC_ID,DM_PRS_1,DM_PRS_LST,DX_STR_ADR_1,DX_STR_ADR_2,DX_STR_ADR_3,DM_CT,DC_DOM_ST,DM_FGN_CNY,DF_ZIP_CDE,DI_VLD_ADR,LD_SCL_SPR,LF_LST_DTS_SD10,WD_LON_RPD_SR,ACSKEY,IC_LON_PGM1,LD_LON_1_DSB1,LA_CUR_PRI1,IC_LON_PGM2,LD_LON_1_DSB2,LA_CUR_PRI2,IC_LON_PGM3,LD_LON_1_DSB3,LA_CUR_PRI3,IC_LON_PGM4,LD_LON_1_DSB4,LA_CUR_PRI4,IC_LON_PGM5,LD_LON_1_DSB5,LA_CUR_PRI5,IC_LON_PGM6,LD_LON_1_DSB6,LA_CUR_PRI6,IC_LON_PGM7,LD_LON_1_DSB7,LA_CUR_PRI7,IC_LON_PGM8,LD_LON_1_DSB8,LA_CUR_PRI8,IC_LON_PGM9,LD_LON_1_DSB9,LA_CUR_PRI9,IC_LON_PGM10,LD_LON_1_DSB10,LA_CUR_PRI10,IC_LON_PGM11,LD_LON_1_DSB11,LA_CUR_PRI11,IC_LON_PGM12,LD_LON_1_DSB12,LA_CUR_PRI12,IC_LON_PGM13,LD_LON_1_DSB13,LA_CUR_PRI13,IC_LON_PGM14,LD_LON_1_DSB14,LA_CUR_PRI14,IC_LON_PGM15,LD_LON_1_DSB15,LA_CUR_PRI15,IC_LON_PGM16,LD_LON_1_DSB16,LA_CUR_PRI16,IC_LON_PGM17,LD_LON_1_DSB17,LA_CUR_PRI17,IC_LON_PGM18,LD_LON_1_DSB18,LA_CUR_PRI18,IC_LON_PGM19,LD_LON_1_DSB19,LA_CUR_PRI19,IC_LON_PGM20,LD_LON_1_DSB20,LA_CUR_PRI20,IC_LON_PGM21,LD_LON_1_DSB21,LA_CUR_PRI21,IC_LON_PGM22,LD_LON_1_DSB22,LA_CUR_PRI22,IC_LON_PGM23,LD_LON_1_DSB23,LA_CUR_PRI23,IC_LON_PGM24,LD_LON_1_DSB24,LA_CUR_PRI24,IC_LON_PGM25,LD_LON_1_DSB25,LA_CUR_PRI25,IC_LON_PGM26,LD_LON_1_DSB26,LA_CUR_PRI26,IC_LON_PGM27,LD_LON_1_DSB27,LA_CUR_PRI27,IC_LON_PGM28,LD_LON_1_DSB28,LA_CUR_PRI28,IC_LON_PGM29,LD_LON_1_DSB29,LA_CUR_PRI29,IC_LON_PGM30,LD_LON_1_DSB30,LA_CUR_PRI30,IC_LON_PGM31,LD_LON_1_DSB31,LA_CUR_PRI31,IC_LON_PGM32,LD_LON_1_DSB32,LA_CUR_PRI32,IC_LON_PGM33,LD_LON_1_DSB33,LA_CUR_PRI33,IC_LON_PGM34,LD_LON_1_DSB34,LA_CUR_PRI34,IC_LON_PGM35,LD_LON_1_DSB35,LA_CUR_PRI35,IC_LON_PGM36,LD_LON_1_DSB36,LA_CUR_PRI36,IC_LON_PGM37,LD_LON_1_DSB37,LA_CUR_PRI37,IC_LON_PGM38,LD_LON_1_DSB38,LA_CUR_PRI38,IC_LON_PGM39,LD_LON_1_DSB39,LA_CUR_PRI39,IC_LON_PGM40,LD_LON_1_DSB40,LA_CUR_PRI40,IC_LON_PGM41,LD_LON_1_DSB41,LA_CUR_PRI41,IC_LON_PGM42,LD_LON_1_DSB42,LA_CUR_PRI42,IC_LON_PGM43,LD_LON_1_DSB43,LA_CUR_PRI43,IC_LON_PGM44,LD_LON_1_DSB44,LA_CUR_PRI44,IC_LON_PGM45,LD_LON_1_DSB45,LA_CUR_PRI45,IC_LON_PGM46,LD_LON_1_DSB46,LA_CUR_PRI46,IC_LON_PGM47,LD_LON_1_DSB47,LA_CUR_PRI47,IC_LON_PGM48,LD_LON_1_DSB48,LA_CUR_PRI48,IC_LON_PGM49,LD_LON_1_DSB49,LA_CUR_PRI49,IC_LON_PGM50,LD_LON_1_DSB50,LA_CUR_PRI50',8,1,8)

SELECT @ROWCOUNT = @@ROWCOUNT, @ERROR = @@ERROR

DECLARE @FileHeaderId INT = (SELECT FileHeaderId FROM ULS.[print].FileHeaders WHERE FileHeader = 'BF_SSN,DF_SPE_ACC_ID,DM_PRS_1,DM_PRS_LST,DX_STR_ADR_1,DX_STR_ADR_2,DX_STR_ADR_3,DM_CT,DC_DOM_ST,DM_FGN_CNY,DF_ZIP_CDE,DI_VLD_ADR,LD_SCL_SPR,LF_LST_DTS_SD10,WD_LON_RPD_SR,ACSKEY,IC_LON_PGM1,LD_LON_1_DSB1,LA_CUR_PRI1,IC_LON_PGM2,LD_LON_1_DSB2,LA_CUR_PRI2,IC_LON_PGM3,LD_LON_1_DSB3,LA_CUR_PRI3,IC_LON_PGM4,LD_LON_1_DSB4,LA_CUR_PRI4,IC_LON_PGM5,LD_LON_1_DSB5,LA_CUR_PRI5,IC_LON_PGM6,LD_LON_1_DSB6,LA_CUR_PRI6,IC_LON_PGM7,LD_LON_1_DSB7,LA_CUR_PRI7,IC_LON_PGM8,LD_LON_1_DSB8,LA_CUR_PRI8,IC_LON_PGM9,LD_LON_1_DSB9,LA_CUR_PRI9,IC_LON_PGM10,LD_LON_1_DSB10,LA_CUR_PRI10,IC_LON_PGM11,LD_LON_1_DSB11,LA_CUR_PRI11,IC_LON_PGM12,LD_LON_1_DSB12,LA_CUR_PRI12,IC_LON_PGM13,LD_LON_1_DSB13,LA_CUR_PRI13,IC_LON_PGM14,LD_LON_1_DSB14,LA_CUR_PRI14,IC_LON_PGM15,LD_LON_1_DSB15,LA_CUR_PRI15,IC_LON_PGM16,LD_LON_1_DSB16,LA_CUR_PRI16,IC_LON_PGM17,LD_LON_1_DSB17,LA_CUR_PRI17,IC_LON_PGM18,LD_LON_1_DSB18,LA_CUR_PRI18,IC_LON_PGM19,LD_LON_1_DSB19,LA_CUR_PRI19,IC_LON_PGM20,LD_LON_1_DSB20,LA_CUR_PRI20,IC_LON_PGM21,LD_LON_1_DSB21,LA_CUR_PRI21,IC_LON_PGM22,LD_LON_1_DSB22,LA_CUR_PRI22,IC_LON_PGM23,LD_LON_1_DSB23,LA_CUR_PRI23,IC_LON_PGM24,LD_LON_1_DSB24,LA_CUR_PRI24,IC_LON_PGM25,LD_LON_1_DSB25,LA_CUR_PRI25,IC_LON_PGM26,LD_LON_1_DSB26,LA_CUR_PRI26,IC_LON_PGM27,LD_LON_1_DSB27,LA_CUR_PRI27,IC_LON_PGM28,LD_LON_1_DSB28,LA_CUR_PRI28,IC_LON_PGM29,LD_LON_1_DSB29,LA_CUR_PRI29,IC_LON_PGM30,LD_LON_1_DSB30,LA_CUR_PRI30,IC_LON_PGM31,LD_LON_1_DSB31,LA_CUR_PRI31,IC_LON_PGM32,LD_LON_1_DSB32,LA_CUR_PRI32,IC_LON_PGM33,LD_LON_1_DSB33,LA_CUR_PRI33,IC_LON_PGM34,LD_LON_1_DSB34,LA_CUR_PRI34,IC_LON_PGM35,LD_LON_1_DSB35,LA_CUR_PRI35,IC_LON_PGM36,LD_LON_1_DSB36,LA_CUR_PRI36,IC_LON_PGM37,LD_LON_1_DSB37,LA_CUR_PRI37,IC_LON_PGM38,LD_LON_1_DSB38,LA_CUR_PRI38,IC_LON_PGM39,LD_LON_1_DSB39,LA_CUR_PRI39,IC_LON_PGM40,LD_LON_1_DSB40,LA_CUR_PRI40,IC_LON_PGM41,LD_LON_1_DSB41,LA_CUR_PRI41,IC_LON_PGM42,LD_LON_1_DSB42,LA_CUR_PRI42,IC_LON_PGM43,LD_LON_1_DSB43,LA_CUR_PRI43,IC_LON_PGM44,LD_LON_1_DSB44,LA_CUR_PRI44,IC_LON_PGM45,LD_LON_1_DSB45,LA_CUR_PRI45,IC_LON_PGM46,LD_LON_1_DSB46,LA_CUR_PRI46,IC_LON_PGM47,LD_LON_1_DSB47,LA_CUR_PRI47,IC_LON_PGM48,LD_LON_1_DSB48,LA_CUR_PRI48,IC_LON_PGM49,LD_LON_1_DSB49,LA_CUR_PRI49,IC_LON_PGM50,LD_LON_1_DSB50,LA_CUR_PRI50')
UPDATE Uls.[print].ScriptData SET FileHeaderId = @FileHeaderId WHERE ScriptDataId = 170

SELECT @ROWCOUNT = @ROWCOUNT + @@ROWCOUNT, @ERROR = @ERROR + @@ERROR


IF @ROWCOUNT = @ExpectedRowCount AND @ERROR = 0
	BEGIN
		PRINT 'Transaction committed'
		COMMIT TRANSACTION
		--ROLLBACK TRANSACTION
	END
ELSE
	BEGIN
		PRINT 'ROWCOUNT:  ' + CAST(@ROWCOUNT AS VARCHAR(10))
		PRINT 'ERROR:  ' + CAST(@ERROR AS VARCHAR(10))
		PRINT 'Transaction NOT committed'
		ROLLBACK TRANSACTION
	END
