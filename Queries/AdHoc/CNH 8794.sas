/*%LET RPTLIB = %SYSGET(reportdir);*/
%LET RPTLIB = T:\SAS;

PROC IMPORT OUT= WORK.IMPORTED
            DATAFILE= "T:\SSNs for Data Dump NH XXXX.xlsx" 
            DBMS=EXCEL REPLACE;
     RANGE="SheetX$"; 
     GETNAMES=YES;
     MIXED=NO;
     SCANTEXT=YES;
     USEDATE=YES;
     SCANTIME=YES;
RUN;

%MACRO SEND_DATA(DATASET);
LIBNAME  LEGEND  REMOTE  SERVER=LEGEND SLIBREF=WORK;
DATA LEGEND.&DATASET; *Send data to Legend;
SET &DATASET;
RUN;
%MEND;

%SEND_DATA(IMPORTED);

RSUBMIT;
LIBNAME PKUR DBX DATABASE=DNFPUTDL OWNER=PKUR;
PROC SQL;
		CREATE TABLE CLEANUP_IMPORTED AS
			SELECT	
				*
			FROM
				IMPORTED D
				INNER JOIN PKUR.FRXX_MTH_INT_RPT FRXX
					ON PUT(D.SSN,ZX.) = FRXX.BF_SSN
					AND D.LN_SEQ = PUT(FRXX.LN_SEQ,zX.)
;

QUIT;
ENDRSUBMIT;

DATA CLEANUP_IMPORTED;
SET LEGEND.CLEANUP_IMPORTED;
RUN;

PROC EXPORT DATA= WORK.CLEANUP_IMPORTED 
            OUTFILE= "T:\CNH XXXX.xlsx" 
            DBMS=EXCEL REPLACE;
     SHEET="_FRXX"; 
RUN;

