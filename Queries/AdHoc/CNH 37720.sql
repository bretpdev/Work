SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
SELECT
	LNXX.BF_SSN,
	LNXX.LN_SEQ,
	LNXX.LC_RPT_STA_CRB,
	MIN(LNXX.LD_DLQ_OCC) AS FirstDelinquency
FROM
	CDW..LNXX_LON_DLQ_HST LNXX
	INNER JOIN OPENQUERY
	(LEGEND,
	'
		SELECT DISTINCT
			BF_SSN,
			LN_SEQ,
			LC_RPT_STA_CRB
		FROM
			PKUS.LNXX_LON_CRB_RPT
		WHERE
			LC_RPT_STA_CRB IN (''XX'',''XX'',''XX'',''XX'',''XX'',''XX'',''XX'',''XX'',''XX'',''XX'')
	'
	) LNXX
		ON LNXX.BF_SSN = LNXX.BF_SSN
		AND LNXX.LN_SEQ = LNXX.LN_SEQ
WHERE
	CAST(LNXX.LD_DLQ_OCC AS DATE) <= CAST('XXXX-XX-XX' AS DATE)
GROUP BY
	LNXX.BF_SSN,
	LNXX.LN_SEQ,
	LNXX.LC_RPT_STA_CRB
ORDER BY
	LNXX.BF_SSN,
	LNXX.LN_SEQ,
	LNXX.LC_RPT_STA_CRB