--run on UHEAASQLDB
USE ULS
GO

BEGIN TRY
	BEGIN TRANSACTION;

		DECLARE @ROWCOUNT INT = 0
				,@ExpectedRowCount INT = 1428 --# of distinct zips + 1 disaster forb
				,@Disaster VARCHAR(100) = 'COVID-19 Pandemic MI/MA (DR-4494/4496)'
				,@BeginDate DATE = CONVERT(DATE,'20200327') --INCIDENT start date (not declaration date!)
				,@AddedBy VARCHAR(50) = 'UNH 66758' --change to current NH ticket
				,@DisasterID_initial INT = (SELECT MAX(DisasterId)+1 FROM dasforbfed.Disasters);

		--SET IDENTITY_INSERT [dasforbfed].[Disasters] ON; --OPSDEV ONLY

			INSERT INTO [dasforbfed].[Disasters] (DisasterId, Disaster, BeginDate, EndDate, MaxEndDate, Active, AddedBy)
			VALUES(@DisasterID_initial, @Disaster, @BeginDate, DATEADD(DAY, 89, @BeginDate), DATEADD(DAY, 89, @BeginDate), 1, @AddedBy);--1
			-- Save/Set the row count from the previously executed statement
			SELECT @ROWCOUNT = @@ROWCOUNT;		
		
		--SET IDENTITY_INSERT [dasforbfed].[Disasters] OFF; --OPSDEV ONLY
		
		--Affected zip codes:
		DECLARE @DisasterID INT = (SELECT DisasterId FROM dasforbfed.Disasters WHERE Disaster = @Disaster);

		DECLARE @Zips1 TABLE (ZipCode VARCHAR(5));
		INSERT INTO @Zips1 (ZipCode) VALUES 
('49825'),
('49668'),
('49853'),
('48667'),
('49666'),
('49107'),
('49043'),
('48876'),
('48616'),
('49405'),
('48231'),
('48164'),
('49764'),
('48265'),
('49744'),
('48836'),
('49115'),
('48812'),
('49629'),
('48023'),
('49759'),
('48131'),
('49270'),
('49094'),
('48322'),
('48840'),
('49753'),
('49752'),
('48063'),
('48224'),
('49891'),
('49757'),
('49456'),
('49014'),
('49676'),
('48191'),
('49281'),
('49002'),
('49863'),
('48034'),
('49968'),
('49319'),
('49227'),
('48634'),
('48143'),
('48756'),
('49320'),
('48865'),
('48445'),
('48735'),
('49058'),
('49010'),
('48551'),
('49076'),
('48471'),
('48222'),
('49643'),
('49510'),
('48112'),
('48738'),
('48922'),
('49795'),
('49326'),
('48862'),
('48633'),
('48468'),
('48433'),
('48027'),
('49342'),
('48159'),
('49622'),
('49422'),
('49238'),
('49663'),
('48033'),
('49267'),
('49449'),
('48663'),
('49001'),
('49037'),
('49625'),
('49229'),
('48321'),
('49322'),
('49628'),
('49343'),
('49799'),
('48875'),
('49873'),
('48437'),
('49916'),
('49318'),
('49682'),
('48629'),
('49947'),
('49330'),
('49631'),
('49518'),
('48216'),
('49915'),
('48215'),
('48095'),
('49242'),
('49228'),
('49901'),
('49062'),
('48762'),
('48117'),
('48363'),
('48710'),
('49301'),
('49355'),
('48195'),
('48065'),
('48470'),
('48202'),
('48229'),
('48658'),
('49285'),
('48158'),
('48334'),
('49706'),
('48930'),
('48071'),
('49847'),
('49881'),
('49945'),
('49336'),
('49736'),
('49246'),
('49101'),
('49401'),
('49730'),
('48182'),
('48335'),
('49348'),
('49061'),
('48622'),
('49106'),
('48882'),
('49233'),
('49254'),
('49716'),
('49633'),
('48761'),
('49259'),
('49261'),
('49802'),
('49306'),
('49866'),
('49418'),
('49801'),
('49312'),
('48360'),
('48670'),
('48627'),
('49424'),
('49546'),
('48184'),
('49113'),
('48220'),
('49356'),
('49921'),
('49426'),
('48208'),
('48426'),
('49129'),
('49220'),
('49971'),
('49444'),
('49203'),
('49895'),
('48826'),
('49872'),
('48125'),
('48754'),
('48341'),
('48173'),
('49512'),
('49797'),
('48219'),
('48306'),
('48343'),
('48133'),
('49768'),
('49430'),
('48048'),
('48615'),
('49893'),
('49793'),
('49012'),
('49051'),
('49729'),
('49887'),
('49791'),
('48632'),
('49451'),
('48556'),
('49204'),
('48139'),
('49104'),
('48160'),
('48768'),
('49402'),
('48852'),
('49664'),
('49463'),
('48217'),
('48763'),
('49886'),
('48911'),
('48825'),
('48207'),
('49818'),
('48169'),
('48554'),
('48390'),
('49677'),
('48873'),
('49617'),
('48180'),
('49112'),
('48956'),
('48326'),
('48421'),
('48166'),
('48895'),
('48091'),
('49349'),
('48706'),
('48096'),
('48866'),
('48637'),
('48278'),
('49019'),
('49530'),
('48467'),
('49304'),
('49011'),
('48889'),
('49884'),
('49221'),
('48420'),
('49411'),
('48552'),
('49050'),
('48188'),
('48103'),
('48661'),
('48650'),
('48842'),
('49125'),
('49903'),
('48228'),
('49440'),
('49734'),
('49337'),
('49665'),
('49849'),
('48888'),
('48238'),
('49722'),
('49645'),
('48312'),
('48302'),
('48154'),
('49618'),
('48841'),
('48060'),
('48723'),
('48176'),
('48472'),
('48127'),
('49060'),
('49347'),
('49274'),
('49931'),
('48820'),
('48260'),
('49836'),
('48757'),
('48449'),
('48174'),
('49417'),
('48745'),
('49409'),
('49404'),
('48030'),
('48480'),
('49436'),
('48419'),
('48816'),
('48086'),
('48235'),
('49808'),
('48770'),
('49519'),
('48108'),
('48410'),
('49839'),
('48201'),
('48210'),
('49679'),
('49749'),
('48098'),
('48118'),
('49052'),
('48059'),
('49046'),
('49735'),
('49271'),
('49723'),
('48846'),
('49656'),
('49041'),
('48017'),
('49031'),
('48113'),
('49868'),
('48619'),
('48654'),
('49357'),
('49015'),
('48662'),
('48813'),
('48725'),
('49644'),
('48858'),
('49516'),
('49020'),
('49458'),
('49852'),
('48049'),
('48104'),
('48054'),
('48801'),
('48815'),
('49784'),
('49241'),
('48146'),
('49434'),
('48277'),
('49862'),
('48370'),
('49969'),
('49419'),
('49683'),
('49248'),
('48069'),
('48225'),
('48311'),
('49782'),
('48438'),
('48659'),
('48411'),
('48916'),
('48075'),
('48618'),
('49515'),
('49831'),
('49408'),
('49738'),
('48744'),
('49913'),
('48203'),
('48340'),
('49258'),
('48638'),
('49328'),
('48818'),
('49748'),
('49619'),
('48760'),
('48232'),
('49740'),
('48028'),
('49548'),
('48105'),
('48374'),
('48092'),
('49920'),
('48236'),
('48243'),
('48213'),
('49073'),
('49236'),
('48838'),
('49079'),
('48853'),
('48604'),
('49925'),
('49615'),
('48333'),
('48883'),
('48239'),
('48428'),
('48918'),
('48641'),
('49955'),
('49420'),
('48450'),
('49961'),
('48924'),
('49845'),
('48316'),
('49640'),
('48187'),
('49646'),
('49634'),
('48128'),
('49942'),
('48318'),
('49820'),
('49835'),
('49092'),
('49560'),
('49654'),
('49696'),
('48804'),
('48879'),
('49325'),
('48221'),
('49896'),
('49272'),
('49709'),
('48429'),
('49880'),
('48809'),
('48843'),
('48045'),
('49728'),
('49437'),
('49128'),
('48845'),
('49077'),
('49068'),
('49642'),
('48168'),
('49816'),
('49036'),
('49892'),
('49053'),
('49117'),
('48623'),
('48628'),
('48867'),
('49240'),
('49224'),
('48003'),
('48332'),
('48849'),
('48082'),
('48167'),
('48189'),
('48651'),
('49202'),
('48834'),
('48915'),
('48342'),
('48603'),
('49745'),
('49821'),
('49004'),
('48829'),
('49829'),
('49504'),
('48861'),
('48432'),
('49096'),
('49948'),
('49776'),
('48004'),
('48830'),
('48150'),
('49279'),
('48371'),
('48233'),
('49626'),
('48608'),
('48079'),
('49008'),
('48047'),
('49442'),
('48827'),
('49064'),
('49963'),
('49690'),
('49805'),
('49770'),
('49781'),
('49667'),
('49675'),
('48877'),
('48035'),
('49453'),
('49775'),
('49040'),
('48436'),
('48212'),
('48453'),
('48051'),
('49074'),
('48844'),
('48860'),
('48606'),
('48417'),
('49806'),
('49126'),
('49623'),
('49021'),
('49819'),
('48022'),
('49934'),
('49057'),
('48068'),
('48120'),
('48330'),
('48451'),
('49514'),
('49707'),
('49266'),
('48909'),
('48885'),
('49910'),
('49688'),
('49765'),
('48502'),
('49653'),
('48892'),
('49127'),
('49930'),
('48237'),
('49660'),
('49785'),
('48871'),
('49468'),
('49247'),
('48912'),
('48193'),
('48415'),
('48107'),
('48857'),
('48070'),
('48444'),
('48708'),
('49119'),
('49871'),
('49962'),
('49461'),
('48323'),
('49814'),
('48085'),
('48509'),
('49525'),
('49950'),
('49635'),
('49269'),
('49720'),
('48642'),
('48649'),
('49428'),
('49874'),
('48032'),
('48505'),
('48066'),
('48067'),
('48204'),
('48115'),
('49621'),
('49287'),
('48657'),
('49555'),
('48268'),
('48356'),
('48279'),
('49024'),
('49013'),
('49283'),
('49317'),
('48121'),
('49854'),
('49711'),
('49103'),
('49689'),
('48209'),
('48304'),
('49091'),
('48288'),
('49685'),
('48454'),
('49721'),
('49423'),
('49912'),
('49323'),
('49959'),
('48026'),
('48041'),
('48081'),
('48872'),
('48701'),
('48832'),
('49459'),
('48002'),
('48951'),
('48315'),
('48455'),
('49739'),
('48141'),
('49252'),
('48138'),
('49611'),
('49027'),
('48074'),
('49713'),
('49232'),
('48557'),
('49415'),
('49335'),
('48186'),
('48161'),
('48382'),
('49344'),
('48724'),
('49097'),
('48621'),
('49967'),
('48933'),
('49848'),
('48733'),
('49788'),
('49796'),
('48656'),
('48185'),
('49894'),
('48272'),
('49302'),
('49452'),
('48021'),
('48064'),
('48177'),
('48416'),
('49733'),
('49070'),
('48380'),
('48896'),
('49885'),
('49413'),
('48823'),
('48624'),
('49718'),
('48787'),
('48747'),
('48044'),
('48730'),
('48106'),
('49063'),
('49255'),
('48856'),
('48266'),
('49756'),
('49927'),
('48609'),
('48240'),
('49056'),
('48739'),
('49833'),
('49082'),
('48729'),
('48084'),
('48242'),
('49263'),
('49544'),
('48728'),
('48705'),
('49071'),
('49807'),
('48183'),
('48822'),
('49277'),
('49755'),
('48887'),
('48101'),
('49815'),
('48205'),
('49616'),
('48446'),
('48759'),
('48859'),
('49737'),
('48901'),
('48357'),
('49284'),
('48765'),
('49034'),
('49130'),
('48083'),
('48097'),
('49766'),
('48140'),
('48366'),
('48531'),
('48749'),
('48206'),
('48652'),
('48039'),
('49009'),
('49239'),
('48418'),
('49454'),
('49026'),
('49724'),
('48864'),
('48007'),
('49237'),
('49639'),
('48848'),
('49627'),
('48346'),
('49761'),
('49883'),
('49067'),
('49841'),
('49032'),
('48037'),
('48913'),
('48625'),
('48383'),
('49620'),
('49282'),
('48439'),
('48550'),
('49918'),
('49311'),
('49333'),
('48919'),
('48135'),
('48093'),
('48110'),
('48631'),
('49727'),
('49329'),
('48076'),
('48674'),
('48465'),
('48040'),
('49712'),
('48929'),
('49870'),
('49253'),
('48009'),
('48264'),
('49016'),
('49249'),
('49084'),
('49958'),
('49006'),
('49111'),
('49792'),
('48331'),
('48386'),
('49965'),
('48362'),
('48375'),
('48046'),
('49779'),
('49673'),
('48851'),
('48377'),
('48647'),
('48126'),
('48310'),
('49042'),
('49201'),
('49017'),
('49288'),
('49087'),
('49448'),
('48727'),
('48255'),
('49305'),
('48893'),
('49093'),
('49441'),
('48460'),
('49435'),
('49834'),
('48145'),
('49686'),
('48811'),
('48422'),
('49120'),
('49116'),
('48908'),
('49078'),
('48740'),
('49038'),
('48732'),
('48412'),
('49523'),
('48320'),
('49684'),
('49902'),
('48073'),
('48325'),
('49045'),
('48214'),
('49345'),
('48227'),
('48636'),
('48137'),
('48036'),
('48532'),
('49783'),
('49230'),
('48218'),
('48223'),
('49877'),
('48742'),
('49250'),
('48897'),
('48755'),
('49960'),
('48226'),
('49601'),
('48807'),
('48328'),
('49341'),
('49030'),
('49747'),
('48072'),
('49425'),
('48837'),
('48886'),
('48506'),
('48686'),
('48722'),
('49303'),
('48507'),
('48309'),
('49636'),
('49657'),
('48042'),
('49715'),
('49534'),
('48094'),
('49460'),
('48170'),
('49083'),
('49929'),
('49878'),
('49774'),
('48850'),
('49725'),
('49786'),
('48088'),
('48707'),
('48703'),
('48005'),
('49655'),
('48423'),
('48620'),
('49268'),
('48764'),
('49865'),
('48442'),
('48833'),
('49309'),
('48746'),
('48179'),
('49705'),
('48324'),
('49351'),
('49412'),
('49919'),
('48831'),
('49612'),
('49822'),
('49072'),
('48878'),
('48854'),
('49315'),
('48726'),
('49102'),
('48881'),
('48308'),
('48824'),
('48884'),
('49321'),
('48613'),
('48743'),
('48122'),
('48099'),
('48456'),
('48329'),
('49455'),
('48874'),
('49911'),
('48894'),
('48144'),
('49726'),
('49637'),
('48748'),
('49938'),
('48461'),
('48937'),
('49827'),
('49670'),
('48230'),
('48336'),
('48614'),
('49429'),
('48314'),
('48817'),
('49751'),
('49088'),
('49307'),
('48307'),
('49507'),
('48025'),
('49864'),
('48610'),
('48198'),
('49316'),
('48089'),
('49099'),
('48737'),
('48906'),
('49650'),
('48891'),
('48835'),
('48617'),
('48234'),
('49066'),
('48006'),
('48387'),
('48116'),
('49257'),
('48381'),
('49917'),
('48435'),
('49047'),
('48197'),
('48721'),
('48397'),
('48611'),
('49858'),
('48758'),
('48475'),
('49089'),
('49599'),
('48731'),
('48376'),
('49649'),
('49780'),
('49245'),
('49081'),
('49648'),
('48347'),
('49762'),
('48847'),
('48655'),
('49502'),
('49509'),
('49332'),
('49674'),
('48015'),
('49445'),
('49406'),
('48720'),
('48626')
;
		DECLARE @Zips2 TABLE (ZipCode VARCHAR(5));
		INSERT INTO @Zips2 (ZipCode) VALUES
('48464'),
('48401'),
('48808'),
('48750'),
('48275'),
('48630'),
('49613'),
('49276'),
('49338'),
('49840'),
('49289'),
('48806'),
('48111'),
('49659'),
('48503'),
('49035'),
('48734'),
('49339'),
('48123'),
('49098'),
('49028'),
('48413'),
('48555'),
('49421'),
('48152'),
('48165'),
('49080'),
('49403'),
('48367'),
('49614'),
('49234'),
('48269'),
('49838'),
('49701'),
('49817'),
('48157'),
('48414'),
('49023'),
('49090'),
('48855'),
('49410'),
('48917'),
('48466'),
('49588'),
('49946'),
('48359'),
('49861'),
('48607'),
('48175'),
('49812'),
('48741'),
('49638'),
('48043'),
('48038'),
('49075'),
('48890'),
('49095'),
('49610'),
('48819'),
('48602'),
('48313'),
('48870'),
('49508'),
('49346'),
('48001'),
('49952'),
('48980'),
('49416'),
('49443'),
('49876'),
('48267'),
('49630'),
('49746'),
('49235'),
('49007'),
('48012'),
('48090'),
('48910'),
('48612'),
('49018'),
('48303'),
('48653'),
('48327'),
('49505'),
('48766'),
('48529'),
('48178'),
('48635'),
('48153'),
('48430'),
('49503'),
('48317'),
('48301'),
('48880'),
('48441'),
('48130'),
('48463'),
('49826'),
('49065'),
('48469'),
('49033'),
('49651'),
('49003'),
('49769'),
('49908'),
('49457'),
('48605'),
('48473'),
('48244'),
('48080'),
('49340'),
('48476'),
('49970'),
('48114'),
('48361'),
('48050'),
('49265'),
('49427'),
('48134'),
('48504'),
('48211'),
('48501'),
('49632'),
('49251'),
('49264'),
('48151'),
('49450'),
('48553'),
('48462'),
('48109'),
('49922'),
('48601'),
('48348'),
('48458'),
('49777'),
('49506'),
('49310'),
('49743'),
('48393'),
('49029'),
('49855'),
('48192'),
('49528'),
('49501'),
('48014'),
('49022'),
('48353'),
('48767'),
('49879'),
('49837'),
('48350'),
('49717'),
('48062'),
('49710'),
('49464'),
('48821'),
('49760'),
('48162'),
('49964'),
('49953'),
('49314'),
('49680'),
('49256'),
('48124'),
('48190'),
('49005'),
('48440'),
('49262'),
('49331'),
('48136'),
('49055'),
('49935'),
('48519'),
('49048'),
('49085'),
('49446'),
('49431'),
('49286'),
('48061'),
('49039'),
('49905'),
('49327'),
('48434'),
('48805'),
('48427'),
('49719'),
('48640'),
('48457'),
('01085'),
('01202'),
('02134'),
('01054'),
('01380'),
('02672'),
('02543'),
('01354'),
('02553'),
('01041'),
('02670'),
('01007'),
('01375'),
('01008'),
('01097'),
('02109'),
('01116'),
('02126'),
('02575'),
('02651'),
('01201'),
('01115'),
('01351'),
('02284'),
('02211'),
('01027'),
('01235'),
('01243'),
('01077'),
('01224'),
('02601'),
('01346'),
('02129'),
('02648'),
('02639'),
('02661'),
('01103'),
('02638'),
('01240'),
('01222'),
('01033'),
('01105'),
('01071'),
('01118'),
('02206'),
('02119'),
('02122'),
('02542'),
('01011'),
('02667'),
('02662'),
('01014'),
('02646'),
('01003'),
('01521'),
('01367'),
('02660'),
('02293'),
('01259'),
('01229'),
('02649'),
('01338'),
('01063'),
('02298'),
('02212'),
('02647'),
('01107'),
('02632'),
('02133'),
('02222'),
('01237'),
('02196'),
('02123'),
('01343'),
('01247'),
('01081'),
('01069'),
('02559'),
('02132'),
('02163'),
('01244'),
('02673'),
('01260'),
('01098'),
('01139'),
('02562'),
('01073'),
('02241'),
('01342'),
('01263'),
('01376'),
('01001'),
('01088'),
('02564'),
('01084'),
('01364'),
('02666'),
('01093'),
('01151'),
('02643'),
('02568'),
('02537'),
('01128'),
('01344'),
('01203'),
('01252'),
('01061'),
('01032'),
('02657'),
('02152'),
('01034'),
('02539'),
('01082'),
('02633'),
('01337'),
('02552'),
('02561'),
('01060'),
('01002'),
('01230'),
('02117'),
('01102'),
('01059'),
('02204'),
('02120'),
('02650'),
('01089'),
('02668'),
('01012'),
('01104'),
('02540'),
('01050'),
('01199'),
('01129'),
('01013'),
('01066'),
('01340'),
('02663'),
('02655'),
('02150'),
('02203'),
('02111'),
('01223'),
('01379'),
('02675'),
('01053'),
('01370'),
('01090'),
('02671'),
('02536'),
('01349'),
('01036'),
('01225'),
('02201'),
('01302'),
('01079'),
('01264'),
('01009'),
('02659'),
('01029'),
('01062'),
('01096'),
('01267'),
('01245'),
('02556'),
('02210'),
('01226'),
('02136'),
('02631'),
('01227'),
('01119'),
('02532'),
('01020'),
('02217'),
('02135'),
('02151'),
('02644'),
('02125'),
('01350'),
('01075'),
('01339'),
('02669'),
('02199'),
('01086'),
('01144'),
('01109'),
('02297'),
('02635'),
('01266'),
('02205'),
('02634'),
('02127'),
('02637'),
('02557'),
('01242'),
('01236'),
('01347'),
('01010'),
('01138'),
('02110'),
('01257'),
('01360'),
('02121'),
('01355'),
('02664'),
('02118'),
('02653'),
('01040'),
('02563'),
('02130'),
('02642'),
('01373'),
('01270'),
('01039'),
('01021'),
('02713'),
('01106'),
('02128'),
('01004'),
('01220'),
('01056'),
('02554'),
('01095'),
('02114'),
('01341'),
('02641'),
('02283'),
('02116'),
('02630'),
('02108'),
('02124'),
('02584'),
('01038'),
('01030'),
('02541'),
('01330'),
('02137'),
('01253'),
('02535'),
('01255'),
('01072'),
('01256'),
('02574'),
('02131'),
('01057'),
('02112'),
('01035'),
('01238'),
('01254'),
('02645'),
('01258'),
('01028'),
('01101'),
('02115'),
('01111'),
('01378'),
('01262'),
('02215'),
('01070'),
('01108'),
('01026'),
('02113'),
('02652'),
('01152'),
('01022'),
('02266'),
('01080'),
('01301'),
('02534')
;
--		DECLARE @Zips3 TABLE (ZipCode VARCHAR(5));
--		INSERT INTO @Zips3 (ZipCode) VALUES
--;

--;WITH Z AS
--(
--	SELECT * FROM @ZIPS1 
--	UNION ALL
--	SELECT * FROM @ZIPS2 
--	--UNION ALL
--	--SELECT * FROM @ZIPS3
--)
--	select 'all_zips' as category, count(ZipCode) as tally from z
--	union all
--	select 'distinct_zips' as category, count(distinct ZipCode) as tally from z
--;
--1427

		IF NOT EXISTS 
		(
			SELECT 
				ZipId 
			FROM 
				[dasforbfed].[Zips] Z1
				INNER JOIN 
				(
					SELECT * FROM @ZIPS1 
					UNION ALL
					SELECT * FROM @ZIPS2 
					--UNION ALL
					--SELECT * FROM @ZIPS3 			
				) Z2
					ON Z1.ZipCode = Z2.ZipCode
			WHERE
				Z1.DisasterId = @DisasterID
		)
		BEGIN
			INSERT INTO 
				[dasforbfed].[Zips]	(ZipCode, DisasterId)
			SELECT DISTINCT
				ZipCode
				,@DisasterID 
			FROM 
				(
					SELECT * FROM @ZIPS1 
					UNION ALL
					SELECT * FROM @ZIPS2 
					--UNION ALL
					--SELECT * FROM @ZIPS3 			
				)z
		END;

		-- Save/Set the row count from the previously executed statement
		SELECT @ROWCOUNT = @ROWCOUNT + @@ROWCOUNT;

	IF @ROWCOUNT = @ExpectedRowCount
		BEGIN
			PRINT 'Transaction committed.'
			COMMIT TRANSACTION
			--ROLLBACK TRANSACTION
		END
	ELSE
		BEGIN
			PRINT 'Transaction NOT committed.';
			PRINT 'Expected row count not met. Expecting ' +  CAST(@ExpectedRowCount AS VARCHAR(10)) + ' rows, but returned ' + CAST(@ROWCOUNT AS VARCHAR(10))+ ' rows.';
			ROLLBACK TRANSACTION;
		END
END TRY
BEGIN CATCH
	PRINT 'Transaction NOT committed. Errors found in SQL statement.';
	ROLLBACK TRANSACTION;
	THROW;
END CATCH;
