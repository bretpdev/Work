USE UDW
GO
--summary
SELECT
	PD30.DC_DOM_ST AS [STATE],
	COUNT(DISTINCT PD10.DF_PRS_ID) AS BORROWER_COUNT
FROM
	UDW..PD10_PRS_NME PD10
	INNER JOIN UDW..PD30_PRS_ADR PD30
		ON PD30.DF_PRS_ID = PD10.DF_PRS_ID
	INNER JOIN UDW..LN10_LON LN10
		ON LN10.BF_SSN = PD10.DF_PRS_ID
WHERE
	PD30.DI_VLD_ADR = 'Y'
	AND PD30.DC_DOM_ST IN ('WA','CT','CO','NJ','VA','IL', 'NY')
	AND PD30.DC_ADR = 'L'
	AND LN10.LA_CUR_PRI > 0.00
	AND LN10.LC_STA_LON10 = 'R'
GROUP BY
	PD30.DC_DOM_ST


SELECT
	PD10.DF_SPE_ACC_ID,
	LN10.LN_SEQ,
	PD30.DC_DOM_ST
FROM
	UDW..PD10_PRS_NME PD10
	INNER JOIN UDW..PD30_PRS_ADR PD30
		ON PD30.DF_PRS_ID = PD10.DF_PRS_ID
	INNER JOIN UDW..LN10_LON LN10
		ON LN10.BF_SSN = PD10.DF_PRS_ID
WHERE
	PD30.DI_VLD_ADR = 'Y'
	AND PD30.DC_DOM_ST = 'WA' --,'CT','CO','NJ','VA','IL')
	AND PD30.DC_ADR = 'L'
	AND LN10.LA_CUR_PRI > 0.00
	AND LN10.LC_STA_LON10 = 'R'

SELECT
	PD10.DF_SPE_ACC_ID,
	LN10.LN_SEQ,
	PD30.DC_DOM_ST
FROM
	UDW..PD10_PRS_NME PD10
	INNER JOIN UDW..PD30_PRS_ADR PD30
		ON PD30.DF_PRS_ID = PD10.DF_PRS_ID
	INNER JOIN UDW..LN10_LON LN10
		ON LN10.BF_SSN = PD10.DF_PRS_ID
WHERE
	PD30.DI_VLD_ADR = 'Y'
	AND PD30.DC_DOM_ST = 'CT' --,'CT','CO','NJ','VA','IL')
	AND PD30.DC_ADR = 'L'
	AND LN10.LA_CUR_PRI > 0.00
	AND LN10.LC_STA_LON10 = 'R'

SELECT
	PD10.DF_SPE_ACC_ID,
	LN10.LN_SEQ,
	PD30.DC_DOM_ST
FROM
	UDW..PD10_PRS_NME PD10
	INNER JOIN UDW..PD30_PRS_ADR PD30
		ON PD30.DF_PRS_ID = PD10.DF_PRS_ID
	INNER JOIN UDW..LN10_LON LN10
		ON LN10.BF_SSN = PD10.DF_PRS_ID
WHERE
	PD30.DI_VLD_ADR = 'Y'
	AND PD30.DC_DOM_ST = 'CO' --,'CT','CO','NJ','VA','IL')
	AND PD30.DC_ADR = 'L'
	AND LN10.LA_CUR_PRI > 0.00
	AND LN10.LC_STA_LON10 = 'R'

SELECT
	PD10.DF_SPE_ACC_ID,
	LN10.LN_SEQ,
	PD30.DC_DOM_ST
FROM
	UDW..PD10_PRS_NME PD10
	INNER JOIN UDW..PD30_PRS_ADR PD30
		ON PD30.DF_PRS_ID = PD10.DF_PRS_ID
	INNER JOIN UDW..LN10_LON LN10
		ON LN10.BF_SSN = PD10.DF_PRS_ID
WHERE
	PD30.DI_VLD_ADR = 'Y'
	AND PD30.DC_DOM_ST = 'NJ' --,'CT','CO','NJ','VA','IL')
	AND PD30.DC_ADR = 'L'
	AND LN10.LA_CUR_PRI > 0.00
	AND LN10.LC_STA_LON10 = 'R'

SELECT
	PD10.DF_SPE_ACC_ID,
	LN10.LN_SEQ,
	PD30.DC_DOM_ST
FROM
	UDW..PD10_PRS_NME PD10
	INNER JOIN UDW..PD30_PRS_ADR PD30
		ON PD30.DF_PRS_ID = PD10.DF_PRS_ID
	INNER JOIN UDW..LN10_LON LN10
		ON LN10.BF_SSN = PD10.DF_PRS_ID
WHERE
	PD30.DI_VLD_ADR = 'Y'
	AND PD30.DC_DOM_ST = 'VA' --,'CT','CO','NJ','VA','IL')
	AND PD30.DC_ADR = 'L'
	AND LN10.LA_CUR_PRI > 0.00
	AND LN10.LC_STA_LON10 = 'R'

SELECT
	PD10.DF_SPE_ACC_ID,
	LN10.LN_SEQ,
	PD30.DC_DOM_ST
FROM
	UDW..PD10_PRS_NME PD10
	INNER JOIN UDW..PD30_PRS_ADR PD30
		ON PD30.DF_PRS_ID = PD10.DF_PRS_ID
	INNER JOIN UDW..LN10_LON LN10
		ON LN10.BF_SSN = PD10.DF_PRS_ID
WHERE
	PD30.DI_VLD_ADR = 'Y'
	AND PD30.DC_DOM_ST = 'IL' --,'CT','CO','NJ','VA','IL')
	AND PD30.DC_ADR = 'L'
	AND LN10.LA_CUR_PRI > 0.00
	AND LN10.LC_STA_LON10 = 'R'

SELECT
	PD10.DF_SPE_ACC_ID,
	LN10.LN_SEQ,
	PD30.DC_DOM_ST
FROM
	UDW..PD10_PRS_NME PD10
	INNER JOIN UDW..PD30_PRS_ADR PD30
		ON PD30.DF_PRS_ID = PD10.DF_PRS_ID
	INNER JOIN UDW..LN10_LON LN10
		ON LN10.BF_SSN = PD10.DF_PRS_ID
WHERE
	PD30.DI_VLD_ADR = 'Y'
	AND PD30.DC_DOM_ST = 'NY' --,'CT','CO','NJ','VA','IL')
	AND PD30.DC_ADR = 'L'
	AND LN10.LA_CUR_PRI > 0.00
	AND LN10.LC_STA_LON10 = 'R'