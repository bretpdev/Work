--Default claim type 1

SELECT DISTINCT
	LN10.BF_SSN,
	LN10.LN_SEQ,
	LN10.LF_LON_CUR_OWN,
	ABS(LN10.LA_CUR_PRI) AS LA_CUR_PRI,
	ABS(LN90.LA_FAT_CUR_PRI) AS LA_FAT_CUR_PRI,
	ABS(LN90.LA_FAT_NSI) AS LA_FAT_NSI,
	SUM(ABS(ISNULL(LN90.LA_FAT_CUR_PRI,0.00)) + ISNULL(ABS(LN90.LA_FAT_NSI),0.00)) AS TotalTransaction
FROM
	UDW..LN10_LON LN10
	INNER JOIN UDW..LN90_FIN_ATY LN90
		ON LN90.BF_SSN = LN10.BF_SSN
		AND LN90.LN_SEQ = LN10.LN_SEQ
		AND LN90.PC_FAT_TYP = '10'
		AND LN90.PC_FAT_SUB_TYP = '30'
		AND LN90.LC_STA_LON90 = 'A'
		AND ISNULL(RTRIM(LN90.LC_FAT_REV_REA),'') = ''
	INNER JOIN UDW..LN40_LON_CLM_PCL LN40
		ON LN40.BF_SSN = LN10.BF_SSN
		AND LN40.LN_SEQ = LN10.LN_SEQ
		AND LN40.LC_REA_CLP_LON = '06'
		AND LN40.LD_CAN_CLM_PCL IS NULL
	INNER JOIN UDW..DW01_DW_CLC_CLU DW01
		ON DW01.BF_SSN = LN10.BF_SSN
		AND DW01.LN_SEQ = LN10.LN_SEQ
		AND DW01.WC_DW_LON_STA = '12'
WHERE
	(
		LN10.LF_LON_CUR_OWN LIKE '829769%'
		OR LN10.LF_LON_CUR_OWN LIKE '830248%'
		OR LN10.LF_LON_CUR_OWN IN ('826717')
	)
	
--All claim paid loans
SELECT DISTINCT
	LN10.BF_SSN,
	LN10.LN_SEQ,
	LN10.LF_LON_CUR_OWN,
	ABS(LN10.LA_CUR_PRI) AS LA_CUR_PRI,
	ABS(LN90.LA_FAT_CUR_PRI) AS LA_FAT_CUR_PRI,
	ABS(LN90.LA_FAT_NSI) AS LA_FAT_NSI,
	SUM(ABS(ISNULL(LN90.LA_FAT_CUR_PRI,0.00)) + ISNULL(ABS(LN90.LA_FAT_NSI),0.00)) AS TotalTransaction
FROM
	UDW..LN10_LON LN10
	INNER JOIN UDW..LN90_FIN_ATY LN90
		ON LN90.BF_SSN = LN10.BF_SSN
		AND LN90.LN_SEQ = LN10.LN_SEQ
		AND LN90.PC_FAT_TYP = '10'
		AND LN90.PC_FAT_SUB_TYP = '30'
		AND LN90.LC_STA_LON90 = 'A'
		AND ISNULL(RTRIM(LN90.LC_FAT_REV_REA),'') = ''
	INNER JOIN UDW..DW01_DW_CLC_CLU DW01
		ON DW01.BF_SSN = LN10.BF_SSN
		AND DW01.LN_SEQ = LN10.LN_SEQ
		AND DW01.WC_DW_LON_STA = '12'
WHERE
	(
		LN10.LF_LON_CUR_OWN LIKE '829769%'
		OR LN10.LF_LON_CUR_OWN LIKE '830248%'
		OR LN10.LF_LON_CUR_OWN IN ('826717')
	)