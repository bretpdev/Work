SELECT
	*
FROM OPENQUERY
(
	LEGEND,
	'
		SELECT
			BF_SSN,
			LN_SEQ
		FROM
			PKUB.LNXX_LON
		WHERE
			LF_DOE_SCL_ORG IN
			(
				 ''XXXXXXXX'' 
				,''XXXXXXXX'' 
			)
	'
);



--ever attended:
SELECT	* FROM OPENQUERY(LEGEND,'
	SELECT DISTINCT
		LNXX.BF_SSN,
		LNXX.LN_SEQ,
		LNXX.LD_TRM_BEG,
		LNXX.LF_DOE_SCL_ORG,
		MRXX.LF_DOE_SCL_ENR_CUR,
		CASE
			WHEN LNXX.LF_DOE_SCL_ORG IN (
				 ''XXXXXXXX'' 
				,''XXXXXXXX'' 
			)
			AND MRXX.LF_DOE_SCL_ENR_CUR IN (
				 ''XXXXXXXX'' 
				,''XXXXXXXX'' 
			)
			THEN ''BOTH''
			WHEN LNXX.LF_DOE_SCL_ORG IN (
				 ''XXXXXXXX'' 
				,''XXXXXXXX'' 
			)
			THEN ''ORIGINAL''
			WHEN MRXX.LF_DOE_SCL_ENR_CUR IN (
				 ''XXXXXXXX'' 
				,''XXXXXXXX'' 
			)
			THEN ''TRANSFER''
		END AS MATCH
		,WQXX.PF_REQ_ACT
	FROM
		PKUB.LNXX_LON LNXX
		INNER JOIN PKUB.WQXX_TSK_QUE WQXX
			ON LNXX.BF_SSN = WQXX.BF_SSN
			AND WQXX.PF_REQ_ACT = ''DIFCR''
		LEFT JOIN PKUR.MRXX_MGT_RPT_LON MRXX
			ON LNXX.BF_SSN = MRXX.BF_SSN
	WHERE
		--DAYS(LNXX.LD_TRM_BEG) BETWEEN DAYS(''XXXX-XX-XX'') AND DAYS(CURRENT DATE)
		--AND 
		(
				LNXX.LF_DOE_SCL_ORG IN (
					 ''XXXXXXXX'' 
					,''XXXXXXXX'' 
				)
				OR MRXX.LF_DOE_SCL_ENR_CUR IN (
					 ''XXXXXXXX'' 
					,''XXXXXXXX'' 
				)
		)
	ORDER BY
		LNXX.LD_TRM_BEG
') 