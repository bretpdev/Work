
LIBNAME  DUSTER  REMOTE  SERVER=DUSTER  SLIBREF=WORK;
RSUBMIT;


PROC SQL;
	CONNECT TO DB2 (DATABASE=DLGSUTWH);

	CREATE TABLE DEMO AS
		SELECT 
			*
		FROM 
			CONNECTION TO DB2 
				(
					SELECT
						LN66.*
					FROM	
						OLWHRM1.LN10_LON LN10
					INNER JOIN OLWHRM1.LN65_LON_RPS LN65
						ON LN65.BF_SSN = LN10.BF_SSN
						AND LN65.LN_SEQ = LN10.LN_SEQ
					INNER JOIN OLWHRM1.RS10_BR_RPD RS10
						ON RS10.BF_SSN = LN65.BF_SSN
						AND RS10.LN_RPS_SEQ = LN65.LN_RPS_SEQ
					INNER JOIN OLWHRM1.LN66_LON_RPS_SPF LN66
						ON LN65.BF_SSN = LN66.BF_SSN
						AND LN65.LN_SEQ = LN66.LN_SEQ
						AND LN65.LN_RPS_SEQ = LN66.LN_RPS_SEQ
					WHERE
						LN10.LA_CUR_PRI > 0
						AND LN10.LC_STA_LON10 = 'R'
						AND LN65.LC_TYP_SCH_DIS IN ('IB','IL')
						AND LN65.LC_STA_LON65 = 'A'
						AND LN10.IF_DOE_LDR IN ('826717','830248')
						AND LN66.LN_GRD_RPS_SEQ = 3
					

					FOR READ ONLY WITH UR
				)
	;

	DISCONNECT FROM DB2;

	/*%PUT  SQLXRC= >>> &SQLXRC <<< ||| SQLXMSG= >>> &SQLXMSG >>> ;  ** INCLUDES ERROR MESSAGES TO SAS LOG  ;*/
	/*%SQLCHECK;*/
QUIT;

ENDRSUBMIT;

DATA DEMO; SET DUSTER.DEMO; RUN;

PROC EXPORT DATA = WORK.DEMO 
            OUTFILE = "T:\NH 20213.xls" 
            DBMS = EXCEL
			REPLACE;
     SHEET="Sheet1"; 
RUN;
