USE ReportServer
GO

BEGIN TRANSACTION
	DECLARE @ERROR INT = X
	DECLARE @ROWCOUNT INT = X
	DECLARE @Expected INT = XX

--select * from ReportServer..Subscriptions where LastStatus like '%UNWCXX%' or LastStatus like '%uheinvmet%'
--This is being used to have it resubmit on Monday the Xnd
UPDATE
	ReportServer..Subscriptions
SET
	LastStatus = 'forced failure'
WHERE 
	SubscriptionID IN 
	(
	'XXCAXXXE-XXXD-XXCA-XXDX-XXEBAXXEXBEX',
	'XXXDCBEX-XBAX-XXFX-XFXX-XXXXDXXFXXXB',
	'XXXXXXEC-FFXX-XCXX-XXBX-XXXEXCXDXXEX',
	'CEXFXXAX-DACX-XXXX-AXXX-XDXFXXXXECEX',
	'XXXXXXDX-XXXX-XFXX-BDXX-XXDXXBXXCDXX',
	'XXCXECXX-XEXX-XXCX-BDXA-XCXXAXXFBBBX',
	'BXAXXXEX-XEEX-XXXD-BACX-XFBXFFXXXFCX',
	'XXXXFXXX-FXXF-XEBX-BXXB-XCXBXXXDXABF',
	'FEXXXXXX-BXXX-XXFX-AXXE-XXFXXEXDAAFF',
	'AXBXXDDX-XEXF-XDXC-BBXX-XXXXDXXXECXD',
	'XFXXXDDX-XXXX-XDBX-XXEX-XXXFXXXAXXBX',
	'EXADFFXX-XXXX-XCXX-XEEX-XXAXXXXXXXXE',
	'EXBXXAXC-FXXB-XBXA-XXAX-XXXXXAXEAXXX',
	'XXXXXXXX-XBDX-XAXX-XXXD-XXXXXXXXXXXE',
	'XDXFCXXX-AXFX-XAXX-XXCA-XCFXXEXDXAXC',
	'XXDXFEXX-XDXX-XXXX-AEXX-XXDFCDFXXXXX',
	'XXXXXXXF-XXFX-XXFX-BXFX-XXBAEXAXXBXA',
	'ECXXXXXD-XBDX-XXBX-XXXD-AXAFXCXXXXDC',
	'XDEAXXXX-XCXX-XFXX-AXXX-BXXXEAXXBXXX',
	'XXXBXAXX-EFBX-XXXX-AEAA-BXXXXXEXECDX',
	'XDXXXDXE-ACCA-XXXX-XCFC-BXCXXXEXXXXX',
	'XXXCFXFX-XAFE-XXXB-BXEX-BXDXAXBBDXXF',
	'XAXXDCFX-XXDX-XXEX-AXXX-CXXXXEXCXCXX',
	'EAXXXXDX-EBXC-XXFB-XXXC-DDBDXXDXXCCX',
	'XDXXXXFX-XXDC-XXXX-XXDX-DFXXBXEXBXXF'
	)

	-- Save/Set the row count and error number (if any) from the previously executed statement
	SELECT @ROWCOUNT = @@ROWCOUNT, @ERROR = @@ERROR

IF @ROWCOUNT = @Expected AND @ERROR = X
	BEGIN
		PRINT 'Transaction committed'
		COMMIT TRANSACTION
		--ROLLBACK TRANSACTION
	END
ELSE
	BEGIN
		PRINT 'ROWCOUNT:  ' + CAST(@ROWCOUNT as VARCHAR(XX))
		PRINT 'ERROR:  ' + CAST(@ERROR as VARCHAR(XX))
		PRINT 'Transaction NOT committed'
		ROLLBACK TRANSACTION
	END