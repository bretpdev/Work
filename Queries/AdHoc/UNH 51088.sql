select * from openquery (duster,'
			SELECT 
				X.BF_SSN 
				,X.PC_FAT_TYP||X.PC_FAT_SUB_TYP AS TX_TYP
				,X.LD_FAT_EFF 
				,ABS(SUM(X.LA_FAT_CUR_PRI)) AS LA_FAT_CUR_PRI
				,ABS(SUM(X.LA_FAT_NSI)) AS LA_FAT_NSI
				,ABS(SUM(X.LA_FAT_LTE_FEE)) AS LA_FAT_LTE_FEE
			FROM 
				OLWHRM1.LN90_FIN_ATY X
				INNER JOIN 
				(
					SELECT 
						BF_SSN
						,MAX(LD_FAT_EFF) AS LD_FAT_EFF
					FROM 
						OLWHRM1.LN90_FIN_ATY 
					WHERE 
						LC_FAT_REV_REA = ''''
						AND LC_STA_LON90 = ''A''
						AND PC_FAT_TYP = ''10''
						AND PC_FAT_SUB_TYP IN (''10'',''11'',''12'',''41'')
						and bf_ssn = ''528613587''
					GROUP BY 
						BF_SSN
				) Y
				ON X.BF_SSN = Y.BF_SSN
				AND X.LD_FAT_EFF = Y.LD_FAT_EFF
			WHERE 
				X.PC_FAT_TYP = ''10''
				AND X.PC_FAT_SUB_TYP IN (''10'',''11'',''12'',''41'')
				AND X.LC_FAT_REV_REA = '' '' 
				AND X.LC_STA_LON90 = ''A''


			and x.bf_ssn = ''528613587''

			GROUP BY 
				X.BF_SSN
				,X.PC_FAT_TYP
				,X.PC_FAT_SUB_TYP
				,X.LD_FAT_EFF 
')


528613587



SELECT DISTINCT * FROM OPENQUERY (DUSTER,'
	SELECT
		PD10.DF_SPE_ACC_ID
		,LN10.BF_SSN
	FROM
		OLWHRM1.PD10_PRS_NME PD10
		INNER JOIN OLWHRM1.LN10_LON LN10
			ON LN10.BF_SSN = PD10.DF_PRS_ID	
	WHERE
		PD10.DF_SPE_ACC_ID IN
		(
 ''1550022150'' 
,''5682218749'' 
,''6088665791'' 
,''2357665240'' 
,''4326740493'' 
,''5005071838'' 
,''0745372812'' 
,''5510762467'' 
		)

')	ORDER BY
		BF_SSN;





SELECT DISTINCT * FROM OPENQUERY (DUSTER,'
	SELECT
		PD10.DF_SPE_ACC_ID
		,LN10.BF_SSN
		,BL10.LC_IND_BIL_SNT
		,MAX.LD_BIL_CRT
		,BL10.LC_BIL_TYP
		,LN10.IC_LON_PGM
		--,COUNT(LN10.LN_SEQ) AS LN_COUNT
		,LN60.LD_FOR_BEG
		,LN60.LD_FOR_END

	FROM
		OLWHRM1.BL10_BR_BIL BL10
		INNER JOIN OLWHRM1.PD10_PRS_NME PD10
			ON BL10.BF_SSN = PD10.DF_PRS_ID
		INNER JOIN OLWHRM1.LN10_LON LN10
			ON BL10.BF_SSN = LN10.BF_SSN
		INNER JOIN
		(
			SELECT
				BL10.BF_SSN
				,MAX(BL10.LD_BIL_CRT) AS LD_BIL_CRT
			FROM
				OLWHRM1.BL10_BR_BIL BL10
			GROUP BY
				BL10.BF_SSN
		) MAX
			ON BL10.BF_SSN = MAX.BF_SSN
			AND BL10.LD_BIL_CRT = MAX.LD_BIL_CRT
		LEFT JOIN
		(
			SELECT
				LN60.BF_SSN
				,LN60.LN_SEQ
				,LN60.LD_FOR_BEG
				,LN60.LD_FOR_END
			FROM
				OLWHRM1.LN60_BR_FOR_APV LN60
			WHERE
				-- BETWEEN LD_FOR_BEG AND LD_FOR_END
				--AND 
				LN60.LC_STA_LON60 = ''A''
		) LN60
			ON LN10.BF_SSN = LN60.BF_SSN
			AND LN10.LN_SEQ = LN60.LN_SEQ
	WHERE
		PD10.DF_SPE_ACC_ID IN
		(
			 ''1550022150''
			,''5682218749''
			,''6845495479''
			,''1918872203'' 
			,''6088665791'' 
			,''2357665240'' 
			,''5265063179'' 
			,''4326740493'' 
			,''5005071838'' 
			,''0745372812'' 
			,''5510762467''
		)
	--GROUP BY
	--	PD10.DF_SPE_ACC_ID
	--	,BL10.LC_IND_BIL_SNT
	--	,MAX.LD_BIL_CRT
	--	,BL10.LC_BIL_TYP
	--	,LN10.IC_LON_PGM
	ORDER BY 
		PD10.DF_SPE_ACC_ID
		,MAX.LD_BIL_CRT
');

SELECT * FROM OPENQUERY (DUSTER,'
SELECT 
	LN10.BF_SSN
	,CASE
		WHEN PD30_B.DC_DOM_ST_B <> '' '' 
			AND SUBSTR(PD30_B.DF_ZIP_CDE_B,6,1) = '' ''
		THEN SUBSTR(PD30_B.DF_ZIP_CDE_B,1,5)
		WHEN PD30_B.DC_DOM_ST_B <> '' '' 
			AND SUBSTR(PD30_B.DF_ZIP_CDE_B,6,1) <> '' ''
		THEN SUBSTR(PD30_B.DF_ZIP_CDE_B,1,5)||''-''||SUBSTR(PD30_B.DF_ZIP_CDE_B,6,4)
		WHEN PD30_B.DC_DOM_ST_B = '' ''
		THEN PD30_B.DF_ZIP_CDE_B
		END AS DF_ZIP_CDE_B
	,PD30_B.DM_CT_B
	,PD30_B.DX_STR_ADR_3_B
	,PD30_B.DX_STR_ADR_2_B
	,PD30_B.DX_STR_ADR_1_B
	,PD30_B.DC_ADR_B
	,CASE 
		WHEN PD30_B.DC_DOM_ST_B <> '' '' 
		THEN PD30_B.DC_DOM_ST_B
		WHEN PD30_B.DC_DOM_ST_B = '' '' 
		THEN PD30_B.DM_FGN_ST_B
		END AS STATE_B
	,PD30_B.DM_FGN_CNY_B
	,pd30_b.dc_adr
FROM 
	OLWHRM1.PD10_PRS_NME PD10
	INNER JOIN OLWHRM1.LN10_LON LN10
		ON PD10.DF_PRS_ID = LN10.BF_SSN
	INNER JOIN 
	(
		SELECT 
			DF_PRS_ID
			,dc_adr
			,DF_ZIP_CDE AS DF_ZIP_CDE_B
			,DM_CT AS DM_CT_B
			,DX_STR_ADR_3 AS DX_STR_ADR_3_B
			,DX_STR_ADR_2 AS DX_STR_ADR_2_B
			,DX_STR_ADR_1 AS DX_STR_ADR_1_B
			,DC_ADR AS DC_ADR_B
			,DC_DOM_ST AS DC_DOM_ST_B
			,DM_FGN_ST AS DM_FGN_ST_B
			,DM_FGN_CNY AS DM_FGN_CNY_B
			FROM 
			OLWHRM1.PD30_PRS_ADR
		WHERE 
			--DC_ADR = ''B''
			--AND 
			DI_VLD_ADR = ''Y''
	) PD30_B
	ON PD10.DF_PRS_ID = PD30_B.DF_PRS_ID
WHERE 
	LN10.LC_STA_LON10 = ''R''
	AND 
	LN10.BF_SSN IN 
	(
		''322724946'',
		''494969524'',
		''528550140'',
		''528658816'',
		''421192660'',
		''026660905'',
		''520250722'',
		''630053718'',
		''626041396'',
		''520703436''
	)
')