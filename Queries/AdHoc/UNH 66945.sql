--run on UHEAASQLDB
USE ULS
GO

BEGIN TRY
	BEGIN TRANSACTION;

		DECLARE @ROWCOUNT INT = 0
				,@ExpectedRowCount INT = 1440 --# of distinct zips + 1 disaster forb
				,@Disaster VARCHAR(100) = 'COVID-19 Pandemic DE/SD/NM (DR-4526/4527/4529)'
				,@BeginDate DATE = CONVERT(DATE,'20200405') --declaration date
				,@AddedBy VARCHAR(50) = 'UNH 66945' --change to current NH ticket
				,@DisasterID_initial INT = (SELECT MAX(DisasterId)+1 FROM dasforbuh.Disasters);

		--SET IDENTITY_INSERT [dasforbuh].[Disasters] ON; --OPSDEV ONLY

			INSERT INTO [dasforbuh].[Disasters]
			(
				DisasterId, 
				Disaster, 
				BeginDate, 
				EndDate, 
				MaxEndDate, 
				DelinquencyOverride, --set to 1 for COVID
				Active, 
				AddedBy
			)
			VALUES
			(
				@DisasterID_initial, 
				@Disaster, 
				@BeginDate, 
				DATEADD(DAY, 89, @BeginDate), 
				DATEADD(DAY, 89, @BeginDate), 
				1, 
				1, 
				@AddedBy
			);--1
			-- Save/Set the row count from the previously executed statement
			SELECT @ROWCOUNT = @@ROWCOUNT;		
		
		--SET IDENTITY_INSERT [dasforbuh].[Disasters] OFF; --OPSDEV ONLY
		
		--Affected zip codes:
		DECLARE @DisasterID INT = (SELECT DisasterId FROM dasforbuh.Disasters WHERE Disaster = @Disaster);

		DECLARE @Zips1 TABLE (ZipCode VARCHAR(5)); 
		INSERT INTO @Zips1 (ZipCode) VALUES 
--Affected Zip Codes
('57572'),
('57379'),
('57005'),
('57236'),
('57109'),
('57252'),
('57031'),
('57709'),
('57323'),
('57033'),
('57566'),
('57426'),
('57787'),
('57522'),
('57361'),
('57645'),
('57006'),
('57471'),
('57625'),
('57108'),
('57442'),
('57367'),
('57724'),
('57445'),
('57427'),
('57077'),
('57103'),
('57438'),
('57245'),
('57015'),
('57025'),
('57428'),
('57585'),
('57066'),
('57631'),
('57043'),
('57474'),
('57434'),
('57241'),
('57576'),
('57313'),
('57330'),
('57279'),
('57650'),
('57201'),
('57331'),
('57218'),
('57224'),
('57424'),
('57580'),
('57579'),
('57748'),
('57543'),
('57075'),
('57630'),
('57349'),
('57315'),
('57436'),
('57036'),
('57763'),
('57042'),
('57767'),
('57329'),
('57364'),
('57380'),
('57358'),
('57455'),
('57755'),
('57773'),
('57632'),
('57016'),
('57312'),
('57059'),
('57421'),
('57270'),
('57764'),
('57751'),
('57792'),
('57219'),
('57384'),
('57401'),
('57430'),
('57439'),
('57382'),
('57037'),
('57030'),
('57020'),
('57046'),
('57051'),
('57319'),
('57584'),
('57317'),
('57101'),
('57386'),
('57555'),
('57563'),
('57232'),
('57356'),
('57633'),
('57622'),
('57234'),
('57324'),
('57799'),
('57242'),
('57263'),
('57766'),
('57621'),
('57706'),
('57226'),
('57271'),
('57039'),
('57063'),
('57521'),
('57354'),
('57018'),
('57268'),
('57350'),
('57754'),
('57564'),
('57326'),
('57788'),
('57363'),
('57760'),
('57570'),
('57022'),
('57068'),
('57440'),
('57475'),
('57562'),
('57479'),
('57577'),
('57186'),
('57243'),
('57365'),
('57078'),
('57258'),
('57028'),
('57262'),
('57065'),
('57429'),
('57716'),
('57641'),
('57567'),
('57013'),
('57640'),
('57661'),
('57193'),
('57433'),
('57257'),
('57601'),
('57770'),
('57214'),
('57532'),
('57321'),
('57732'),
('57359'),
('57017'),
('57446'),
('57055'),
('57272'),
('57481'),
('57107'),
('57301'),
('57249'),
('57231'),
('57544'),
('57468'),
('57785'),
('57038'),
('57216'),
('57435'),
('57073'),
('57278'),
('57259'),
('57067'),
('57541'),
('57422'),
('57335'),
('57076'),
('57551'),
('57032'),
('57273'),
('57531'),
('57328'),
('57337'),
('57269'),
('57533'),
('57340'),
('57325'),
('57660'),
('57105'),
('57634'),
('57717'),
('57070'),
('57437'),
('57248'),
('57469'),
('57552'),
('57003'),
('57626'),
('57794'),
('57548'),
('57035'),
('57476'),
('57701'),
('57553'),
('57780'),
('57072'),
('57737'),
('57344'),
('57769'),
('57477'),
('57260'),
('57239'),
('57117'),
('57366'),
('57027'),
('57779'),
('57376'),
('57730'),
('57052'),
('57534'),
('57752'),
('57568'),
('57449'),
('57441'),
('57247'),
('57227'),
('57540'),
('57761'),
('57744'),
('57332'),
('57255'),
('57385'),
('57523'),
('57375'),
('57223'),
('57574'),
('57656'),
('57238'),
('57636'),
('57725'),
('57198'),
('57026'),
('57448'),
('57460'),
('57339'),
('57118'),
('57314'),
('57212'),
('57644'),
('57004'),
('57024'),
('57467'),
('57639'),
('57049'),
('57355'),
('57782'),
('57041'),
('57014'),
('57547'),
('57420'),
('57451'),
('57536'),
('57461'),
('57466'),
('57104'),
('57266'),
('57346'),
('57529'),
('57265'),
('57062'),
('57362'),
('57772'),
('57034'),
('57348'),
('57012'),
('57256'),
('57383'),
('57703'),
('57071'),
('57368'),
('57381'),
('57783'),
('57045'),
('57473'),
('57048'),
('57776'),
('57657'),
('57007'),
('57058'),
('57747'),
('57264'),
('57472'),
('57029'),
('57722'),
('57658'),
('57322'),
('57225'),
('57371'),
('57311'),
('57465'),
('57456'),
('57276'),
('57559'),
('57714'),
('57021'),
('57735'),
('57762'),
('57756'),
('57370'),
('57649'),
('57652'),
('57374'),
('57047'),
('57399'),
('57646'),
('57040'),
('57623'),
('57110'),
('57002'),
('57235'),
('57432'),
('57054'),
('57702'),
('57220'),
('57759'),
('57402'),
('57057'),
('57501'),
('57261'),
('57246'),
('57758'),
('57537'),
('57719'),
('57560'),
('57221'),
('57345'),
('57528'),
('57718'),
('57642'),
('57569'),
('57334'),
('57470'),
('57237'),
('57353'),
('57520'),
('57648'),
('57741'),
('57750'),
('57720'),
('57791'),
('57050'),
('57793'),
('57251'),
('57217'),
('57454'),
('57106'),
('57213'),
('57538'),
('57064'),
('57571'),
('57651'),
('57001'),
('57638'),
('57620'),
('57369'),
('57197'),
('57452'),
('57450'),
('57069'),
('57342'),
('57373'),
('57341'),
('57274'),
('57233'),
('57061'),
('57745'),
('57738'),
('57659'),
('57790'),
('57010'),
('57457'),
('57053'),
('57775'),
('19731'),
('19725'),
('19702'),
('19963'),
('19967'),
('19891'),
('19809'),
('19897'),
('19936'),
('19901'),
('19890'),
('19960'),
('19938'),
('19930'),
('19884'),
('19708'),
('19953'),
('19807'),
('19969'),
('19939'),
('19717'),
('19893'),
('19905'),
('19714'),
('19970'),
('19973'),
('19713'),
('19952'),
('19950'),
('19977'),
('19896'),
('19951'),
('19707'),
('19904'),
('19810'),
('19947'),
('19802'),
('19899'),
('19806'),
('19720'),
('19721'),
('19946'),
('19718'),
('19898'),
('19941'),
('19886'),
('19968'),
('19902'),
('19709'),
('19715'),
('19805'),
('19895'),
('19943'),
('19734'),
('19956'),
('19730'),
('19906'),
('19962'),
('19955'),
('19733'),
('19711'),
('19880'),
('19803'),
('19804'),
('19885'),
('19934'),
('19903'),
('19732'),
('19940'),
('19710'),
('19801'),
('19850'),
('19701'),
('19736'),
('19892'),
('19933'),
('19975'),
('19961'),
('19954'),
('19735'),
('19703'),
('19980'),
('19894'),
('19706'),
('19945'),
('19971'),
('19979'),
('19808'),
('19726'),
('19931'),
('19716'),
('19964'),
('19966'),
('19712'),
('19944'),
('19958'),
('38737'),
('39180'),
('39402'),
('88114'),
('87049'),
('38772'),
('39207'),
('88006'),
('39296'),
('88311'),
('39051'),
('87185'),
('39507'),
('39404'),
('38627'),
('87461'),
('38957'),
('87117'),
('38873'),
('38901'),
('88410'),
('39656'),
('39218'),
('87184'),
('39669'),
('38866'),
('38739'),
('87521'),
('39073'),
('39502'),
('87540'),
('38646'),
('38949'),
('38647'),
('39213'),
('39531'),
('38774'),
('38632'),
('88231'),
('39760'),
('39364'),
('38849'),
('39157'),
('87557'),
('88348'),
('39194'),
('87083'),
('87746'),
('87313'),
('88047'),
('39109'),
('39217'),
('87508'),
('87417'),
('38848'),
('39079'),
('38880'),
('39753'),
('38672'),
('39098'),
('87569'),
('38654'),
('39506'),
('38658'),
('87041'),
('38927'),
('38773'),
('87125'),
('87026'),
('38732'),
('88211'),
('39477'),
('38661'),
('88063'),
('39211'),
('39739'),
('88325'),
('87730'),
('87510'),
('87114'),
('39330'),
('87061'),
('87035'),
('39563'),
('38924'),
('39107'),
('88001'),
('39359'),
('88036'),
('87052'),
('39060'),
('87514'),
('87120'),
('38619'),
('38778'),
('39555'),
('87002'),
('88065'),
('87753'),
('38940'),
('38669'),
('88124'),
('39574'),
('39436'),
('88055'),
('39664'),
('38701'),
('39271'),
('38844'),
('87535'),
('87059'),
('38964'),
('88026'),
('88061'),
('87415'),
('88435'),
('39771'),
('87029'),
('39059'),
('88220'),
('39095'),
('39751'),
('39193'),
('88232'),
('39704'),
('87060'),
('88125'),
('88339'),
('87102'),
('87824'),
('88314'),
('38753'),
('88417'),
('39150'),
('88342'),
('87113'),
('39341'),
('88415'),
('39647'),
('39350'),
('39745'),
('39269'),
('39302'),
('87325'),
('38804'),
('87831'),
('87124'),
('87413'),
('39736'),
('38835'),
('39480'),
('87046'),
('39475'),
('39565'),
('38863'),
('39047'),
('88072'),
('39161'),
('39540'),
('38761'),
('38953'),
('38824'),
('39216'),
('38771'),
('39457'),
('87558'),
('38781'),
('39482'),
('38679'),
('39110'),
('88058'),
('39039'),
('88115'),
('38913'),
('38622'),
('39162'),
('39456'),
('38776'),
('87531'),
('39086'),
('39063'),
('87025'),
('87034'),
('88023'),
('88316'),
('87506'),
('38954'),
('39560'),
('39701'),
('87192'),
('39532'),
('87731'),
('88256'),
('38920'),
('39328'),
('87012'),
('38860'),
('38914'),
('39479'),
('38625'),
('39552'),
('88039'),
('39078'),
('39533'),
('38676'),
('88265'),
('38659'),
('38628'),
('38955'),
('87564'),
('87827'),
('39191'),
('87047'),
('87576'),
('38869'),
('87416'),
('87732'),
('39307'),
('39358'),
('87420'),
('87729'),
('87153'),
('88427'),
('39663'),
('88032'),
('88250'),
('39520'),
('87801'),
('38655'),
('87187'),
('38749'),
('38947'),
('88340'),
('39440'),
('39041'),
('39366'),
('87053'),
('39272'),
('87111'),
('88267'),
('87505'),
('38677'),
('87740'),
('39171'),
('39182'),
('87549'),
('39558'),
('88263'),
('87519'),
('38629'),
('38946'),
('39568'),
('88123'),
('87070'),
('39304'),
('39173'),
('87190'),
('38839'),
('88024'),
('39201'),
('87734'),
('88439'),
('39045'),
('87529'),
('38733'),
('87365'),
('87502'),
('39117'),
('87174'),
('87573'),
('87715'),
('39462'),
('39730'),
('88430'),
('38723'),
('87357'),
('39348'),
('39339'),
('38858'),
('88254'),
('38850'),
('87402'),
('38961'),
('39332'),
('39360'),
('87040'),
('38626'),
('88021'),
('39043'),
('38943'),
('39601'),
('39643'),
('87321'),
('39455'),
('87821'),
('88244'),
('39144'),
('88203'),
('39737'),
('88419'),
('39284'),
('87538'),
('87181'),
('38634'),
('39750'),
('39470'),
('87027'),
('38675'),
('87745'),
('87196'),
('87008'),
('88121'),
('87513'),
('38963'),
('39177'),
('87317'),
('87101'),
('88025'),
('88136'),
('88049'),
('87592'),
('38610'),
('39362'),
('39747'),
('38617'),
('87038'),
('38668'),
('87016'),
('87533'),
('88433'),
('38868'),
('38754'),
('39212'),
('87419'),
('39140'),
('39169'),
('88321'),
('88044'),
('87578'),
('38683'),
('87121'),
('38638'),
('39077'),
('38639'),
('39081'),
('87825'),
('39352'),
('88253'),
('38826'),
('87501'),
('39209'),
('87503'),
('38950'),
('87714'),
('38962'),
('87516'),
('39535'),
('88349'),
('39425'),
('39289'),
('38859'),
('88431'),
('88034'),
('39190'),
('39250'),
('87023'),
('87939'),
('87195'),
('87582'),
('39441'),
('38876'),
('87107'),
('87553'),
('39156'),
('39119'),
('88134'),
('38603'),
('39082'),
('39759'),
('39158'),
('39423'),
('88346'),
('39573'),
('38725'),
('87577'),
('39595'),
('87021'),
('38878'),
('88347'),
('87418'),
('39356'),
('87537'),
('38602'),
('87108'),
('88242'),
('88048'),
('39355'),
('88262'),
('39571'),
('39146'),
('39167'),
('87015'),
('87742'),
('87579'),
('39756'),
('39460'),
('38856'),
('39443'),
('87539'),
('87562'),
('39165'),
('87004'),
('39071'),
('87326'),
('39090'),
('39347'),
('38651'),
('38827'),
('39326'),
('38643'),
('38722'),
('87001'),
('87524'),
('38960'),
('87151'),
('87504'),
('38780'),
('87736'),
('38720'),
('38871'),
('39553'),
('87701'),
('88053'),
('38765'),
('39202'),
('39225'),
('38928'),
('88004'),
('39044'),
('39038'),
('87544'),
('87499'),
('88113'),
('87941'),
('39429'),
('87115'),
('38630'),
('87511'),
('88052'),
('88132'),
('39215'),
('39530'),
('39160'),
('87752'),
('87566'),
('88352'),
('39476'),
('38637'),
('87527'),
('87936'),
('38930'),
('87109'),
('39040'),
('87072'),
('38751'),
('87509'),
('39668'),
('87116'),
('87421'),
('87571')
;
		DECLARE @Zips2 TABLE (ZipCode VARCHAR(5));
		INSERT INTO @Zips2 (ZipCode) VALUES 
('39478'),
('87832'),
('38623'),
('39116'),
('39645'),
('87024'),
('39703'),
('38803'),
('39367'),
('88119'),
('39148'),
('87301'),
('38843'),
('88126'),
('39054'),
('88133'),
('87935'),
('38745'),
('87580'),
('38702'),
('87933'),
('39153'),
('38609'),
('39327'),
('38945'),
('88317'),
('87931'),
('38879'),
('87551'),
('38635'),
('88103'),
('87315'),
('38941'),
('88344'),
('39069'),
('88411'),
('39459'),
('38748'),
('88038'),
('88130'),
('88002'),
('87199'),
('88318'),
('88422'),
('88351'),
('87823'),
('39439'),
('87512'),
('39305'),
('88030'),
('39206'),
('87176'),
('39058'),
('39465'),
('39741'),
('87144'),
('39426'),
('39503'),
('39361'),
('87830'),
('88046'),
('88260'),
('87560'),
('39204'),
('39345'),
('39772'),
('87131'),
('39629'),
('87020'),
('39115'),
('88310'),
('39154'),
('88013'),
('39633'),
('88118'),
('39298'),
('87518'),
('38917'),
('38685'),
('87901'),
('87328'),
('38666'),
('39649'),
('39335'),
('39083'),
('88210'),
('39602'),
('39286'),
('39581'),
('39061'),
('39042'),
('88312'),
('87320'),
('87710'),
('39705'),
('38820'),
('38935'),
('39653'),
('88355'),
('38614'),
('87543'),
('87455'),
('38902'),
('87119'),
('87713'),
('39354'),
('39572'),
('87063'),
('87042'),
('39562'),
('87105'),
('39159'),
('39066'),
('87718'),
('87312'),
('39074'),
('38870'),
('39567'),
('39657'),
('38611'),
('38665'),
('39401'),
('39097'),
('39710'),
('87194'),
('88201'),
('39323'),
('38846'),
('88337'),
('87064'),
('38769'),
('88007'),
('38642'),
('38649'),
('88033'),
('87556'),
('88028'),
('39422'),
('39505'),
('39702'),
('88102'),
('88336'),
('88012'),
('87410'),
('39648'),
('87654'),
('39111'),
('39067'),
('38618'),
('87062'),
('39442'),
('87056'),
('87583'),
('87532'),
('39746'),
('88042'),
('87022'),
('39576'),
('39451'),
('39766'),
('87724'),
('87574'),
('88116'),
('88027'),
('39534'),
('39529'),
('87733'),
('88418'),
('39057'),
('39755'),
('39336'),
('88005'),
('39232'),
('87323'),
('87545'),
('38825'),
('87191'),
('39320'),
('39181'),
('88436'),
('39282'),
('87316'),
('39365'),
('87048'),
('87045'),
('87103'),
('38726'),
('88354'),
('38652'),
('38644'),
('87567'),
('87530'),
('39569'),
('38944'),
('88040'),
('87930'),
('88202'),
('87364'),
('39122'),
('87032'),
('87011'),
('88213'),
('87412'),
('39735'),
('88031'),
('87520'),
('39130'),
('39163'),
('38855'),
('39283'),
('87014'),
('88081'),
('88350'),
('39056'),
('39481'),
('39632'),
('38764'),
('88054'),
('38730'),
('39406'),
('39303'),
('39744'),
('39236'),
('88324'),
('88008'),
('39179'),
('87548'),
('87517'),
('39652'),
('88062'),
('38923'),
('87007'),
('38738'),
('87552'),
('88401'),
('38915'),
('88268'),
('39427'),
('87319'),
('38966'),
('39754'),
('39322'),
('87106'),
('38641'),
('39403'),
('39521'),
('38828'),
('87198'),
('39577'),
('88240'),
('39337'),
('39145'),
('38921'),
('39743'),
('38601'),
('39183'),
('88434'),
('39121'),
('88414'),
('88323'),
('39752'),
('38633'),
('88051'),
('38952'),
('88135'),
('88022'),
('38704'),
('39667'),
('87043'),
('39062'),
('38959'),
('39437'),
('39174'),
('39114'),
('39525'),
('38703'),
('87123'),
('39630'),
('87547'),
('38673'),
('39501'),
('39631'),
('39168'),
('87017'),
('38877'),
('38664'),
('38760'),
('87750'),
('39452'),
('87009'),
('39483'),
('88301'),
('39561'),
('39564'),
('39654'),
('38875'),
('38829'),
('38833'),
('39635'),
('87044'),
('39096'),
('88230'),
('87006'),
('88043'),
('87581'),
('39170'),
('38663'),
('38838'),
('88424'),
('39463'),
('39108'),
('87122'),
('38852'),
('87528'),
('39769'),
('87575'),
('88101'),
('88056'),
('39740'),
('39087'),
('38740'),
('87305'),
('88041'),
('38847'),
('39324'),
('88221'),
('38744'),
('87507'),
('39309'),
('87747'),
('38762'),
('38841'),
('38767'),
('88264'),
('88003'),
('87028'),
('39080'),
('87013'),
('87018'),
('38674'),
('87728'),
('38857'),
('38782'),
('38645'),
('38958'),
('87722'),
('38759'),
('38756'),
('87940'),
('87942'),
('39342'),
('87112'),
('87937'),
('39325'),
('39088'),
('88122'),
('38967'),
('88426'),
('38916'),
('39192'),
('39346'),
('87031'),
('87037'),
('39665'),
('88421'),
('38864'),
('39149'),
('88252'),
('87327'),
('39474'),
('88345'),
('88341'),
('87515'),
('88255'),
('39666'),
('38768'),
('39603'),
('38929'),
('39363'),
('38948'),
('39662'),
('87104'),
('38926'),
('87712'),
('88009'),
('38680'),
('39464'),
('38851'),
('38731'),
('39522'),
('38721'),
('87375'),
('87197'),
('38620'),
('88045'),
('87068'),
('39092'),
('38922'),
('38746'),
('87302'),
('87723'),
('39466'),
('88029'),
('87594'),
('39641'),
('87525'),
('87523'),
('39205'),
('88120'),
('38925'),
('39175'),
('38874'),
('39556'),
('88112'),
('39566'),
('87735'),
('87820'),
('38965'),
('39773'),
('39210'),
('38802'),
('39338'),
('87310'),
('39288'),
('88011'),
('38951'),
('39407'),
('38650'),
('39208'),
('38834'),
('88343'),
('38865'),
('38801'),
('39638'),
('39152'),
('87005'),
('87154'),
('87743'),
('39189'),
('39046'),
('38631'),
('87829'),
('38621'),
('38686'),
('87036'),
('88338'),
('87010'),
('87711'),
('38606'),
('39301'),
('39776'),
('87193'),
('39166'),
('87749'),
('39461'),
('87828'),
('87401'),
('39762'),
('88353'),
('38862'),
('87051'),
('88020'),
('39203'),
('88241'),
('38736'),
('39094'),
('39421'),
('39176'),
('87110'),
('87158'),
('38671'),
('88330'),
('87347'),
('87565'),
('88416'),
('39113'),
('39120'),
('87943'),
('39767'),
('87311'),
('87522'),
('39661'),
('38821'),
('39428'),
('38670'),
('87554'),
('87322'),
('39151')
;

--		DECLARE @Zips3 TABLE (ZipCode VARCHAR(5));
--		INSERT INTO @Zips3 (ZipCode) VALUES
--;


--;WITH Z AS
--(
--	SELECT * FROM @ZIPS1 
--	UNION ALL
--	SELECT * FROM @ZIPS2 
--	--UNION ALL
--	--SELECT * FROM @ZIPS3
--)
--	select 'all_zips' as category, count(ZipCode) as tally from z
--	union all
--	select 'distinct_zips' as category, count(distinct ZipCode) as tally from z
--;
----1439

		IF NOT EXISTS 
		(
			SELECT 
				ZipId 
			FROM 
				[dasforbuh].[Zips] Z1
				INNER JOIN 
				(
					SELECT * FROM @ZIPS1 
					UNION ALL
					SELECT * FROM @ZIPS2 
					--UNION ALL
					--SELECT * FROM @ZIPS3 			
				) Z2
					ON Z1.ZipCode = Z2.ZipCode
			WHERE
				Z1.DisasterId = @DisasterID
		)
		BEGIN
			INSERT INTO 
				[dasforbuh].[Zips]	(ZipCode, DisasterId)
			SELECT DISTINCT
				ZipCode
				,@DisasterID 
			FROM 
				(
					SELECT * FROM @ZIPS1 
					UNION ALL
					SELECT * FROM @ZIPS2 
					--UNION ALL
					--SELECT * FROM @ZIPS3 			
				)z
		END;

		-- Save/Set the row count from the previously executed statement
		SELECT @ROWCOUNT = @ROWCOUNT + @@ROWCOUNT;

	IF @ROWCOUNT = @ExpectedRowCount
		BEGIN
			PRINT 'Transaction committed.'
			COMMIT TRANSACTION
			--ROLLBACK TRANSACTION
		END
	ELSE
		BEGIN
			PRINT 'Transaction NOT committed.';
			PRINT 'Expected row count not met. Expecting ' +  CAST(@ExpectedRowCount AS VARCHAR(10)) + ' rows, but returned ' + CAST(@ROWCOUNT AS VARCHAR(10))+ ' rows.';
			ROLLBACK TRANSACTION;
		END
END TRY
BEGIN CATCH
	PRINT 'Transaction NOT committed. Errors found in SQL statement.';
	ROLLBACK TRANSACTION;
	THROW;
END CATCH;
