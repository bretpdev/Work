SELECT * FROM OPENQUERY(LEGEND,
'


SELECT DISTINCT
	PDXX.DF_PRS_ID,
	LTRIM(RTRIM(PDXX.DM_PRS_X)) AS FIRST_NAME,
	LTRIM(RTRIM(DM_PRS_LST)) AS LAST_NAME,
	LNXX.LN_SEQ,
	LNXX.LR_ITR,
	LNXX.LA_CUR_PRI
FROM
	PKUB.PDXX_PRS_NME PDXX
	INNER JOIN 
	(
		SELECT
			LNXX.BF_SSN,
			LNXX.LN_SEQ,
			LNXX.LR_ITR,
			ROW_NUMBER() OVER (PARTITION BY LNXX.BF_SSN, LNXX.LN_SEQ ORDER BY LD_STA_LONXX DESC) AS SEQ
		FROM	
			PKUB.LNXX_INT_RTE_HST LNXX
		WHERE
			LNXX.LC_STA_LONXX = ''A''
			AND
			CURRENT DATE BETWEEN LNXX.LD_ITR_EFF_BEG AND LNXX.LD_ITR_EFF_END
	) LNXX
		ON LNXX.BF_SSN = PDXX.DF_PRS_ID
		AND LNXX.SEQ = X
	INNER JOIN PKUB.LNXX_LON LNXX
		ON LNXX.BF_SSN = LNXX.BF_SSN
		AND LNXX.LN_SEQ = LNXX.LN_SEQ
WHERE
	LNXX.LR_ITR >= X.XX




')