SELECT distinct
	LN80.BF_SSN,
	LN80.LN_SEQ,
	CONVERT(VARCHAR(10), LN80.LD_BIL_DU_LON,101) AS LD_BIL_DU_LON,
	ABS(LN80.LA_LTE_FEE_OTS_PRT) AS LA_LTE_FEE_OTS_PRT,
	CASE 
		WHEN LN90.BF_SSN IS NULL THEN 'NO PAYMENT'
		WHEN LN90.LA_FAT_LTE_FEE IS NULL THEN 'PAYMENT DID NOT APPLY TO LATE FEE'
		WHEN ABS(LN90.LA_FAT_LTE_FEE) = LN80.LA_LTE_FEE_OTS_PRT THEN 'PAYMENT PAID LATE FEE IN FULL'
		WHEN LN80.LA_LTE_FEE_OTS_PRT - ABS(LN90.LA_FAT_LTE_FEE) > 0 THEN 'PARTIAL LATE FEE PAID'
		WHEN LN80.LA_LTE_FEE_OTS_PRT - ABS(LN90.LA_FAT_LTE_FEE) < 0 THEN 'LATE FEE > THAN PRINTED ON BILL'
	END AS PAID_FEE,
	ABS(LN90.LA_FAT_LTE_FEE) AS LA_FAT_LTE_FEE
FROM 
	UDW..LN80_LON_BIL_CRF LN80
	INNER JOIN UDW..BL10_BR_BIL BL10
		ON BL10.BF_SSN = LN80.BF_SSN
		AND BL10.LD_BIL_CRT = LN80.LD_BIL_CRT 
		AND BL10.LN_SEQ_BIL_WI_DTE = LN80.LN_SEQ_BIL_WI_DTE
	LEFT JOIN UDW..LN75_BIL_LON_FAT LN75
		ON LN75.BF_SSN = LN80.BF_SSN
		AND LN75.LD_BIL_CRT = LN80.LD_BIL_CRT
		AND LN75.LN_SEQ_BIL_WI_DTE = LN80.LN_SEQ_BIL_WI_DTE
		AND LN75.LN_BIL_OCC_SEQ = LN80.LN_BIL_OCC_SEQ
	LEFT JOIN UDW..LN90_FIN_ATY LN90
		ON LN90.BF_SSN = LN80.BF_SSN
		AND LN90.LN_SEQ = LN80.LN_SEQ
		AND LN90.LN_FAT_SEQ = LN75.LN_FAT_SEQ
		AND LN90.LC_STA_LON90 = 'A'
		AND ISNULL(LN90.LC_FAT_REV_REA,'') = ''
WHERE
	LD_BIL_DU_LON > '03/13/2020'
	AND BL10.LC_STA_BIL10 = 'A'
	AND LC_STA_LON80 = 'A'
	AND (LA_LTE_FEE_OTS_PRT IS NOT NULL AND LA_LTE_FEE_OTS_PRT > 0)
	