USE CDW

--Query X
SELECT DISTINCT
  PDXX.DF_SPE_ACC_ID AS Account_Number
  ,PDXX.DD_DTH_STA AS Date_of_Death_Status
FROM
	LNXX_LON LNXX
	INNER JOIN PDXX_GTR_DTH PDXX
		ON LNXX.BF_SSN = PDXX.DF_PRS_ID
	INNER JOIN PDXX_PRS_NME PDXX
		ON PDXX.DF_PRS_ID = PDXX.DF_PRS_ID
WHERE
	LNXX.LA_CUR_PRI > X.XX 
	AND LNXX.LC_STA_LONXX = 'R'
	AND PDXX.DC_DTH_STA = 'XX'

--Query X
SELECT DISTINCT
	PDXX.DF_SPE_ACC_ID AS Account_Number
	,PDXX.DD_DTH_STA AS Date_of_Death_Status
    ,LNXX.LN_DLQ_MAX + X AS Number_Day_Delinq
FROM
	LNXX_LON LNXX
	INNER JOIN PDXX_GTR_DTH PDXX
		ON LNXX.BF_SSN = PDXX.DF_PRS_ID
	INNER JOIN LNXX_LON_DLQ_HST LNXX
		ON LNXX.BF_SSN = LNXX.BF_SSN
		AND LNXX.LN_SEQ = LNXX.LN_SEQ
	INNER JOIN PDXX_PRS_NME PDXX
		ON PDXX.DF_PRS_ID = PDXX.DF_PRS_ID
WHERE
	LNXX.LA_CUR_PRI > X.XX 
	AND LNXX.LC_STA_LONXX = 'R'
	AND PDXX.DC_DTH_STA = 'XX'
	AND CAST(LNXX.LD_STA_LONXX AS DATE) = DATEADD(DAY,-X, CAST(GETDATE() AS DATE))
