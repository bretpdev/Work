USE BSYS
GO

BEGIN TRANSACTION
DECLARE @ERROR INT = 0
DECLARE @ROWCOUNT INT = 0
DECLARE @ExpectedRowCount INT = 9

--Query Body
DECLARE @ID INT
INSERT INTO ULS.[print].FileHeaders(FileHeader,StateIndex,AccountNumberIndex,CostCenterCodeIndex)
VALUES('BF_SSN,DF_SPE_ACC_ID,DM_PRS_1,DM_PRS_LST,DX_STR_ADR_1,DX_STR_ADR_2,DM_CT,DC_DOM_ST,DF_ZIP_CDE,DM_FGN_CNY,D_DATE,ACSKEY,STATE_CODE,COST_CENTER_CODE',7,1,13)

SELECT @ROWCOUNT = @@ROWCOUNT, @ERROR = @@ERROR

SET @ID = (SELECT FileHeaderId FROM ULS.[print].FileHeaders WHERE FileHeader = 'BF_SSN,DF_SPE_ACC_ID,DM_PRS_1,DM_PRS_LST,DX_STR_ADR_1,DX_STR_ADR_2,DM_CT,DC_DOM_ST,DF_ZIP_CDE,DM_FGN_CNY,D_DATE,ACSKEY,STATE_CODE,COST_CENTER_CODE')

UPDATE 
	ULS.[print].ScriptData
SET
	FileHeaderId = @ID 
WHERE 
	LetterId IN (138,139,140,142,143,144,146,147)
--Query Body

SELECT @ROWCOUNT = @ROWCOUNT + @@ROWCOUNT, @ERROR = @ERROR + @@ERROR

IF @ROWCOUNT = @ExpectedRowCount AND @ERROR = 0
	BEGIN
		PRINT 'Transaction committed'
		COMMIT TRANSACTION
	END
ELSE
	BEGIN
		PRINT 'ROWCOUNT:  ' + CAST(@ROWCOUNT as VARCHAR(10))
		PRINT 'ERROR:  ' + CAST(@ERROR as VARCHAR(10))
		PRINT '!!!  Transaction NOT committed.  Contact a member of Application Development to have this error corrected.'
		ROLLBACK TRANSACTION
	END



