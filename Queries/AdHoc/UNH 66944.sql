--run on UHEAASQLDB
USE ULS
GO

BEGIN TRY
	BEGIN TRANSACTION;

		DECLARE @ROWCOUNT INT = 0
				,@ExpectedRowCount INT = 2622 --# of distinct zips + 1 disaster forb
				,@Disaster VARCHAR(100) = 'COVID-19 Pandemic WI/NE/NV/AZ/UT (DR-4520/4521/4523/4524/4525)'
				,@BeginDate DATE = CONVERT(DATE,'20200404') --declaration date
				,@AddedBy VARCHAR(50) = 'UNH 66944' --change to current NH ticket
				,@DisasterID_initial INT = (SELECT MAX(DisasterId)+1 FROM dasforbuh.Disasters);

		--SET IDENTITY_INSERT [dasforbuh].[Disasters] ON; --OPSDEV ONLY

			INSERT INTO [dasforbuh].[Disasters]
			(
				DisasterId, 
				Disaster, 
				BeginDate, 
				EndDate, 
				MaxEndDate, 
				DelinquencyOverride, --set to 1 for COVID
				Active, 
				AddedBy
			)
			VALUES
			(
				@DisasterID_initial, 
				@Disaster, 
				@BeginDate, 
				DATEADD(DAY, 89, @BeginDate), 
				DATEADD(DAY, 89, @BeginDate), 
				1, 
				1, 
				@AddedBy
			);--1
			-- Save/Set the row count from the previously executed statement
			SELECT @ROWCOUNT = @@ROWCOUNT;		
		
		--SET IDENTITY_INSERT [dasforbuh].[Disasters] OFF; --OPSDEV ONLY
		
		--Affected zip codes:
		DECLARE @DisasterID INT = (SELECT DisasterId FROM dasforbuh.Disasters WHERE Disaster = @Disaster);

		DECLARE @Zips1 TABLE (ZipCode VARCHAR(5)); 
		INSERT INTO @Zips1 (ZipCode) VALUES 
--Affected Zip Codes 
('54875'),
('53125'),
('53033'),
('54407'),
('53940'),
('54832'),
('53064'),
('54305'),
('53931'),
('53015'),
('53947'),
('53065'),
('54130'),
('54493'),
('53150'),
('54014'),
('54524'),
('53530'),
('54861'),
('54810'),
('54771'),
('53407'),
('54560'),
('54441'),
('54853'),
('53186'),
('53295'),
('54414'),
('53802'),
('54175'),
('53066'),
('54805'),
('53194'),
('53809'),
('53011'),
('54774'),
('53811'),
('53057'),
('54956'),
('54978'),
('53121'),
('53562'),
('54001'),
('53405'),
('54155'),
('54948'),
('53928'),
('54405'),
('54646'),
('54610'),
('54721'),
('53099'),
('53221'),
('53518'),
('53941'),
('53188'),
('53185'),
('54769'),
('53569'),
('53534'),
('54205'),
('53573'),
('54120'),
('54906'),
('54928'),
('54426'),
('53969'),
('53102'),
('54471'),
('54817'),
('53512'),
('53824'),
('54813'),
('53943'),
('53140'),
('54806'),
('53702'),
('53954'),
('53935'),
('53214'),
('54980'),
('53581'),
('54456'),
('54737'),
('54447'),
('53142'),
('53595'),
('54514'),
('53522'),
('54301'),
('54131'),
('54615'),
('53548'),
('54871'),
('54521'),
('53816'),
('53578'),
('53040'),
('54228'),
('54247'),
('53820'),
('54984'),
('53901'),
('53063'),
('53153'),
('53950'),
('54739'),
('54914'),
('54539'),
('54412'),
('54234'),
('54527'),
('54723'),
('54561'),
('53953'),
('53159'),
('53807'),
('54002'),
('54728'),
('53948'),
('53223'),
('54816'),
('54115'),
('54220'),
('53206'),
('54670'),
('54529'),
('54159'),
('53792'),
('54114'),
('53082'),
('54525'),
('53585'),
('53543'),
('54541'),
('54418'),
('53151'),
('54750'),
('53132'),
('53550'),
('54489'),
('54880'),
('54820'),
('54140'),
('53923'),
('53790'),
('53070'),
('53061'),
('54165'),
('54966'),
('53956'),
('54649'),
('53008'),
('54138'),
('53704'),
('53128'),
('54642'),
('54103'),
('54624'),
('54743'),
('54821'),
('53574'),
('53201'),
('53597'),
('53118'),
('54618'),
('54842'),
('54889'),
('53525'),
('54141'),
('54627'),
('54479'),
('53195'),
('54472'),
('54888'),
('54828'),
('54873'),
('54865'),
('53556'),
('53715'),
('53549'),
('53021'),
('53586'),
('53056'),
('53955'),
('54822'),
('53726'),
('54876'),
('54559'),
('53557'),
('54486'),
('53001'),
('54843'),
('54534'),
('53147'),
('54119'),
('53553'),
('54761'),
('54751'),
('54943'),
('54240'),
('54634'),
('53171'),
('54667'),
('53149'),
('54858'),
('54768'),
('53408'),
('54801'),
('54555'),
('54976'),
('54106'),
('54484'),
('54661'),
('54855'),
('53599'),
('54424'),
('54620'),
('54621'),
('53093'),
('54520'),
('53925'),
('53406'),
('54519'),
('53203'),
('53233'),
('53580'),
('54302'),
('53047'),
('53143'),
('53225'),
('54625'),
('53958'),
('54562'),
('53930'),
('53719'),
('53144'),
('53952'),
('54937'),
('54313'),
('53793'),
('53503'),
('53079'),
('53035'),
('54545'),
('53812'),
('54970'),
('54162'),
('53714'),
('54154'),
('54402'),
('54986'),
('53004'),
('53402'),
('54421'),
('54738'),
('53024'),
('54102'),
('53594'),
('53045'),
('53141'),
('54455'),
('54501'),
('54969'),
('54457'),
('53911'),
('54428'),
('53783'),
('54757'),
('53810'),
('53596'),
('54208'),
('54985'),
('54153'),
('54933'),
('54895'),
('54515'),
('54123'),
('53583'),
('54245'),
('54166'),
('53037'),
('53216'),
('53538'),
('54648'),
('53227'),
('54156'),
('53073'),
('54981'),
('53081'),
('54536'),
('53044'),
('53511'),
('53091'),
('53529'),
('54731'),
('53717'),
('53208'),
('54650'),
('53570'),
('53588'),
('54550'),
('53959'),
('53016'),
('53587'),
('53577'),
('54702'),
('54664'),
('53002'),
('53558'),
('53542'),
('54722'),
('53528'),
('54748'),
('54429'),
('54129'),
('54734'),
('53706'),
('53813'),
('54494'),
('54945'),
('53213'),
('54935'),
('53072'),
('54960'),
('54173'),
('54111'),
('54006'),
('53521'),
('54764'),
('54213'),
('54209'),
('54538'),
('54409'),
('54170'),
('54152'),
('53027'),
('53211'),
('54174'),
('54136'),
('53774'),
('53910'),
('54226'),
('54754'),
('53148'),
('53192'),
('54942'),
('53263'),
('53006'),
('53020'),
('54662'),
('54013'),
('54474'),
('54836'),
('54128'),
('53942'),
('53559'),
('54440'),
('54923'),
('54602'),
('54655'),
('54921'),
('53808'),
('54232'),
('53527'),
('53551'),
('53075'),
('53060'),
('54024'),
('54874'),
('53403'),
('54420'),
('54651'),
('54812'),
('53092'),
('54344'),
('54017'),
('53949'),
('53701'),
('53804'),
('53029'),
('53259'),
('54614'),
('53510'),
('53593'),
('53080'),
('53791'),
('54616'),
('54490'),
('54930'),
('53789'),
('53718'),
('53050'),
('54217'),
('53226'),
('53158'),
('54666'),
('54977'),
('53708'),
('54454'),
('54422'),
('53167'),
('54940'),
('53178'),
('53946'),
('54531'),
('54946'),
('54020'),
('54016'),
('54413'),
('54725'),
('54169'),
('54919'),
('54241'),
('53933'),
('54850'),
('54211'),
('54530'),
('54632'),
('54150'),
('53504'),
('54652'),
('53212'),
('53713'),
('54110'),
('54121'),
('54847'),
('53502'),
('54857'),
('54720'),
('53929'),
('54749'),
('53535'),
('54830'),
('53274'),
('54235'),
('53555'),
('53101'),
('53517'),
('53127'),
('54303'),
('54210'),
('53961'),
('53179'),
('54613'),
('54915'),
('54990'),
('54475'),
('53052'),
('54868'),
('54770'),
('53936'),
('53565'),
('54556'),
('54965'),
('54952'),
('54758'),
('54814'),
('53520'),
('53191'),
('53566'),
('54656'),
('54451'),
('54665'),
('54638'),
('53170'),
('54611'),
('54631'),
('54202'),
('54829'),
('53237'),
('54404'),
('54927'),
('54740'),
('54558'),
('54488'),
('53182'),
('54742'),
('53827'),
('54896'),
('53089'),
('54971'),
('54840'),
('53278'),
('54216'),
('54726'),
('54643'),
('53584'),
('53744'),
('53069'),
('53224'),
('53526'),
('54463'),
('53533'),
('54304'),
('53098'),
('54961'),
('53032'),
('54126'),
('53590'),
('54007'),
('54406'),
('53157'),
('54221'),
('53926'),
('54125'),
('53965'),
('54557'),
('54435'),
('53104'),
('54005'),
('53017'),
('53042'),
('54028'),
('54543'),
('53794'),
('53818'),
('53589'),
('54912'),
('53957'),
('54151'),
('53014'),
('54469'),
('53222'),
('54628'),
('53916'),
('53007'),
('54827'),
('54903'),
('53711'),
('53235'),
('54442'),
('53189'),
('54962'),
('54566'),
('54657'),
('54564'),
('54931'),
('54891'),
('53541'),
('54425'),
('54415'),
('53103'),
('54308'),
('53922'),
('53293'),
('54629'),
('54124'),
('54741'),
('54745'),
('53152'),
('53951'),
('54944'),
('53968'),
('54470'),
('53058'),
('53204'),
('54537'),
('53154'),
('53786'),
('54967'),
('54867'),
('53010'),
('54911'),
('54839'),
('54974'),
('53785'),
('54411'),
('53172'),
('54542'),
('53168'),
('53207'),
('54746'),
('53039'),
('53536'),
('54826'),
('54480'),
('53119'),
('53038'),
('53156'),
('53108'),
('54968'),
('53288'),
('54149'),
('54492'),
('54107'),
('54841'),
('54499'),
('53130'),
('53046'),
('54532'),
('54214'),
('54947'),
('54465'),
('53516'),
('54324'),
('54025'),
('54027'),
('53078'),
('54229'),
('54408'),
('54838'),
('53937'),
('54113'),
('54824'),
('53210'),
('53126'),
('54848'),
('53788'),
('53219'),
('54659'),
('53817'),
('54957'),
('53088'),
('53579'),
('53944'),
('54941'),
('54645'),
('54747'),
('53018'),
('54552'),
('54427'),
('53531'),
('54417'),
('53013'),
('54467'),
('54127'),
('54762'),
('54160'),
('54548'),
('54517'),
('54464'),
('54913'),
('54846'),
('54459'),
('54766'),
('54449'),
('53034'),
('53777'),
('54623'),
('54023'),
('53023'),
('54844'),
('54437'),
('54101'),
('54458'),
('54901'),
('54554'),
('54637'),
('54636'),
('54983'),
('54512'),
('53501'),
('53963'),
('54772'),
('53094'),
('54765'),
('54890'),
('54513'),
('54212'),
('54641'),
('54082'),
('54401'),
('54204'),
('53716'),
('53146'),
('54963'),
('54568'),
('53139'),
('53129'),
('53560'),
('53505'),
('53218'),
('54849'),
('54735'),
('53401'),
('53022'),
('54311'),
('54495'),
('53826'),
('53507'),
('53110'),
('53705'),
('53019'),
('54729'),
('54870'),
('54922'),
('54563'),
('54760'),
('54654'),
('54462'),
('54022'),
('54446'),
('53187'),
('54482'),
('54936'),
('53181'),
('53085'),
('54909'),
('53049'),
('54443'),
('54201'),
('54835'),
('53184'),
('53003'),
('54207'),
('54491'),
('54926'),
('54603'),
('53784'),
('54026'),
('54626'),
('54859'),
('54403'),
('54011'),
('53120'),
('54932'),
('53031'),
('53523'),
('54763'),
('54619'),
('54658'),
('54021'),
('53934'),
('54498'),
('53962'),
('54143'),
('54724'),
('54653'),
('54227'),
('54410'),
('54929'),
('53048'),
('53540'),
('54565'),
('53114'),
('54466'),
('53228'),
('54837'),
('53205'),
('53964'),
('53805'),
('53532'),
('53725'),
('53821'),
('54979'),
('54546'),
('53598'),
('54893'),
('53090'),
('53026'),
('54644'),
('54460'),
('54416'),
('53138'),
('54003'),
('54756'),
('53122'),
('53105'),
('54845'),
('53960'),
('54307'),
('54436'),
('54476'),
('54481'),
('54246'),
('53924'),
('54635'),
('54872'),
('53012'),
('53076'),
('53782'),
('54736'),
('53059'),
('53545'),
('54819'),
('53920'),
('53913'),
('53537'),
('54547'),
('54009'),
('54104'),
('54450'),
('53083'),
('54622'),
('54215'),
('53508'),
('53825'),
('54733'),
('53506'),
('54639'),
('53404'),
('54306'),
('54732'),
('54759'),
('53290'),
('53572'),
('53086'),
('53137'),
('53097'),
('53703'),
('53707'),
('54423'),
('53571'),
('54452'),
('53074'),
('53005'),
('53183'),
('54730'),
('54864'),
('53803'),
('54964'),
('54473'),
('53547'),
('54612'),
('54856'),
('54862'),
('54004'),
('53234'),
('54511'),
('54487'),
('53932'),
('53051'),
('54630'),
('53563'),
('54230'),
('54433'),
('54701'),
('54767'),
('53036'),
('54180'),
('54137'),
('54177'),
('54660'),
('54112'),
('54430'),
('53202'),
('54448'),
('53582'),
('53209'),
('53801'),
('53176'),
('53939'),
('54854'),
('53109'),
('53575'),
('53515'),
('53115'),
('54703'),
('54949'),
('53561'),
('53177'),
('54755'),
('54015'),
('53062'),
('53544'),
('54540'),
('53190'),
('53215'),
('54485'),
('54161'),
('53217'),
('54526'),
('54773'),
('54902'),
('53919'),
('54669'),
('53095'),
('54982'),
('54727'),
('54171'),
('54139'),
('54157'),
('53546'),
('53576'),
('53220'),
('54904'),
('53806'),
('54135'),
('54950'),
('53554'),
('54601'),
('68743'),
('68932'),
('68410'),
('68981'),
('68343'),
('68005'),
('68840'),
('69147'),
('68056'),
('69301'),
('69165'),
('68450'),
('68844'),
('68824'),
('68621'),
('68050'),
('68802'),
('68039'),
('68057'),
('68348'),
('69045'),
('68371'),
('69352'),
('68114'),
('68588'),
('68922'),
('69335'),
('68836'),
('68941'),
('68667'),
('69347'),
('69142'),
('69027'),
('69150'),
('68739'),
('68352'),
('68781'),
('68034'),
('68920'),
('68321'),
('68628'),
('68633'),
('68130'),
('68456'),
('68777'),
('68735'),
('68731'),
('68950'),
('69155'),
('69123'),
('68970'),
('68863'),
('69341'),
('68458'),
('68462'),
('68869'),
('68378'),
('68198'),
('68375'),
('68305'),
('68655'),
('69367'),
('68466'),
('68058'),
('68071'),
('68101'),
('68747'),
('69144')
;
		DECLARE @Zips2 TABLE (ZipCode VARCHAR(5));
		INSERT INTO @Zips2 (ZipCode) VALUES 
('68429'),
('68502'),
('68544'),
('68314'),
('68421'),
('68062'),
('68757'),
('68936'),
('68440'),
('68952'),
('68636'),
('68761'),
('68447'),
('69120'),
('68506'),
('68832'),
('68642'),
('68368'),
('68817'),
('68531'),
('68774'),
('68733'),
('68467'),
('68508'),
('68042'),
('68666'),
('68065'),
('69358'),
('68402'),
('68002'),
('68033'),
('69366'),
('68943'),
('68789'),
('69032'),
('68654'),
('68815'),
('68766'),
('68763'),
('68038'),
('68404'),
('68882'),
('68759'),
('68669'),
('68977'),
('68827'),
('68320'),
('68640'),
('68419'),
('68873'),
('68164'),
('68117'),
('68172'),
('68127'),
('68959'),
('68330'),
('68624'),
('68622'),
('68760'),
('68341'),
('68026'),
('68147'),
('68113'),
('68883'),
('68924'),
('68445'),
('69143'),
('69030'),
('68347'),
('68108'),
('68465'),
('69038'),
('68064'),
('68930'),
('68176'),
('68710'),
('68527'),
('69023'),
('68944'),
('68966'),
('68382'),
('68701'),
('68756'),
('68417'),
('68825'),
('68517'),
('68504'),
('68376'),
('69022'),
('68183'),
('68001'),
('68420'),
('68856'),
('68361'),
('68022'),
('68961'),
('68342'),
('68821'),
('68822'),
('68638'),
('68319'),
('68003'),
('68848'),
('68626'),
('68823'),
('69128'),
('68304'),
('68764'),
('68773'),
('69024'),
('69033'),
('69152'),
('68351'),
('68016'),
('68014'),
('68357'),
('68790'),
('69041'),
('68820'),
('68055'),
('68144'),
('69346'),
('69339'),
('69042'),
('69168'),
('68118'),
('68116'),
('68813'),
('68637'),
('68716'),
('68876'),
('69345'),
('68339'),
('68786'),
('68528'),
('68942'),
('69190'),
('69036'),
('68454'),
('68443'),
('69125'),
('68439'),
('69046'),
('68728'),
('68112'),
('68182'),
('68406'),
('68516'),
('68812'),
('69122'),
('69356'),
('68648'),
('68881'),
('68948'),
('68927'),
('68409'),
('68103'),
('68047'),
('69170'),
('68938'),
('68784'),
('69363'),
('68929'),
('68137'),
('68732'),
('68367'),
('68136'),
('69101'),
('68765'),
('68138'),
('68664'),
('68344'),
('68310'),
('68643'),
('68852'),
('68663'),
('68791'),
('69353'),
('68726'),
('68354'),
('68717'),
('68018'),
('68407'),
('68788'),
('68758'),
('69337'),
('68792'),
('68719'),
('68327'),
('68464'),
('69039'),
('68037'),
('68727'),
('68509'),
('68928'),
('68958'),
('69154'),
('68752'),
('68364'),
('68831'),
('68859'),
('68746'),
('68843'),
('68063'),
('69156'),
('68855'),
('69331'),
('68853'),
('69201'),
('69135'),
('68845'),
('68787'),
('68040'),
('69151'),
('68036'),
('68416'),
('69162'),
('69140'),
('68070'),
('68104'),
('69130'),
('68418'),
('68978'),
('68940'),
('68346'),
('69166'),
('68634'),
('68771'),
('68322'),
('68325'),
('68972'),
('68849'),
('68318'),
('68778'),
('68044'),
('68583'),
('68381'),
('68145'),
('68833'),
('68729'),
('68009'),
('68741'),
('68340'),
('69026'),
('68326'),
('68720'),
('68134'),
('68004'),
('68365'),
('68973'),
('68111'),
('68501'),
('68020'),
('68828'),
('68437'),
('68875'),
('68442'),
('69351'),
('68945'),
('68436'),
('68503'),
('68661'),
('68309'),
('68627'),
('68835'),
('68045'),
('68632'),
('68532'),
('68362'),
('68333'),
('69103'),
('68864'),
('68780'),
('69129'),
('69133'),
('68448'),
('68131'),
('68372'),
('68380'),
('69216'),
('68152'),
('68460'),
('68767'),
('68180'),
('68960'),
('68779'),
('68925'),
('68124'),
('69220'),
('69161'),
('69138'),
('68123'),
('68957'),
('68154'),
('68328'),
('69354'),
('68949'),
('68349'),
('68446'),
('68431'),
('69029'),
('68007'),
('68377'),
('68976'),
('68066'),
('68736'),
('68847'),
('68505'),
('68457'),
('69040'),
('69348'),
('68444'),
('68335'),
('68105'),
('68017'),
('68816'),
('69212'),
('68751'),
('68133'),
('68135'),
('68956'),
('68665'),
('68413'),
('68072'),
('68323'),
('68926'),
('68623'),
('68975'),
('68878'),
('68073'),
('68521'),
('68725'),
('68865'),
('68524'),
('68514'),
('68955'),
('69333'),
('68714'),
('68507'),
('68360'),
('68749'),
('68967'),
('68862'),
('68316'),
('68980'),
('68770'),
('68874'),
('68713'),
('69149'),
('68178'),
('68110'),
('69336'),
('68102'),
('68933'),
('68423'),
('68644'),
('68379'),
('69219'),
('69020'),
('68662'),
('69043'),
('68529'),
('68658'),
('68838'),
('68723'),
('68734'),
('68068'),
('68542'),
('68742'),
('68718'),
('68745'),
('68015'),
('68748'),
('68801'),
('68841'),
('69163'),
('68776'),
('68879'),
('68405'),
('68641'),
('68649'),
('68522'),
('68307'),
('69148'),
('68769'),
('68631'),
('68434'),
('69001'),
('69127'),
('68197'),
('68301'),
('68753'),
('69021'),
('68048'),
('68872'),
('69340'),
('68724'),
('68029'),
('68803'),
('68336'),
('68424'),
('69028'),
('68902'),
('69044'),
('68023'),
('69221'),
('68810'),
('68870'),
('68025'),
('68901'),
('68858'),
('68107'),
('68030'),
('68814'),
('69334'),
('69146'),
('69153'),
('68702'),
('68923'),
('68329'),
('68355'),
('68106'),
('68510'),
('69157'),
('68031'),
('69365'),
('68041'),
('68715'),
('68861'),
('68067'),
('69121'),
('69145'),
('68433'),
('68740'),
('68837'),
('69037'),
('68653'),
('69343'),
('69132'),
('69218'),
('68119'),
('69357'),
('68520'),
('69360'),
('69217'),
('69141'),
('68324'),
('68337'),
('68461'),
('68366'),
('68738'),
('68313'),
('69211'),
('68652'),
('68350'),
('68175'),
('68934'),
('68602'),
('68854'),
('68315'),
('68979'),
('68422'),
('68935'),
('68345'),
('68415'),
('69160'),
('68946'),
('68629'),
('68403'),
('68069'),
('68818'),
('68842'),
('68122'),
('69169'),
('68722'),
('69350'),
('68601'),
('68982'),
('68179'),
('69025'),
('68620'),
('68971'),
('68401'),
('68430'),
('68846'),
('68059'),
('68834'),
('68939'),
('68651'),
('68438'),
('69361'),
('68954'),
('68453'),
('68826'),
('68850'),
('68142'),
('68974'),
('68132'),
('69355'),
('69214'),
('68937'),
('69171'),
('68860'),
('68647'),
('68338'),
('69210'),
('68635'),
('68331'),
('68455'),
('68303'),
('68139'),
('68008'),
('68157'),
('68414'),
('68512'),
('68947'),
('69167'),
('68866'),
('68452'),
('68128'),
('68964'),
('68969'),
('68711'),
('68061'),
('68463'),
('68441'),
('68730'),
('68370'),
('68358'),
('68046'),
('68317'),
('68768'),
('68109'),
('68332'),
('68019'),
('68785'),
('68428'),
('68523'),
('69131'),
('68659'),
('68526'),
('68359'),
('68783'),
('68871'),
('69034'),
('68010'),
('68028'),
('68660'),
('68755'),
('69134'),
('89704'),
('89721'),
('89557'),
('89105'),
('89425'),
('89420'),
('89412'),
('89418'),
('89152'),
('89183'),
('89060'),
('89521'),
('89510'),
('89037'),
('88905'),
('89103'),
('89815'),
('89163'),
('89084'),
('89507'),
('89426'),
('89570'),
('89408'),
('89114'),
('89501'),
('89131'),
('89315'),
('89142'),
('89314'),
('89155'),
('89185'),
('89702'),
('89436'),
('89421'),
('89019'),
('89008'),
('89044'),
('89822'),
('89101'),
('89520'),
('89409'),
('89157'),
('89714'),
('89460'),
('89136'),
('89011'),
('89317'),
('89146'),
('89133'),
('89005'),
('89821'),
('89135'),
('89003'),
('89081'),
('89018'),
('89007'),
('89440'),
('89496'),
('89036'),
('89404'),
('89153'),
('89828'),
('89164'),
('89017'),
('89149'),
('89193'),
('89130'),
('89002'),
('89515'),
('89030'),
('89820'),
('89067'),
('89803'),
('89070'),
('89403'),
('89139'),
('89138'),
('89166'),
('89533'),
('89311'),
('89447'),
('89316'),
('89711'),
('89712'),
('89032'),
('89439'),
('89128'),
('89180'),
('89126'),
('89148'),
('89424'),
('89031'),
('89144'),
('89450'),
('89012'),
('89411'),
('89033'),
('89449'),
('89024'),
('89191'),
('89428'),
('89112'),
('89022'),
('89021'),
('89048'),
('89432'),
('89703'),
('89122'),
('89020'),
('89433'),
('89801'),
('89429'),
('89834'),
('89451'),
('89141'),
('89119'),
('89402'),
('89006'),
('89301'),
('89505'),
('89502'),
('89140'),
('89506'),
('89825'),
('89154'),
('89121'),
('89177'),
('89009'),
('89143'),
('89108'),
('89173'),
('89415'),
('89599'),
('89555'),
('89422'),
('89039'),
('89832'),
('89045'),
('89046'),
('89513'),
('89077'),
('89124'),
('89127'),
('89448'),
('89833'),
('89511'),
('89054'),
('89406'),
('89169'),
('89150'),
('89134'),
('89001'),
('89705'),
('89116'),
('89137'),
('89111'),
('89162'),
('89042'),
('89104'),
('89156'),
('89086'),
('89414'),
('89034'),
('89195'),
('89027'),
('89170'),
('89438'),
('89523'),
('89826'),
('89405'),
('89407'),
('89010'),
('89835'),
('89016'),
('89015'),
('89102'),
('89040'),
('89503'),
('89823'),
('89052'),
('89125'),
('89413'),
('89830'),
('89452'),
('89025'),
('89445'),
('89106'),
('89442'),
('89120'),
('89430'),
('89074'),
('89049'),
('89118'),
('89701'),
('89151'),
('89165'),
('89883'),
('89802'),
('89199'),
('89504'),
('89123'),
('89147'),
('89427'),
('89595'),
('89013'),
('89310'),
('89047'),
('89029'),
('89117'),
('89004'),
('89087'),
('89713'),
('89706'),
('89441'),
('89159'),
('89041'),
('89508'),
('89113'),
('89431'),
('89115'),
('89023'),
('89519'),
('89161'),
('89085'),
('89831'),
('89028'),
('89110'),
('89160'),
('89026'),
('89043'),
('89145'),
('89318'),
('89423'),
('89061'),
('89014'),
('89179'),
('89444'),
('89107'),
('89419'),
('89435'),
('89129'),
('89109'),
('89512'),
('89319'),
('89434'),
('89509'),
('89132'),
('89178'),
('88901'),
('89446'),
('89158'),
('89053'),
('89410'),
('84622'),
('84109'),
('84713'),
('84046'),
('84407'),
('84114'),
('84095'),
('84602'),
('84091'),
('84118'),
('84540'),
('84074'),
('84010'),
('84305'),
('84040'),
('84628'),
('84051'),
('84037'),
('84105'),
('84772'),
('84523'),
('84714'),
('84145'),
('84133'),
('84036'),
('84529'),
('84735'),
('84078'),
('84087'),
('84733'),
('84004'),
('84648'),
('84531'),
('84132'),
('84328'),
('84760'),
('84638'),
('84741'),
('84764'),
('84779'),
('84409'),
('84751'),
('84624'),
('84752'),
('84312'),
('84739'),
('84627'),
('84405'),
('84117'),
('84127'),
('84651'),
('84103'),
('84515'),
('84306'),
('84606'),
('84086'),
('84763'),
('84415'),
('84311'),
('84725'),
('84143'),
('84033'),
('84701'),
('84339'),
('84106'),
('84029'),
('84512'),
('84102'),
('84722'),
('84126'),
('84662'),
('84513'),
('84649'),
('84639'),
('84712'),
('84244'),
('84049'),
('84753'),
('84316'),
('84131'),
('84081'),
('84518'),
('84315'),
('84729'),
('84158'),
('84526'),
('84637'),
('84756'),
('84414'),
('84331'),
('84728'),
('84041'),
('84634'),
('84044'),
('84318'),
('84038'),
('84402'),
('84539'),
('84776'),
('84184'),
('84747'),
('84128'),
('84730'),
('84002'),
('84310'),
('84031'),
('84152'),
('84321'),
('84003'),
('84134'),
('84314'),
('84646'),
('84067'),
('84630'),
('84130'),
('84336'),
('84621'),
('84530'),
('84199'),
('84001'),
('84401'),
('84334'),
('84330'),
('84047'),
('84511'),
('84084'),
('84021'),
('84011'),
('84151'),
('84325'),
('84653'),
('84076'),
('84313'),
('84119'),
('84631'),
('84089'),
('84770'),
('84332'),
('84740'),
('84085'),
('84017'),
('84090'),
('84324'),
('84750'),
('84715'),
('84660'),
('84745'),
('84308'),
('84141'),
('84075'),
('84035'),
('84082'),
('84069'),
('84766'),
('84302'),
('84124'),
('84083'),
('84022'),
('84603'),
('84742'),
('84079'),
('84754'),
('84412'),
('84623'),
('84719'),
('84790'),
('84122'),
('84333'),
('84335'),
('84645'),
('84636'),
('84642'),
('84112'),
('84773'),
('84317'),
('84129'),
('84320'),
('84165'),
('84536'),
('84629'),
('84064'),
('84052'),
('84718'),
('84783'),
('84721'),
('84761'),
('84720'),
('84121'),
('84643'),
('84034'),
('84148'),
('84633'),
('84535'),
('84058'),
('84139')
;
		DECLARE @Zips3 TABLE (ZipCode VARCHAR(5));
		INSERT INTO @Zips3 (ZipCode) VALUES
('84042'),
('84039'),
('84522'),
('84063'),
('84027'),
('84180'),
('84744'),
('84656'),
('84710'),
('84723'),
('84008'),
('84640'),
('84201'),
('84403'),
('84097'),
('84171'),
('84054'),
('84337'),
('84765'),
('84304'),
('84647'),
('84731'),
('84014'),
('84080'),
('84732'),
('84784'),
('84025'),
('84533'),
('84767'),
('84094'),
('84157'),
('84061'),
('84791'),
('84009'),
('84404'),
('84780'),
('84338'),
('84762'),
('84050'),
('84015'),
('84319'),
('84111'),
('84018'),
('84043'),
('84626'),
('84724'),
('84023'),
('84055'),
('84534'),
('84657'),
('84053'),
('84601'),
('84006'),
('84749'),
('84045'),
('84016'),
('84525'),
('84620'),
('84521'),
('84072'),
('84667'),
('84301'),
('84032'),
('84110'),
('84665'),
('84062'),
('84604'),
('84190'),
('84743'),
('84056'),
('84060'),
('84771'),
('84501'),
('84104'),
('84068'),
('84107'),
('84664'),
('84726'),
('84759'),
('84323'),
('84774'),
('84775'),
('84652'),
('84120'),
('84125'),
('84123'),
('84057'),
('84746'),
('84088'),
('84655'),
('84007'),
('84327'),
('84073'),
('84026'),
('84092'),
('84066'),
('84542'),
('84758'),
('84408'),
('84737'),
('84138'),
('84341'),
('84520'),
('84096'),
('84516'),
('84024'),
('84071'),
('84309'),
('84101'),
('84059'),
('84326'),
('84147'),
('84738'),
('84644'),
('84115'),
('84028'),
('84013'),
('84113'),
('84632'),
('84170'),
('84663'),
('84635'),
('84757'),
('84098'),
('84116'),
('84108'),
('84711'),
('84322'),
('84782'),
('84654'),
('84005'),
('84528'),
('84329'),
('84716'),
('84510'),
('84150'),
('84020'),
('84093'),
('84605'),
('84755'),
('84307'),
('84340'),
('84781'),
('84537'),
('84734'),
('84070'),
('84065'),
('84532'),
('84736'),
('85724'),
('85257'),
('85547'),
('85723'),
('85942'),
('85373'),
('85283'),
('86339'),
('85341'),
('85324'),
('85731'),
('85193'),
('86034'),
('85363'),
('85628'),
('85739'),
('86404'),
('85643'),
('85006'),
('85295'),
('85650'),
('86020'),
('85212'),
('85069'),
('85329'),
('85249'),
('85922'),
('85718'),
('86438'),
('85224'),
('85225'),
('85535'),
('85671'),
('85658'),
('85743'),
('85233'),
('85728'),
('86337'),
('86321'),
('86029'),
('86313'),
('85705'),
('85244'),
('86340'),
('86511'),
('85054'),
('85250'),
('85024'),
('85379'),
('85026'),
('85540'),
('85603'),
('85036'),
('85644'),
('85020'),
('85023'),
('86331'),
('85332'),
('86023'),
('85035'),
('85143'),
('86046'),
('85299'),
('85001'),
('86338'),
('86305'),
('86004'),
('85140'),
('86016'),
('86427'),
('85670'),
('85357'),
('86033'),
('85306'),
('85757'),
('85901'),
('85301'),
('86003'),
('85638'),
('85064'),
('85745'),
('86440'),
('85178'),
('85654'),
('85033'),
('85015'),
('86322'),
('85626'),
('85311'),
('85066'),
('86047'),
('85051'),
('85608'),
('85615'),
('86412'),
('85648'),
('85925'),
('86054'),
('85271'),
('85128'),
('85005'),
('85208'),
('86547'),
('85018'),
('85321'),
('85032'),
('86437'),
('85078'),
('85043'),
('85260'),
('86320'),
('85387'),
('85610'),
('85310'),
('85050'),
('85355'),
('86040'),
('86512'),
('85312'),
('86507'),
('85067'),
('85137'),
('85378'),
('85548'),
('85741'),
('86039'),
('86432'),
('85269'),
('86336'),
('86435'),
('85205'),
('86342'),
('85304'),
('85333'),
('86332'),
('86044'),
('85298'),
('85734'),
('86508'),
('86434'),
('85636'),
('85309'),
('85711'),
('85007'),
('85629'),
('85395'),
('86401'),
('85609'),
('85027'),
('86409'),
('85737'),
('85345'),
('86329'),
('85135'),
('85747'),
('85377'),
('86351'),
('85014'),
('85934'),
('85364'),
('85344'),
('85627'),
('85706'),
('86506'),
('85750'),
('85542'),
('85374'),
('85302'),
('86303'),
('85334'),
('85017'),
('85923'),
('85746'),
('85736'),
('85928'),
('85285'),
('85347'),
('85210'),
('85618'),
('85381'),
('85635'),
('85131'),
('85940'),
('85216'),
('85340'),
('85206'),
('85702'),
('85326'),
('85619'),
('85041'),
('85620'),
('85029'),
('86323'),
('85320'),
('85267'),
('85040'),
('85712'),
('85075'),
('85744'),
('85258'),
('85630'),
('86502'),
('85551'),
('86446'),
('85611'),
('85359'),
('85655'),
('85709'),
('86505'),
('85308'),
('86439'),
('85376'),
('86403'),
('86011'),
('85356'),
('85738'),
('85246'),
('86315'),
('86333'),
('85719'),
('85086'),
('85714'),
('85933'),
('85274'),
('85735'),
('85123'),
('85013'),
('85010'),
('85286'),
('85030'),
('86021'),
('85641'),
('85046'),
('86556'),
('85281'),
('85138'),
('85751'),
('85044'),
('85342'),
('85008'),
('85053'),
('85530'),
('86052'),
('85708'),
('86018'),
('86535'),
('85550'),
('85037'),
('86017'),
('85601'),
('86515'),
('86538'),
('85061'),
('85602'),
('85031'),
('86035'),
('86436'),
('85325'),
('86043'),
('86324'),
('85350'),
('85346'),
('86443'),
('85141'),
('85201'),
('85118'),
('85625'),
('85065'),
('85070'),
('85546'),
('85277'),
('85343'),
('86335'),
('85733'),
('85371'),
('85021'),
('85252'),
('86053'),
('85268'),
('85226'),
('85130'),
('85637'),
('85717'),
('85775'),
('86442'),
('86301'),
('86312'),
('85544'),
('85726'),
('85261'),
('85083'),
('85732'),
('86038'),
('85382'),
('86514'),
('85119'),
('86426'),
('85211'),
('85541'),
('85202'),
('85621'),
('86030'),
('86510'),
('85287'),
('85062'),
('85362'),
('85365'),
('85614'),
('85912'),
('85390'),
('85328'),
('85539'),
('85349'),
('85392'),
('85653'),
('85932'),
('85716'),
('85190'),
('85011'),
('85203'),
('85194'),
('85351'),
('85352'),
('86022'),
('86520'),
('86045'),
('85337'),
('85012'),
('85275'),
('85132'),
('85307'),
('85019'),
('85034'),
('85703'),
('85367'),
('85935'),
('85742'),
('85720'),
('85375'),
('85048'),
('85388'),
('85266'),
('85372'),
('85335'),
('85632'),
('85531'),
('86343'),
('85127'),
('85501'),
('85191'),
('85071'),
('86540'),
('85323'),
('85623'),
('85120'),
('85710'),
('85534'),
('85322'),
('86413'),
('85063'),
('85009'),
('85701'),
('85616'),
('85631'),
('85502'),
('85255'),
('85704'),
('85755'),
('85121'),
('85634'),
('85396'),
('85080'),
('85756'),
('85552'),
('85385'),
('85338'),
('85087'),
('85930'),
('85633'),
('85722'),
('85721'),
('85117'),
('86028'),
('86441'),
('85264'),
('85645'),
('85296'),
('86005'),
('85028'),
('85725'),
('86431'),
('85748'),
('85358'),
('86334'),
('86025'),
('86444'),
('85263'),
('85073'),
('85939'),
('86433'),
('85142'),
('86015'),
('85085'),
('86411'),
('86326'),
('85213'),
('85318'),
('85172'),
('85929'),
('86341'),
('85920'),
('85354'),
('85060'),
('85911'),
('86544'),
('85139'),
('85259'),
('85926'),
('85280'),
('85076'),
('85646'),
('85713'),
('85543'),
('86302'),
('85253'),
('85336'),
('86024'),
('85004'),
('85282'),
('85941'),
('85234'),
('85339'),
('85383'),
('85173'),
('85707'),
('86314'),
('85536'),
('85353'),
('85752'),
('85284'),
('85715'),
('85042'),
('85749'),
('85348'),
('85754'),
('85605'),
('85652'),
('85215'),
('85380'),
('85303'),
('86429'),
('85192'),
('85327'),
('85022'),
('85045'),
('85079'),
('85545'),
('86036'),
('86032'),
('85214'),
('85936'),
('86405'),
('85038'),
('86042'),
('85937'),
('85254'),
('86545'),
('85262'),
('85082'),
('85251'),
('85248'),
('85145'),
('86327'),
('86325'),
('85613'),
('85927'),
('85003'),
('85204'),
('85606'),
('85931'),
('85256'),
('85532'),
('85331'),
('86445'),
('85297'),
('85207'),
('85553'),
('85624'),
('85640'),
('85074'),
('86504'),
('85361'),
('86430'),
('85607'),
('86002'),
('85554'),
('85209'),
('86001'),
('85147'),
('86304'),
('85305'),
('85639'),
('86031'),
('86503'),
('86406'),
('85039'),
('85938'),
('85366'),
('85016'),
('85072'),
('85740'),
('85617'),
('85068'),
('85236'),
('85622'),
('86402'),
('85002'),
('85902'),
('85369'),
('85730'),
('85360'),
('85533'),
('85924'),
('85122')
;


--;WITH Z AS
--(
--	SELECT * FROM @ZIPS1 
--	UNION ALL
--	SELECT * FROM @ZIPS2 
--	UNION ALL
--	SELECT * FROM @ZIPS3
--)
--	select 'all_zips' as category, count(ZipCode) as tally from z
--	union all
--	select 'distinct_zips' as category, count(distinct ZipCode) as tally from z
--;
----2621

		IF NOT EXISTS 
		(
			SELECT 
				ZipId 
			FROM 
				[dasforbuh].[Zips] Z1
				INNER JOIN 
				(
					SELECT * FROM @ZIPS1 
					UNION ALL
					SELECT * FROM @ZIPS2 
					UNION ALL
					SELECT * FROM @ZIPS3 			
				) Z2
					ON Z1.ZipCode = Z2.ZipCode
			WHERE
				Z1.DisasterId = @DisasterID
		)
		BEGIN
			INSERT INTO 
				[dasforbuh].[Zips]	(ZipCode, DisasterId)
			SELECT DISTINCT
				ZipCode
				,@DisasterID 
			FROM 
				(
					SELECT * FROM @ZIPS1 
					UNION ALL
					SELECT * FROM @ZIPS2 
					UNION ALL
					SELECT * FROM @ZIPS3 			
				)z
		END;

		-- Save/Set the row count from the previously executed statement
		SELECT @ROWCOUNT = @ROWCOUNT + @@ROWCOUNT;

	IF @ROWCOUNT = @ExpectedRowCount
		BEGIN
			PRINT 'Transaction committed.'
			COMMIT TRANSACTION
			--ROLLBACK TRANSACTION
		END
	ELSE
		BEGIN
			PRINT 'Transaction NOT committed.';
			PRINT 'Expected row count not met. Expecting ' +  CAST(@ExpectedRowCount AS VARCHAR(10)) + ' rows, but returned ' + CAST(@ROWCOUNT AS VARCHAR(10))+ ' rows.';
			ROLLBACK TRANSACTION;
		END
END TRY
BEGIN CATCH
	PRINT 'Transaction NOT committed. Errors found in SQL statement.';
	ROLLBACK TRANSACTION;
	THROW;
END CATCH;
