--query based on CNH XXXXX
USE CDW
GO

SELECT DISTINCT	
	LNXX.BF_SSN
	,LNXX.LN_SEQ
	,LNXX.IC_LON_PGM
FROM	
	..LNXX_LON LNXX
	INNER JOIN ..PDXX_PRS_NME PDXX
		ON LNXX.BF_SSN = PDXX.DF_PRS_ID
	INNER JOIN ..DWXX_DW_CLC_CLU DWXX
		ON LNXX.BF_SSN = DWXX.BF_SSN
		AND LNXX.LN_SEQ = DWXX.LN_SEQ
WHERE	
	LNXX.LC_STA_LONXX = 'R'
	AND LNXX.LA_CUR_PRI > X.XX
	AND	DWXX.WC_DW_LON_STA IN ('XX','XX','XX','XX','XX','XX','XX','XX','XX','XX')
	AND LNXX.IC_LON_PGM NOT IN 
	(
		'DLUCNS', 'DLSCNS', 'CNSLDN', 'DSCON', 'DLUSPL', 'DUCON', 
		'SPCNSL', 'SUBCNS', 'SUBSPC', 'UNCNS', 'DLSPCN', 'DLSSPL', 
		'DLCNSL', 'DLPCNS', 'UNSPC', 'DLSCST', 'DLSCUN', 'DLSCPL', 
		'DLSCPG', 'DLSCSL', 'DLSCSC', 'DLSCUC', 'DLSCCN'
	)
