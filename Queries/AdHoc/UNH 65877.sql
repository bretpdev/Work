USE UDW;
GO

DECLARE @BORROWERS TABLE
(
	BF_SSN VARCHAR(9),
	LN_SEQ VARCHAR(3),
	LN_RPS_SEQ VARCHAR(3)
);

INSERT INTO @BORROWERS (BF_SSN, LN_SEQ, LN_RPS_SEQ) VALUES
('014648681', '1', '4'),
('027708125', '1', '4'),
('027708125', '1', '3'),
('040646314', '1', '5'),
('040646314', '3', '5'),
('104768912', '1', '2'),
('111722788', '2', '3'),
('137047923', '1', '7'),
('137047923', '2', '8'),
('176621278', '1', '3'),
('176621278', '2', '3'),
('181607070', '2', '11'),
('181607070', '3', '11'),
('181607070', '4', '11'),
('181607070', '5', '11'),
('212798131', '1', '3'),
('219027296', '1', '23'),
('219027296', '2', '23'),
('219027296', '3', '24'),
('219027296', '4', '25'),
('219027296', '5', '24'),
('219027296', '6', '25'),
('223938910', '1', '7'),
('223938910', '2', '7'),
('223938910', '3', '7'),
('247815409', '1', '4'),
('311866367', '1', '6'),
('444948780', '1', '3'),
('462931115', '1', '7'),
('462931115', '2', '8'),
('503084941', '1', '8'),
('518158881', '1', '7'),
('518158881', '2', '7'),
('519371217', '1', '9'),
('519371217', '2', '10'),
('519371217', '3', '10'),
('519371217', '4', '10'),
('523115495', '1', '4'),
('523115495', '2', '4'),
('528436526', '14','5'),
('528791387', '7', '5'),
('528791387', '8', '5'),
('528791387', '9', '5'),
('528791387', '10', '5'),
('528996777', '8', '8'),
('529197369', '1', '5'),
('529197369', '2', '5'),
('529771062', '11', '29'),
('529777944', '1', '4'),
('529777944', '2', '4'),
('529793017', '5', '47'),
('529793017', '6', '47'),
('529793017', '7', '47'),
('529793017', '8', '47'),
('529793017', '9', '47'),
('529793017', '10', '47'),
('529793017', '12', '47'),
('529793017', '13', '47'),
('529796102', '1', '15'),
('529796102', '2', '15'),
('529892968', '1', '4'),
('529911938', '1', '7'),
('529911938', '2', '7'),
('529983277', '26', '44'),
('529983277', '27', '44'),
('529983277', '26', '43'),
('529983277', '27', '43'),
('530753288', '1', '4'),
('564479692', '1', '11'),
('564479692', '2', '12'),
('587498379', '1', '6'),
('587498379', '2', '7'),
('587498379', '3', '5'),
('593927553', '1', '15'),
('593927553', '2', '15'),
('603202247', '1', '4'),
('606300427', '2', '6'),
('610669547', '1', '4'),
('610669547', '2', '4'),
('610669547', '3', '4'),
('610669547', '4', '4'),
('614293844', '1', '3'),
('614293844', '2', '4'),
('646030093', '2', '3'),
('646030093', '3', '3'),
('646030093', '4', '3'),
('646030093', '5', '3'),
('646123579', '7', '8'),
('646126724', '1', '2'),
('646126724', '2', '2'),
('646126724', '3', '2'),
('646126724', '4', '2'),
('646126724', '5', '2'),
('646126724', '6', '2'),
('646126724', '7', '2'),
('647181575', '1', '2'),
('647181575', '2', '2'),
('647181575', '3', '2'),
('647181575', '4', '2'),
('647181575', '5', '2'),
('647209637', '1', '5'),
('647209637', '2', '5'),
('647209637', '3', '5'),
('647209637', '4', '5'),
('647209637', '5', '5'),
('647209637', '6', '5'),
('647209637', '8', '5'),
('647266425', '2', '4'),
('647266425', '3', '4'),
('667038457', '1', '3'),
('667038457', '2', '3')
;
--SELECT * FROM @BORROWERS

SELECT DISTINCT
	BOR.BF_SSN,
	BOR.LN_SEQ,
	BOR.LN_RPS_SEQ,
	RS10.LD_RPS_1_PAY_DU
FROM
	@BORROWERS BOR
	INNER JOIN LN65_LON_RPS LN65
		ON LN65.BF_SSN = BOR.BF_SSN
		AND LN65.LN_SEQ = BOR.LN_SEQ
		AND LN65.LN_RPS_SEQ = BOR.LN_RPS_SEQ
	INNER JOIN RS10_BR_RPD RS10
		ON RS10.BF_SSN = LN65.BF_SSN
		AND RS10.LN_RPS_SEQ = LN65.LN_RPS_SEQ
;

