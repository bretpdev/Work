LIBNAME DUSTER REMOTE SERVER=DUSTER SLIBREF=WORK;
RSUBMIT;
LIBNAME OLWHRM1 DB2 DATABASE=DLGSUTWH OWNER=OLWHRM1;
PROC SQL ;
	CREATE TABLE LP0613 AS
		SELECT
			*
		FROM
			OLWHRM1.LP06_ITR_AND_TYP
		WHERE
			PC_STA_LPD06 = 'A'
			AND PD_EFF_SR_LPD06 = '01JUL2013'D
			AND IF_GTR = '000749' 
			AND IF_OWN = '828476'
	;

	CREATE TABLE LP0614 AS
		SELECT
			*
		FROM
			OLWHRM1.LP06_ITR_AND_TYP
		WHERE
			PC_STA_LPD06 = 'A'
			AND PD_EFF_SR_LPD06 = '01JUL2014'D
			AND IF_GTR = '000749' 
			AND IF_OWN = '828476'
	;

	CREATE TABLE LP06 AS
		SELECT
			LP0613.*
		FROM
			OLWHRM1.LP06_ITR_AND_TYP LP0613
			LEFT JOIN OLWHRM1.LP06_ITR_AND_TYP LP0614
				ON LP0613.PC_STA_LPD06 = LP0614.PC_STA_LPD06
				AND LP0613.IC_LON_PGM = LP0614.IC_LON_PGM
				AND LP0613.PF_RGL_CAT = LP0614.PF_RGL_CAT
				AND LP0613.IF_GTR = LP0614.IF_GTR
				AND LP0613.IF_OWN = LP0614.IF_OWN
				AND LP0613.IF_BND_ISS = LP0614.IF_BND_ISS
				AND LP0613.PC_ITR_TYP = LP0614.PC_ITR_TYP
				AND LP0614.PD_EFF_SR_LPD06 = '01JUL2014'D
		WHERE
			LP0613.PC_STA_LPD06 = 'A'
			AND LP0613.PD_EFF_SR_LPD06 = '01JUL2013'D
			AND LP0613.IF_GTR = '000749' 
			AND LP0613.IF_OWN = '828476'
			AND LP0614.IF_BND_ISS IS NULL
	;
QUIT;
ENDRSUBMIT;
/**/
/*DATA LP0613; SET DUSTER.LP0613; RUN;*/
/*DATA LP0614; SET DUSTER.LP0614; RUN;*/
DATA LP06; SET DUSTER.LP06; RUN;

PROC EXPORT
		DATA=LP06
		OUTFILE='T:\SAS\Missing Interest Rates.XLSX'
		REPLACE;
RUN;
