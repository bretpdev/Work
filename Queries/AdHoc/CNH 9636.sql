/*detail*/
SELECT * FROM OPENQUERY (LEGEND, '
	SELECT DISTINCT
		LNXX.BF_SSN
		,LNXX.LN_SEQ
		,LNXX.LC_INT_RDC_PGM
		,LNXX.LD_CRT_LONXX
		,LNXX.LC_STA_LONXX
	FROM
		PKUB.LNXX_INT_RTE_HST LNXX
	WHERE
		LNXX.LC_INT_RDC_PGM = ''M''
		AND DAYS(LNXX.LD_CRT_LONXX) BETWEEN DAYS(''XX/XX/XXXX'') AND DAYS(''XX/XX/XXXX'')
		AND LNXX.LC_STA_LONXX = ''A''
');

/*output*/
SELECT * FROM OPENQUERY (LEGEND, '
	SELECT DISTINCT
		LNXX.BF_SSN
		,LNXX.LN_SEQ
	FROM
		PKUB.LNXX_INT_RTE_HST LNXX
	WHERE
		LNXX.LC_INT_RDC_PGM = ''M''
		AND DAYS(LNXX.LD_CRT_LONXX) BETWEEN DAYS(''XX/XX/XXXX'') AND DAYS(''XX/XX/XXXX'')
		AND LNXX.LC_STA_LONXX = ''A''
');

/*output - summary*/
SELECT * FROM OPENQUERY (LEGEND, '
	SELECT 
		COUNT(DISTINCT LNXX.BF_SSN) AS UNIQUE_BORROWERS
	FROM
		PKUB.LNXX_INT_RTE_HST LNXX
	WHERE
		LNXX.LC_INT_RDC_PGM = ''M''
		AND DAYS(LNXX.LD_CRT_LONXX) BETWEEN DAYS(''XX/XX/XXXX'') AND DAYS(''XX/XX/XXXX'')
		AND LNXX.LC_STA_LONXX = ''A''
');
