select * from openquery(legend,
'
SELECT DISTINCT
	PDXX.DF_SPE_ACC_ID,
	LN_SEQ,
	LD_ITR_EFF_BEG,
	LD_ITR_EFF_END
FROM 
	PKUB.LNXX_INT_RTE_HST LNXX
	INNER JOIN PKUB.PDXX_PRS_NME PDXX
		ON PDXX.DF_PRS_ID = LNXX.BF_SSN
WHERE
	LNXX.LC_INT_RDC_PGM = ''S''
	AND LNXX.LR_ITR = X.XXX
	AND
	(
		YEAR(LD_ITR_EFF_BEG) <= XXXX
		AND
		YEAR(LD_ITR_EFF_END) >= XXXX
	)
')	