--run on UHEAASQLDB
USE ULS
GO

BEGIN TRY
	BEGIN TRANSACTION;

		DECLARE @ROWCOUNT INT = 0
				,@ExpectedRowCount INT = 1944 --# of distinct zips + 1 disaster forb
				,@Disaster VARCHAR(100) = 'COVID-19 Pandemic IN/NH/AR (DR-4515/4516/4518)'
				,@BeginDate DATE = CONVERT(DATE,'20200403') --declaration date
				,@AddedBy VARCHAR(50) = 'UNH 66932' --change to current NH ticket
				,@DisasterID_initial INT = (SELECT MAX(DisasterId)+1 FROM dasforbuh.Disasters);

		--SET IDENTITY_INSERT [dasforbuh].[Disasters] ON; --OPSDEV ONLY

			INSERT INTO [dasforbuh].[Disasters]
			(
				DisasterId, 
				Disaster, 
				BeginDate, 
				EndDate, 
				MaxEndDate, 
				DelinquencyOverride, --set to 1 for COVID
				Active, 
				AddedBy
			)
			VALUES
			(
				@DisasterID_initial, 
				@Disaster, 
				@BeginDate, 
				DATEADD(DAY, 89, @BeginDate), 
				DATEADD(DAY, 89, @BeginDate), 
				1, 
				1, 
				@AddedBy
			);--1
			-- Save/Set the row count from the previously executed statement
			SELECT @ROWCOUNT = @@ROWCOUNT;		
		
		--SET IDENTITY_INSERT [dasforbuh].[Disasters] OFF; --OPSDEV ONLY
		
		--Affected zip codes:
		DECLARE @DisasterID INT = (SELECT DisasterId FROM dasforbuh.Disasters WHERE Disaster = @Disaster);

		DECLARE @Zips1 TABLE (ZipCode VARCHAR(5));
		INSERT INTO @Zips1 (ZipCode) VALUES 
--Affected Zip Codes
('47131'),
('46930'),
('46283'),
('46799'),
('46869'),
('46208'),
('46563'),
('46798'),
('46537'),
('47617'),
('47459'),
('46032'),
('46045'),
('46515'),
('46904'),
('47116'),
('47240'),
('47965'),
('47190'),
('47970'),
('46411'),
('47861'),
('47460'),
('46216'),
('47112'),
('46615'),
('47954'),
('46931'),
('46365'),
('47955'),
('46912'),
('47932'),
('47220'),
('47010'),
('47860'),
('46320'),
('46517'),
('47024'),
('46991'),
('46288'),
('46375'),
('46051'),
('46950'),
('46167'),
('46785'),
('47735'),
('46979'),
('46164'),
('46103'),
('46922'),
('46379'),
('46947'),
('46543'),
('47125'),
('47003'),
('47273'),
('47408'),
('47249'),
('47958'),
('47983'),
('46161'),
('46298'),
('47326'),
('46018'),
('46225'),
('46524'),
('46082'),
('47957'),
('47232'),
('47585'),
('47354'),
('47528'),
('46982'),
('46710'),
('47247'),
('46165'),
('46528'),
('47666'),
('46382'),
('47023'),
('47809'),
('47987'),
('47134'),
('47803'),
('47638'),
('46572'),
('46773'),
('46290'),
('47272'),
('47519'),
('47952'),
('46938'),
('47703'),
('47715'),
('46928'),
('47568'),
('47202'),
('46218'),
('46203'),
('47382'),
('47420'),
('47885'),
('46897'),
('46376'),
('46786'),
('46063'),
('46322'),
('46368'),
('47537'),
('46581'),
('47521'),
('47124'),
('46310'),
('46896'),
('47145'),
('46366'),
('46967'),
('46377'),
('46075'),
('46745'),
('47579'),
('47845'),
('46038'),
('46780'),
('47982'),
('47136'),
('47451'),
('46867'),
('47117'),
('47432'),
('47879'),
('46553'),
('46347'),
('46980'),
('46868'),
('47337'),
('47660'),
('46783'),
('47435'),
('46635'),
('47978'),
('47556'),
('46992'),
('47629'),
('47711'),
('46205'),
('46355'),
('47586'),
('46209'),
('47369'),
('46860'),
('47552'),
('46280'),
('46350'),
('46996'),
('46854'),
('47226'),
('47940'),
('46229'),
('47616'),
('46277'),
('46809'),
('46804'),
('46131'),
('47230'),
('47386'),
('46111'),
('47438'),
('47731'),
('46784'),
('47021'),
('46253'),
('46815'),
('47035'),
('47990'),
('46140'),
('47648'),
('47514'),
('46975'),
('47880'),
('46680'),
('47163'),
('47263'),
('47963'),
('47725'),
('47580'),
('46803'),
('47928'),
('47730'),
('47380'),
('46742'),
('47702'),
('47165'),
('47906'),
('47846'),
('47597'),
('46154'),
('47944'),
('47341'),
('46324'),
('47142'),
('46730'),
('46346'),
('47306'),
('47525'),
('47334'),
('46319'),
('46307'),
('46126'),
('46738'),
('47670'),
('47223'),
('47512'),
('47141'),
('47620'),
('47305'),
('47710'),
('47104'),
('46601'),
('47393'),
('46941'),
('47804'),
('46142'),
('46349'),
('47722'),
('47574'),
('47708'),
('47344'),
('47713'),
('47524'),
('46156'),
('47740'),
('46776'),
('46571'),
('46514'),
('46405'),
('47146'),
('46348'),
('46552'),
('46183'),
('46175'),
('46916'),
('46721'),
('46504'),
('47546'),
('47308'),
('46556'),
('47834'),
('47967'),
('46532'),
('47011'),
('46863'),
('46236'),
('47992'),
('47345'),
('47876'),
('46856'),
('46401'),
('46970'),
('46614'),
('46929'),
('47882'),
('46031'),
('47989'),
('47732'),
('46125'),
('47433'),
('47975'),
('46204'),
('46130'),
('46184'),
('47924'),
('47161'),
('47737'),
('47280'),
('46207'),
('47138'),
('46016'),
('46731'),
('47453'),
('46143'),
('46539'),
('47747'),
('47421'),
('47905'),
('46037'),
('47427'),
('46120'),
('46704'),
('47995'),
('46121'),
('47361'),
('46044'),
('47355'),
('47338'),
('46987'),
('47863'),
('46554'),
('46383'),
('47842'),
('47704'),
('47307'),
('47467'),
('46562'),
('46624'),
('47683'),
('46787'),
('47576'),
('47236'),
('47405'),
('46162'),
('46953'),
('46814'),
('47270'),
('47443'),
('47981'),
('47871'),
('46845'),
('47618'),
('47631'),
('47283'),
('47445'),
('46855'),
('47135'),
('47375'),
('47034'),
('46015'),
('46301'),
('47969'),
('47531'),
('46825'),
('46237'),
('46852'),
('47854'),
('47942'),
('46410'),
('47434'),
('46565'),
('46123'),
('46173'),
('47265'),
('46408'),
('46170'),
('47964'),
('46403'),
('46308'),
('46345'),
('47733'),
('47536'),
('47581'),
('47848'),
('46702'),
('46371'),
('47019'),
('46573'),
('47639'),
('46001'),
('47385'),
('46990'),
('47918'),
('46352'),
('47330'),
('47613'),
('47464'),
('47114'),
('46380'),
('47040'),
('46865'),
('46235'),
('46340'),
('47577'),
('47966'),
('46763'),
('46127'),
('47039'),
('46058'),
('46147'),
('47016'),
('46285'),
('47724'),
('47909'),
('47119'),
('47996'),
('47174'),
('47199'),
('46151'),
('46911'),
('46779'),
('46660'),
('46978'),
('47654'),
('46984'),
('47611'),
('46133'),
('46202'),
('47462'),
('47591'),
('46242'),
('47358'),
('47403'),
('46628'),
('46160'),
('46701'),
('46540'),
('47366'),
('47360'),
('46511'),
('46249'),
('47853'),
('47320'),
('47390'),
('47339'),
('46341'),
('46077'),
('47325'),
('46056'),
('46144'),
('47342'),
('46772'),
('46048'),
('47807'),
('47396'),
('46960'),
('46068'),
('46327'),
('47126'),
('47123'),
('47881'),
('46733'),
('46943'),
('47006'),
('46536'),
('47849'),
('47712'),
('47838'),
('47108'),
('46311'),
('46936'),
('46920'),
('46071'),
('47562'),
('47060'),
('47469'),
('46011'),
('47245'),
('46076'),
('46935'),
('47281'),
('47997'),
('47150'),
('47383'),
('46885'),
('47714'),
('46124'),
('47532'),
('47201'),
('47959'),
('46994'),
('46755'),
('46555'),
('46406'),
('46932'),
('46247'),
('47904'),
('46213'),
('47456'),
('46699'),
('46107'),
('46835'),
('47943'),
('47122'),
('47304'),
('46914'),
('46128'),
('47020'),
('46312'),
('46230'),
('47437'),
('46765'),
('46118'),
('46064'),
('47634'),
('46508'),
('46117'),
('47857'),
('46017'),
('46304'),
('46360'),
('47352'),
('47441'),
('46228'),
('46595'),
('47234'),
('47951'),
('47106'),
('46049'),
('47133'),
('46070'),
('47426'),
('46901'),
('46176'),
('47225'),
('46769'),
('47129'),
('46222'),
('47649'),
('47513'),
('46122'),
('47246'),
('47930'),
('47884'),
('47224'),
('46214'),
('46634'),
('47515'),
('46737'),
('46409'),
('46919'),
('46074'),
('47164'),
('47033'),
('47522'),
('46182'),
('46033'),
('47402'),
('46516'),
('47340'),
('46858'),
('46260'),
('47331'),
('46506'),
('47429'),
('46163'),
('46501'),
('46939'),
('46777'),
('46619'),
('47387'),
('47335'),
('46748'),
('47031'),
('47619'),
('46759'),
('47541'),
('47841'),
('46802'),
('46036'),
('46381'),
('46391'),
('46538'),
('46971'),
('47357'),
('47921'),
('46850'),
('47994'),
('47030'),
('46713'),
('47401'),
('47808'),
('46866'),
('46282'),
('46110'),
('46778'),
('46995'),
('46926'),
('46788'),
('46206'),
('47929'),
('46946'),
('46530'),
('47598'),
('46705'),
('46013'),
('47260'),
('46819'),
('46986'),
('47041'),
('47901'),
('47151'),
('47847'),
('46851'),
('47017'),
('46857'),
('46808'),
('46794'),
('47336'),
('47850'),
('47406'),
('47140'),
('46402'),
('47235'),
('46816'),
('47177'),
('46062'),
('46030'),
('46792'),
('47431'),
('47553'),
('47132'),
('46616'),
('47750'),
('47463'),
('46957'),
('47588'),
('46393'),
('47734'),
('47878'),
('46767'),
('47980'),
('47920'),
('47458'),
('47872'),
('47575'),
('47368'),
('46861'),
('46542'),
('47875'),
('47640'),
('46761'),
('47596'),
('47118'),
('46129'),
('46531'),
('47243'),
('46072'),
('47388'),
('46937'),
('46171'),
('46862'),
('46302'),
('46372'),
('47110'),
('46303'),
('47147'),
('46060'),
('47801'),
('46385'),
('47228'),
('47471'),
('47170'),
('46384'),
('47470'),
('47547'),
('46227'),
('46069'),
('47922'),
('47831'),
('46158'),
('46067'),
('47542'),
('46148'),
('47852'),
('46917'),
('46106'),
('46582'),
('46268'),
('46545'),
('46921'),
('47381'),
('47244'),
('46035'),
('47535'),
('47551'),
('46050'),
('47558'),
('47832'),
('46113'),
('46714'),
('47933'),
('46180'),
('46801'),
('47868'),
('47446'),
('46526'),
('47144'),
('46255'),
('46952'),
('47840'),
('47941'),
('47706'),
('47721'),
('47991'),
('47454'),
('47851'),
('47529'),
('47012'),
('46923'),
('47167'),
('46711'),
('47327'),
('46746'),
('46806'),
('47322'),
('46061'),
('46534'),
('47962'),
('46617'),
('47520'),
('46725'),
('47869'),
('47633'),
('47370'),
('46250'),
('47561'),
('46186'),
('46544'),
('46789'),
('47630'),
('46989'),
('46150'),
('47573'),
('47362'),
('47833'),
('46172'),
('47701'),
('46166'),
('46244'),
('46251'),
('47858'),
('46985'),
('47736'),
('46750'),
('47274'),
('47324'),
('47231'),
('46155'),
('46239'),
('46913'),
('47665'),
('47166'),
('47635'),
('47302'),
('46637'),
('46968'),
('47394'),
('47356'),
('47968'),
('46220'),
('46262'),
('46796'),
('47902'),
('46859'),
('46012'),
('47203'),
('47949'),
('47866'),
('46546'),
('46394'),
('46550'),
('47436'),
('47227'),
('46899'),
('46226'),
('47025'),
('46590'),
('46325'),
('47359'),
('47348'),
('47162'),
('47516'),
('47111'),
('46567'),
('47993'),
('46703'),
('46256'),
('46795'),
('46240'),
('46965'),
('47578'),
('46770'),
('47557'),
('47615'),
('47637'),
('46146'),
('46962'),
('46502'),
('47523'),
('46392'),
('47448'),
('46112'),
('46513'),
('46902'),
('46404'),
('46361'),
('47862'),
('46915'),
('46373'),
('47590'),
('46732'),
('46988'),
('47353'),
('46047'),
('47612'),
('46998'),
('46259'),
('46201'),
('47907'),
('46168'),
('46407'),
('46782'),
('46221'),
('47903'),
('47038'),
('46510'),
('46853'),
('47647'),
('46743'),
('46034'),
('47716'),
('47373'),
('46740'),
('47971'),
('47549'),
('47465'),
('46039'),
('46219'),
('47102'),
('46040'),
('46055'),
('47917'),
('46958'),
('46102'),
('47037'),
('46864'),
('47925'),
('47036'),
('47719'),
('47043'),
('46135'),
('46181'),
('47916'),
('46781'),
('47527'),
('46626'),
('46760'),
('47948'),
('47946'),
('46374'),
('47836'),
('46933'),
('47550'),
('46157'),
('47874'),
('47960'),
('47175'),
('46052'),
('47449'),
('47303'),
('47250'),
('47452'),
('47264'),
('46115'),
('47160'),
('46390'),
('47802'),
('46723'),
('46580'),
('46791'),
('47974'),
('46613'),
('46974'),
('46807'),
('46706'),
('46747'),
('47564'),
('46797'),
('46895'),
('47392'),
('46764'),
('47455'),
('46241'),
('46771'),
('47367'),
('46959'),
('47567'),
('47601'),
('46356'),
('47115'),
('46104'),
('47950'),
('47865'),
('46231'),
('47001'),
('46951'),
('46942'),
('46793'),
('47042'),
('47107'),
('47018'),
('47120'),
('46741'),
('46014'),
('47143'),
('46041'),
('46961'),
('47424'),
('47584'),
('46224'),
('47032'),
('46065'),
('46898'),
('46805'),
('46323'),
('46254'),
('47705'),
('46910'),
('47720'),
('47837'),
('47229'),
('47384'),
('46574'),
('47859'),
('46818'),
('46945'),
('47986'),
('47346'),
('47351'),
('46321'),
('47728'),
('46766'),
('47977'),
('47610'),
('47022'),
('46507'),
('47501'),
('46057'),
('46278'),
('47545'),
('47468'),
('46234'),
('47172'),
('47870'),
('46217'),
('46085'),
('47137'),
('46149'),
('46561'),
('47404'),
('47374'),
('47805'),
('47371'),
('47926'),
('46342'),
('46774'),
('46940'),
('47282'),
('47407'),
('47855'),
('47130'),
('47988'),
('47923'),
('47457'),
('46570'),
('46903'),
('46105'),
('46977'),
('46527'),
('72934'),
('71652'),
('72928'),
('72680'),
('71720'),
('72099'),
('72134'),
('72569'),
('72959'),
('71676'),
('72905'),
('72460'),
('72434')
;

		DECLARE @Zips2 TABLE (ZipCode VARCHAR(5));
		INSERT INTO @Zips2 (ZipCode) VALUES 
('72451'),
('72392'),
('72837'),
('71968'),
('72427'),
('72718'),
('71865'),
('72438'),
('72034'),
('72083'),
('72416'),
('72021'),
('72347'),
('72956'),
('72457'),
('72387'),
('72372'),
('71724'),
('72429'),
('72170'),
('72773'),
('72661'),
('71932'),
('72168'),
('72464'),
('72827'),
('72455'),
('72716'),
('72052'),
('72940'),
('72733'),
('72001'),
('72312'),
('72560'),
('71864'),
('72176'),
('72916'),
('72642'),
('72395'),
('71861'),
('72119'),
('72567'),
('72089'),
('72713'),
('72338'),
('72221'),
('72201'),
('72212'),
('72024'),
('72029'),
('72854'),
('72577'),
('72222'),
('72173'),
('72033'),
('72444'),
('72211'),
('72927'),
('72057'),
('72330'),
('72061'),
('72539'),
('72479'),
('72624'),
('71638'),
('72014'),
('72587'),
('72471'),
('72542'),
('71961'),
('72830'),
('72631'),
('72762'),
('72425'),
('72722'),
('72120'),
('72583'),
('72935'),
('72515'),
('72765'),
('72373'),
('72727'),
('71942'),
('72178'),
('72015'),
('72904'),
('72458'),
('72207'),
('72851'),
('72662'),
('71766'),
('72585'),
('72204'),
('71831'),
('71828'),
('72389'),
('72114'),
('72117'),
('71670'),
('72104'),
('72365'),
('72524'),
('72328'),
('72811'),
('71745'),
('72644'),
('72301'),
('72729'),
('72332'),
('72801'),
('72632'),
('72441'),
('72936'),
('72018'),
('72036'),
('72544'),
('72641'),
('72465'),
('72843'),
('71971'),
('72082'),
('71662'),
('71765'),
('72190'),
('71945'),
('71853'),
('71837'),
('71852'),
('72623'),
('71838'),
('72923'),
('72182'),
('72575'),
('71721'),
('72051'),
('72633'),
('71943'),
('72841'),
('71842'),
('71826'),
('71973'),
('72153'),
('72260'),
('72042'),
('72619'),
('72553'),
('72522'),
('71902'),
('72123'),
('71950'),
('72346'),
('71822'),
('72512'),
('72424'),
('71923'),
('71667'),
('72734'),
('72628'),
('72102'),
('72058'),
('72634'),
('72007'),
('72167'),
('72521'),
('72568'),
('71647'),
('72139'),
('72530'),
('72768'),
('72003'),
('72657'),
('72335'),
('72135'),
('71935'),
('72355'),
('71749'),
('72084'),
('72130'),
('72149'),
('71758'),
('72348'),
('72520'),
('72812'),
('71678'),
('72110'),
('71754'),
('72046'),
('72081'),
('72437'),
('72470'),
('72085'),
('72654'),
('72231'),
('72957'),
('72834'),
('72035'),
('71953'),
('71728'),
('72203'),
('72004'),
('72436'),
('71666'),
('71744'),
('72327'),
('72503'),
('72670'),
('72828'),
('72602'),
('71859'),
('72769'),
('72412'),
('72370'),
('72501'),
('72440'),
('72914'),
('72932'),
('72430'),
('71661'),
('71941'),
('72225'),
('72402'),
('72415'),
('72917'),
('72390'),
('71762'),
('72342'),
('72048'),
('72741'),
('72055'),
('72732'),
('72519'),
('72711'),
('72435'),
('72655'),
('72124'),
('72669'),
('72668'),
('72324'),
('72533'),
('72865'),
('71940'),
('71820'),
('72833'),
('72158'),
('72064'),
('72145'),
('72044'),
('71901'),
('72384'),
('72902'),
('72938'),
('71612'),
('72651'),
('72127'),
('72143'),
('72635'),
('71969'),
('72469'),
('72391'),
('71750'),
('72336'),
('72858'),
('71640'),
('71827'),
('72206'),
('72175'),
('72913'),
('72853'),
('72403'),
('71970'),
('72944'),
('72025'),
('71730'),
('72947'),
('72107'),
('72074'),
('72933'),
('72411'),
('72663'),
('72088'),
('72428'),
('71846'),
('72715'),
('71656'),
('72010'),
('72417'),
('72410'),
('72482'),
('72126'),
('72255'),
('71753'),
('72776'),
('72472'),
('71677'),
('72367'),
('71960'),
('72313'),
('72955'),
('72745'),
('72958'),
('72121'),
('72639'),
('72311'),
('72702'),
('72550'),
('72066'),
('72475'),
('72339'),
('72682'),
('71823'),
('71929'),
('71763'),
('72030'),
('72129'),
('72645'),
('72529'),
('72118'),
('72216'),
('72666'),
('71933'),
('72566'),
('72422'),
('72730'),
('72474'),
('72329'),
('72047'),
('72319'),
('71748'),
('72826'),
('71644'),
('72764'),
('72295'),
('72513'),
('72901'),
('72013'),
('72413'),
('71659'),
('72863'),
('72845'),
('72824'),
('72930'),
('71959'),
('72615'),
('72209'),
('72140'),
('71910'),
('72072'),
('72714'),
('72857'),
('71751'),
('72565'),
('72164'),
('72447'),
('71665'),
('72364'),
('71860'),
('72040'),
('72829'),
('72070'),
('72325'),
('72946'),
('71639'),
('71601'),
('71903'),
('72122'),
('72653'),
('71847'),
('71747'),
('71658'),
('72360'),
('72461'),
('72719'),
('72640'),
('71643'),
('72686'),
('72462'),
('71921'),
('72562'),
('72310'),
('72068'),
('72005'),
('72571'),
('72073'),
('72736'),
('72219'),
('72749'),
('72835'),
('72683'),
('72087'),
('72320'),
('71731'),
('72019'),
('72067'),
('72685'),
('72919'),
('72630'),
('71834'),
('71701'),
('71839'),
('72376'),
('72584'),
('72703'),
('71726'),
('72846'),
('71671'),
('72658'),
('72404'),
('72386'),
('72648'),
('72540'),
('72636'),
('72821'),
('71759'),
('71770'),
('71832'),
('72112'),
('72065'),
('72341'),
('72433'),
('72576'),
('72419'),
('72751'),
('72770'),
('72405'),
('71998'),
('71964'),
('71742'),
('72133'),
('72450'),
('72952'),
('71663'),
('72368'),
('71920'),
('72026'),
('72017'),
('72032'),
('72679'),
('71602'),
('72027'),
('71611'),
('71913'),
('71772'),
('72675'),
('72572'),
('72106'),
('72847'),
('72537'),
('72316'),
('71722'),
('72020'),
('72011'),
('72060'),
('72031'),
('72753'),
('72215'),
('71646'),
('71841'),
('72075'),
('71862'),
('72002'),
('72166'),
('72103'),
('72079'),
('72543'),
('72421'),
('72037'),
('71651'),
('72528'),
('72737'),
('72774'),
('71631'),
('72331'),
('72205'),
('72802'),
('71825'),
('72414'),
('72431'),
('72613'),
('72554'),
('72116'),
('72650'),
('72856'),
('72712'),
('72043'),
('72128'),
('71957'),
('72445'),
('71944'),
('72358'),
('72526'),
('72199'),
('72532'),
('72315'),
('72069'),
('72739'),
('72760'),
('71840'),
('72579'),
('71855'),
('71613'),
('72449'),
('72181'),
('72227'),
('72757'),
('72041'),
('72704'),
('71835'),
('72396'),
('72006'),
('72735'),
('72531'),
('71999'),
('72937'),
('72638'),
('72137'),
('71725'),
('72756'),
('72086'),
('72156'),
('72354'),
('72626'),
('72101'),
('72028'),
('72906'),
('72063'),
('71962'),
('72538'),
('72948'),
('72150'),
('71956'),
('71654'),
('72742'),
('72611'),
('72115'),
('71958'),
('72023'),
('72394'),
('72453'),
('72852'),
('72740'),
('72945'),
('72350'),
('72113'),
('72738'),
('71642'),
('72943'),
('72432'),
('72761'),
('72359'),
('72321'),
('72136'),
('72379'),
('72131'),
('72157'),
('72832'),
('72443'),
('72012'),
('72556'),
('72601'),
('71802'),
('72340'),
('72456'),
('72534'),
('72581'),
('72860'),
('72536'),
('72038'),
('72217'),
('72179'),
('72459'),
('71966'),
('71858'),
('72842'),
('72573'),
('71965'),
('72466'),
('72728'),
('72838'),
('72820'),
('72527'),
('72744'),
('72180'),
('72366'),
('71949'),
('72478'),
('71854'),
('72677'),
('72353'),
('72426'),
('72374'),
('72950'),
('72111'),
('72454'),
('72659'),
('72721'),
('72142'),
('72202'),
('72747'),
('71660'),
('71922'),
('72921'),
('72152'),
('72855'),
('71866'),
('71851'),
('72564'),
('71972'),
('72377'),
('71674'),
('72169'),
('72908'),
('71635'),
('72351'),
('72903'),
('72561'),
('72616'),
('72223'),
('72326'),
('72132'),
('72629'),
('72108'),
('72369'),
('71857'),
('72076'),
('72016'),
('72322'),
('72926'),
('72383'),
('72555'),
('72951'),
('72214'),
('72059'),
('72303'),
('72617'),
('72125'),
('71833'),
('71603'),
('72442'),
('72352'),
('71909'),
('71836'),
('71743'),
('71740'),
('72401'),
('72687'),
('72183'),
('72717'),
('71914'),
('71657'),
('72752'),
('72758'),
('72823'),
('71937'),
('71752'),
('72080'),
('72523'),
('72546'),
('72210'),
('72918'),
('71675'),
('72467'),
('71653'),
('71655'),
('72039'),
('71711'),
('72766'),
('71845'),
('71952'),
('72941'),
('72660'),
('72333'),
('72022'),
('72525'),
('72141'),
('72701'),
('72045'),
('72078'),
('72840'),
('71630'),
('72949'),
('72578'),
('71764'),
('72839'),
('72165'),
('72517'),
('72473'),
('72545'),
('72476'),
('71801'),
('72160'),
('72053'),
('72672'),
('03225'),
('03745'),
('03743'),
('03838'),
('03217'),
('03785'),
('03227'),
('03875'),
('03231'),
('03447'),
('03773'),
('03598'),
('03844'),
('03055'),
('03442'),
('03850'),
('03865'),
('03864'),
('03750'),
('03896'),
('03882'),
('03579'),
('03034'),
('03253'),
('03609'),
('03448'),
('03605'),
('03584'),
('03255'),
('03071'),
('03840'),
('03441'),
('03871'),
('03467'),
('03766'),
('03583'),
('03242'),
('03054'),
('03595'),
('03221'),
('03106'),
('03861'),
('03468'),
('03885'),
('03858'),
('03049'),
('03450'),
('03814'),
('03038'),
('03602'),
('03883'),
('03862'),
('03784'),
('03279'),
('03260'),
('03281'),
('03804'),
('03851'),
('03070'),
('03108'),
('03590'),
('03226'),
('03276'),
('03254'),
('03603'),
('03801'),
('03282'),
('03825'),
('03307'),
('03040'),
('03045'),
('03298'),
('03470'),
('03105'),
('03821'),
('03837'),
('03860'),
('03084'),
('03284'),
('03240'),
('03769'),
('03033'),
('03435'),
('03278'),
('03230'),
('03830'),
('03458'),
('03464'),
('03452'),
('03082'),
('03751'),
('03469'),
('03811'),
('03461'),
('03843'),
('03809'),
('03842'),
('03870'),
('03304'),
('03857'),
('03755'),
('03853'),
('03233'),
('03835'),
('03819'),
('03064'),
('03768'),
('03101'),
('03060'),
('03431'),
('03272'),
('03581'),
('03753'),
('03445'),
('03449'),
('03592'),
('03224'),
('03740'),
('03781'),
('03086'),
('03854'),
('03812'),
('03261'),
('03601'),
('03456'),
('03246'),
('03836'),
('03597'),
('03817'),
('03754'),
('03041'),
('03608'),
('03455'),
('03856'),
('03302'),
('03833'),
('03749'),
('03887'),
('03273'),
('03031'),
('03057'),
('03570'),
('03451'),
('03266'),
('03102'),
('03878'),
('03894'),
('03466'),
('03443'),
('03859'),
('03816'),
('03036'),
('03257'),
('03087'),
('03287'),
('03575'),
('03869'),
('03249'),
('03848'),
('03457'),
('03269'),
('03079'),
('03440'),
('03826'),
('03846'),
('03243'),
('03245'),
('03774'),
('03048'),
('03890'),
('03847'),
('03852'),
('03866'),
('03802'),
('03262'),
('03827'),
('03867'),
('03748'),
('03220'),
('03252'),
('03237'),
('03818'),
('03780'),
('03216'),
('03777'),
('03607'),
('03841'),
('03855'),
('03873'),
('03280'),
('03845'),
('03256'),
('03576'),
('03872'),
('03104'),
('03824'),
('03111'),
('03839'),
('03813'),
('03241'),
('03234'),
('03247'),
('03770'),
('03574'),
('03849'),
('03444'),
('03268'),
('03803'),
('03238'),
('03051'),
('03289'),
('03053'),
('03042'),
('03741'),
('03756'),
('03215'),
('03585'),
('03884'),
('03301'),
('03582'),
('03779'),
('03832'),
('03820'),
('03222'),
('03032'),
('03462'),
('03465'),
('03868'),
('03446'),
('03044'),
('03765'),
('03046'),
('03604'),
('03589'),
('03063'),
('03103'),
('03291'),
('03223'),
('03275'),
('03293'),
('03886'),
('03815'),
('03043'),
('03263'),
('03061'),
('03047'),
('03218'),
('03305'),
('03588'),
('03822'),
('03259'),
('03073'),
('03823'),
('03077'),
('03251'),
('03109'),
('03229'),
('03593'),
('03580'),
('03303'),
('03264'),
('03746'),
('03897'),
('03874'),
('03771'),
('03062'),
('03235'),
('03052'),
('03299'),
('03782'),
('03037'),
('03290'),
('03586'),
('03244'),
('03752'),
('03110'),
('03561'),
('03076'),
('03258'),
('03285'),
('03810')
;
--		DECLARE @Zips3 TABLE (ZipCode VARCHAR(5));
--		INSERT INTO @Zips3 (ZipCode) VALUES
--;

--;WITH Z AS
--(
--	SELECT * FROM @ZIPS1 
--	UNION ALL
--	SELECT * FROM @ZIPS2 
--	--UNION ALL
--	--SELECT * FROM @ZIPS3
--)
--	select 'all_zips' as category, count(ZipCode) as tally from z
--	union all
--	select 'distinct_zips' as category, count(distinct ZipCode) as tally from z
--;
----1943

		IF NOT EXISTS 
		(
			SELECT 
				ZipId 
			FROM 
				[dasforbuh].[Zips] Z1
				INNER JOIN 
				(
					SELECT * FROM @ZIPS1 
					UNION ALL
					SELECT * FROM @ZIPS2 
					--UNION ALL
					--SELECT * FROM @ZIPS3 			
				) Z2
					ON Z1.ZipCode = Z2.ZipCode
			WHERE
				Z1.DisasterId = @DisasterID
		)
		BEGIN
			INSERT INTO 
				[dasforbuh].[Zips]	(ZipCode, DisasterId)
			SELECT DISTINCT
				ZipCode
				,@DisasterID 
			FROM 
				(
					SELECT * FROM @ZIPS1 
					UNION ALL
					SELECT * FROM @ZIPS2 
					--UNION ALL
					--SELECT * FROM @ZIPS3 			
				)z
		END;

		-- Save/Set the row count from the previously executed statement
		SELECT @ROWCOUNT = @ROWCOUNT + @@ROWCOUNT;

	IF @ROWCOUNT = @ExpectedRowCount
		BEGIN
			PRINT 'Transaction committed.'
			COMMIT TRANSACTION
			--ROLLBACK TRANSACTION
		END
	ELSE
		BEGIN
			PRINT 'Transaction NOT committed.';
			PRINT 'Expected row count not met. Expecting ' +  CAST(@ExpectedRowCount AS VARCHAR(10)) + ' rows, but returned ' + CAST(@ROWCOUNT AS VARCHAR(10))+ ' rows.';
			ROLLBACK TRANSACTION;
		END
END TRY
BEGIN CATCH
	PRINT 'Transaction NOT committed. Errors found in SQL statement.';
	ROLLBACK TRANSACTION;
	THROW;
END CATCH;
