use udw

go

SELECT DISTINCT
	LN10.BF_SSN AS SSN,
	LN10.LN_SEQ,
	LTRIM(RTRIM(PD10.DM_PRS_1)) + ' ' + LTRIM(RTRIM(PD10.DM_PRS_LST)) AS NAME,
	ISNULL(LK10.PX_DSC_MDM, DW01.WC_DW_LON_STA) AS [STATUS],
	ISNULL(LN16.LN_DLQ_MAX + 1, 0) AS "Days of Deliquency",
	LN10.LA_CUR_PRI,
	GU10.IM_GTR_FUL
FROM
	LN10_LON LN10
	INNER JOIN DW01_DW_CLC_CLU DW01
		ON DW01.BF_SSN = LN10.BF_SSN
		AND DW01.LN_SEQ = LN10.LN_SEQ
	INNER JOIN PD10_PRS_NME PD10
		ON PD10.DF_PRS_ID = LN10.BF_SSN
	INNER JOIN GU10_GTR GU10
		ON GU10.IF_GTR = LN10.IF_GTR

	LEFT JOIN 
	(
		SELECT * FROM OPENQUERY(DUSTER, 'SELECT * FROM OLWHRM1.LK10_LS_CDE_LKP WHERE PM_ATR = ''WC-DW-LON-STA''')
	)LK10
		ON LK10.PX_ATR_VAL = DW01.WC_DW_LON_STA
	LEFT JOIN LN16_LON_DLQ_HST LN16
		ON LN16.BF_SSN = LN10.BF_SSN
		AND LN16.LN_SEQ = LN10.LN_SEQ
		AND LN16.LC_STA_LON16 = '1'
WHERE
	LN10.IF_GTR != '000749'
	AND LN10.LA_CUR_PRI > 0.00
	AND LN10.LC_STA_LON10 = 'R'
ORDER BY 
LN10.BF_SSN,
LN10.LN_SEQ
	