USE CDW;
GO

DECLARE @ACCT TABLE (AN VARCHAR(XX));

INSERT INTO @ACCT(AN)
VALUES
	('XXXXXXXXXX'),
	('XXXXXXXXXX'),
	('XXXXXXXXXX'),
	('XXXXXXXXXX'),
	('XXXXXXXXXX'),
	('XXXXXXXXXX'),
	('XXXXXXXXXX'),
	('XXXXXXXXXX'),
	('XXXXXXXXXX'),
	('XXXXXXXXXX'),
	('XXXXXXXXXX'),
	('XXXXXXXXXX'),
	('XXXXXXXXXX');

--to verify account numbers are valid
--SELECT DISTINCT PDXX.DF_SPE_ACC_ID FROM @ACCT ACCT INNER JOIN PDXX_PRS_NME PDXX ON ACCT.AN = PDXX.DF_SPE_ACC_ID ORDER BY PDXX.DF_SPE_ACC_ID;

SELECT PDXX.DF_SPE_ACC_ID, RSXX.* FROM @ACCT ACCT INNER JOIN PDXX_PRS_NME PDXX ON ACCT.AN = PDXX.DF_SPE_ACC_ID LEFT JOIN RSXX_IBR_RPS RSXX ON PDXX.DF_PRS_ID = RSXX.BF_SSN ORDER BY PDXX.DF_SPE_ACC_ID;
SELECT PDXX.DF_SPE_ACC_ID, RSXX.* FROM @ACCT ACCT INNER JOIN PDXX_PRS_NME PDXX ON ACCT.AN = PDXX.DF_SPE_ACC_ID LEFT JOIN RSXX_BR_RPD RSXX ON PDXX.DF_PRS_ID = RSXX.BF_SSN ORDER BY PDXX.DF_SPE_ACC_ID;
SELECT PDXX.DF_SPE_ACC_ID, RSXX.* FROM @ACCT ACCT INNER JOIN PDXX_PRS_NME PDXX ON ACCT.AN = PDXX.DF_SPE_ACC_ID LEFT JOIN RSXX_IBR_IRL_LON RSXX ON PDXX.DF_PRS_ID = RSXX.BF_SSN ORDER BY PDXX.DF_SPE_ACC_ID;
SELECT PDXX.DF_SPE_ACC_ID, LNXX.* FROM @ACCT ACCT INNER JOIN PDXX_PRS_NME PDXX ON ACCT.AN = PDXX.DF_SPE_ACC_ID LEFT JOIN LNXX_LON_RPS LNXX	 ON PDXX.DF_PRS_ID = LNXX.BF_SSN ORDER BY PDXX.DF_SPE_ACC_ID;
SELECT PDXX.DF_SPE_ACC_ID, LNXX.* FROM @ACCT ACCT INNER JOIN PDXX_PRS_NME PDXX ON ACCT.AN = PDXX.DF_SPE_ACC_ID LEFT JOIN LNXX_RPD_PIO_CVN LNXX ON PDXX.DF_PRS_ID = LNXX.BF_SSN ORDER BY PDXX.DF_SPE_ACC_ID;
