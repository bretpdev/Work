

BEGIN TRANSACTION
	DECLARE @ERROR INT = 0
	DECLARE @ROWCOUNT INT = 0

	--delete row
	DELETE FROM BSYS..MABC_SSN_User_XRef WHERE RangeID = 7
	SELECT @ROWCOUNT = @@ROWCOUNT, @ERROR = @@ERROR

	--update range IDs
	UPDATE BSYS..MABC_SSN_User_XRef SET RangeID =  7 WHERE UserID = 'UT01602'
	SELECT @ROWCOUNT = @ROWCOUNT + @@ROWCOUNT, @ERROR = @ERROR + @@ERROR

	UPDATE BSYS..MABC_SSN_User_XRef SET RangeID =  8 WHERE UserID = 'UT01641'
	SELECT @ROWCOUNT = @ROWCOUNT + @@ROWCOUNT, @ERROR = @ERROR + @@ERROR

	UPDATE BSYS..MABC_SSN_User_XRef SET RangeID =  9 WHERE UserID = 'UT02442'
	SELECT @ROWCOUNT = @ROWCOUNT + @@ROWCOUNT, @ERROR = @ERROR + @@ERROR

	UPDATE BSYS..MABC_SSN_User_XRef SET RangeID = 10 WHERE UserID = 'UT02443'
	SELECT @ROWCOUNT = @ROWCOUNT + @@ROWCOUNT, @ERROR = @ERROR + @@ERROR


	-- update range begin and end
	UPDATE BSYS..MABC_SSN_User_XRef SET SSNRangeBegin =  0, SSNRangeEnd = 10 WHERE RangeID = 1
	SELECT @ROWCOUNT = @ROWCOUNT + @@ROWCOUNT, @ERROR = @ERROR + @@ERROR

	UPDATE BSYS..MABC_SSN_User_XRef SET SSNRangeBegin = 11, SSNRangeEnd = 20 WHERE RangeID = 2
	SELECT @ROWCOUNT = @ROWCOUNT + @@ROWCOUNT, @ERROR = @ERROR + @@ERROR

	UPDATE BSYS..MABC_SSN_User_XRef SET SSNRangeBegin = 21, SSNRangeEnd = 30 WHERE RangeID = 3
	SELECT @ROWCOUNT = @ROWCOUNT + @@ROWCOUNT, @ERROR = @ERROR + @@ERROR

	UPDATE BSYS..MABC_SSN_User_XRef SET SSNRangeBegin = 31, SSNRangeEnd = 40 WHERE RangeID = 4
	SELECT @ROWCOUNT = @ROWCOUNT + @@ROWCOUNT, @ERROR = @ERROR + @@ERROR

	UPDATE BSYS..MABC_SSN_User_XRef SET SSNRangeBegin = 41, SSNRangeEnd = 50 WHERE RangeID = 5
	SELECT @ROWCOUNT = @ROWCOUNT + @@ROWCOUNT, @ERROR = @ERROR + @@ERROR

	UPDATE BSYS..MABC_SSN_User_XRef SET SSNRangeBegin = 51, SSNRangeEnd = 60 WHERE RangeID = 6
	SELECT @ROWCOUNT = @ROWCOUNT + @@ROWCOUNT, @ERROR = @ERROR + @@ERROR

	UPDATE BSYS..MABC_SSN_User_XRef SET SSNRangeBegin = 61, SSNRangeEnd = 70 WHERE RangeID = 7
	SELECT @ROWCOUNT = @ROWCOUNT + @@ROWCOUNT, @ERROR = @ERROR + @@ERROR

	UPDATE BSYS..MABC_SSN_User_XRef SET SSNRangeBegin = 71, SSNRangeEnd = 80 WHERE RangeID = 8
	SELECT @ROWCOUNT = @ROWCOUNT + @@ROWCOUNT, @ERROR = @ERROR + @@ERROR

	UPDATE BSYS..MABC_SSN_User_XRef SET SSNRangeBegin = 81, SSNRangeEnd = 90 WHERE RangeID = 9
	SELECT @ROWCOUNT = @ROWCOUNT + @@ROWCOUNT, @ERROR = @ERROR + @@ERROR

	UPDATE BSYS..MABC_SSN_User_XRef SET SSNRangeBegin = 91, SSNRangeEnd = 99 WHERE RangeID = 10
	SELECT @ROWCOUNT = @ROWCOUNT + @@ROWCOUNT, @ERROR = @ERROR + @@ERROR



IF @ROWCOUNT = 15 AND @ERROR = 0
	BEGIN
		PRINT 'Transaction committed'
		COMMIT TRANSACTION
		--ROLLBACK TRANSACTION
	END
ELSE
	BEGIN
		PRINT 'ROWCOUNT:  ' + CAST(@ROWCOUNT as VARCHAR(10))
		PRINT 'ERROR:  ' + CAST(@ERROR as VARCHAR(10))
		PRINT '!!!  Transaction NOT committed.  Contact a member of Application Development to have this error corrected.'
		ROLLBACK TRANSACTION
	END