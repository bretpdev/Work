/*%LET RPTLIB = %SYSGET(reportdir);*/
%LET RPTLIB = T:\SAS;

LIBNAME  DUSTER  REMOTE  SERVER=DUSTER  SLIBREF=WORK;
RSUBMIT;

PROC SQL;
CONNECT TO DB2 (DATABASE=DLGSUTWH);
CREATE TABLE DEMO AS
SELECT *
FROM CONNECTION TO DB2 (
	SELECT DISTINCT
				MR01.BF_SSN,
				MR01.LN_SEQ,
				MR01.IF_BND_ISS

	FROM	
		OLWHRM1.MR01_MGT_RPT_LON MR01
	WHERE 
		MR01.IF_BND_ISS NOT IN ('8802000T','0000STNF') 
		AND MR01.LA_CUR_PRI > 0
		AND MR01.IF_BND_ISS <> ''

FOR READ ONLY WITH UR
);
DISCONNECT FROM DB2;

/*%PUT  SQLXRC= >>> &SQLXRC <<< ||| SQLXMSG= >>> &SQLXMSG >>> ;  ** INCLUDES ERROR MESSAGES TO SAS LOG  ;*/
/*%SQLCHECK;*/
/*QUIT;*/

ENDRSUBMIT;

PROC EXPORT DATA= DUSTER.DEMO 
            OUTFILE= "T:\SAS\NH15762.xlsx" 
            DBMS=EXCEL REPLACE;
     SHEET="Sheet1"; 
RUN;
