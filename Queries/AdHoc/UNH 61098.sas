*import data sets from text files;
DATA S1;
	INFILE "Q:\Support Services\JR\UNH 61098\SCRA_4_0_UTLWD42.LWD42R2.20171003";
	INPUT 
		SSN $ 1-9
		DOB 10-17
		LAST_NAME $ 18-43
		FIRST_NAME $ 44-63
		CUSTOMER_RECORD_ID $ 64-91
		ACTIVE_DUTY_STATUS_DATE 92-99  
		BLANK $ 100
		ACTIVE_DUTY_ON_ADS_DATE $ 101
		LEFT_ACTIVE_DUTY_LE367_DAYS $ 102
		NOTIFIED_OF_ACTIVE_DUTY_RECALL $ 103
		ACTIVE_DUTY_END_DT 104-111 /*unformatted*/
		MATCH_RESULT_CODE 112
		ERROR 113
		DATE_OF_MATCH 114-121
		ACTIVE_DUTY_BEGIN_DT 122-129 /*unformatted*/
		EID_BEGIN_DT 130-137 /*unformatted*/
		EID_END_DT 138-145 /*unformatted*/
		SERVICE_COMPONENT $ 146-147
		EID_SERVICE_COMPONENT $ 148-149
		MIDDLE_NAME $ 150-169
		CERTIFICATE_ID $ 170-184
	;
RUN;

DATA S2;
	INFILE "Q:\Support Services\JR\UNH 61098\SCRA_4_4_UTLWD42LWD42R2.txt";
	INPUT 
		SSN $ 1-9
		DOB 10-17
		LAST_NAME $ 18-43
		FIRST_NAME $ 44-63
		CUSTOMER_RECORD_ID $ 64-91
		ACTIVE_DUTY_STATUS_DATE 92-99  
		BLANK $ 100
		ACTIVE_DUTY_ON_ADS_DATE $ 101
		LEFT_ACTIVE_DUTY_LE367_DAYS $ 102
		NOTIFIED_OF_ACTIVE_DUTY_RECALL $ 103
		ACTIVE_DUTY_END_DT 104-111 /*unformatted*/
		MATCH_RESULT_CODE 112
		ERROR 113
		DATE_OF_MATCH 114-121
		ACTIVE_DUTY_BEGIN_DT 122-129 /*unformatted*/
		EID_BEGIN_DT 130-137 /*unformatted*/
		EID_END_DT 138-145 /*unformatted*/
		SERVICE_COMPONENT $ 146-147
		EID_SERVICE_COMPONENT $ 148-149
		MIDDLE_NAME $ 150-169
		CERTIFICATE_ID $ 170-184
	;
RUN;

DATA S3;
	INFILE "Q:\Support Services\JR\UNH 61098\SCRA_4_4_UTLWD42R2.txt";
	INPUT 
		SSN $ 1-9
		DOB 10-17
		LAST_NAME $ 18-43
		FIRST_NAME $ 44-63
		CUSTOMER_RECORD_ID $ 64-91
		ACTIVE_DUTY_STATUS_DATE 92-99  
		BLANK $ 100
		ACTIVE_DUTY_ON_ADS_DATE $ 101
		LEFT_ACTIVE_DUTY_LE367_DAYS $ 102
		NOTIFIED_OF_ACTIVE_DUTY_RECALL $ 103
		ACTIVE_DUTY_END_DT 104-111 /*unformatted*/
		MATCH_RESULT_CODE 112
		ERROR 113
		DATE_OF_MATCH 114-121
		ACTIVE_DUTY_BEGIN_DT 122-129 /*unformatted*/
		EID_BEGIN_DT 130-137 /*unformatted*/
		EID_END_DT 138-145 /*unformatted*/
		SERVICE_COMPONENT $ 146-147
		EID_SERVICE_COMPONENT $ 148-149
		MIDDLE_NAME $ 150-169
		CERTIFICATE_ID $ 170-184
	;
RUN;

DATA S4;
	INFILE "Q:\Support Services\JR\UNH 61098\SCRA_4_5_UTLWD42LWD42R2.txt";
	INPUT 
		SSN $ 1-9
		DOB 10-17
		LAST_NAME $ 18-43
		FIRST_NAME $ 44-63
		CUSTOMER_RECORD_ID $ 64-91
		ACTIVE_DUTY_STATUS_DATE 92-99  
		BLANK $ 100
		ACTIVE_DUTY_ON_ADS_DATE $ 101
		LEFT_ACTIVE_DUTY_LE367_DAYS $ 102
		NOTIFIED_OF_ACTIVE_DUTY_RECALL $ 103
		ACTIVE_DUTY_END_DT 104-111 /*unformatted*/
		MATCH_RESULT_CODE 112
		ERROR 113
		DATE_OF_MATCH 114-121
		ACTIVE_DUTY_BEGIN_DT 122-129 /*unformatted*/
		EID_BEGIN_DT 130-137 /*unformatted*/
		EID_END_DT 138-145 /*unformatted*/
		SERVICE_COMPONENT $ 146-147
		EID_SERVICE_COMPONENT $ 148-149
		MIDDLE_NAME $ 150-169
		CERTIFICATE_ID $ 170-184
	;
RUN;

DATA S5;
	INFILE "Q:\Support Services\JR\UNH 61098\SCRA_4_5_UTLWD42R2 (Aug).txt";
	INPUT 
		SSN $ 1-9
		DOB 10-17
		LAST_NAME $ 18-43
		FIRST_NAME $ 44-63
		CUSTOMER_RECORD_ID $ 64-91
		ACTIVE_DUTY_STATUS_DATE 92-99  
		BLANK $ 100
		ACTIVE_DUTY_ON_ADS_DATE $ 101
		LEFT_ACTIVE_DUTY_LE367_DAYS $ 102
		NOTIFIED_OF_ACTIVE_DUTY_RECALL $ 103
		ACTIVE_DUTY_END_DT 104-111 /*unformatted*/
		MATCH_RESULT_CODE 112
		ERROR 113
		DATE_OF_MATCH 114-121
		ACTIVE_DUTY_BEGIN_DT 122-129 /*unformatted*/
		EID_BEGIN_DT 130-137 /*unformatted*/
		EID_END_DT 138-145 /*unformatted*/
		SERVICE_COMPONENT $ 146-147
		EID_SERVICE_COMPONENT $ 148-149
		MIDDLE_NAME $ 150-169
		CERTIFICATE_ID $ 170-184
	;
RUN;

DATA S6;
	INFILE "Q:\Support Services\JR\UNH 61098\SCRA_4_5_UTLWD42R2.txt";
	INPUT 
		SSN $ 1-9
		DOB 10-17
		LAST_NAME $ 18-43
		FIRST_NAME $ 44-63
		CUSTOMER_RECORD_ID $ 64-91
		ACTIVE_DUTY_STATUS_DATE 92-99  
		BLANK $ 100
		ACTIVE_DUTY_ON_ADS_DATE $ 101
		LEFT_ACTIVE_DUTY_LE367_DAYS $ 102
		NOTIFIED_OF_ACTIVE_DUTY_RECALL $ 103
		ACTIVE_DUTY_END_DT 104-111 /*unformatted*/
		MATCH_RESULT_CODE 112
		ERROR 113
		DATE_OF_MATCH 114-121
		ACTIVE_DUTY_BEGIN_DT 122-129 /*unformatted*/
		EID_BEGIN_DT 130-137 /*unformatted*/
		EID_END_DT 138-145 /*unformatted*/
		SERVICE_COMPONENT $ 146-147
		EID_SERVICE_COMPONENT $ 148-149
		MIDDLE_NAME $ 150-169
		CERTIFICATE_ID $ 170-184
	;
RUN;

DATA S7;
	INFILE "Q:\Support Services\JR\UNH 61098\SCRA_4_8_UTLWD42R2.9-7-18.txt";
	INPUT 
		SSN $ 1-9
		DOB 10-17
		LAST_NAME $ 18-43
		FIRST_NAME $ 44-63
		CUSTOMER_RECORD_ID $ 64-91
		ACTIVE_DUTY_STATUS_DATE 92-99  
		BLANK $ 100
		ACTIVE_DUTY_ON_ADS_DATE $ 101
		LEFT_ACTIVE_DUTY_LE367_DAYS $ 102
		NOTIFIED_OF_ACTIVE_DUTY_RECALL $ 103
		ACTIVE_DUTY_END_DT 104-111 /*unformatted*/
		MATCH_RESULT_CODE 112
		ERROR 113
		DATE_OF_MATCH 114-121
		ACTIVE_DUTY_BEGIN_DT 122-129 /*unformatted*/
		EID_BEGIN_DT 130-137 /*unformatted*/
		EID_END_DT 138-145 /*unformatted*/
		SERVICE_COMPONENT $ 146-147
		EID_SERVICE_COMPONENT $ 148-149
		MIDDLE_NAME $ 150-169
		CERTIFICATE_ID $ 170-184
	;
RUN;

DATA ALL;
	SET S1 S2 S3 S4 S5 S6 S7
;RUN;

DATA SCRA;
	SET ALL;
	WHERE ACTIVE_DUTY_ON_ADS_DATE ^= 'N'
	OR LEFT_ACTIVE_DUTY_LE367_DAYS ^= 'N'
	OR NOTIFIED_OF_ACTIVE_DUTY_RECALL ^= 'N'
;RUN;

PROC SORT DATA=SCRA OUT=SCRA;
	BY SSN;
RUN;

PROC EXPORT
	DATA=SCRA
	OUTFILE="Q:\Support Services\JR\UNH 61098\UNH 61098.xlsx"
	DBMS = EXCEL
	REPLACE;
	SHEET="SCRA_files";
RUN;
