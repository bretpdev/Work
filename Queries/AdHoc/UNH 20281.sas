LIBNAME DUSTER REMOTE SERVER=DUSTER SLIBREF=WORK;
RSUBMIT;
LIBNAME OLWHRM1 DB2 DATABASE=DLGSUTWH OWNER=OLWHRM1;

PROC SQL;
	CREATE TABLE EAGLE AS
		SELECT
			CATX(' ',PD01.DM_PRS_1,PD01.DM_PRS_LST) AS NAME,
			GA01.DF_PRS_ID_BR AS SSN,
			PD01.DF_SPE_ACC_ID AS ACCOUNT_NUMBER,
			CATX('',GA10.AF_APL_ID,GA10.AF_APL_ID_SFX) AS CLUID,
			GA10.AD_PRC AS GUARANTY_DATE
		FROM
			OLWHRM1.PD01_PDM_INF PD01
			JOIN OLWHRM1.GA01_APP GA01
				ON PD01.DF_PRS_ID = GA01.DF_PRS_ID_BR
				AND SUBSTR(GA01.AF_APL_OPS_SCL,1,6) IN ('021785')
			JOIN OLWHRM1.GA10_LON_APP GA10
				ON GA01.AF_APL_ID = GA10.AF_APL_ID
				AND GA10.AD_PRC BETWEEN '01JAN2009'D AND '31DEC2010'D
				AND GA10.AC_PRC_STA = 'A'
	;

	CREATE TABLE STEVENS AS
		SELECT
			CATX(' ',PD01.DM_PRS_1,PD01.DM_PRS_LST) AS NAME,
			GA01.DF_PRS_ID_BR AS SSN,
			PD01.DF_SPE_ACC_ID AS ACCOUNT_NUMBER,
			CATX('',GA10.AF_APL_ID,GA10.AF_APL_ID_SFX) AS CLUID,
			GA10.AD_PRC AS GUARANTY_DATE
		FROM
			OLWHRM1.PD01_PDM_INF PD01
			JOIN OLWHRM1.GA01_APP GA01
				ON PD01.DF_PRS_ID = GA01.DF_PRS_ID_BR
				AND SUBSTR(GA01.AF_APL_OPS_SCL,1,6) IN ('003674')
			JOIN OLWHRM1.GA10_LON_APP GA10
				ON GA01.AF_APL_ID = GA10.AF_APL_ID
				AND GA10.AD_PRC BETWEEN '01JAN2009'D AND '31DEC2010'D
				AND GA10.AC_PRC_STA = 'A'
	;

QUIT;
ENDRSUBMIT;

DATA EAGLE; SET DUSTER.EAGLE; RUN;
DATA STEVENS; SET DUSTER.STEVENS; RUN;

PROC EXPORT
		DATA=EAGLE
		OUTFILE='T:\SAS\EAGLE GATE.XLSX'
		REPLACE;
RUN;

PROC EXPORT
		DATA=STEVENS
		OUTFILE='T:\SAS\STEVENS HENAGER.XLSX'
		REPLACE;
RUN;
