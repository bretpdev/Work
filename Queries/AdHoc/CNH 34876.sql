SELECT DISTINCT Data.DF_SPE_ACC_ID AS IDRBorrowers,
	CASE WHEN Data.PaymentAmount = X THEN X ELSE X END AS ZeroDollarPaymentBorrowers
FROM
(
	SELECT DISTINCT
		PDXX.DF_SPE_ACC_ID,
		SUM(RS.LA_RPS_ISL) AS PaymentAmount
	FROM
		CDW..PDXX_PRS_NME PDXX
		INNER JOIN CDW..LNXX_LON LNXX
			ON LNXX.BF_SSN = PDXX.DF_PRS_ID
		INNER JOIN CDW.calc.RepaymentSchedules RS
			ON RS.BF_SSN = LNXX.BF_SSN
			AND RS.LN_SEQ = LNXX.LN_SEQ
			AND RS.CurrentGradation = X
			AND RS.LC_TYP_SCH_DIS IN('CA', 'CX', 'CX', 'CX', 'IB', 'IX', 'IX', 'IS')
	WHERE
		LNXX.LA_CUR_PRI > X
		AND LNXX.LC_STA_LONXX = 'R'
	GROUP BY
		PDXX.DF_SPE_ACC_ID
) Data
