select POP.*, S.DocId from openquery(legend,
'
SELECT
	AYXX.BF_SSN,
	AYXX.PF_REQ_ACT,
	AYXX.LD_ATY_REQ_RCV
FROM
	PKUB.AYXX_BR_LON_ATY AYXX
WHERE
	PF_REQ_ACT IN (''DIXRD'',''DIAAA'',
''IBADI'',''DIATY'',''DIBCR'',''DIBKP'',
''DIBNK'',''CRBOB'',''DIBRP'',''DICHG'',
''DICNS'',''DICSK'',''DISPC'',''DIDDA'',
''DIDDB'',''DIDDC'',''DIDDE'',''DIDED'',
''DIDEM'',''DIDFR'',''DIDIM'',''DIDIS'',
''DIDLT'',''DIDRJ'',''DIDTH'',''DIENR'',
''DIFAX'',''DIFCR'',''DIFRB'',''IBRDF'',
''DRICR'',''IDRPR'',''DIINC'',''DIINV'',
''DIKEY'',''DILCD'',''DILIB'',''DILVC'',
''DIMIL'',''CROEC'',''DIPSF'',''DIREQ'',
''RPSFM'',''DISXX'',''DISCR'',''DISFD'',
''DISLL'',''DISLT'',''DISMV'',''DISPD'',
''DISPO'',''DISRF'',''DISSL'',''DISSN'',
''DITAX'',''DITLF'',''DITPD'',''DIUPR'')
AND AYXX.LD_ATY_REQ_RCV BETWEEN ''XX/XX/XXXX'' AND ''XX/XX/XXXX''
AND AYXX.LD_ATY_RSP IS NOT NULL
')POP
LEFT JOIN CLS..SheetX S
	ON POP.PF_REQ_ACT = S.Arc