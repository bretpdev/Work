SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
SELECT
	LNXX.BF_SSN,
	LNXX.LN_SEQ,
	FBXX.LD_FOR_REQ_BEG AS RequestedBegin,
	LNXX.LD_FOR_BEG AS ActualBegin,
	FBXX.LD_FOR_BR_REQ_END AS RequestedEnd,
	LNXX.LD_FOR_END AS ActualEnd,
	LNXX.LD_FOR_APL AS AppliedDate
FROM
	CDW..FBXX_BR_FOR_REQ FBXX
	INNER JOIN CDW..LNXX_BR_FOR_APV LNXX
		ON FBXX.BF_SSN = LNXX.BF_SSN
		AND FBXX.LF_FOR_CTL_NUM = LNXX.LF_FOR_CTL_NUM
WHERE
	FBXX.LC_FOR_STA = 'A'
	AND FBXX.LC_STA_FORXX = 'A'
	AND FBXX.LC_FOR_TYP = 'XX'
	AND LNXX.LC_STA_LONXX = 'A'
	AND LNXX.LC_FOR_RSP != 'XXX' --Exclude denials
	AND
	(
		(
			MONTH(FBXX.LD_FOR_REQ_BEG) IN(X,X)
			AND YEAR(FBXX.LD_FOR_REQ_BEG) = XXXX
		)
		OR
		(
			MONTH(FBXX.LD_FOR_REQ_BEG) IN(X,X)
			AND YEAR(FBXX.LD_FOR_REQ_BEG) = XXXX
		)
	)
ORDER BY
	YEAR(FBXX.LD_FOR_REQ_BEG),
	MONTH(FBXX.LD_FOR_REQ_BEG),
	DAY(FBXX.LD_FOR_REQ_BEG),
	LNXX.BF_SSN,
	LNXX.LN_SEQ


SELECT DISTINCT
	LNXX.BF_SSN,
	LNXX.LN_SEQ,
	FBXX.LD_FOR_REQ_BEG AS RequestedBegin,
	LNXX.LD_FOR_BEG AS ActualBegin,
	FBXX.LD_FOR_BR_REQ_END AS RequestedEnd,
	LNXX.LD_FOR_END AS ActualEnd,
	LNXX.LD_FOR_APL AS AppliedDate
FROM
	CDW..FBXX_BR_FOR_REQ FBXX
	INNER JOIN CDW..LNXX_BR_FOR_APV LNXX
		ON FBXX.BF_SSN = LNXX.BF_SSN
		AND FBXX.LF_FOR_CTL_NUM = LNXX.LF_FOR_CTL_NUM
	INNER JOIN CDW..PDXX_PRS_NME PDXX
		ON PDXX.DF_PRS_ID = LNXX.BF_SSN
	INNER JOIN CLS.dasforbfed.ProcessQueue PQ
		ON PQ.AccountNumber = PDXX.DF_SPE_ACC_ID
		AND PQ.ForbearanceAddedOn >= 'XXXX-XX-XX'
		AND LNXX.LD_FOR_APL >= PQ.ForbearanceAddedOn
WHERE
	FBXX.LC_FOR_STA = 'A'
	AND FBXX.LC_STA_FORXX = 'A'
	AND FBXX.LC_FOR_TYP = 'XX'
	AND LNXX.LC_STA_LONXX = 'A'
	AND LNXX.LC_FOR_RSP != 'XXX' --Exclude denials
ORDER BY
	FBXX.LD_FOR_REQ_BEG,
	LNXX.BF_SSN,
	LNXX.LN_SEQ