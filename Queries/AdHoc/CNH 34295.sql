SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
GO

USE CDW
GO

SELECT DISTINCT
	 PDXX.DF_SPE_ACC_ID
	--,RFXX.BF_SSN
	,PDXX.DF_PRS_ID
	,PDXX.DF_ZIP_CDE
	,PDXX.DC_DOM_ST
	,PDXX.DI_VLD_ADR
FROM
	PDXX_PRS_ADR PDXX
	LEFT JOIN PDXX_PRS_NME PDXX
		ON PDXX.DF_PRS_ID = PDXX.DF_PRS_ID
	--LEFT JOIN RFXX_RFR RFXX
	--	ON PDXX.DF_PRS_ID = RFXX.BF_RFR
WHERE
	PDXX.DC_DOM_ST = 'PR'
	AND PDXX.DI_VLD_ADR = 'Y'
	AND (PDXX.DF_ZIP_CDE NOT BETWEEN 'XXXXX' AND 'XXXXX')
	AND (PDXX.DF_ZIP_CDE NOT BETWEEN 'XXXXX' AND 'XXXXX')
ORDER BY
	PDXX.DF_SPE_ACC_ID DESC
	,PDXX.DF_ZIP_CDE
	
	



----DELINQUENT
--SELECT DISTINCT
--	LNXX.BF_SSN
--	,LNXX.LC_STA_LONXX
--	,DWXX.WC_DW_LON_STA
--	,PDXX.DC_DOM_ST
--	,LNXX.LN_DLQ_MAX
--	,LNXX.LD_STA_LONXX
--FROM
--	LNXX_LON LNXX
--	INNER JOIN LNXX_LON_DLQ_HST LNXX
--		ON LNXX.BF_SSN = LNXX.BF_SSN
--		AND LNXX.LN_SEQ = LNXX.LN_SEQ
--	INNER JOIN DWXX_DW_CLC_CLU DWXX
--		ON LNXX.BF_SSN = DWXX.BF_SSN
--		AND LNXX.LN_SEQ = DWXX.LN_SEQ
--	INNER JOIN PDXX_PRS_ADR PDXX
--		 ON LNXX.BF_SSN = PDXX.DF_PRS_ID
--WHERE
--	PDXX.DC_DOM_ST = 'PR'
--	AND LNXX.LC_STA_LONXX = 'R'
--	AND DWXX.WC_DW_LON_STA = XX
--	AND LNXX.LN_DLQ_MAX >= XX
--	AND LNXX.LD_STA_LONXX BETWEEN CAST('XXXX-XX-XX' AS DATE) AND CAST('XXXX-XX-XX' AS DATE)
--ORDER BY
--	LNXX.LD_STA_LONXX
--;



----DEFAULT
--SELECT DISTINCT
--	LNXX.BF_SSN
--	,LNXX.PC_FAT_TYP
--	,LNXX.PC_FAT_SUB_TYP
--	,LNXX.LD_STA_LONXX
--	,PDXX.DC_DOM_ST
--FROM
--	LNXX_LON LNXX
--	INNER JOIN LNXX_FIN_ATY LNXX
--		ON LNXX.BF_SSN = LNXX.BF_SSN
--		AND LNXX.LN_SEQ = LNXX.LN_SEQ
--	INNER JOIN PDXX_PRS_ADR PDXX
--		 ON LNXX.BF_SSN = PDXX.DF_PRS_ID
--WHERE
--	PDXX.DC_DOM_ST = 'PR'
--	AND LNXX.PC_FAT_TYP = XX
--	AND LNXX.PC_FAT_SUB_TYP = XX
--	AND LNXX.LD_STA_LONXX >= CAST('XXXX-XX-XX' AS DATE)
--ORDER BY
--	LNXX.LD_STA_LONXX
--;