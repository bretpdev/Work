LIBNAME DUSTER REMOTE SERVER=DUSTER SLIBREF=WORK;
RSUBMIT;
LIBNAME OLWHRM1 DB2 DATABASE=DLGSUTWH OWNER=OLWHRM1;
PROC SQL;
	CREATE TABLE AVGDEBT AS
		SELECT DISTINCT
			LN10.BF_SSN,
			LN10.LN_SEQ,
			LN10.LA_CUR_PRI,
			LN10.LF_LON_CUR_OWN
		FROM
			OLWHRM1.LN10_LON LN10

	;

	CREATE TABLE ALLLNDRS AS
		SELECT DISTINCT
			COUNT(DISTINCT BF_SSN) AS BRWS,
			SUM(LA_CUR_PRI) AS LA_CUR_PRI,
			SUM(LA_CUR_PRI)/COUNT(DISTINCT BF_SSN) AS AVGDEBT
		FROM
			AVGDEBT
		WHERE 
			LF_LON_CUR_OWN IN ('826717','830248','828476')
	;

	CREATE TABLE WYLNDRS AS
		SELECT DISTINCT
			COUNT(DISTINCT BF_SSN) AS BRWS,
			SUM(LA_CUR_PRI) AS LA_CUR_PRI,
			SUM(LA_CUR_PRI)/COUNT(DISTINCT BF_SSN) AS AVGDEBT
		FROM
			AVGDEBT
		WHERE 
			LF_LON_CUR_OWN IN ('826717','830248')
	;

	CREATE TABLE UTLNDRS AS
		SELECT DISTINCT
			COUNT(DISTINCT BF_SSN) AS BRWS,
			SUM(LA_CUR_PRI) AS LA_CUR_PRI,
			SUM(LA_CUR_PRI)/COUNT(DISTINCT BF_SSN) AS AVGDEBT
		FROM
			AVGDEBT
		WHERE 
			LF_LON_CUR_OWN IN ('828476')
	;
QUIT;
ENDRSUBMIT;

DATA ALLLNDRS; SET DUSTER.ALLLNDRS; RUN;
DATA WYLNDRS; SET DUSTER.WYLNDRS; RUN;
DATA UTLNDRS; SET DUSTER.UTLNDRS; RUN;

