DECLARE @DATA TABLE (AWARD_ID VARCHAR(XX))
INSERT INTO @DATA VALUES
('XXXXXXXXXPXXGXXXXXXXX'),
('XXXXXXXXXSXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXPXXGXXXXXXXX'),
('XXXXXXXXXPXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXSXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXPXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXPXXGXXXXXXXX'),
('XXXXXXXXXSXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXPXXGXXXXXXXX'),
('XXXXXXXXXSXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXSXXGXXXXXXXX'),
('XXXXXXXXXSXXGXXXXXXXX'),
('XXXXXXXXXSXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXSXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXSXXGXXXXXXXX'),
('XXXXXXXXXPXXGXXXXXXXX'),
('XXXXXXXXXPXXGXXXXXXXX'),
('XXXXXXXXXPXXGXXXXXXXX'),
('XXXXXXXXXPXXGXXXXXXXX'),
('XXXXXXXXXPXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXPXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXSXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXSXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXSXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXPXXGXXXXXXXX'),
('XXXXXXXXXPXXGXXXXXXXX'),
('XXXXXXXXXPXXGXXXXXXXX'),
('XXXXXXXXXPXXGXXXXXXXX'),
('XXXXXXXXXSXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXPXXGXXXXXXXX'),
('XXXXXXXXXSXXGXXXXXXXX'),
('XXXXXXXXXSXXGXXXXXXXX'),
('XXXXXXXXXSXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXPXXGXXXXXXXX'),
('XXXXXXXXXPXXGXXXXXXXX'),
('XXXXXXXXXSXXGXXXXXXXX'),
('XXXXXXXXXSXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXSXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXSXXGXXXXXXXX'),
('XXXXXXXXXSXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXPXXGXXXXXXXX'),
('XXXXXXXXXPXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXPXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXSXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXPXXGXXXXXXXX'),
('XXXXXXXXXPXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXSXXGXXXXXXXX'),
('XXXXXXXXXSXXGXXXXXXXX'),
('XXXXXXXXXSXXGXXXXXXXX'),
('XXXXXXXXXSXXGXXXXXXXX'),
('XXXXXXXXXSXXGXXXXXXXX'),
('XXXXXXXXXSXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXSXXEXXXXXXXX'),
('XXXXXXXXXUXXEXXXXXXXX'),
('XXXXXXXXXSXXGXXXXXXXX'),
('XXXXXXXXXSXXGXXXXXXXX'),
('XXXXXXXXXSXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXPXXGXXXXXXXX'),
('XXXXXXXXXPXXGXXXXXXXX'),
('XXXXXXXXXPXXEXXXXXXXX'),
('XXXXXXXXXPXXGXXXXXXXX'),
('XXXXXXXXXPXXGXXXXXXXX'),
('XXXXXXXXXPXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXPXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXPXXEXXXXXXXX'),
('XXXXXXXXXSXXGXXXXXXXX'),
('XXXXXXXXXSXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXSXXGXXXXXXXX'),
('XXXXXXXXXSXXGXXXXXXXX'),
('XXXXXXXXXSXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXSXXGXXXXXXXX'),
('XXXXXXXXXSXXGXXXXXXXX'),
('XXXXXXXXXSXXGXXXXXXXX'),
('XXXXXXXXXSXXGXXXXXXXX'),
('XXXXXXXXXSXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXSXXGXXXXXXXX'),
('XXXXXXXXXSXXGXXXXXXXX'),
('XXXXXXXXXSXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXSXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXPXXGXXXXXXXX'),
('XXXXXXXXXPXXGXXXXXXXX'),
('XXXXXXXXXPXXGXXXXXXXX'),
('XXXXXXXXXSXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXSXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXSXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXPXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXPXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXSXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXPXXEXXXXXXXX'),
('XXXXXXXXXPXXEXXXXXXXX'),
('XXXXXXXXXUXXEXXXXXXXX'),
('XXXXXXXXXUXXEXXXXXXXX'),
('XXXXXXXXXSXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXPXXGXXXXXXXX'),
('XXXXXXXXXPXXGXXXXXXXX'),
('XXXXXXXXXSXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXSXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXSXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXSXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXPXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXSXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXSXXGXXXXXXXX'),
('XXXXXXXXXSXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX'),
('XXXXXXXXXUXXGXXXXXXXX')




SELECT DISTINCT
	FSXX.BF_SSN,
	D.AWARD_ID,
	CASE WHEN AYXX.BF_SSN IS NOT NULL THEN 'Y' ELSE 'N' END AS HAS_CVDOO_ARC,
	LKXX.PX_DSC_MDM AS LOAN_STATUS,
	ISNULL(FORB.PX_DSC_LNG,'') AS FORBEARANCE_TYPE,
	ISNULL(CONVERT(VARCHAR, FORB.LD_FOR_BEG,XXX),'') AS FORBEARANCE_BEGIN,
	ISNULL(CONVERT(VARCHAR,FORB.LD_FOR_END,XXX),'') AS FORBEARANCE_END,
	ISNULL(DEF.PX_DSC_LNG,'') AS DEFERMENT_TYPE,
	ISNULL(CONVERT(VARCHAR,DEF.LD_DFR_BEG,XXX),'') AS DEFERMENT_BEGIN,
	ISNULL(CONVERT(VARCHAR,DEF.LD_DFR_END,XXX),'') AS DEFERMENT_END

FROM
	@DATA D
	INNER JOIN CDW..FSXX_DL_LON FSXX
		ON (FSXX.LF_FED_AWD + RIGHT('XXX' + CAST(LN_FED_AWD_SEQ AS VARCHAR(X)), X)) = D.AWARD_ID
	INNER JOIN CDW..DWXX_DW_CLC_CLU DWXX
		ON DWXX.BF_SSN = FSXX.BF_SSN
		AND DWXX.LN_SEQ = FSXX.LN_SEQ
	INNER JOIN CDW..LKXX_LS_CDE_LKP LKXX
		ON LKXX.PM_ATR = 'WC-DW-LON-STA'
		AND LKXX.PX_ATR_VAL = DWXX.WC_DW_LON_STA
	LEFT JOIN CDW..AYXX_BR_LON_ATY AYXX
		ON AYXX.BF_SSN = FSXX.BF_SSN
		AND AYXX.PF_REQ_ACT = 'CVDOO'
		AND AYXX.LC_STA_ACTYXX = 'A'
	LEFT JOIN
	(
		SELECT DISTINCT
			LNXX.BF_SSN,
			LNXX.LN_SEQ,
			LKXX.PX_DSC_LNG,
			LNXX.LD_FOR_BEG,
			LNXX.LD_FOR_END
		FROM
			CDW..FBXX_BR_FOR_REQ FBXX
			INNER JOIN CDW..LNXX_BR_FOR_APV LNXX
				ON LNXX.BF_SSN = FBXX.BF_SSN
				AND LNXX.LF_FOR_CTL_NUM = FBXX.LF_FOR_CTL_NUM
			INNER JOIN CDW..FSXX_DL_LON FSXX
				ON FSXX.BF_SSN = LNXX.BF_SSN
				AND FSXX.LN_SEQ = LNXX.LN_SEQ
			INNER JOIN CDW..LKXX_LS_CDE_LKP LKXX
				ON LKXX.PM_ATR = 'LC-FOR-TYP'
				AND LKXX.PX_ATR_VAL = FBXX.LC_FOR_TYP
			INNER JOIN @DATA D
				ON D.AWARD_ID = (FSXX.LF_FED_AWD + RIGHT('XXX' + CAST(LN_FED_AWD_SEQ AS VARCHAR(X)), X))
		WHERE
			LNXX.LC_STA_LONXX = 'A'
			AND FBXX.LC_STA_FORXX = 'A'
			AND FBXX.LC_FOR_STA = 'A' --denied records cant have this active
			AND LNXX.LC_FOR_RSP != 'XXX'
			AND	CAST(GETDATE() AS DATE) BETWEEN LNXX.LD_FOR_BEG AND LNXX.LD_FOR_END
	) FORB
		ON FORB.BF_SSN = FSXX.BF_SSN
		AND FORB.LN_SEQ = FSXX.LN_SEQ
	LEFT JOIN
	(
		SELECT DISTINCT
			LNXX.BF_SSN,
			LNXX.LN_SEQ,
			LKXX.PX_DSC_LNG,
			LNXX.LD_DFR_BEG,
			LNXX.LD_DFR_END
		FROM
			CDW..DFXX_BR_DFR_REQ DFXX
			INNER JOIN CDW..LNXX_BR_DFR_APV LNXX
				ON LNXX.BF_SSN = DFXX.BF_SSN
				AND LNXX.LF_DFR_CTL_NUM = DFXX.LF_DFR_CTL_NUM
			INNER JOIN CDW..FSXX_DL_LON FSXX
				ON FSXX.BF_SSN = LNXX.BF_SSN
				AND FSXX.LN_SEQ = LNXX.LN_SEQ
			INNER JOIN CDW..LKXX_LS_CDE_LKP LKXX
				ON LKXX.PM_ATR = 'LC-DFR-TYP'
				AND LKXX.PX_ATR_VAL = DFXX.LC_DFR_TYP
			INNER JOIN @DATA D
				ON D.AWARD_ID = (FSXX.LF_FED_AWD + RIGHT('XXX' + CAST(LN_FED_AWD_SEQ AS VARCHAR(X)), X))
		WHERE
			LNXX.LC_STA_LONXX = 'A'
			AND DFXX.LC_STA_DFRXX = 'A'
			AND DFXX.LC_DFR_STA = 'A' --denied records cant have this active
			AND LNXX.LC_DFR_RSP != 'XXX'
			AND	CAST(GETDATE() AS DATE) BETWEEN LNXX.LD_DFR_BEG AND LNXX.LD_DFR_END
	) DEF
		ON DEF.BF_SSN = FSXX.BF_SSN
		AND DEF.LN_SEQ = FSXX.LN_SEQ