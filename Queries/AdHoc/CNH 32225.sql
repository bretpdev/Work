--local table
SELECT 
	[DF_PRS_ID]
	,[DC_PHN]
	,[DT_PHN_BST_CL]
	,[DD_PHN_VER]
	,[DI_PHN_VLD]
	,[DN_PHN_XTN]
	,[DN_DOM_PHN_LCL]
	,[DN_DOM_PHN_XCH]
	,[DN_DOM_PHN_ARA]
	,[DI_PHN_WTS]
	,[DX_PHN_TME_ZNE]
	,[DF_LST_USR_PDXX]
	,[DN_FGN_PHN_INL]
	,[DN_FGN_PHN_CNY]
	,[DN_FGN_PHN_CT]
	,[DN_FGN_PHN_LCL]
	,[DF_LST_DTS_PDXX]
	,[DD_CRT_PDXX]
	,[DC_NO_HME_PHN]
	,[DD_NO_HME_PHN]
	,[DC_PHN_SRC]
	,[DD_ORG_DB_CRT_PDXX]
	,[DI_HST_OLY_PDXX]
	,[DC_ALW_ADL_PHN]  --changed name from Geo_PHN_IND ???
FROM 
	[CDW].[dbo].[PDXX_PRS_PHN]
WHERE
	DF_PRS_ID = 'XXXXXXXXX'

--full listing of all valid consent values in PDXX
SELECT 
	DC_ALW_ADL_PHN
	,COUNT(*) AS TOTAL
FROM
	[CDW].[dbo].[PDXX_PRS_PHN]
GROUP BY 
	DC_ALW_ADL_PHN

--SELECT DF_SPE_ACC_ID, DF_PRS_ID FROM CDW..PDXX_PRS_NME WHERE DF_SPE_ACC_ID = 'XXXXXXXXXX'

--MauiDude info:
SELECT 
	[DF_SPE_ACC_ID]
	,[DC_PHN]
	,[DD_PHN_VER]
	,[DI_PHN_VLD]
	,[DN_DOM_PHN_ARA]
	,[DN_DOM_PHN_XCH]
	,[DN_DOM_PHN_LCL]
	,[DN_PHN_XTN]
	,[DN_FGN_PHN_CNY]
	,[DN_FGN_PHN_CT]
	,[DN_FGN_PHN_LCL]
	,[CONSENT_IND]  --same as Geo_PHN_IND or DC_ALW_ADL ??
	,[LINE_TYP]
FROM 
	[CDW].[dbo].[PDXX_Phone]
WHERE
	DF_SPE_ACC_ID = 'XXXXXXXXXX'

--query portion from SAS UTNWSXX
SELECT * FROM OPENQUERY (LEGEND,'
	SELECT DISTINCT
		PDXX.DF_PRS_ID,
		PDXX.DN_DOM_PHN_ARA || PDXX.DN_DOM_PHN_XCH || PDXX.DN_DOM_PHN_LCL AS PHN,
		PDXX.DC_PHN,
		CASE
			WHEN PDXX.DC_ALW_ADL_PHN IN (''L'',''Q'',''P'') 
				THEN ''Y''
				ELSE ''N''
		END AS DC_ALW_ADL_PHN,
		PDXX.DC_ALW_ADL_PHN AS Consent
	FROM 
		PKUB.PDXX_PRS_PHN PDXX
	WHERE
		DF_PRS_ID = ''XXXXXXXXX''
');