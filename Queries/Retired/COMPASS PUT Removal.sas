*---------------------*
| COMPASS PUT REMOVAL |
*---------------------*;
%LET RPTLIB = T:\SAS;
FILENAME REPORT2 "&RPTLIB/COMPASSPutRemoval.R2.txt";
LIBNAME  WORKLOCL  REMOTE  SERVER=CYPRUS  SLIBREF=WORK;
RSUBMIT;
PROC SQL;
CONNECT TO DB2 (DATABASE=DLGSUTWH);
CREATE TABLE CPR AS
SELECT *
FROM CONNECTION TO DB2 (
SELECT DISTINCT A.AF_APL_ID||A.AF_APL_ID_SFX AS CLUID
FROM OLWHRM1.GA10_LON_APP A
INNER JOIN OLWHRM1.LN10_LON B
	ON A.AF_APL_ID = B.LF_LON_ALT
	AND INT(A.AF_APL_ID_SFX) = B.LN_LON_ALT_SEQ
WHERE A.AD_ECA_PUT_ANT IS NOT NULL
	AND B.LC_STA_LON10 <> 'D'
FOR READ ONLY WITH UR
);
DISCONNECT FROM DB2;
ENDRSUBMIT;
DATA CPR;
	SET WORKLOCL.CPR;
RUN;
DATA _NULL_;
	SET CPR;
	V = '';
	FILE REPORT2 DROPOVER LRECL=32767;
	FORMAT CLUID $19. ;
	FORMAT V $1. ;
	DO;
		PUT @ 1 CLUID
			@ 80 V;
	END;
RUN;
