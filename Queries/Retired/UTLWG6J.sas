OPTIONS
  YEARCUTOFF=1960
  MISSING=' '
  ERRORS=0
  NOCENTER
  LS=80
  PS=60;

%LET RPTLIB=%SYSGET(reportdir);

FILENAME REPORT2 "&RPTLIB/ULWG6J.LWG6JR2";

PROC SQL;
  CONNECT TO DB2 (DATABASE=dlgsutwh);
  CREATE TABLE NLGS AS
    SELECT *
    FROM CONNECTION TO DB2 (
      SELECT
        A.DF_PRS_ID_STU   AS SSNO,
        B.AC_LON_TYP      AS LTYPE,
        A.AF_APL_ID       AS UID,
        B.AF_APL_ID_SFX   AS UIDSEQ,
        A.AF_APL_OPS_SCL  AS OESCODE,
        B.AD_PRC          AS PROC,
        B.AA_GTE_LON_AMT  AS LNAMT
      FROM
        olwhrm1.GA01_APP A
        INNER JOIN olwhrm1.GA10_LON_APP B
          ON A.AF_APL_ID=B.AF_APL_ID
      WHERE
        B.AC_PRC_STA='P'
    );
  DISCONNECT FROM DB2;
  %PUT &SQLXRC& &SQLXMSG&;
QUIT;

PROC SORT
  DATA=NLGS;
  BY OESCODE PROC SSNO;
RUN;

PROC PRINTTO
  NEW PRINT=REPORT2;
RUN;

OPTIONS
  PAGENO=1;

PROC PRINT
  DATA=NLGS
  SPLIT='\'
  UNIFORM
  NOOBS
  N;
  LABEL
    OESCODE='SCHOOL CODE'
    SSNO='STUDENT''S SOC SEC #'
    LTYPE='LOAN TYPE'
    UID='UNIQUE ID#'
    UIDSEQ='UNIQUE ID SEQ#'
    PROC='PROCESSING DATE'
    LNAMT='LOAN AMOUNT';
  VAR OESCODE SSNO LTYPE UID UIDSEQ PROC LNAMT;
  FORMAT PROC MMDDYY10.;
  FORMAT LNAMT DOLLAR7.;
  TITLE 'PROVISIONAL APPROVALS';
  FOOTNOTE 'PJS, JOB=LWG6J, REPORT=LWG6JR2';
RUN;

DATA _NULL_;
  FILE PRINT;
  PUT
  / @1  '***** END OF REPORT *****'
    #59
    @1  'PJS, JOB=LWG6J, REPORT=LWG6JR2';
RUN;

PROC PRINTTO
  PRINT=PRINT;
RUN;
