/*LIBNAME DLGSUTWH DB2 DATABASE=DLGSUTWH OWNER=OLWHRM1;
%LET RPTLIB = %SYSGET(reportdir);
FILENAME REPORT2 "&RPTLIB/ULWAB1.LWAB1R2";*/

LIBNAME  WORKLOCL  REMOTE  SERVER=CYPRUS  SLIBREF=WORK;
RSUBMIT;
PROC SQL;
CONNECT TO DB2 (DATABASE=DLGSUTWH);
CREATE TABLE SINFO AS
SELECT *
FROM CONNECTION TO DB2 (
SELECT DISTINCT
		 A.IM_IST_FUL
		,A.IF_IST
		,A.IC_IST_DPT 
		,A.IC_FRM_OPT
		,A.IC_PLS_FRM_OPT
		,A.IN_CNL_APL_FIL_VRS
	
FROM	OLWHRM1.SC01_LGS_SCL_INF A
WHERE	A.IF_IST IN ('02270800', '02270801', '01147900', '02612200', '00367000',
'00160600', '00162500', '00367600', '00367100', '02178500', '02573100', '02504000', '03108200',
'02556800', '03617300', '02361000', '01017300', '00367200', '02298500', '03082100', '02531800', 
'02531801', '02531802', '02360800', '00522000', '02078800', '00367900', '00367901', '00367800',
'02516100', '00367403', '00367400', '00367401', '00367404', '00367405', '02098805', '00367500',
'03030600', '03030601', '03030603', '03030604', '03030605', '03030606', '00367700', '00402700',
'00368000', '00368100')	

);
DISCONNECT FROM DB2;
ENDRSUBMIT;

DATA SINFO;
SET WORKLOCL.SINFO;
RUN;

DATA SINFO;
SET SINFO;
FORMAT IC_FRM_OPT IC_PLS_FRM_OPT IN_CNL_APL_FIL_VRS ESIGN ;
IF IC_FRM_OPT = 1 THEN IC_FRM_OPT = 'Y';
	ELSE IC_FRM_OPT = 'N';
IF IC_PLS_FRM_OPT = 1 THEN IC_PLS_FRM_OPT = 'Y';
	ELSE IF IC_PLS_FRM_OPT = 4 THEN IC_PLS_FRM_OPT = 'Y';
	ELSE IF IC_PLS_FRM_OPT = 5 THEN IC_PLS_FRM_OPT = 'Y';
	ELSE IC_PLS_FRM_OPT = 'N';
IF IN_CNL_APL_FIL_VRS = '004' THEN IN_CNL_APL_FIL_VRS = 'Y';
	ELSE IN_CNL_APL_FIL_VRS = 'N';
IF  IF_IST = '02531801' THEN IC_IST_DPT = '110';
IF  IF_IST = '03030603' THEN IC_IST_DPT = '110';
IF IM_IST_FUL = 'BRIGHAM YOUNG UNIVERSITY-IDAHO' THEN ESIGN = 'Y';
	ELSE IF IM_IST_FUL = 'UNIVERSITY OF UTAH' THEN ESIGN = 'Y'; 
	ELSE IF IM_IST_FUL = 'SOUTHERN UTAH UNIVERSITY' THEN ESIGN = 'Y';
	ELSE IF IM_IST_FUL = 'DIXIE STATE COLLEGE OF UTAH' THEN ESIGN = 'Y';
	ELSE IF IM_IST_FUL = 'WEBER STATE UNIVERSITY' THEN ESIGN = 'Y';
	ELSE ESIGN = 'N';
RUN;
PROC SQL;
CREATE TABLE SINFO_S AS
SELECT * 
FROM SINFO
WHERE IC_IST_DPT <> '112';
QUIT;
PROC SQL;
CREATE TABLE SINFO_U AS
SELECT * 
FROM SINFO_S
WHERE IC_IST_DPT <> '114';
QUIT;
PROC SORT DATA=SINFO_U;
BY IM_IST_FUL;
RUN;
/*PROC PRINTTO PRINT=REPORT2;
RUN;*/
OPTIONS PAGENO=1 LS=120 NODATE CENTER;
PROC PRINT NOOBS SPLIT='/' DATA=WORK.SINFO_U D;

VAR 	IF_IST
		IM_IST_FUL
		IC_FRM_OPT
		IC_PLS_FRM_OPT
		IN_CNL_APL_FIL_VRS
		ESIGN;
LABEL	IF_IST = 'SCHOOL CODE'
		IM_IST_FUL = 'SCHOOL NAME'
		ESIGN = 'ESIGN'
		IC_FRM_OPT = 'SERIAL STAFFORD'
		IC_PLS_FRM_OPT = 'PLUS MPN'
		IN_CNL_APL_FIL_VRS = 'COMMON LINE';
TITLE	'COMMON LINE, SERIAL STAFFORD, PLUS MPN SCHOOL INFORMATION';
RUN;
