/*UTLWE09 LPP SERVICING DATA FILE FOR FINANCE - MR52 TABLE*/
LIBNAME DLGSUTWH DB2 DATABASE=DLGSUTWH OWNER=OLWHRM1;
%LET RPTLIB = %SYSGET(reportdir);
FILENAME REPORT2 "&RPTLIB/ULWE09.LWE09R2";
/*LIBNAME  WORKLOCL  REMOTE  SERVER=CYPRUS  SLIBREF=WORK;*/
/*RSUBMIT;*/
PROC SQL;
CONNECT TO DB2 (DATABASE=DLGSUTWH);
CREATE TABLE M52TBDAT AS
SELECT *
FROM CONNECTION TO DB2 (
SELECT DISTINCT A.BF_SSN
		,A.LN_SEQ
		,A.LN_BR_DSB_SEQ
		,A.LD_DSB_CAN
		,A.LA_DSB_CAN
		,A.LD_DSB
		,A.LA_DSB
		,A.LC_DSB_TYP
		,A.WX_DSB_TYP
		,A.LC_DSB_CAN_TYP
		,A.WX_DSB_CAN_TYP
		,A.LC_DSB_FEE_1
		,A.WX_DSB_FEE_1
		,A.LA_DSB_FEE_1
		,A.LC_DSB_FEE_2
		,A.WX_DSB_FEE_2
		,A.LA_DSB_FEE_2
		,A.LC_DSB_FEE_3
		,A.WX_DSB_FEE_3
		,A.LA_DSB_FEE_3
		,A.LF_DSB_CHK
		,A.LC_LDR_DSB_MDM
		,A.WX_LDR_DSB_MDM
		,A.WX_POR_RCC_RPT_LN1
		,A.WX_POR_RCC_RPT_LN2
		,A.AF_DSB_RPT
		,A.AF_BND_ISS
		,A.IC_LON_PGM
		,A.IF_GTR
		,A.DM_PRS_1
		,A.DM_PRS_MID
		,A.DM_PRS_LST
		,A.DM_PRS_LST_SFX
		,A.WF_OWN_RSB_ORG_FEE
		,A.WF_BND_ISS_RSB_ORG
		,A.WN_DSB
		,A.WN_DSB_TOT
		,A.WN_CAN
		,A.WN_CAN_TOT
		,A.WX_POR_RCC_RPT_LN3
		,A.WA_DSB_FEE_CAN_1
		,A.WA_DSB_FEE_CAN_2
		,A.WR_ITR_1
		,A.WC_ITR_TYP_1
		,A.LF_CUR_POR
		,A.WC_TYP_SCL_ORG
		,A.WC_ELG_SIN_1
		,A.LC_SCY_PGA_PGM_YR
		,A.LF_DOE_SCL_ORG
		,A.WF_TIR_PCE_MR52
		,A.WI_DSB_ORG
		,A.WD_DSB_CAN_REV
		,A.WA_DSB_CAN_REV
		,A.WA_FEE_CAN_REV_1
		,A.WA_FEE_CAN_REV_2
		,A.WN_CAN_REV
		,A.WN_CAN_REV_TOT
		,A.WX_POR_RCC_RPT_LN4
		,A.LC_DSB_CAN_REA
		,A.WX_DSB_CAN_REA
FROM OLWHRM1.MR52_MR_DSB_MTH A

);
DISCONNECT FROM DB2;
/*ENDRSUBMIT;*/
/*DATA M52TBDAT;*/
/*SET WORKLOCL.M52TBDAT;*/
/*RUN;*/
PROC SORT DATA=M52TBDAT;
BY BF_SSN LN_SEQ;
RUN;
DATA _NULL_;
SET  WORK.M52TBDAT;            
*FILE 'T:\SAS\ULWE09.LWE09R2' DELIMITER=',' DSD DROPOVER LRECL=32767;
FILE REPORT2 DELIMITER=',' DSD DROPOVER LRECL=32767;
FORMAT BF_SSN $9. ;
FORMAT LN_SEQ 6. ;
FORMAT LN_BR_DSB_SEQ 6. ;
FORMAT LD_DSB_CAN YYMMDDD10.;
FORMAT LA_DSB_CAN 10.2 ;
FORMAT LD_DSB YYMMDDD10. ;
FORMAT LA_DSB 10.2 ;
FORMAT LC_DSB_TYP $1. ;
FORMAT WX_DSB_TYP $20. ;
FORMAT LC_DSB_CAN_TYP $1. ;
FORMAT WX_DSB_CAN_TYP $20. ;
FORMAT LC_DSB_FEE_1 $2. ;
FORMAT WX_DSB_FEE_1 $20. ;
FORMAT LA_DSB_FEE_1 9.2 ;
FORMAT LC_DSB_FEE_2 $2. ;
FORMAT WX_DSB_FEE_2 $20. ;
FORMAT LA_DSB_FEE_2 9.2 ;
FORMAT LC_DSB_FEE_3 $2. ;
FORMAT WX_DSB_FEE_3 $20. ;
FORMAT LA_DSB_FEE_3 9.2 ;
FORMAT LF_DSB_CHK $10. ;
FORMAT LC_LDR_DSB_MDM $1. ;
FORMAT WX_LDR_DSB_MDM $20. ;
FORMAT WX_POR_RCC_RPT_LN1 $3. ;
FORMAT WX_POR_RCC_RPT_LN2 $3. ;
FORMAT AF_DSB_RPT $8. ;
FORMAT AF_BND_ISS $8. ;
FORMAT IC_LON_PGM $6. ;
FORMAT IF_GTR $6. ;
FORMAT DM_PRS_1 $13. ;
FORMAT DM_PRS_MID $13. ;
FORMAT DM_PRS_LST $23. ;
FORMAT DM_PRS_LST_SFX $4. ;
FORMAT WF_OWN_RSB_ORG_FEE $8. ;
FORMAT WF_BND_ISS_RSB_ORG $8. ;
FORMAT WN_DSB 4. ;
FORMAT WN_DSB_TOT 4. ;
FORMAT WN_CAN 4. ;
FORMAT WN_CAN_TOT 4. ;
FORMAT WX_POR_RCC_RPT_LN3 $3. ;
FORMAT WA_DSB_FEE_CAN_1 9.2 ;
FORMAT WA_DSB_FEE_CAN_2 9.2 ;
FORMAT WR_ITR_1 7.3 ;
FORMAT WC_ITR_TYP_1 $2. ;
FORMAT LF_CUR_POR $20. ;
FORMAT WC_TYP_SCL_ORG $2. ;
FORMAT WC_ELG_SIN_1 $1. ;
FORMAT LC_SCY_PGA_PGM_YR $1. ;
FORMAT LF_DOE_SCL_ORG $8. ;
FORMAT WF_TIR_PCE_MR52 $3. ;
FORMAT WI_DSB_ORG $1. ;
FORMAT WD_DSB_CAN_REV YYMMDDD10. ;
FORMAT WA_DSB_CAN_REV 10.2 ;
FORMAT WA_FEE_CAN_REV_1 9.2 ;
FORMAT WA_FEE_CAN_REV_2 9.2 ;
FORMAT WN_CAN_REV 4. ;
FORMAT WN_CAN_REV_TOT 4. ;
FORMAT WX_POR_RCC_RPT_LN4 $3. ;
FORMAT LC_DSB_CAN_REA $4. ;
FORMAT WX_DSB_CAN_REA $20. ;
IF _N_ = 1 THEN        /* WRITE COLUMN NAMES */
DO;
PUT
'BF_SSN'
','
'LN_SEQ'
','
'LN_BR_DSB_SEQ'
','
'LD_DSB_CAN'
','
'LA_DSB_CAN'
','
'LD_DSB'
','
'LA_DSB'
','
'LC_DSB_TYP'
','
'WX_DSB_TYP'
','
'LC_DSB_CAN_TYP'
','
'WX_DSB_CAN_TYP'
','
'LC_DSB_FEE_1'
','
'WX_DSB_FEE_1'
','
'LA_DSB_FEE_1'
','
'LC_DSB_FEE_2'
','
'WX_DSB_FEE_2'
','
'LA_DSB_FEE_2'
','
'LC_DSB_FEE_3'
','
'WX_DSB_FEE_3'
','
'LA_DSB_FEE_3'
','
'LF_DSB_CHK'
','
'LC_LDR_DSB_MDM'
','
'WX_LDR_DSB_MDM'
','
'WX_POR_RCC_RPT_LN1'
','
'WX_POR_RCC_RPT_LN2'
','
'AF_DSB_RPT'
','
'AF_BND_ISS'
','
'IC_LON_PGM'
','
'IF_GTR'
','
'DM_PRS_1'
','
'DM_PRS_MID'
','
'DM_PRS_LST'
','
'DM_PRS_LST_SFX'
','
'WF_OWN_RSB_ORG_FEE'
','
'WF_BND_ISS_RSB_ORG'
','
'WN_DSB'
','
'WN_DSB_TOT'
','
'WN_CAN'
','
'WN_CAN_TOT'
','
'WX_POR_RCC_RPT_LN3'
','
'WA_DSB_FEE_CAN_1'
','
'WA_DSB_FEE_CAN_2'
','
'WR_ITR_1'
','
'WC_ITR_TYP_1'
','
'LF_CUR_POR'
','
'WC_TYP_SCL_ORG'
','
'WC_ELG_SIN_1'
','
'LC_SCY_PGA_PGM_YR'
','
'LF_DOE_SCL_ORG'
','
'WF_TIR_PCE_MR52'
','
'WI_DSB_ORG'
','
'WD_DSB_CAN_REV'
','
'WA_DSB_CAN_REV'
','
'WA_FEE_CAN_REV_1'
','
'WA_FEE_CAN_REV_2'
','
'WN_CAN_REV'
','
'WN_CAN_REV_TOT'
','
'WX_POR_RCC_RPT_LN4'
','
'LC_DSB_CAN_REA'
','
'WX_DSB_CAN_REA'
;
END;
DO;
PUT BF_SSN $ @;
PUT LN_SEQ @;
PUT LN_BR_DSB_SEQ @;
PUT LD_DSB_CAN @;
PUT LA_DSB_CAN @;
PUT LD_DSB @;
PUT LA_DSB @;
PUT LC_DSB_TYP $ @;
PUT WX_DSB_TYP $ @;
PUT LC_DSB_CAN_TYP $ @;
PUT WX_DSB_CAN_TYP $ @;
PUT LC_DSB_FEE_1 $ @;
PUT WX_DSB_FEE_1 $ @;
PUT LA_DSB_FEE_1 @;
PUT LC_DSB_FEE_2 $ @;
PUT WX_DSB_FEE_2 $ @;
PUT LA_DSB_FEE_2 @;
PUT LC_DSB_FEE_3 $ @;
PUT WX_DSB_FEE_3 $ @;
PUT LA_DSB_FEE_3 @;
PUT LF_DSB_CHK $ @;
PUT LC_LDR_DSB_MDM $ @;
PUT WX_LDR_DSB_MDM $ @;
PUT WX_POR_RCC_RPT_LN1 $ @;
PUT WX_POR_RCC_RPT_LN2 $ @;
PUT AF_DSB_RPT $ @;
PUT AF_BND_ISS $ @;
PUT IC_LON_PGM $ @;
PUT IF_GTR $ @;
PUT DM_PRS_1 $ @;
PUT DM_PRS_MID $ @;
PUT DM_PRS_LST $ @;
PUT DM_PRS_LST_SFX $ @;
PUT WF_OWN_RSB_ORG_FEE $ @;
PUT WF_BND_ISS_RSB_ORG $ @;
PUT WN_DSB @;
PUT WN_DSB_TOT @;
PUT WN_CAN @;
PUT WN_CAN_TOT @;
PUT WX_POR_RCC_RPT_LN3 $ @;
PUT WA_DSB_FEE_CAN_1 @;
PUT WA_DSB_FEE_CAN_2 @;
PUT WR_ITR_1 @;
PUT WC_ITR_TYP_1 $ @;
PUT LF_CUR_POR $ @;
PUT WC_TYP_SCL_ORG $ @;
PUT WC_ELG_SIN_1 $ @;
PUT LC_SCY_PGA_PGM_YR $ @;
PUT LF_DOE_SCL_ORG $ @;
PUT WF_TIR_PCE_MR52 $ @;
PUT WI_DSB_ORG $ @;
PUT WD_DSB_CAN_REV @;
PUT WA_DSB_CAN_REV @;
PUT WA_FEE_CAN_REV_1 @;
PUT WA_FEE_CAN_REV_2 @;
PUT WN_CAN_REV @;
PUT WN_CAN_REV_TOT @;
PUT WX_POR_RCC_RPT_LN4 $ @;
PUT LC_DSB_CAN_REA $ @;
PUT WX_DSB_CAN_REA $ ;
;
END;
RUN;


