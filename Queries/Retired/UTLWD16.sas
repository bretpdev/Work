/**UTLWD16 WORK TRACKING SHEET ACCOUNT RESOLUTION**/
LIBNAME DLGSUTWH DB2 DATABASE=DLGSUTWH OWNER=OLWHRM1;
%LET RPTLIB = %SYSGET(reportdir);
FILENAME REPORT2 "&RPTLIB/ULWD16.LWD16R2";
FILENAME REPORT3 "&RPTLIB/ULWD16.LWD16R3";

/*LIBNAME  WORKLOCL  REMOTE  SERVER=CYPRUS  SLIBREF=WORK;*/
/*RSUBMIT;*/
PROC SQL;
CONNECT TO DB2 (DATABASE=DLGSUTWH);
CREATE TABLE ARDWTR AS
SELECT *
FROM CONNECTION TO DB2 (
SELECT
	A.BF_LST_USR_AY01	AS USER_ID,
	A.PF_ACT			AS ACTION_CODE,
	RTRIM(B.PX_ACT_DSC)	AS ACTION_CODE_DESCRIPTION,  
	A.BC_ATY_TYP		AS ACTIVITY_TYPE,
	A.BC_ATY_CNC_TYP	AS CONTACT_TYPE, 
	A.DF_PRS_ID			AS SSN,
	A.BD_ATY_PRF		AS DATE,
	A.BX_CMT			AS COMMENTS		
FROM OLWHRM1.AY01_BR_ATY A 
 	INNER JOIN OLWHRM1.AC01_ACT B
ON A.PF_ACT = B.PF_ACT
WHERE A.BF_LST_USR_AY01 IN ('UT00013','UT00123','UT00072') 
AND DAYS(A.BD_ATY_PRF) = DAYS(CURRENT DATE) - 1
);
DISCONNECT FROM DB2;
/*ENDRSUBMIT;*/
/**/
/*DATA ARDWTR;*/
/*SET WORKLOCL.ARDWTR;*/
/*RUN;*/

PROC SORT DATA = ARDWTR;
BY USER_ID DESCENDING ACTION_CODE;
RUN;

OPTIONS PAGENO=1 ORIENTATION=LANDSCAPE;
OPTIONS PS=39 LS=127;

PROC PRINTTO PRINT=REPORT2;
RUN;

PROC PRINT SPLIT='/' DATA=ARDWTR N="TOTAL:  " /*WIDTH=MIN*/;
BY USER_ID;
LABEL 	USER_ID = 'User ID'
		ACTION_CODE = 'Action Code'
		ACTION_CODE_DESCRIPTION = 'Action Code Description'
		ACTIVITY_TYPE = 'Activity Type'
		CONTACT_TYPE = 'Contact Type'
		SSN = 'SNN'
		DATE = 'Date'
		COMMENTS = 'Comments';

VAR USER_ID ACTION_CODE ACTION_CODE_DESCRIPTION ACTIVITY_TYPE CONTACT_TYPE SSN DATE;
FORMAT DATE MMDDYY.;
TITLE	"Account Resolution Daily Work Tracking Report";
FOOTNOTE  'JOB = UTLWD16     REPORT = ULWD16.LWD16R2';
RUN;

OPTIONS PAGENO=1;

PROC PRINTTO PRINT=REPORT3;
RUN;

PROC PRINT SPLIT='/' DATA=ARDWTR N="TOTAL:  " /*WIDTH=MIN*/;
BY USER_ID;
LABEL COMMENTS = 'Comments';
VAR COMMENTS;
FORMAT COMMENTS $122.;
TITLE	"Account Resolution Daily Work Tracking Report";
FOOTNOTE  'JOB = UTLWD16     REPORT = ULWD16.LWD16R3';
RUN;
