*run in DUSTER;
LIBNAME  DUSTER  REMOTE  SERVER=DUSTER  SLIBREF=WORK;
RSUBMIT;
PROC SQL;
	CONNECT TO DB2 (DATABASE=DLGSUTWH);
	CREATE TABLE DUSTER_TABLES AS
		SELECT 
			DT.LIBNAME
			,DT.MEMNAME AS TABLE_NAME
		FROM
			DICTIONARY.TABLES DT
		WHERE
			DBMS_MEMTYPE = 'TABLE'
	;
	DISCONNECT FROM DB2;
QUIT;
ENDRSUBMIT;
PROC EXPORT 
	DATA= DUSTER.DUSTER_TABLES
	OUTFILE= "T:\SAS\Warehouse_Tables.xlsx" 
	DBMS=EXCEL REPLACE;
	SHEET="Duster";
RUN;

***************************************;

*run in LEGEND;
LIBNAME  LEGEND  REMOTE  SERVER=LEGEND  SLIBREF=WORK;
RSUBMIT;
PROC SQL;
	CONNECT TO DB2 (DATABASE=DNFPUTDL);
	CREATE TABLE LEGEND_TABLES AS
	SELECT 
		*
	FROM CONNECTION TO DB2
	(
		SELECT
			TABSCHEMA 
			,TABNAME
		FROM 
			SYSCAT.TABLES
		WHERE
			OWNER = 'UTDLRM1'
			AND OWNERTYPE = 'U'
			AND TABSCHEMA NOT IN ('SYSTOOLS','ASN','IBM_RTMON','INFO','DBAWORK','PKUBCRB')
		;
	);
	DISCONNECT FROM DB2;
QUIT;
ENDRSUBMIT;
PROC EXPORT 
	DATA= LEGEND.LEGEND_TABLES
	OUTFILE= "T:\SAS\Warehouse_Tables.xlsx" 
	DBMS=EXCEL REPLACE;
	SHEET="Legend";
RUN;
