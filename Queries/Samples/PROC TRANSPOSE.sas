/*CONDENSE A LIST THAT CONTAINS MULTIPLE ROWS FOR THE SAME LOAN
BY CREATING NEW VARIABLES ON A SINGLE ROW.
VAR = THE DIFFERENT VALUE ACROSS MULTIPLE ROWS.  NEW VARIABLES WILL BE CREATED 1-99 FOR THESE.
BY = THE CONSTANT VALUES ACROSS MULTIPLE ROWS.
*/


*!!!see utlws01 OR UTLWS06 for a good example with comma-delimited output!!!;

PROC TRANSPOSE DATA=LMERR1 OUT=LMERR2 (DROP=_NAME_ _LABEL_) PREFIX=ERR;
VAR ERR_CD;
BY SSN_BR UID LN_TYP GTY_DT;
RUN;

/*OR*/

DATA DISB; 
SET DISB; 
SORTBY = BF_SSN||LN_SEQ;
RUN;

DATA DISB (DROP=SORTBY);
SET DISB;
BY SORTBY;
RETAIN LN_LON_DSB_SEQ1 LD_DSB1 LA_DSB1 LA_DSB_CAN1 LA_PRE_DSB_CAN1
LN_LON_DSB_SEQ2 LD_DSB2 LA_DSB2 LA_DSB_CAN2 LA_PRE_DSB_CAN2
LN_LON_DSB_SEQ3 LD_DSB3 LA_DSB3 LA_DSB_CAN3 LA_PRE_DSB_CAN3
LN_LON_DSB_SEQ4 LD_DSB4 LA_DSB4 LA_DSB_CAN4 LA_PRE_DSB_CAN4
LN_LON_DSB_SEQ5 LD_DSB5 LA_DSB5 LA_DSB_CAN5 LA_PRE_DSB_CAN5
LN_LON_DSB_SEQ6 LD_DSB6 LA_DSB6 LA_DSB_CAN1 LA_PRE_DSB_CAN6;
IF LN_LON_DSB_SEQ = 1 THEN DO;
	LN_LON_DSB_SEQ1 = LN_LON_DSB_SEQ;
	LD_DSB1 = LD_DSB;
	LA_DSB1 = LA_DSB;
	LA_DSB_CAN1 = LA_DSB_CAN;
	LA_PRE_DSB_CAN1 = LA_PRE_DSB_CAN;
	END;
ELSE IF LN_LON_DSB_SEQ = 2 THEN DO;
	LN_LON_DSB_SEQ2 = LN_LON_DSB_SEQ;
	LD_DSB2 = LD_DSB;
	LA_DSB2 = LA_DSB;
	LA_DSB_CAN2 = LA_DSB_CAN;
	LA_PRE_DSB_CAN2 = LA_PRE_DSB_CAN;
	END;
ELSE IF LN_LON_DSB_SEQ = 3 THEN DO;
	LN_LON_DSB_SEQ3 = LN_LON_DSB_SEQ;
	LD_DSB3 = LD_DSB;
	LA_DSB3 = LA_DSB;
	LA_DSB_CAN3 = LA_DSB_CAN;
	LA_PRE_DSB_CAN3 = LA_PRE_DSB_CAN;
	END;
ELSE IF LN_LON_DSB_SEQ = 4 THEN DO;
	LN_LON_DSB_SEQ4 = LN_LON_DSB_SEQ;
	LD_DSB4 = LD_DSB;
	LA_DSB4 = LA_DSB;
	LA_DSB_CAN4 = LA_DSB_CAN;
	LA_PRE_DSB_CAN4 = LA_PRE_DSB_CAN;
	END;
ELSE IF LN_LON_DSB_SEQ = 5 THEN DO;
	LN_LON_DSB_SEQ5 = LN_LON_DSB_SEQ;
	LD_DSB5 = LD_DSB;
	LA_DSB5 = LA_DSB;
	LA_DSB_CAN5 = LA_DSB_CAN;
	LA_PRE_DSB_CAN5 = LA_PRE_DSB_CAN;
	END;
ELSE IF LN_LON_DSB_SEQ = 6 THEN DO;
	LN_LON_DSB_SEQ6 = LN_LON_DSB_SEQ;
	LD_DSB6 = LD_DSB;
	LA_DSB6 = LA_DSB;
	LA_DSB_CAN6 = LA_DSB_CAN;
	LA_PRE_DSB_CAN6 = LA_PRE_DSB_CAN;
	END;
IF LAST.SORTBY;
RUN;