*-------------------------------*
| Regents' Final Denial Reasons |
*-------------------------------*;
%LET RPTLIB = T:\;
FILENAME REPORT2 "&RPTLIB/RegentsPrintedReport.R2.txt";
FILENAME REPORT3 "&RPTLIB/RegentsFile.R3.txt";

PROC SQL;
CONNECT TO ODBC AS REGENTS (REQUIRED="FILEDSN=X:\PADR\ODBC\Regents.dsn;");
CREATE TABLE RFDR AS
SELECT *
FROM CONNECTION TO REGENTS (
	SELECT . . .


	);
DISCONNECT FROM REGENTS;
QUIT;

PROC PRINTTO PRINT=REPORT2 NEW;
RUN;
OPTIONS ORIENTATION = LANDSCAPE;
OPTIONS PS=39 LS=127;
TITLE "REGENTS' FINAL DENIAL REASONS SUMMARY";
FOOTNOTE   "JOB = REGENTS' FINAL DENIAL REASONS  	 REPORT = R2";
PROC CONTENTS DATA=DEN OUT=EMPTYSET NOPRINT;
DATA _NULL_;
SET EMPTYSET;
FILE PRINT;
IF  NOBS=0 AND _N_ =1 THEN DO;
	PUT // 126*'-';
	PUT      ////
		@51 '**** NO OBSERVATIONS FOUND ****';
	PUT ////
		@57 '-- END OF REPORT --';
	PUT ////////////
		@46 "JOB = REGENTS' FINAL DENIAL REASONS  	 REPORT = R2";
	END;
RETURN;
RUN;
PROC PRINT NOOBS SPLIT='/' DATA=DEN WIDTH=UNIFORM WIDTH=MIN LABEL;
FORMAT STUCT COMMA10.;
VAR Description STUCT;
LABEL Description = 'DENIAL/REASON'
	STUCT = 'NUMBER OF/STUDENTS';
RUN;
PROC PRINTTO;
RUN;
DATA _NULL_;
	SET RFDR;
	FILE REPORT3 DELIMITER=',' DSD DROPOVER LRECL=32767;
	IF _N_ = 1 THEN	DO;
	   PUT "SSID,FirstName,LastName,DenialReason";
	END;
	DO;
	   PUT StateStudentId $ @;
	   PUT FirstName $ @;
	   PUT LastName $ @;
	   PUT Description $ ;
	END;
RUN;
