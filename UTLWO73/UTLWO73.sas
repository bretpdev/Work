*---------------------------------------------------*
| UTLWO73 DATE ENTERED REPAYMENT AFTER DEFAULT DATE |
*---------------------------------------------------*;
/*LIBNAME DLGSUTWH DB2 DATABASE=DLGSUTWH OWNER=OLWHRM1;*/
/*%LET RPTLIB = %SYSGET(reportdir);*/
%LET RPTLIB = T:\SAS;
FILENAME REPORT2 "&RPTLIB/ULWO73.LWO73R2";
FILENAME REPORTZ "&RPTLIB/ULWO73.LWO73RZ";
DATA _NULL_;
	CALL SYMPUT('RUNDATE',PUT(INTNX('DAY',TODAY(),0,'beginning'), MMDDYY10.));
	CALL SYMPUT('RUNTIME',PUT(TIME(), TIME.));
RUN;
LIBNAME  WORKLOCL  REMOTE  SERVER=CYPRUS  SLIBREF=WORK;
RSUBMIT;
%MACRO SQLCHECK (SQLRPT= );
%IF &SQLXRC NE 0 %THEN %DO;
	DATA _NULL_;
    FILE REPORTZ NOTITLES;
    PUT @01 " ********************************************************************* "
      / @01 " ****  THE SQL CODE ABOVE HAS EXPERIENCED AN ERROR.               **** "
      / @01 " ****  THE SAS LOG IN &SQLRPT SHOULD BE REVIEWED.          **** "       
      / @01 " ********************************************************************* "
      / @01 " ****  THE SQL ERROR CODE IS  &SQLXRC  AND THE SQL ERROR MESSAGE  **** "
      / @01 " ****  &SQLXMSG   **** "
      / @01 " ********************************************************************* ";
	RUN;
%END;
%MEND;
PROC SQL;
CONNECT TO DB2 (DATABASE=DLGSUTWH);
CREATE TABLE DERADD AS
SELECT *
FROM CONNECTION TO DB2 (
SELECT DISTINCT B.DF_SPE_ACC_ID
	,A.LD_LDR_POF
	,C.AD_NDS_CLC_ENT_RPD
FROM OLWHRM1.DC01_LON_CLM_INF A
INNER JOIN OLWHRM1.PD01_PDM_INF B
	ON A.BF_SSN = B.DF_PRS_ID
INNER JOIN OLWHRM1.GA15_NDS_ID C
	ON A.AF_APL_ID = C.AF_APL_ID
	AND A.AF_APL_ID_SFX = C.AF_APL_ID_SFX
INNER JOIN OLWHRM1.GA14_LON_STA D
	ON C.AF_APL_ID = D.AF_APL_ID
	AND C.AF_APL_ID_SFX = D.AF_APL_ID_SFX
WHERE A.LC_STA_DC10 = '03'
	AND A.LC_REA_CLM_ASN_DOE = ''
	AND A.LD_CLM_ASN_DOE IS NULL
	AND A.LD_LDR_POF < C.AD_NDS_CLC_ENT_RPD
	AND C.AC_STA_GA15 = 'A'
	AND D.AC_STA_GA14 = 'A'
	AND D.AC_LON_STA_TYP IN ('CP','DN')
	AND D.AC_LON_STA_REA IN ('DB','DF','DQ')
FOR READ ONLY WITH UR
);
DISCONNECT FROM DB2;
/*%PUT  SQLXRC= >>> &SQLXRC <<< ||| SQLXMSG= >>> &SQLXMSG >>>  ;  * INCLUDES ERROR MESSAGES TO SAS LOG  ;*/
/*%SQLCHECK (SQLRPT=ULWO73.LWO73RZ);*/
/*QUIT;*/
ENDRSUBMIT;

DATA DERADD ;
SET WORKLOCL.DERADD;
RUN;

PROC PRINTTO PRINT=REPORT2 NEW;
RUN;
OPTIONS ORIENTATION = LANDSCAPE;
OPTIONS PS=39 LS=127 PAGENO=1 NODATE CENTER;
TITLE 'DATE ENT REPAYMENT AFTER DEFAULT DATE';
TITLE2	"&RUNDATE - &RUNTIME";
FOOTNOTE1  	"This document may contain borrowers' sensitive information that UHEAA has pledged to protect.";
FOOTNOTE2	'Please take appropriate precautions to safeguard this information.';
FOOTNOTE3	;
FOOTNOTE4   'JOB = UTLWO73  	 REPORT = ULWO73.LWO73R2';
PROC CONTENTS DATA=DERADD OUT=EMPTYSET NOPRINT;
DATA _NULL_;
SET EMPTYSET;
FILE PRINT;
IF  NOBS=0 AND _N_ =1 THEN DO;
	PUT // 132*'-';
	PUT      //////
		@51 '**** NO OBSERVATIONS FOUND ****';
	PUT //////
		@57 '-- END OF REPORT --';
	PUT //////////////
		@46 "JOB = UTLWO73  	 REPORT = ULWO73.LWO73R2";
	END;
RETURN;
RUN;
PROC PRINT NOOBS SPLIT='/' DATA=DERADD WIDTH=UNIFORM WIDTH=MIN LABEL;
FORMAT LD_LDR_POF AD_NDS_CLC_ENT_RPD MMDDYY10.;
VAR DF_SPE_ACC_ID LD_LDR_POF AD_NDS_CLC_ENT_RPD;
LABEL DF_SPE_ACC_ID = 'ACCOUNT #'
LD_LDR_POF = 'LENDER PAYOFF DATE'
AD_NDS_CLC_ENT_RPD = 'CALCULATED DATE ENTERED REPAYMENT'
;
RUN;
PROC PRINTTO;
RUN;
