

CREATE PROCEDURE [dbo].[ValidTaskAdd]
	@AccountNumber VARCHAR(10)
AS
	IF EXISTS
	(
		SELECT 
			GA01.DF_PRS_ID_BR
		FROM 
			ODW..GA01_APP GA01 
		INNER JOIN ODW..PD01_PDM_INF PD01 
			ON PD01.DF_PRS_ID = GA01.DF_PRS_ID_BR
		INNER JOIN ODW..GA10_LON_APP GA10 
			ON GA10.AF_APL_ID = GA01.AF_APL_ID
		INNER JOIN ODW..GA14_LON_STA GA14 
			ON GA10.AF_APL_ID = GA14.AF_APL_ID AND GA10.AF_APL_ID_SFX = GA14.AF_APL_ID_SFX
		WHERE
			PD01.DF_SPE_ACC_ID = @AccountNumber
		AND	GA14.AC_LON_STA_TYP Not IN ('AE','PF','PC','PN','CA','AL')
		AND	GA14.AC_STA_GA14 = 'A'
		AND	GA10.AA_CUR_PRI > 0.00
		)
			SELECT 1
		ELSE
			SELECT 0