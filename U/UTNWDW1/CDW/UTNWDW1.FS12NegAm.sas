/*TEST*/
/*%LET TESTMSG = - THIS IS A TEST;
%LET RPTLIB = T:\SAS;
%LET LOGLIB = Y:\Batch\Logs;
%LET CODELIB = Y:\Codebase\SAS\CDW;
%LET ODBCFILE = BSYS_TEST;
%LET DB = CDW_test;
%LET ODBCFILE_CSYS = CSYSTest;*/

/*LIVE*/
%LET TESTMSG = - THIS IS LIVE;
%LET RPTLIB = Z:\Batch\FTP;
%LET LOGLIB = Z:\Batch\Logs;
%LET CODELIB = Z:\Codebase\SAS\CDW;
%LET ODBCFILE = BSYS;
%LET DB = CDW;
%LET ODBCFILE_CSYS = CSYS;

%INCLUDE "&CODELIB\UTNWDW1 CDW DAILY UPDATE.FOLDER AND DATABASE.SAS"  ;
%FILECHECK(38);

DATA FS12(drop=trunc);
	INFILE REPORT38 DSD DLM = ',' FIRSTOBS=1 MISSOVER end = eof LRECL = 32767;
	INPUT 
		DF_SPE_ACC_ID :$10.
		LN_SEQ :6.
		LD_CRT_NEG_AMR_LTR :DATE9.
		LA_PRJ_NEG_AMR_INT :12.2
	;
	%TRUNCAT(38);
RUN;

/*convert SAS date to SQL Server datetime*/
DATA FS12;
	SET FS12;
	LD_CRT_NEG_AMR_LTR = LD_CRT_NEG_AMR_LTR*86400;
RUN;

%COPYERROR;

%ENCHILADA
	(
		FS12,
		FS12_NegAm,
		DF_SPE_ACC_ID
		LN_SEQ
		LD_CRT_NEG_AMR_LTR,
		LA_PRJ_NEG_AMR_INT,
/*		no filter*/
	);

%FINISH(SOURCE=FS12_NegAm);
