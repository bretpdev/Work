/*TEST*/
/*%LET TESTMSG = - THIS IS A TEST;
%LET RPTLIB = T:\SAS;
%LET LOGLIB = Y:\Batch\Logs;
%LET CODELIB = Y:\Codebase\SAS\CDW;
%LET ODBCFILE = BSYS_TEST;
%LET DB = CDW_test;
%LET ODBCFILE_CSYS = CSYSTest;*/

/*LIVE*/
%LET TESTMSG = - THIS IS LIVE;
%LET RPTLIB = Z:\Batch\FTP;
%LET LOGLIB = Z:\Batch\Logs;
%LET CODELIB = Z:\Codebase\SAS\CDW;
%LET ODBCFILE = BSYS;
%LET DB = CDW;
%LET ODBCFILE_CSYS = CSYS;

%INCLUDE "&CODELIB\UTNWDW1 CDW DAILY UPDATE.FOLDER AND DATABASE.SAS";
%FILECHECK(26);

DATA PD42 (drop=trunc dc_alw_adl_phn);
	INFILE REPORT26 DSD DLM = ',' FIRSTOBS=1 MISSOVER end = eof;
	INPUT DF_SPE_ACC_ID :$10. DC_PHN :$1. DC_ALW_ADL_PHN :$1. DD_PHN_VER :$10. DI_PHN_VLD :$1.
		DN_DOM_PHN_ARA :$3. DN_DOM_PHN_XCH :$3. DN_DOM_PHN_LCL :$4. DN_PHN_XTN :$5. DN_FGN_PHN_CNY :$3. 
		DN_FGN_PHN_CT :$5. DN_FGN_PHN_LCL :$11.;
	if dc_alw_adl_phn in ('L','P','X') THEN CONSENT_IND = 'Y'; 
		ELSE CONSENT_IND = 'N';
	if dc_alw_adl_phn in ('N','P') THEN LINE_TYP = 'M';
	ELSE if dc_alw_adl_phn in ('L','Q') THEN LINE_TYP = 'L';
	ELSE if dc_alw_adl_phn in ('U','X') THEN LINE_TYP = 'U';

%TRUNCAT(26);
RUN;
%COPYERROR;
PROC SORT DATA=PD42 ; BY DF_SPE_ACC_ID DC_PHN; RUN;
DATA PD42; SET PD42; BY DF_SPE_ACC_ID DC_PHN; IF LAST.DC_PHN; RUN;

%ENCHILADA(PD42,PD42_PHONE,DF_SPE_ACC_ID DC_PHN,DD_PHN_VER DI_PHN_VLD DN_DOM_PHN_ARA
	DN_DOM_PHN_XCH DN_DOM_PHN_LCL DN_PHN_XTN DN_FGN_PHN_CNY DN_FGN_PHN_CT DN_FGN_PHN_LCL CONSENT_IND LINE_TYP,);

%GOODBYE_NULL(PD42_PHONE,DD_PHN_VER,'');
%GOODBYE_NULL(PD42_PHONE,DI_PHN_VLD,'');
%GOODBYE_NULL(PD42_PHONE,DN_DOM_PHN_ARA,'');
%GOODBYE_NULL(PD42_PHONE,DN_DOM_PHN_XCH,'');
%GOODBYE_NULL(PD42_PHONE,DN_DOM_PHN_LCL,'');
%GOODBYE_NULL(PD42_PHONE,DN_PHN_XTN,'');
%GOODBYE_NULL(PD42_PHONE,DN_FGN_PHN_CNY,'');
%GOODBYE_NULL(PD42_PHONE,DN_FGN_PHN_CT,'');
%GOODBYE_NULL(PD42_PHONE,DN_FGN_PHN_LCL,'');
%GOODBYE_NULL(PD42_PHONE,CONSENT_IND,'');
%GOODBYE_NULL(PD42_PHONE,LINE_TYP,'');

%FINISH(SOURCE=Phone);
