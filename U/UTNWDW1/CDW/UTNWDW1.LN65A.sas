/*TEST*/
/*%LET TESTMSG = - THIS IS A TEST;
%LET RPTLIB = T:\SAS;
%LET LOGLIB = Y:\Batch\Logs;
%LET CODELIB = Y:\Codebase\SAS\CDW;
%LET ODBCFILE = BSYS_TEST;
%LET DB = CDW_test;
%LET ODBCFILE_CSYS = CSYSTest;*/

/*LIVE*/
%LET TESTMSG = - THIS IS LIVE;
%LET RPTLIB = Z:\Batch\FTP;
%LET LOGLIB = Z:\Batch\Logs;
%LET CODELIB = Z:\Codebase\SAS\CDW;
%LET ODBCFILE = BSYS;
%LET DB = CDW;
%LET ODBCFILE_CSYS = CSYS;

%INCLUDE "&CODELIB\UTNWDW1 CDW DAILY UPDATE.FOLDER AND DATABASE.SAS";
%FILECHECK(53);


DATA LN65A(drop=trunc);
	INFILE REPORT53 DSD DLM = ',' FIRSTOBS=1 MISSOVER end = eof;
	INPUT 
		BF_SSN :$9.
		LN_SEQ :2.
		LN_RPS_SEQ :2.
		LA_RPD_INT_DIS :8.2
		LR_APR_RPD_DIS :5.3
		LA_TOT_RPD_DIS :8.2
		LA_CPI_RPD_DIS :8.2
		LR_INT_RPD_DIS :5.3
		LA_ANT_CAP :7.2
		LD_GRC_PRD_END :DATE9.
		LD_CRT_LON65 :DATE9.
		LC_STA_LON65 :$1.
		LF_LST_DTS_LN65 :DATETIME25.
		LC_TYP_SCH_DIS :$2.
		LA_ACR_INT_RPD :7.2
		LA_ANT_SUP_FEE :7.2
		LN_RPD_MAX_TRM_REQ :3.0
		LD_RPD_MAX_TRM_SR :DATE9.
		LC_RPD_INA_REA :$1.
		LC_RPD_DIS :$1.
		LR_CLC_INC_SCH :5.3
		LA_CLC_RPY_SCH :8.2
		LI_ICR_RPD_NEG_AMR :$1.;
%TRUNCAT1(53, BF_SSN);
RUN;
%COPYERROR;

DATA LN65A;
SET LN65A;
	LD_GRC_PRD_END = LD_GRC_PRD_END * 86400;
	LD_CRT_LON65 = LD_CRT_LON65 * 86400;
	LD_RPD_MAX_TRM_SR = LD_RPD_MAX_TRM_SR * 86400;
RUN;

PROC SORT DATA=LN65A; BY BF_SSN LN_SEQ LN_RPS_SEQ; RUN;

%ENCHILADA(
LN65A,
LN65_LON_RPS,
BF_SSN  
LN_SEQ  
LN_RPS_SEQ,
LA_RPD_INT_DIS  
LR_APR_RPD_DIS  
LA_TOT_RPD_DIS  
LA_CPI_RPD_DIS  
LR_INT_RPD_DIS  
LA_ANT_CAP  
LD_GRC_PRD_END  
LD_CRT_LON65  
LC_STA_LON65  
LF_LST_DTS_LN65  
LC_TYP_SCH_DIS  
LA_ACR_INT_RPD  
LA_ANT_SUP_FEE  
LN_RPD_MAX_TRM_REQ  
LD_RPD_MAX_TRM_SR  
LC_RPD_INA_REA  
LC_RPD_DIS  
LR_CLC_INC_SCH  
LA_CLC_RPY_SCH  
LI_ICR_RPD_NEG_AMR
);

%FINISH(SOURCE=LN65A);
