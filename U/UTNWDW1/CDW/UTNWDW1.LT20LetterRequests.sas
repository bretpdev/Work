/*TEST*/
/*%LET TESTMSG = - THIS IS A TEST;
%LET RPTLIB = T:\SAS;
%LET LOGLIB = Y:\Batch\Logs;
%LET CODELIB = Y:\Codebase\SAS\CDW;
%LET ODBCFILE = BSYS_TEST;
%LET DB = CDW_test;
%LET ODBCFILE_CSYS = CSYSTest;*/

/*LIVE*/
%LET TESTMSG = - THIS IS LIVE;
%LET RPTLIB = Z:\Batch\FTP;
%LET LOGLIB = Z:\Batch\Logs;
%LET CODELIB = Z:\Codebase\SAS\CDW;
%LET ODBCFILE = BSYS;
%LET DB = CDW;
%LET ODBCFILE_CSYS = CSYS;

%INCLUDE "&CODELIB\UTNWDW1 CDW DAILY UPDATE.FOLDER AND DATABASE.SAS"  ;
%FILECHECK(34);

OPTIONS MPRINT;

DATA LT20(DROP=trunc);
	INFILE REPORT34 DSD DLM = ',' FIRSTOBS=1 MISSOVER END = eof LRECL = 32767;
	INPUT 
		DF_SPE_ACC_ID :$10.
		RT_RUN_SRT_PRC :$23.
		RN_SEQ_LTR_CRT_PRC :11.
		RN_SEQ_REC_PRC :6.
		RT_RUN_SRT_DTS_PRC :DATETIME25.3
		RM_DSC_LTR_PRC :$10.
		RC_TYP_SBJ_PRC :$1.
		RF_SBJ_PRC :$9.
		RN_ENT_REQ_PRC  :4. 
		RN_ATY_SEQ_PRC :11.
		RI_REC_PRC :$1.
		RX_REQ_ARA_1_PRC :$250.
		RI_LTR_REQ_DEL_PRC :$1.
		RC_LTR_REQ_SRC_PRC :$1.
		RI_PRV_RUN_ERR_PRC :$1.
		RF_COR_DOC_PRC :$17.
		RI_LTR_OPT_ENC_PRC :$1.
	;
	%TRUNCAT(34);
RUN;

%COPYERROR;

PROC SORT DATA=LT20 NODUPKEY;
	BY DF_SPE_ACC_ID RT_RUN_SRT_PRC RN_SEQ_LTR_CRT_PRC RN_SEQ_REC_PRC;
RUN; 

%ENCHILADA
	(
		LT20,
		LT20_LetterRequests,
		DF_SPE_ACC_ID
		RT_RUN_SRT_PRC
		RN_SEQ_LTR_CRT_PRC
		RN_SEQ_REC_PRC,
		RT_RUN_SRT_DTS_PRC
		RM_DSC_LTR_PRC
		RC_TYP_SBJ_PRC
		RF_SBJ_PRC
		RN_ENT_REQ_PRC
		RN_ATY_SEQ_PRC
		RI_REC_PRC
		RX_REQ_ARA_1_PRC
		RI_LTR_REQ_DEL_PRC
		RC_LTR_REQ_SRC_PRC
		RI_PRV_RUN_ERR_PRC
		RF_COR_DOC_PRC
		RI_LTR_OPT_ENC_PRC,
/*		no filter*/
	);

%FINISH(SOURCE=LetterRequests);
