/*%LET RPTLIB = %SYSGET(reportdir);*/
%LET RPTLIB = T:\;
FILENAME REPORTZ "&RPTLIB/UNWO20.NWO20RZ";
FILENAME REPORT2 "&RPTLIB/UNWO20.NWO20R2";
FILENAME REPORT3 "&RPTLIB/UNWO20.NWO20R3";
FILENAME REPORT4 "&RPTLIB/UNWO20.NWO20R4";

LIBNAME  LEGEND  REMOTE  SERVER=LEGEND SLIBREF=work  ;
RSUBMIT LEGEND;
/*%let DB = DNFPRQUT;  *This is test;*/
/*%let DB = DNFPRUUT;  *This is VUK3 test;*/
%let DB = DNFPUTDL;  *This is live;

LIBNAME PKUB DB2 DATABASE=&DB OWNER=PKUB;

PROC SQL;
	CONNECT TO DB2 (DATABASE=&DB);

	CREATE TABLE POP AS
		SELECT	
			*
		FROM	
			CONNECTION TO DB2 
				(
					SELECT DISTINCT
						PD10.DF_SPE_ACC_ID,
						PD10.DF_PRS_ID,
						PD10.DM_PRS_1,
						PD10.DM_PRS_LST,
						RM30.LC_RMT_REV_REA_REJ,
						LN90.LD_FAT_EFF,
						REV1.LD_FAT_EFF AS REV_PMT_1,
						REV2.LD_FAT_EFF AS REV_PMT_2,
						REV3.LD_FAT_EFF AS REV_PMT_3
					FROM
						PKUB.PD10_PRS_NME PD10
						INNER JOIN PKUB.BR30_BR_EFT BR30
							ON BR30.BF_SSN = PD10.DF_PRS_ID
						INNER JOIN PKUB.LN83_EFT_TO_LON LN83
							ON LN83.BF_SSN = BR30.BF_SSN
							AND LN83.BN_EFT_SEQ = BR30.BN_EFT_SEQ
							AND LN83.LC_STA_LN83 IN ('A','D')
						INNER JOIN PKUB.LN10_LON LN10
							ON LN10.BF_SSN = LN83.BF_SSN
							AND LN10.LN_SEQ = LN83.LN_SEQ
						LEFT JOIN /*GETS PAID HEAD BORROWERS*/
						(
							SELECT
								BF_SSN
							FROM
								PKUB.LN80_LON_BIL_CRF LN80
							WHERE
								LN80.LC_STA_LON80 = 'A' 
								AND LN80.LC_BIL_TYP_LON = 'P'
								AND (DAYS(LN80.LD_BIL_DU_LON) - DAYS(CURRENT_DATE) ) > 21
								AND  LN80.LA_TOT_BIL_STS >= LN80.LA_BIL_CUR_DU
						)BILL
							ON BILL.BF_SSN = LN10.BF_SSN
						INNER JOIN PKUB.LN90_FIN_ATY LN90
							ON LN90.BF_SSN = LN10.BF_SSN
							AND LN90.LN_SEQ = LN10.LN_SEQ
						INNER JOIN PKUB.LN94_LON_PAY_FAT LN94
							ON LN94.BF_SSN = LN90.BF_SSN
							AND LN94.LN_SEQ = LN90.LN_SEQ
							AND LN94.LN_FAT_SEQ = LN90.LN_FAT_SEQ
						INNER JOIN PKUB.RM30_BR_RMT RM30
							ON RM30.LD_RMT_BCH_INI = LN94.LD_RMT_BCH_INI
							AND RM30.LC_RMT_BCH_SRC_IPT = LN94.LC_RMT_BCH_SRC_IPT
							AND RM30.LN_RMT_BCH_SEQ = LN94.LN_RMT_BCH_SEQ
							AND RM30.LN_RMT_SEQ = LN94.LN_RMT_SEQ
							AND RM30.LN_RMT_ITM = LN94.LN_RMT_ITM
							AND RM30.LN_RMT_ITM_SEQ = LN94.LN_RMT_ITM_SEQ
						LEFT JOIN /*GETS THE FIRST INSTANCE OF A REVERSED PAYMENT*/
						(
							SELECT DISTINCT
								LN90.BF_SSN,
								LN90.LN_SEQ,
								LN90.LD_FAT_EFF
							FROM 
								PKUB.LN90_FIN_ATY LN90
								INNER JOIN PKUB.LN94_LON_PAY_FAT LN94
									ON LN94.BF_SSN = LN90.BF_SSN
									AND LN94.LN_SEQ = LN90.LN_SEQ
									AND LN94.LN_FAT_SEQ = LN90.LN_FAT_SEQ
								INNER JOIN PKUB.BR30_BR_EFT BR30
									ON BR30.BF_SSN = LN90.BF_SSN
								INNER JOIN PKUB.LN83_EFT_TO_LON LN83
									ON LN83.BF_SSN = BR30.BF_SSN
									AND LN83.BN_EFT_SEQ = BR30.BN_EFT_SEQ
									AND LN83.LC_STA_LN83 IN ('A','D')
								INNER JOIN PKUB.RM30_BR_RMT RM30
									ON RM30.LD_RMT_BCH_INI = LN94.LD_RMT_BCH_INI
									AND RM30.LC_RMT_BCH_SRC_IPT = LN94.LC_RMT_BCH_SRC_IPT
									AND RM30.LN_RMT_BCH_SEQ = LN94.LN_RMT_BCH_SEQ
									AND RM30.LN_RMT_SEQ = LN94.LN_RMT_SEQ
									AND RM30.LN_RMT_ITM = LN94.LN_RMT_ITM
									AND RM30.LN_RMT_ITM_SEQ = LN94.LN_RMT_ITM_SEQ
								LEFT JOIN
								(
									SELECT
										BF_SSN,
										COALESCE(MAX(LD_ATY_REQ_RCV), '01/01/1960') AS LD_ATY_REQ_RCV
									FROM
										PKUB.AY10_BR_LON_ATY
									WHERE
										PF_REQ_ACT = 'RMACH'
									GROUP BY
										BF_SSN
								) AY10
									ON AY10.BF_SSN = LN90.BF_SSN
							WHERE 
								(LN90.LD_FAT_EFF > COALESCE(AY10.LD_ATY_REQ_RCV, '01/01/1960'))
								AND (LN90.PC_FAT_TYP = '10' AND LN90.PC_FAT_SUB_TYP = '10')
								AND LN90.LC_FAT_REV_REA = '1'
								AND RM30.LC_RMT_STA  = 'A'
								AND RM30.LC_RMT_REV_REA_REJ NOT IN ('02','03','04','05')
								AND RM30.LC_RMT_BCH_IPT_REV = 'E'
								AND DAYS(LN90.LD_FAT_EFF) BETWEEN  DAYS(LN83.LD_EFT_EFF_BEG) AND DAYS(COALESCE(LN83.LD_EFT_EFF_END, CURRENT_DATE))
							) REV1
								ON LN10.BF_SSN = REV1.BF_SSN
								AND LN10.LN_SEQ = REV1.LN_SEQ
						LEFT JOIN /*GETS THE SECOND INSTANCE OF A REVERSED PAYMENT*/
						(
							SELECT DISTINCT
								LN90.BF_SSN,
								LN90.LN_SEQ,
								LN90.LD_FAT_EFF
							FROM 
								PKUB.LN90_FIN_ATY LN90
								INNER JOIN PKUB.LN94_LON_PAY_FAT LN94
									ON LN94.BF_SSN = LN90.BF_SSN
									AND LN94.LN_SEQ = LN90.LN_SEQ
									AND LN94.LN_FAT_SEQ = LN90.LN_FAT_SEQ
								INNER JOIN PKUB.BR30_BR_EFT BR30
									ON BR30.BF_SSN = LN90.BF_SSN
								INNER JOIN PKUB.LN83_EFT_TO_LON LN83
									ON LN83.BF_SSN = BR30.BF_SSN
									AND LN83.BN_EFT_SEQ = BR30.BN_EFT_SEQ
									AND LN83.LC_STA_LN83 IN ('A','D')
								INNER JOIN PKUB.RM30_BR_RMT RM30
									ON RM30.LD_RMT_BCH_INI = LN94.LD_RMT_BCH_INI
									AND RM30.LC_RMT_BCH_SRC_IPT = LN94.LC_RMT_BCH_SRC_IPT
									AND RM30.LN_RMT_BCH_SEQ = LN94.LN_RMT_BCH_SEQ
									AND RM30.LN_RMT_SEQ = LN94.LN_RMT_SEQ
									AND RM30.LN_RMT_ITM = LN94.LN_RMT_ITM
									AND RM30.LN_RMT_ITM_SEQ = LN94.LN_RMT_ITM_SEQ
								LEFT JOIN
								(
									SELECT
										BF_SSN,
										COALESCE(MAX(LD_ATY_REQ_RCV), '01/01/1960') AS LD_ATY_REQ_RCV
									FROM
										PKUB.AY10_BR_LON_ATY
									WHERE
										PF_REQ_ACT = 'RMACH'
									GROUP BY
										BF_SSN
								) AY10
									ON AY10.BF_SSN = LN90.BF_SSN
							WHERE 
								(LN90.LD_FAT_EFF >= COALESCE(AY10.LD_ATY_REQ_RCV, '01/01/1960'))
								AND (LN90.PC_FAT_TYP = '10' AND LN90.PC_FAT_SUB_TYP = '10')
								AND LN90.LC_FAT_REV_REA = '1'
								AND RM30.LC_RMT_STA  = 'A'
								AND RM30.LC_RMT_REV_REA_REJ NOT IN ('02','03','04','05')
								AND RM30.LC_RMT_BCH_IPT_REV = 'E'
								AND DAYS(LN90.LD_FAT_EFF) BETWEEN  DAYS(LN83.LD_EFT_EFF_BEG) AND DAYS(COALESCE(LN83.LD_EFT_EFF_END, CURRENT_DATE))
							) REV2
								ON LN10.BF_SSN = REV2.BF_SSN
								AND LN10.LN_SEQ = REV2.LN_SEQ
						LEFT JOIN /*GETS THE THRID INSTANCE OF A REVERSED PAYMENT*/
						(
							SELECT DISTINCT
								LN90.BF_SSN,
								LN90.LN_SEQ,
								LN90.LD_FAT_EFF
							FROM 
								PKUB.LN90_FIN_ATY LN90
								INNER JOIN PKUB.LN94_LON_PAY_FAT LN94
									ON LN94.BF_SSN = LN90.BF_SSN
									AND LN94.LN_SEQ = LN90.LN_SEQ
									AND LN94.LN_FAT_SEQ = LN90.LN_FAT_SEQ
								INNER JOIN PKUB.BR30_BR_EFT BR30
									ON BR30.BF_SSN = LN90.BF_SSN
								INNER JOIN PKUB.LN83_EFT_TO_LON LN83
									ON LN83.BF_SSN = BR30.BF_SSN
									AND LN83.BN_EFT_SEQ = BR30.BN_EFT_SEQ
									AND LN83.LC_STA_LN83 IN ('A','D')
								INNER JOIN PKUB.RM30_BR_RMT RM30
									ON RM30.LD_RMT_BCH_INI = LN94.LD_RMT_BCH_INI
									AND RM30.LC_RMT_BCH_SRC_IPT = LN94.LC_RMT_BCH_SRC_IPT
									AND RM30.LN_RMT_BCH_SEQ = LN94.LN_RMT_BCH_SEQ
									AND RM30.LN_RMT_SEQ = LN94.LN_RMT_SEQ
									AND RM30.LN_RMT_ITM = LN94.LN_RMT_ITM
									AND RM30.LN_RMT_ITM_SEQ = LN94.LN_RMT_ITM_SEQ
								LEFT JOIN
								(
									SELECT
										BF_SSN,
										COALESCE(MAX(LD_ATY_REQ_RCV), '01/01/1960') AS LD_ATY_REQ_RCV
									FROM
										PKUB.AY10_BR_LON_ATY
									WHERE
										PF_REQ_ACT = 'RMACH'
									GROUP BY
										BF_SSN
								) AY10
									ON AY10.BF_SSN = LN90.BF_SSN
							WHERE 
								(LN90.LD_FAT_EFF > COALESCE(AY10.LD_ATY_REQ_RCV, '01/01/1960'))
								AND (LN90.PC_FAT_TYP = '10' AND LN90.PC_FAT_SUB_TYP = '10')
								AND LN90.LC_FAT_REV_REA = '1'
								AND RM30.LC_RMT_STA  = 'A'
								AND RM30.LC_RMT_REV_REA_REJ NOT IN ('02','03','04','05')
								AND RM30.LC_RMT_BCH_IPT_REV = 'E'
								AND DAYS(LN90.LD_FAT_EFF) BETWEEN  DAYS(LN83.LD_EFT_EFF_BEG) AND DAYS(COALESCE(LN83.LD_EFT_EFF_END, CURRENT_DATE))
							) REV3
								ON LN10.BF_SSN = REV3.BF_SSN
								AND LN10.LN_SEQ = REV3.LN_SEQ
					WHERE
						LN10.LA_CUR_PRI > 0
						AND LN10.LC_STA_LON10 = 'R'
						AND BR30.BC_EFT_STA = 'A'
						AND (LN90.PC_FAT_TYP = '10' AND LN90.PC_FAT_SUB_TYP = '10')
						AND LN90.LC_FAT_REV_REA = '1'
						AND RM30.LC_RMT_STA  = 'A'
						AND DAYS(LN90.LD_FAT_EFF) BETWEEN DAYS(LN83.LD_EFT_EFF_BEG) AND DAYS(COALESCE(LN83.LD_EFT_EFF_END, CURRENT_DATE))
						AND BILL.BF_SSN IS NULL
						AND RM30.LC_RMT_BCH_IPT_REV = 'E'


					FOR READ ONLY WITH UR
				)
	;

	DISCONNECT FROM DB2;
QUIT;

PROC SQL;
	CREATE TABLE R2 AS
		SELECT DISTINCT
			DF_SPE_ACC_ID,
			DF_PRS_ID,
			DM_PRS_1,
			DM_PRS_LST
		FROM
			POP
		WHERE
			LC_RMT_REV_REA_REJ NOT IN ('02','03','04','05') 
			AND ((REV_PMT_2 BETWEEN REV_PMT_1 + 27 AND REV_PMT_1 + 31) AND (REV_PMT_3 BETWEEN REV_PMT_2 + 27 AND REV_PMT_2 + 31))
			AND (REV_PMT_1 is not null and REV_PMT_2 is not null and REV_PMT_3 is not null)
;

			
	CREATE TABLE R3 AS 
		SELECT DISTINCT
			POP.DF_SPE_ACC_ID,
			POP.DF_PRS_ID,
			POP.DM_PRS_1,
			POP.DM_PRS_LST,
			POP.LC_RMT_REV_REA_REJ
		FROM 
			POP
		LEFT JOIN
		(
			SELECT
				BF_SSN,
				COALESCE(MAX(LD_ATY_REQ_RCV), INPUT('01/01/1960', DATE9.)) AS LD_ATY_REQ_RCV
			FROM
				PKUB.AY10_BR_LON_ATY
			WHERE
				PF_REQ_ACT = 'APREQ'
			GROUP BY
				BF_SSN
		) AY10
			ON AY10.BF_SSN = POP.DF_PRS_ID
		WHERE
			LC_RMT_REV_REA_REJ IN ('02','03','04','05')
			AND (POP.LD_FAT_EFF > COALESCE(AY10.LD_ATY_REQ_RCV, INPUT('01/01/1960', DATE9.)))
;


		CREATE TABLE FINAL AS 
			SELECT DISTINCT
						POP.DF_SPE_ACC_ID,
						POP.DF_PRS_ID,
						POP.DM_PRS_1 || ' ' || POP.DM_PRS_LST AS NAME,
						PD30.DX_STR_ADR_1,
						PD30.DX_STR_ADR_2,
						PD30.DX_STR_ADR_3,
						PD30.DM_CT,
						PD30.DC_DOM_ST,
						PD30.DF_ZIP_CDE,
						PD30.DM_FGN_CNY,
						PD30.DM_FGN_ST,
						PD30.DI_VLD_ADR,
						COALESCE(PAST_DUE.DAYS_DELQ, 0) AS DAYS_DELQ,
						PD40_HOME.HOME_CONSENT,
						PD40_HOME.HOME_PHONE,
						PD40_ALT.ALT_CONSENT,
						PD40_ALT.ALT_PHONE,
						PD40_WORK.WORK_CONSENT,
						PD40_WORK.WORK_PHONE,
						LN10.LF_LON_CUR_OWN,
						COALESCE(AMT_DUE.AMOUNT_DUE, 0) AS AMOUNT_DUE,
						SUM(LN10.LA_CUR_PRI + COALESCE(DW01.LA_NSI_OTS, 0)) AS TOTAL_BALANCE
					FROM
						R2 POP 
						INNER JOIN PKUB.LN10_LON LN10
							ON LN10.BF_SSN = POP.DF_PRS_ID
						LEFT JOIN PKUB.DW01_DW_CLC_CLU DW01
							ON DW01.BF_SSN = LN10.BF_SSN
							AND DW01.LN_SEQ = LN10.LN_SEQ
						INNER JOIN PKUB.PD30_PRS_ADR PD30
							ON PD30.DF_PRS_ID = POP.DF_PRS_ID
							AND PD30.DC_ADR = 'L'
						LEFT JOIN
						(
							SELECT
								PD40.DF_PRS_ID,
								(PD40.DN_DOM_PHN_ARA || PD40.DN_DOM_PHN_XCH || PD40.DN_DOM_PHN_LCL) AS HOME_PHONE,
								CASE
									WHEN PD40.DC_ALW_ADL_PHN IN ('L','Q','P') THEN 'Y'
									ELSE 'N'
								END AS HOME_CONSENT
							FROM 
								PKUB.PD40_PRS_PHN PD40
							WHERE
								PD40.DC_PHN = 'H'
								AND PD40.DI_PHN_VLD = 'Y'

						)PD40_HOME
							ON PD40_HOME.DF_PRS_ID = POP.DF_PRS_ID
						LEFT JOIN
						(
							SELECT
								PD40.DF_PRS_ID,
								(PD40.DN_DOM_PHN_ARA || PD40.DN_DOM_PHN_XCH || PD40.DN_DOM_PHN_LCL) AS ALT_PHONE,
								CASE
									WHEN PD40.DC_ALW_ADL_PHN IN ('L','Q','P') THEN 'Y'
									ELSE 'N'
								END AS ALT_CONSENT
							FROM 
								PKUB.PD40_PRS_PHN PD40
							WHERE
								PD40.DC_PHN = 'A'
								AND PD40.DI_PHN_VLD = 'Y'

						)PD40_ALT
							ON PD40_ALT.DF_PRS_ID = POP.DF_PRS_ID
						LEFT JOIN
						(
							SELECT
								PD40.DF_PRS_ID,
								(PD40.DN_DOM_PHN_ARA || PD40.DN_DOM_PHN_XCH || PD40.DN_DOM_PHN_LCL) AS WORK_PHONE,
								CASE
									WHEN PD40.DC_ALW_ADL_PHN IN ('L','Q','P') THEN 'Y'
									ELSE 'N'
								END AS WORK_CONSENT
							FROM 
								PKUB.PD40_PRS_PHN PD40
							WHERE
								PD40.DC_PHN = 'W'
								AND PD40.DI_PHN_VLD = 'Y'

						)PD40_WORK
							ON PD40_WORK.DF_PRS_ID = POP.DF_PRS_ID
						LEFT JOIN 
						(
							SELECT
								LN16.BF_SSN,
								(MAX(LN16.LN_DLQ_MAX) + 1) AS DAYS_DELQ
							FROM
								PKUB.LN16_LON_DLQ_HST LN16
							GROUP BY
								LN16.BF_SSN

						)PAST_DUE
							ON PAST_DUE.BF_SSN = POP.DF_PRS_ID
						LEFT JOIN /*GETS THE BORROWERS CURRENT AMOUNT DUE*/
						(
							SELECT
								LN80.BF_SSN,
								SUM(LN80.LA_BIL_PAS_DU + LN80.LA_BIL_CUR_DU + LN80.LA_LTE_FEE_OTS_PRT) AS AMOUNT_DUE
							FROM
								PKUB.LN80_LON_BIL_CRF LN80
							WHERE 
								LN80.LC_BIL_TYP_LON = 'P'
								AND LN80.LC_STA_LON80 = 'A'
								AND LN80.LD_BIL_CRT > (TODAY() - 31) 
							GROUP BY
								LN80.BF_SSN
						) AMT_DUE
							ON AMT_DUE.BF_SSN = POP.DF_PRS_ID
					GROUP BY 
						POP.DF_SPE_ACC_ID,
						POP.DF_PRS_ID,
						POP.DM_PRS_1,
						POP.DM_PRS_LST,
						PD30.DX_STR_ADR_1,
						PD30.DX_STR_ADR_2,
						PD30.DX_STR_ADR_3,
						PD30.DM_CT,
						PD30.DC_DOM_ST,
						PD30.DF_ZIP_CDE,
						PD30.DM_FGN_CNY,
						PD30.DM_FGN_ST,
						PD30.DI_VLD_ADR,
						PAST_DUE.DAYS_DELQ,
						PD40_HOME.HOME_CONSENT,
						PD40_HOME.HOME_PHONE,
						PD40_ALT.ALT_CONSENT,
						PD40_ALT.ALT_PHONE,
						PD40_WORK.WORK_CONSENT,
						PD40_WORK.WORK_PHONE,
						LN10.LF_LON_CUR_OWN,
						AMT_DUE.AMOUNT_DUE
;
QUIT;
ENDRSUBMIT;
	
DATA R2; 
	SET LEGEND.FINAL; 
RUN;


DATA R3;
	SET LEGEND.R3;
RUN;

/*LIBNAME SQL ODBC REQUIRED="FILEDSN=X:\PADR\ODBC\CLS_TEST.dsn; update_lock_typ=nolock; bl_keepnulls=no";*/
/*%INCLUDE "Y:\Codebase\SAS\ArcAdd Common.SAS";*/
/*%LET DSN = 'FILEDSN=X:\PADR\ODBC\CLS_TEST.dsn;';*/
LIBNAME SQL ODBC REQUIRED="FILEDSN=X:\PADR\ODBC\CLS.dsn; update_lock_typ=nolock; bl_keepnulls=no";
%INCLUDE "Z:\Codebase\SAS\ArcAdd Common.SAS";
%LET DSN = 'FILEDSN=X:\PADR\ODBC\CLS.dsn;';

DATA R2;
	SET R2 ;
	RECIPIENT_ID = '';
	IS_REFERENCE = 0;
	IS_ENDORSER = 0;
	PROCESS_FROM = .;
	PROCESS_TO = .;
	NEEDED_BY = .;
	REGARDS_TO = '';
	REGARDS_CODE = '';
	COMMENT = 'Borrower has received three consecutive NSFâ€™s while on ACH. Denial letter sent to borrower.';	
	CREATED_BY = 'UNWO20.R2';
RUN;

PROC SQL;
		INSERT INTO
			SQL.ACHReview
				(
					AccountNumber
				)
		SELECT
			R2.DF_SPE_ACC_ID
			
		FROM
			R2 
		;
QUIT;

%GENERAL_ARC_ADD_PROCESSING(R2, DF_SPE_ACC_ID, COMMENT, RECIPIENT_ID, IS_REFERENCE, IS_ENDORSER, PROCESS_FROM, PROCESS_TO, NEEDED_BY, REGARDS_TO, REGARDS_CODE,CREATED_BY, 1, 'RMACH','UNWO20.R2');

DATA R3;
	SET R3 ;
	LENGTH COMMENT $300.;
	RECIPIENT_ID = '';
	IS_REFERENCE = 0;
	IS_ENDORSER = 0;
	PROCESS_FROM = .;
	PROCESS_TO = .;
	NEEDED_BY = .;
	REGARDS_TO = '';
	REGARDS_CODE = '';
	IF LC_RMT_REV_REA_REJ = '02' THEN COMMENT = 'ACH to be reviewed. Borrowers received NSF due to Account Being Closed.';
	ELSE IF LC_RMT_REV_REA_REJ = '03' THEN COMMENT = 'ACH to be reviewed. Borrowers received NSF due to No Account/Unable to Locate Account.';
	ELSE IF LC_RMT_REV_REA_REJ = '04' THEN COMMENT = 'ACH to be reviewed. Borrowers received NSF due to Invalid Account Number.';
	ELSE COMMENT = 'ACH to be reviewed. Borrowers received NSF due to Unauthorized Debit.';
	CREATED_BY = 'UNWO20.R3';
RUN;

%GENERAL_ARC_ADD_PROCESSING(R3, DF_SPE_ACC_ID, COMMENT, RECIPIENT_ID, IS_REFERENCE, IS_ENDORSER, PROCESS_FROM, PROCESS_TO, NEEDED_BY, REGARDS_TO, REGARDS_CODE,CREATED_BY , 1, 'APREQ','UNWO20.R3');

DATA _NULL_;
SET R2;
FILE REPORT4 DROPOVER LRECL=32767;
DO;
		PUT @1 DF_PRS_ID   			
		@15 NAME
		@70 DAYS_DELQ
		@159 HOME_CONSENT
		@160 HOME_PHONE
		@175 ALT_CONSENT
		@176 ALT_PHONE
		@191 WORK_CONSENT
		@192 WORK_PHONE
		@260 DX_STR_ADR_1
		@290 DX_STR_ADR_2
		@320 DX_STR_ADR_3
		@350 DM_CT
		@370 DC_DOM_ST
		@372 DF_ZIP_CDE
		@414 LF_LON_CUR_OWN
		@422 AMOUNT_DUE
		@429 TOTAL_BALANCE;	
	END;
RUN;
