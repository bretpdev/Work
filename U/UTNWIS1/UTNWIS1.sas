%LET RPTLIB = T:\SAS;
FILENAME REPORT2 "&RPTLIB/CORNERSTONE USER QUEUE ACCESS - FED.R2";

LIBNAME  LEGEND  REMOTE  SERVER=LEGEND SLIBREF=WORK  ;
RSUBMIT;
PROC SQL;
CONNECT TO DB2 (DATABASE=DNFPUTDL);
CREATE TABLE DEMO AS
SELECT *
FROM CONNECTION TO DB2 (
	SELECT A.PF_USR
		,B.XM_USER
		,A.WC_TYP_USR_QUE
		,A.WF_QUE
		,A.WF_SUB_QUE
		FROM PKUB.WQ60_TSK_PL_ASN A
			LEFT OUTER JOIN PKUB.APEX25 B
				ON A.PF_USR = B.XF_USR
			/*WHERE A.PF_USR = 'UT00380'*/
	FOR READ ONLY WITH UR
	);
DISCONNECT FROM DB2;
/*%PUT  SQLXRC= >>> &SQLXRC <<< ||| SQLXMSG= >>> &SQLXMSG >>> ;  ** INCLUDES ERROR MESSAGES TO SAS LOG  ;*/
/*%SQLCHECK;*/
QUIT;
PROC SORT DATA=DEMO; BY PF_USR; RUN;

ENDRSUBMIT;
DATA DEMO;
	SET LEGEND.DEMO;
RUN;

DATA _NULL_;
	SET DEMO ;
	FILE REPORT2 DELIMITER=',' DSD DROPOVER LRECL=32767;
		IF _N_ = 1 THEN PUT "USER ID,USER NAME,QUEUE USER TYPE,QUEUE IDENTIFIER,SUBQUEUE IDENTIFIER";
		PUT PF_USR XM_USER WC_TYP_USR_QUE WF_QUE WF_SUB_QUE;
RUN;
