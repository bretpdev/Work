/*UTLWE15 MONTH END FILE FOR US BANK*/
/*LIBNAME DLGSUTWH DB2 DATABASE=DLGSUTWH OWNER=OLWHRM1;
%LET RPTLIB = %SYSGET(reportdir);
FILENAME REPORT2 "&RPTLIB/ULWE15.LWE15R2";*/

LIBNAME  WORKLOCL  REMOTE  SERVER=CYPRUS  SLIBREF=WORK;
RSUBMIT;
PROC SQL;
CONNECT TO DB2 (DATABASE=DLGSUTWH);
CREATE TABLE MOEUSBK AS
SELECT *
FROM CONNECTION TO DB2 (
SELECT	A.BF_SSN 
		,A.LN_SEQ
		,A.LF_DOE_SCL_ORG
		,A.IC_LON_PGM
		,A.IF_GTR
		,A.LF_STU_SSN
		,A.IF_OWN
		,A.WA_CUR_PRI
		,A.WM_BR_1
		,A.WM_BR_MID
		,A.WM_BR_LST
		,A.WM_BR_LST_SFX
		,B.DD_BRT
		,B.WM_STU_1
		,B.WM_STU_MID
		,B.WM_STU_LST
		,B.WM_STU_LST_SFX
		,B.WX_STR_ADR_1
		,B.WX_STR_ADR_2
		,B.WX_STR_ADR_3
		,B.WM_CT
		,B.DC_DOM_ST
		,B.DF_ZIP_CDE
		,B.DN_PHN_XTN
		,B.DN_DOM_PHN_LCL
		,B.DN_DOM_PHN_XCH
		,B.DN_DOM_PHN_ARA
		,A.LD_SCL_SPR
		,A.WC_LON_STA
		,C.WX_LON_STA
		,A.WR_ITR_1
		,B.LA_LON_AMT_GTR
		,B.LD_LON_GTR
		,B.WX_ADR_EML
		,B.AF_LON_ALT
		,B.AN_SEQ_COM_LN_APL
FROM OLWHRM1.MR5A_MR_LON_MTH_01 A
LEFT OUTER JOIN OLWHRM1.MR5B_MR_LON_MTH_02 B
		 ON A.BF_SSN = B.BF_SSN
		 AND A.LN_SEQ = B.LN_SEQ
		 AND A.IF_OWN = B.IF_OWN
LEFT OUTER JOIN OLWHRM1.MR5C_MR_LON_MTH_03 C
		 ON A.BF_SSN = C.BF_SSN
		 AND A.LN_SEQ = C.LN_SEQ
		 AND A.IF_OWN = C.IF_OWN
WHERE	A.IF_OWN = '811698'
);
DISCONNECT FROM DB2;
ENDRSUBMIT;

DATA MOEUSBK;
SET WORKLOCL.MOEUSBK;
RUN;

PROC SORT DATA=MOEUSBK;
BY BF_SSN LN_SEQ;
RUN;

DATA _NULL_;
SET  WORK.MOEUSBK;
FILE 'T:\SAS\ULWE15.LWE15R2' DELIMITER=',' DSD DROPOVER LRECL=32767;
*FILE REPORT2 DELIMITER=',' DSD DROPOVER LRECL=32767;
FORMAT BF_SSN $9. ;
FORMAT LN_SEQ 6. ;
FORMAT LF_DOE_SCL_ORG $8. ;
FORMAT IC_LON_PGM $6. ;
FORMAT IF_GTR $6. ;
FORMAT LF_STU_SSN $9. ;
FORMAT IF_OWN $8. ;
FORMAT WA_CUR_PRI 10.2 ;
FORMAT WM_BR_1 $13. ;
FORMAT WM_BR_MID $13. ;
FORMAT WM_BR_LST $23. ;
FORMAT WM_BR_LST_SFX $4. ;
FORMAT DD_BRT MMDDYY10. ;
FORMAT WM_STU_1 $13. ;
FORMAT WM_STU_MID $13. ;
FORMAT WM_STU_LST $23. ;
FORMAT WM_STU_LST_SFX $4. ;
FORMAT WX_STR_ADR_1 $30. ;
FORMAT WX_STR_ADR_2 $30. ;
FORMAT WX_STR_ADR_3 $30. ;
FORMAT WM_CT $20. ;
FORMAT DC_DOM_ST $2. ;
FORMAT DF_ZIP_CDE $17. ;
FORMAT DN_PHN_XTN $5. ;
FORMAT DN_DOM_PHN_LCL $4. ;
FORMAT DN_DOM_PHN_XCH $3. ;
FORMAT DN_DOM_PHN_ARA $3. ;
FORMAT LD_SCL_SPR MMDDYY10. ;
FORMAT WC_LON_STA $2. ;
FORMAT WX_LON_STA $10. ;
FORMAT WR_ITR_1 7.3 ;
FORMAT LA_LON_AMT_GTR 10.2 ;
FORMAT LD_LON_GTR MMDDYY10. ;
FORMAT WX_ADR_EML $75. ;
FORMAT AF_LON_ALT $17. ;
FORMAT AN_SEQ_COM_LN_APL 6. ;
IF _N_ = 1 THEN        /* WRITE COLUMN NAMES */
DO;
PUT
'BF_SSN'
','
'LN_SEQ'
','
'LF_DOE_SCL_ORG'
','
'IC_LON_PGM'
','
'IF_GTR'
','
'LF_STU_SSN'
','
'IF_OWN'
','
'WA_CUR_PRI'
','
'WM_BR_1'
','
'WM_BR_MID'
','
'WM_BR_LST'
','
'WM_BR_LST_SFX'
','
'DD_BRT'
','
'WM_STU_1'
','
'WM_STU_MID'
','
'WM_STU_LST'
','
'WM_STU_LST_SFX'
','
'WX_STR_ADR_1'
','
'WX_STR_ADR_2'
','
'WX_STR_ADR_3'
','
'WM_CT'
','
'DC_DOM_ST'
','
'DF_ZIP_CDE'
','
'DN_PHN_XTN'
','
'DN_DOM_PHN_LCL'
','
'DN_DOM_PHN_XCH'
','
'DN_DOM_PHN_ARA'
','
'LD_SCL_SPR'
','
'WC_LON_STA'
','
'WX_LON_STA'
','
'WR_ITR_1'
','
'LA_LON_AMT_GTR'
','
'LD_LON_GTR'
','
'WX_ADR_EML'
','
'AF_LON_ALT'
','
'AN_SEQ_COM_LN_APL'
;
END;
DO;
PUT BF_SSN $ @;
PUT LN_SEQ @;
PUT LF_DOE_SCL_ORG $ @;
PUT IC_LON_PGM $ @;
PUT IF_GTR $ @;
PUT LF_STU_SSN $ @;
PUT IF_OWN $ @;
PUT WA_CUR_PRI @;
PUT WM_BR_1 $ @;
PUT WM_BR_MID $ @;
PUT WM_BR_LST $ @;
PUT WM_BR_LST_SFX $ @;
PUT DD_BRT @;
PUT WM_STU_1 $ @;
PUT WM_STU_MID $ @;
PUT WM_STU_LST $ @;
PUT WM_STU_LST_SFX $ @;
PUT WX_STR_ADR_1 $ @;
PUT WX_STR_ADR_2 $ @;
PUT WX_STR_ADR_3 $ @;
PUT WM_CT $ @;
PUT DC_DOM_ST $ @;
PUT DF_ZIP_CDE $ @;
PUT DN_PHN_XTN $ @;
PUT DN_DOM_PHN_LCL $ @;
PUT DN_DOM_PHN_XCH $ @;
PUT DN_DOM_PHN_ARA $ @;
PUT LD_SCL_SPR @;
PUT WC_LON_STA $ @;
PUT WX_LON_STA $ @;
PUT WR_ITR_1 @;
PUT LA_LON_AMT_GTR @;
PUT LD_LON_GTR @;
PUT WX_ADR_EML $ @;
PUT AF_LON_ALT $ @;
PUT AN_SEQ_COM_LN_APL ;
;
END;
RUN;

