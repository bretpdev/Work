/*UTLWGG7 Legal AWG*/
/*LIBNAME DLGSUTWH DB2 DATABASE=DLGSUTWH OWNER=OLWHRM1;*/
/*%LET RPTLIB = %SYSGET(reportdir);*/
%LET RPTLIB = T:\SAS;
FILENAME REPORT2 "&RPTLIB/ULWGG7.LWGG7R2";
LIBNAME  WORKLOCL  REMOTE  SERVER=CYPRUS  SLIBREF=WORK;
RSUBMIT;
PROC SQL;
CONNECT TO DB2 (DATABASE=DLGSUTWH);
CREATE TABLE LAWG AS
SELECT * 
FROM CONNECTION TO DB2 (
SELECT DISTINCT
	A.BF_SSN AS SSN,
	'LRV4LAWG' AS QNAME,
	'' AS INSTID,
	'' AS INSTTYPE,
	'' AS DUEDATE,
	'' AS DUETIME,
	'' AS TEXT
		FROM OLWHRM1.DC01_LON_CLM_INF A
			INNER JOIN OLWHRM1.GA14_LON_STA B 
				ON A.AF_APL_ID = B.AF_APL_ID
			INNER JOIN OLWHRM1.LA11_LEG_ACT_ATY C
				ON A.BF_SSN = C.DF_PRS_ID_BR
			INNER JOIN OLWHRM1.GA10_LON_APP D
				ON A.AF_APL_ID = D.AF_APL_ID
					WHERE	B.AC_LON_STA_TYP = 'CP'
						AND	C.BC_LEG_ACT_ATY_TYP = 'JD'
						AND	A.LC_PCL_REA IN ('DB', 'DQ', 'DF')
						AND	A.LC_REA_CLM_ASN_DOE IS NULL
						AND A.LC_AUX_STA NOT IN 'O5'
						AND D.AA_CUR_PRI > 50
						AND	C.BC_LEG_ACT_ATY_TYP NOT IN 'EX'
FOR READ ONLY WITH UR
);
DISCONNECT FROM DB2;

ENDRSUBMIT;

DATA LAWG;
SET WORKLOCL.LAWG;
RUN;

DATA _NULL_;
FILE REPORT2 DELIMITER=',' DSD DROPOVER LRECL=32767;
SET  WORK.LAWG;
	FORMAT SSN $9. ;
	FORMAT QNAME $8. ;
	FORMAT INSTID $1. ;
	FORMAT INSTTYPE $1. ;
	FORMAT DUEDATE $1. ;
	FORMAT DUETIME $1. ;
	FORMAT TEXT $1. ;
	DO;
	PUT SSN $ @;
	PUT QNAME $ @;
	PUT INSTID $ @;
	PUT INSTTYPE $ @;
	PUT DUEDATE $ @;
	PUT DUETIME $ @;
	PUT TEXT $ ;
	;
END;
 RUN;
