/*THIS SPECIFICIES WHAT DIRECTORY TO READ REPORTS FROM AND WHICH DATABASE TO UPDATE.*/
/*LIVE*/
%INCLUDE "X:\Sessions\Local SAS Schedule\UDW\UTLWDW1 UHEAA Data Warehouse Load.Folder and Database.sas";
%LET REPORT = X:\PADD\FTP;

/*TEST*/
/*%INCLUDE "X:\PADU\SAS\UDW\UTLWDW1 UHEAA Data Warehouse Load.Folder and Database.sas" ;
%LET REPORT = T:\SAS;*/

%FILECHECK(37);

DATA AP03;
	INFILE REPORT37 DSD DLM = ',' FIRSTOBS=1 MISSOVER END = EOF;
	INPUT 
		AF_APL_ID :$9.
		BF_SSN :$9.
		AN_SEQ
		LF_STU_SSN :$9.
		IC_LON_PGM :$6.
		AD_CRT_APL :date9.
		AC_STA_ORG_PRC :$2.
		AD_STA_ORG_PRC :date9.
		AC_APL_SCR_STA :$1.
		AC_APL_PRC_TYP :$1.
		AI_BR_DLQ_FED_DET :$1.
		AI_BR_DET
		AC_BR_INT_OPT 
		AC_BR_RPD_OPT :$1.
		AI_BR_NED_ORG_FEE
		AI_BR_ATH_DSB_EFT
		AI_EDS_XST_ON_APL
		AI_RFR_XST_ON_APL
		AD_STU_LON_TRM_BEG :date9.
		AD_STU_LON_TRM_END :date9.
		AD_STU_GRD_XPC :date9.
		AI_STU_FGN_CNY_STY :$1.
		AC_STU_MAJ_STY :$3.
		AX_STU_CNL_MAJ_STY :$15.
		AC_STU_SCL_ENR_STA :$1.
		AI_STU_DFR_REQ
		AA_STU_REQ
		AF_DOE_SCL :$8.
		AF_CNL_NON_EDU_BRH :$4.
		AD_SCL_LON_TRM_BEG :date9.
		AD_SCL_LON_TRM_END :date9.
		AD_SCL_ACA_TRM_BEG :date9.
		AD_SCL_ACA_TRM_END :date9.
		AD_SCL_GRD_XPC :date9.
		AC_SCL_STA_STU_ENR :$1.
		AC_SCL_ACA_GDE_LEV :$2.
		AC_SCL_ACA_PGS :$1.
		AA_SCL_EDU_CST
		AA_SCL_EDU_AID_TOT
		AA_SCL_EFC
		AA_SCL_REQ
		AI_SCL_CNF_MPN_OVR :$1.
		AI_SCL_STU_PAS_DU
		AN_SCL_AMT_CLC_MLT
		AF_DOE_LDR :$8.
		AF_LDR_NON_EDU_BRH :$4.
		AF_LDR_APL_FIL :$10.
		AA_LDR_APV
		AC_LDR_PGM_YR :$1.
		AI_LDR_CNF_MPN_OVR :$1.
		AF_LDR_BND_ISS :$8.
		AF_LDR_FEE_TIR :$3.
		AI_LDR_NO_FEE_OVR :$1.
		AF_LDR_ITR_TIR :$3.
		AI_LDR_NO_ITR_OVR :$1.
		AD_LDR_APL_REJ :date9.
		AF_LDR_ORG :$8.
		AI_LDR_MAT_SLL_LON :$1.
		AF_LDR_LST_RST :$8.
		IF_GTR :$6.
		AF_GTR_RFR :$10.
		AA_GTR_LON
		AD_GTR_LON_REQ :date9.
		AD_GTR_ORG :date9.
		AR_GTR_INT
		AC_GTR_ITR_TYP :$2.
		AR_GTR_FEE 
		AI_GTR_TL4_PIO_787 :$1.
		AI_GTR_DSB_LTE_AZ :$1.
		AD_GTR_DSB_MAX_LTE :date9.
		AA_GTR_RSC
		AD_GTR_RSC :date9.
		AC_GTR_DFR_REQ :$1.
		AC_GTR_INT_BIL_OPT :$2.
		AC_GTR_REA_RDC :$2.
		AA_GTR_TOT_SFD_BAL
		AA_GTR_TOT_PLS_BAL
		AI_GTR_RSC :$1.
		AC_SRC_APL :$3.
		AC_VRS_ALT_APL :$4.
		AC_SER_RUE :$2.
		AD_PNT_SIG :date9.
		AI_PNT_VER
		AF_PNT_VER_BY :$8.
		AD_PNT_VER :date9.
		AI_ESC
		AC_APL_HLD :$2.
		AD_APL_HLD :date9.
		AA_STF_APV
		AA_ESM_RPD
		AD_ESM_RPD_SR :date9.
		AD_ESM_POF :date9.
		AC_SYS_CLC_DFR :$1.
		AA_ANL_INC
		AA_MTH_CLC_RPD
		AA_MTH_CMB_DET
		AA_MTH_CMB_INC
		AR_CMB_DET_INC_RTO
		AA_TOT_SFD_BAL
		AA_TOT_PLS_BAL
		AA_TOT_SLS_BAL
		AA_TOT_PRK_BAL
		AA_TOT_HEA_BAL
		AA_OTH_EDU_LON_BAL
		AA_TOT_STU_LN_BAL
		AA_ORG_FEE_PD
		AA_GTR_FEE_PD
		AC_REA_CPY_AP03 :$1.
		AF_APL_ID_CPY :$9.
		AI_EXT_CVN
		AF_APL_ID_CPY_ORG :$9.
		AN_SEQ_CVN
		AN_SIG_ON_PNT
		AF_RGL_CAT_LP06 :$7.
		AF_RGL_CAT_LP09 :$7.
		AF_RGL_CAT_LP10 :$7.
		AF_RGL_CAT_LP12 :$7.
		AF_RGL_CAT_LP20 :$7.
		AD_LON_1_DSB :date9.
		AC_ORG_DPT :$2.
		AR_LP_TB_ITR_MGN
		AD_AMR_BEG :date9.
		AR_SCL_SUB
		AC_PNT_DEL :$1.
		AD_PNT_SNT :date9.
		AC_SCL_NTF_STA_CHG :$1.
		AI_DSB_REJ_ACK_FIL
		AC_PIO_ORG_STA :$1.
		AC_MN_TYP :$1.
		AC_MN_SRL_LON :$1.
		AI_MN_PSD_BS :$1.
		AC_MN_CNF :$1.
		AC_MN_BR_CNF :$1.
		AD_MN_EXP :date9.
		AI_MN_NOG :$1.
		AI_MN_LN_OF_CRD :$1.
		AC_MN_SRL_LON_ORG :$1.
		AD_MN_BR_CNF_SNT :date9.
		AD_MN_BR_CNF_RCV :date9.
		AA_MN_BR_CNF
		AC_MN_REV_REA :$2.
		AF_MN_MST_NTE :$11.
		AN_MN_MST_NTE_SEQ
		AI_MN_ORG_RGT_SLD
		AF_MN_RGT_SLD_TO :$8.
		AF_CNL :$17.
		AF_CNL_SFX :$2.
		AX_CNL_GTR_USE :$23.
		AC_CNL_GTR_STA :$2.
		AD_CNL_GTR_STA :date9.
		AF_CNL_GTR_TRT_DTS :date9.
		AX_CNL_LDR_USE :$23.
		AC_CNL_LDR_SER_STA :$2.
		AD_CNL_LDR_SER_STA :date9.
		AF_CNL_LDR_TRT_DTS :date9.
		AX_CNL_SCL_USE :$23.
		AA_CNL_ACL_RTD
		AA_CNL_WDR_GR_RFD
		AA_CNL_AVL_RNS
		AC_CNL_MTD_FUD_RTD :$2.
		AI_CNL_DSB_CNS :$1.
		AC_CNL_PRC_TYP_APL :$2.
		AC_CNL_RPT_STA :$2.
		AC_CNL_SRV_TYP :$2.
		AC_CNL_ITL_RSP :$1.
		AC_FLW_TYP :$2.
		AC_FLW_STA :$1.
		AD_FLW_STA :date9.
		AD_FLW_APV :date9.
		AF_LST_USR_AP03 :$8.
		AF_LST_DTS_AP03 :date9.
		AD_LON_1_PAY_DU :date9.
		AI_STA_ORG_PRC_CHG
		AI_PNT_PRT
		AD_TO_SER_CMP :date9.
		AI_LDR_RGT_SLD_CHG :$1.
		AC_MN_MST_NTE_ASG :$1.
		AC_CRD_WOR_RED :$1.
		AI_FEE_MNL_CLC :$1.
		AC_BR_ST_DSB_1  :$2.
		AC_SCL_ST_DSB_1 :$2.
		AC_FIL_TYP_REQ :$2.
		AC_FIL_RCP :$1.
		AC_PNT_YR :$7.
		AC_STP_PUR :$1.
		AI_PIO_APL_LDR :$1.
		AI_SCL_ENT_CCL :$1.
		AI_DEG_SKG :$1.
		AA_BS_POI
		AF_CUR_POR  :$20.
		AF_DTS_APL_ELG_CER :date9.
		AD_DTR_APL_CER_CMP :date9.
		AF_USR_CER_CLG  :$8.
		AC_EDU_LEV_TYP :$1.
		AA_LST_CTR_OFR
		AD_LST_CTR_OFR :date9.
		AC_BR_CTR_OFR_RSP :$1.
		AN_BR_PIO_ALT_DNL
		AF_ALT_LON_APL  :$9.
		AC_ALT_APL_ELG_STA :$2.
		AC_ALT_APL_ACT_STA :$1.
		AF_APL_SLC_DIS :$11.
		AI_TLX_APL :$1.
		AF_PNT_VRS :$7.
		AD_APL_EXP :date9.
		AC_APL_EXP_EVT  :$3.
		AC_APL_RVW :$1.
		AC_CNL_TRN_REA :$1.
		AC_ALT_APL_FLW :$2.

		
	;
	%TRUNCAT(37, AF_APL_ID);
RUN;
%copyerror;

DATA AP03;
SET AP03;
	AD_CRT_APL = AD_CRT_APL * 86400;
	AD_STA_ORG_PRC = AD_STA_ORG_PRC * 86400;
	AD_STU_LON_TRM_BEG = AD_STU_LON_TRM_BEG * 86400;
	AD_STU_LON_TRM_END = AD_STU_LON_TRM_END * 86400;
	AD_STU_GRD_XPC = AD_STU_GRD_XPC * 86400;
	AD_SCL_LON_TRM_BEG = AD_SCL_LON_TRM_BEG * 86400;
	AD_SCL_LON_TRM_END = AD_SCL_LON_TRM_END * 86400;
	AD_SCL_ACA_TRM_BEG = AD_SCL_ACA_TRM_BEG * 86400;
	AD_SCL_ACA_TRM_END = AD_SCL_ACA_TRM_END * 86400;
	AD_SCL_GRD_XPC = AD_SCL_GRD_XPC * 86400;
	AD_GTR_LON_REQ = AD_GTR_LON_REQ * 86400;
	AD_GTR_ORG = AD_GTR_ORG * 86400;
	AD_GTR_DSB_MAX_LTE = AD_GTR_DSB_MAX_LTE * 86400;
	AD_GTR_RSC = AD_GTR_RSC * 86400;
	AD_PNT_SIG = AD_PNT_SIG * 86400;
	AD_PNT_VER = AD_PNT_VER * 86400;
	AD_APL_HLD = AD_APL_HLD * 86400;
	AD_ESM_RPD_SR = AD_ESM_RPD_SR * 86400;
	AD_ESM_POF = AD_ESM_POF * 86400;
	AD_LON_1_DSB = AD_LON_1_DSB * 86400;
	AD_AMR_BEG = AD_AMR_BEG * 86400;
	AD_PNT_SNT = AD_PNT_SNT * 86400;
	AD_MN_BR_CNF_SNT = AD_MN_BR_CNF_SNT * 86400;
	AD_MN_BR_CNF_RCV = AD_MN_BR_CNF_RCV * 86400;
	AD_CNL_GTR_STA = AD_CNL_GTR_STA * 86400;
	AF_CNL_GTR_TRT_DTS = AF_CNL_GTR_TRT_DTS * 86400;
	AD_CNL_LDR_SER_STA = AD_CNL_LDR_SER_STA * 86400;
	AF_CNL_LDR_TRT_DTS = AF_CNL_LDR_TRT_DTS * 86400;
	AD_FLW_STA = AD_FLW_STA * 86400;
	AD_FLW_APV = AD_FLW_APV * 86400;
	AF_LST_DTS_AP03 = AF_LST_DTS_AP03 * 86400;
	AD_LON_1_PAY_DU = AD_LON_1_PAY_DU * 86400;
	AF_DTS_APL_ELG_CER = AF_DTS_APL_ELG_CER * 86400;
	AD_DTR_APL_CER_CMP = AD_DTR_APL_CER_CMP * 86400;
	AD_LST_CTR_OFR = AD_LST_CTR_OFR * 86400;
	AD_APL_EXP = AD_APL_EXP * 86400;
RUN;

PROC SORT DATA=AP03; BY AF_APL_ID; RUN;

%ENCHILADA
	(
		AP03,
		AP03_Master_Application,
		AF_APL_ID,
		BF_SSN 
		AN_SEQ
		LF_STU_SSN 
		IC_LON_PGM 
		AD_CRT_APL 
		AC_STA_ORG_PRC 
		AD_STA_ORG_PRC 
		AC_APL_SCR_STA 
		AC_APL_PRC_TYP 
		AI_BR_DLQ_FED_DET 
		AI_BR_DET
		AC_BR_INT_OPT 
		AC_BR_RPD_OPT 
		AI_BR_NED_ORG_FEE
		AI_BR_ATH_DSB_EFT
		AI_EDS_XST_ON_APL
		AI_RFR_XST_ON_APL
		AD_STU_LON_TRM_BEG 
		AD_STU_LON_TRM_END 
		AD_STU_GRD_XPC 
		AI_STU_FGN_CNY_STY 
		AC_STU_MAJ_STY 
		AX_STU_CNL_MAJ_STY 
		AC_STU_SCL_ENR_STA 
		AI_STU_DFR_REQ
		AA_STU_REQ
		AF_DOE_SCL 
		AF_CNL_NON_EDU_BRH 
		AD_SCL_LON_TRM_BEG 
		AD_SCL_LON_TRM_END 
		AD_SCL_ACA_TRM_BEG 
		AD_SCL_ACA_TRM_END 
		AD_SCL_GRD_XPC 
		AC_SCL_STA_STU_ENR 
		AC_SCL_ACA_GDE_LEV 
		AC_SCL_ACA_PGS 
		AA_SCL_EDU_CST
		AA_SCL_EDU_AID_TOT
		AA_SCL_EFC
		AA_SCL_REQ
		AI_SCL_CNF_MPN_OVR 
		AI_SCL_STU_PAS_DU
		AN_SCL_AMT_CLC_MLT
		AF_DOE_LDR 
		AF_LDR_NON_EDU_BRH 
		AF_LDR_APL_FIL 
		AA_LDR_APV
		AC_LDR_PGM_YR 
		AI_LDR_CNF_MPN_OVR 
		AF_LDR_BND_ISS 
		AF_LDR_FEE_TIR 
		AI_LDR_NO_FEE_OVR 
		AF_LDR_ITR_TIR 
		AI_LDR_NO_ITR_OVR 
		AD_LDR_APL_REJ 
		AF_LDR_ORG 
		AI_LDR_MAT_SLL_LON 
		AF_LDR_LST_RST 
		IF_GTR 
		AF_GTR_RFR 
		AA_GTR_LON
		AD_GTR_LON_REQ 
		AD_GTR_ORG 
		AR_GTR_INT
		AC_GTR_ITR_TYP 
		AR_GTR_FEE 
		AI_GTR_TL4_PIO_787 
		AI_GTR_DSB_LTE_AZ 
		AD_GTR_DSB_MAX_LTE 
		AA_GTR_RSC
		AD_GTR_RSC 
		AC_GTR_DFR_REQ 
		AC_GTR_INT_BIL_OPT 
		AC_GTR_REA_RDC 
		AA_GTR_TOT_SFD_BAL
		AA_GTR_TOT_PLS_BAL
		AI_GTR_RSC 
		AC_SRC_APL 
		AC_VRS_ALT_APL 
		AC_SER_RUE 
		AD_PNT_SIG 
		AI_PNT_VER
		AF_PNT_VER_BY 
		AD_PNT_VER 
		AI_ESC
		AC_APL_HLD 
		AD_APL_HLD 
		AA_STF_APV
		AA_ESM_RPD
		AD_ESM_RPD_SR 
		AD_ESM_POF 
		AC_SYS_CLC_DFR 
		AA_ANL_INC
		AA_MTH_CLC_RPD
		AA_MTH_CMB_DET
		AA_MTH_CMB_INC
		AR_CMB_DET_INC_RTO
		AA_TOT_SFD_BAL
		AA_TOT_PLS_BAL
		AA_TOT_SLS_BAL
		AA_TOT_PRK_BAL
		AA_TOT_HEA_BAL
		AA_OTH_EDU_LON_BAL
		AA_TOT_STU_LN_BAL
		AA_ORG_FEE_PD
		AA_GTR_FEE_PD
		AC_REA_CPY_AP03 
		AF_APL_ID_CPY 
		AI_EXT_CVN
		AF_APL_ID_CPY_ORG 
		AN_SEQ_CVN
		AN_SIG_ON_PNT
		AF_RGL_CAT_LP06 
		AF_RGL_CAT_LP09 
		AF_RGL_CAT_LP10 
		AF_RGL_CAT_LP12 
		AF_RGL_CAT_LP20 
		AD_LON_1_DSB 
		AC_ORG_DPT 
		AR_LP_TB_ITR_MGN
		AD_AMR_BEG 
		AR_SCL_SUB
		AC_PNT_DEL 
		AD_PNT_SNT 
		AC_SCL_NTF_STA_CHG 
		AI_DSB_REJ_ACK_FIL
		AC_PIO_ORG_STA 
		AC_MN_TYP 
		AC_MN_SRL_LON 
		AI_MN_PSD_BS 
		AC_MN_CNF 
		AC_MN_BR_CNF 
		AD_MN_EXP 
		AI_MN_NOG 
		AI_MN_LN_OF_CRD 
		AC_MN_SRL_LON_ORG 
		AD_MN_BR_CNF_SNT 
		AD_MN_BR_CNF_RCV 
		AA_MN_BR_CNF
		AC_MN_REV_REA 
		AF_MN_MST_NTE 
		AN_MN_MST_NTE_SEQ
		AI_MN_ORG_RGT_SLD
		AF_MN_RGT_SLD_TO 
		AF_CNL 
		AF_CNL_SFX 
		AX_CNL_GTR_USE 
		AC_CNL_GTR_STA 
		AD_CNL_GTR_STA 
		AF_CNL_GTR_TRT_DTS 
		AX_CNL_LDR_USE 
		AC_CNL_LDR_SER_STA 
		AD_CNL_LDR_SER_STA 
		AF_CNL_LDR_TRT_DTS 
		AX_CNL_SCL_USE 
		AA_CNL_ACL_RTD
		AA_CNL_WDR_GR_RFD
		AA_CNL_AVL_RNS
		AC_CNL_MTD_FUD_RTD 
		AI_CNL_DSB_CNS 
		AC_CNL_PRC_TYP_APL 
		AC_CNL_RPT_STA 
		AC_CNL_SRV_TYP 
		AC_CNL_ITL_RSP 
		AC_FLW_TYP 
		AC_FLW_STA 
		AD_FLW_STA 
		AD_FLW_APV 
		AF_LST_USR_AP03 
		AF_LST_DTS_AP03 
		AD_LON_1_PAY_DU 
		AI_STA_ORG_PRC_CHG
		AI_PNT_PRT
		AD_TO_SER_CMP 
		AI_LDR_RGT_SLD_CHG 
		AC_MN_MST_NTE_ASG 
		AC_CRD_WOR_RED 
		AI_FEE_MNL_CLC 
		AC_BR_ST_DSB_1  
		AC_SCL_ST_DSB_1 
		AC_FIL_TYP_REQ 
		AC_FIL_RCP 
		AC_PNT_YR 
		AC_STP_PUR 
		AI_PIO_APL_LDR 
		AI_SCL_ENT_CCL 
		AI_DEG_SKG 
		AA_BS_POI
		AF_CUR_POR  
		AF_DTS_APL_ELG_CER 
		AD_DTR_APL_CER_CMP 
		AF_USR_CER_CLG  
		AC_EDU_LEV_TYP 
		AA_LST_CTR_OFR
		AD_LST_CTR_OFR 
		AC_BR_CTR_OFR_RSP 
		AN_BR_PIO_ALT_DNL
		AF_ALT_LON_APL  
		AC_ALT_APL_ELG_STA 
		AC_ALT_APL_ACT_STA 
		AF_APL_SLC_DIS 
		AI_TLX_APL 
		AF_PNT_VRS 
		AD_APL_EXP 
		AC_APL_EXP_EVT  
		AC_APL_RVW 
		AC_CNL_TRN_REA 
		AC_ALT_APL_FLW 
	)
;

%FINISH;
