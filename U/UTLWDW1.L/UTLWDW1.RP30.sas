/*THIS SPECIFICIES WHAT DIRECTORY TO READ REPORTS FROM AND WHICH DATABASE TO UPDATE.*/
/*LIVE*/
%INCLUDE "X:\Sessions\Local SAS Schedule\UDW\UTLWDW1 UHEAA Data Warehouse Load.Folder and Database.sas";
%LET REPORT = X:\PADD\FTP;

/*TEST*/
/*%INCLUDE "X:\PADU\SAS\UDW\UTLWDW1 UHEAA Data Warehouse Load.Folder and Database.sas" ;
%LET REPORT = T:\SAS;*/

%FILECHECK(63);

DATA RP30;
	INFILE REPORT63 DSD DLM = ',' FIRSTOBS=1 MISSOVER END = EOF;
	INPUT 
		IF_OWN :$8.
		PN_EFT_RIR_OWN_SEQ :2.
		IC_LON_PGM :$6.
		IF_GTR :$6.
		PD_LON_1_DSB :DATE9.
		PF_DOE_SCL_ORG :$8.
		PC_ST_BR_RSD_APL :$2.
		PD_EFT_RIR_EFF_BEG :DATE9.
		PD_EFT_RIR_EFF_END :DATE9.
		PC_EFT_RIR_STA :$1.
		PD_EFT_RIR_STA :DATE9.
		PI_EFT_RIR_PRC :$1.
		PC_EFT_NSF_LTR_REQ :$5.
		PR_EFT_RIR :5.3
		PF_LST_USR_RP30 :$8.
		PF_LST_DTS_RP30 :DATETIME25.
		PC_EFT_RIR_PNT_YR :$7.
		PD_EFT_BBS_LOT_BEG :DATE9.
		PD_EFT_BBS_GTE_DTE :DATE9.
		PD_EFT_BBS_RPD_SR :DATE9.
		PD_EFT_BBS_LCO_RCV :DATE9.
		PN_EFT_BBS_NSF_LMT :3.0
		PC_EFT_BBS_NSF_PRC :$1.
		PN_EFT_BBS_NSF_MTH :3.0
		PC_EFT_BBS_FED :$3.
		PI_EFT_RIR_RPY_0 :$1.
	;
	%TRUNCAT(63, IF_OWN);
RUN;
%copyerror;

DATA RP30;
SET RP30;
	PD_LON_1_DSB = PD_LON_1_DSB * 86400;
	PD_EFT_RIR_EFF_BEG = PD_EFT_RIR_EFF_BEG * 86400;
	PD_EFT_RIR_EFF_END = PD_EFT_RIR_EFF_END * 86400;
	PD_EFT_RIR_STA = PD_EFT_RIR_STA * 86400;
	PD_EFT_BBS_LOT_BEG = PD_EFT_BBS_LOT_BEG * 86400;
	PD_EFT_BBS_GTE_DTE = PD_EFT_BBS_GTE_DTE * 86400;
	PD_EFT_BBS_RPD_SR = PD_EFT_BBS_RPD_SR * 86400;
	PD_EFT_BBS_LCO_RCV = PD_EFT_BBS_LCO_RCV * 86400;
RUN;

PROC SORT DATA=RP30; BY IF_OWN PN_EFT_RIR_OWN_SEQ; RUN;

%ENCHILADA
	(
		RP30,
		RP30_EFT_RIR_PAR,
		IF_OWN  
		PN_EFT_RIR_OWN_SEQ,
		IC_LON_PGM
		IF_GTR
		PD_LON_1_DSB
		PF_DOE_SCL_ORG
		PC_ST_BR_RSD_APL
		PD_EFT_RIR_EFF_BEG
		PD_EFT_RIR_EFF_END
		PC_EFT_RIR_STA
		PD_EFT_RIR_STA
		PI_EFT_RIR_PRC
		PC_EFT_NSF_LTR_REQ
		PR_EFT_RIR
		PF_LST_USR_RP30
		PF_LST_DTS_RP30
		PC_EFT_RIR_PNT_YR
		PD_EFT_BBS_LOT_BEG
		PD_EFT_BBS_GTE_DTE
		PD_EFT_BBS_RPD_SR
		PD_EFT_BBS_LCO_RCV
		PN_EFT_BBS_NSF_LMT
		PC_EFT_BBS_NSF_PRC
		PN_EFT_BBS_NSF_MTH
		PC_EFT_BBS_FED
		PI_EFT_RIR_RPY_0
	)
;

%FINISH;

