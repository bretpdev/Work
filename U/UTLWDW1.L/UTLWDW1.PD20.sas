/*THIS SPECIFICIES WHAT DIRECTORY TO READ REPORTS FROM AND WHICH DATABASE TO UPDATE.*/
/*LIVE*/
%INCLUDE "X:\Sessions\Local SAS Schedule\UDW\UTLWDW1 UHEAA Data Warehouse Load.Folder and Database.sas";
%LET REPORT = X:\PADD\FTP;

/*TEST*/
/*%INCLUDE "X:\PADU\SAS\UDW\UTLWDW1 UHEAA Data Warehouse Load.Folder and Database.sas" ;
%LET REPORT = T:\SAS;*/

%FILECHECK(42);

DATA PD20;
	INFILE REPORT42 DSD DLM = ',' FIRSTOBS=1 MISSOVER END = EOF;
	INPUT 
		DF_PRS_ID :$9.
		DD_DTH_NTF :DATE9.
		DD_DTH :DATE9.
		DM_DTH_CT :$20.
		DM_DTH_CTY :$15.
		DC_DTH_ST :$2.
		DF_SUR_PRS_ID :$9.
		DM_DTH_FGN_CNY :$15.
		PF_LST_DTS_PD20 :DATETIME25.
		IF_IST :$8.
	;
	%TRUNCAT(42, DF_PRS_ID);
RUN;
%copyerror;

DATA PD20;
SET PD20;
	DD_DTH_NTF = DD_DTH_NTF * 86400;
	DD_DTH = DD_DTH * 86400;
RUN;

PROC SORT DATA=PD20; BY DF_PRS_ID DD_DTH_NTF; RUN;

%ENCHILADA
	(	
		PD20,
		PD20_PRS_DTH,
		DF_PRS_ID  
		DD_DTH_NTF,  
		DD_DTH  
		DM_DTH_CT  
		DM_DTH_CTY  
		DC_DTH_ST  
		DF_SUR_PRS_ID  
		DM_DTH_FGN_CNY  
		PF_LST_DTS_PD20  
		IF_IST  
	)
;

%FINISH;
