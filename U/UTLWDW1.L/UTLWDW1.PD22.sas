/*THIS SPECIFICIES WHAT DIRECTORY TO READ REPORTS FROM AND WHICH DATABASE TO UPDATE.*/
/*LIVE*/
%INCLUDE "X:\Sessions\Local SAS Schedule\UDW\UTLWDW1 UHEAA Data Warehouse Load.Folder and Database.sas";
%LET REPORT = X:\PADD\FTP;

/*TEST*/
/*%INCLUDE "X:\PADU\SAS\UDW\UTLWDW1 UHEAA Data Warehouse Load.Folder and Database.sas" ;
%LET REPORT = T:\SAS;*/

%FILECHECK(44);

DATA PD22;
	INFILE REPORT44 DSD DLM = ',' FIRSTOBS=1 MISSOVER END = EOF;
	INPUT 
		DF_PRS_ID :$9.
		DD_DSA_RPT :DATE9.
		DD_DSA :DATE9.
		DF_DR :$9.
		DC_DSA_NEW_WRS :$1.
		DF_LST_DTS_PD22 :DATETIME25.
		DI_DSA_VET :$1.
		DD_PRS_DSA_SPS_SR :DATE9.
		DD_PRS_DSA_SPS_END :DATE9.
		DF_CRT_USR_PD22 :$8.
		DF_LST_USR_PD22 :$8.
		DD_REC_LST_UPD :DATE9.
		DX_PRS_DSA_TPD_REA :$10.
	;
	%TRUNCAT(44, DF_PRS_ID);
RUN;
%copyerror;

DATA PD22;
SET PD22;
	DD_DSA_RPT = DD_DSA_RPT * 86400;
	DD_DSA = DD_DSA * 86400;
	DD_PRS_DSA_SPS_SR = DD_PRS_DSA_SPS_SR * 86400;
	DD_PRS_DSA_SPS_END = DD_PRS_DSA_SPS_END * 86400;
	DD_REC_LST_UPD = DD_REC_LST_UPD * 86400;

RUN;

PROC SORT DATA=PD22; BY DF_PRS_ID DD_DSA_RPT; RUN;

%ENCHILADA
	(
		PD22,
		PD22_PRS_DSA,
		DF_PRS_ID  
		DD_DSA_RPT,  
		DD_DSA  
		DF_DR  
		DC_DSA_NEW_WRS  
		DF_LST_DTS_PD22  
		DI_DSA_VET  
		DD_PRS_DSA_SPS_SR  
		DD_PRS_DSA_SPS_END  
		DF_CRT_USR_PD22  
		DF_LST_USR_PD22  
		DD_REC_LST_UPD  
		DX_PRS_DSA_TPD_REA  
	)
;

%FINISH;
