/*THIS SPECIFICIES WHAT DIRECTORY TO READ REPORTS FROM AND WHICH DATABASE TO UPDATE.*/
/*LIVE*/
%INCLUDE "X:\Sessions\Local SAS Schedule\UDW\UTLWDW1 UHEAA Data Warehouse Load.Folder and Database.sas";
%LET REPORT = X:\PADD\FTP;

/*TEST*/
/*%INCLUDE "X:\PADU\SAS\UDW\UTLWDW1 UHEAA Data Warehouse Load.Folder and Database.sas" ;
%LET REPORT = T:\SAS;*/

%FILECHECK(25);

DATA PD30 (drop=trunc);
	INFILE REPORT25 DSD DLM = ',' FIRSTOBS=1 MISSOVER end = eof;
	INPUT DF_SPE_ACC_ID :$10. DX_STR_ADR_1 :$30. DX_STR_ADR_2 :$30. DM_CT :$20. DC_DOM_ST :$2. DF_ZIP_CDE :$17. 
		DM_FGN_ST :$15. DM_FGN_CNY :$25. DD_VER_ADR :$10. DI_VLD_ADR :$1. ;
%TRUNCAT(25,DF_SPE_ACC_ID);
RUN;
%copyerror;

PROC SORT DATA=PD30 ; BY DF_SPE_ACC_ID ; RUN;
DATA PD30; SET PD30; BY DF_SPE_ACC_ID; IF LAST.DF_SPE_ACC_ID; RUN;

%ENCHILADA(PD30,PD30_ADDRESS,DF_SPE_ACC_ID,DX_STR_ADR_1 DX_STR_ADR_2 DM_CT DC_DOM_ST DF_ZIP_CDE 
	DM_FGN_ST DM_FGN_CNY DD_VER_ADR DI_VLD_ADR ,);

%GOODBYE_NULL(PD30_ADDRESS,DX_STR_ADR_1,'');
%GOODBYE_NULL(PD30_ADDRESS,DX_STR_ADR_2,'');
%GOODBYE_NULL(PD30_ADDRESS,DM_CT,'');
%GOODBYE_NULL(PD30_ADDRESS,DC_DOM_ST,'');
%GOODBYE_NULL(PD30_ADDRESS,DF_ZIP_CDE,'');
%GOODBYE_NULL(PD30_ADDRESS,DM_FGN_ST,'');
%GOODBYE_NULL(PD30_ADDRESS,DM_FGN_CNY,'');
%GOODBYE_NULL(PD30_ADDRESS,DD_VER_ADR,'');
%GOODBYE_NULL(PD30_ADDRESS,DI_VLD_ADR,'');

%FINISH;
