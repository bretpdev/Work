/*TEST*/
/*%LET TESTMSG = - THIS IS A TEST;
%LET RPTLIB = T:\SAS;
%LET LOGLIB = Y:\Batch\Logs;
%LET CODELIB = Y:\Codebase\SAS\CDW;
%LET ODBCFILE = BSYS_TEST;
%LET DB = CDW_test;
%LET ODBCFILE_CSYS = CSYSTest;*/

/*LIVE*/
%LET TESTMSG = - THIS IS LIVE;
%LET RPTLIB = Z:\Batch\FTP;
%LET LOGLIB = Z:\Batch\Logs;
%LET CODELIB = Z:\Codebase\SAS\CDW;
%LET ODBCFILE = BSYS;
%LET DB = CDW;
%LET ODBCFILE_CSYS = CSYS;

%INCLUDE "&CODELIB\UTNWDW1 CDW DAILY UPDATE.FOLDER AND DATABASE.SAS";
%FILECHECK(45);

options mprint;

DATA WQ20 (drop=trunc);
	INFILE REPORT45 DSD DLM = ',' FIRSTOBS=1 MISSOVER end = eof;
	INPUT 
		DF_SPE_ACC_ID :$10. 
		WF_QUE :$2. 
		WF_SUB_QUE :$2.
		WN_CTL_TSK :$18. 
		PF_REQ_ACT :$5.
		WD_ACT_REQ :DATE9.  
		WD_ACT_RQR :DATE9. 
		WC_CND_CTC :$1. 
		WD_INI_TSK :DATE9. 
		WT_INI_TSK :$10. 
		WF_USR_ASN_TSK :$8. 
		WF_USR_ASN_BY_TSK :$8.
		WX_MSG_1_TSK :$77. 
		WX_MSG_2_TSK :$77. 
		WC_STA_WQUE20 :$1.
		WF_LST_DTS_WQ20 :DATETIME25.  
		LN_ATY_SEQ :4.
		WF_CRT_DTS_WQ20 :DATETIME25. 
;
%TRUNCAT(45);
RUN;
%COPYERROR;

DATA WQ20_FINAL;
SET WQ20;
	WD_ACT_REQ = WD_ACT_REQ*86400;
	WD_ACT_RQR = WD_ACT_RQR*86400;
	WD_INI_TSK = WD_INI_TSK*86400;
/*	WT_INI_TSK = WT_INI_TSK*86400;*/
RUN;

%ENCHILADA(
			WQ20_FINAL,
			WQ20_QueueTasks,
			DF_SPE_ACC_ID WF_QUE WF_SUB_QUE WN_CTL_TSK PF_REQ_ACT,
			WD_ACT_REQ 
			WD_ACT_RQR 
			WC_CND_CTC 
			WD_INI_TSK 
			WT_INI_TSK 
			WF_USR_ASN_TSK 
			WF_USR_ASN_BY_TSK
			WX_MSG_1_TSK 
			WX_MSG_2_TSK 
			WC_STA_WQUE20 
			WF_LST_DTS_WQ20
			LN_ATY_SEQ
			WF_CRT_DTS_WQ20	
		);

%FINISH(SOURCE=QueueTasks);
