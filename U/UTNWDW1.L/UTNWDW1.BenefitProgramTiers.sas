/*TEST*/
/*%LET TESTMSG = - THIS IS A TEST;
%LET RPTLIB = T:\SAS;
%LET LOGLIB = Y:\Batch\Logs;
%LET CODELIB = Y:\Codebase\SAS\CDW;
%LET ODBCFILE = BSYS_TEST;
%LET DB = CDW_test;
%LET ODBCFILE_CSYS = CSYSTest;*/

/*LIVE*/
%LET TESTMSG = - THIS IS LIVE;
%LET RPTLIB = Z:\Batch\FTP;
%LET LOGLIB = Z:\Batch\Logs;
%LET CODELIB = Z:\Codebase\SAS\CDW;
%LET ODBCFILE = BSYS;
%LET DB = CDW;
%LET ODBCFILE_CSYS = CSYS;

%INCLUDE "&CODELIB\UTNWDW1 CDW DAILY UPDATE.FOLDER AND DATABASE.SAS";
%FILECHECK(35);

DATA RP02(drop=trunc);
	INFILE REPORT35 DSD DLM = ',' FIRSTOBS=1 MISSOVER end = eof;
	INPUT 
		DF_SPE_ACC_ID :$10.
		PM_BBS_PGM :$3. 
		PN_BBS_PGM_SEQ :6.
		PF_BBS_PGM_TIR :$2. 
		PN_BBS_PGM_TIR_SEQ :6.
		PC_BBT_ICV :$1. 
		PN_BBT_PAY_ICV :3.0
		PR_BBT_RDC :5.3
		PC_BBT_REB_APL :$1. 
		PA_BBT_REB :8.2
	;
%TRUNCAT(35);
RUN;
%COPYERROR;
PROC SORT DATA=RP02; BY DF_SPE_ACC_ID PM_BBS_PGM PN_BBS_PGM_SEQ PF_BBS_PGM_TIR PN_BBS_PGM_TIR_SEQ; RUN;
DATA RP02; SET RP02; BY DF_SPE_ACC_ID PM_BBS_PGM PN_BBS_PGM_SEQ PF_BBS_PGM_TIR PN_BBS_PGM_TIR_SEQ; IF LAST.PN_BBS_PGM_TIR_SEQ; RUN;

%ENCHILADA
	(
		RP02,
		RP02_BENEFITPROGRAMTIERS, 
/*		primary key fields*/
		DF_SPE_ACC_ID
		PM_BBS_PGM
		PN_BBS_PGM_SEQ
		PF_BBS_PGM_TIR
		PN_BBS_PGM_TIR_SEQ, 
/*		other fields*/
		PC_BBT_ICV
		PN_BBT_PAY_ICV
		PR_BBT_RDC
		PC_BBT_REB_APL
		PA_BBT_REB,
/*		no filter*/
	)
;

%GOODBYE_NULL(RP02_BENEFITPROGRAMTIERS,PC_BBT_ICV,'');
%GOODBYE_NULL(RP02_BENEFITPROGRAMTIERS,PN_BBT_PAY_ICV,0);
%GOODBYE_NULL(RP02_BENEFITPROGRAMTIERS,PR_BBT_RDC,0);
%GOODBYE_NULL(RP02_BENEFITPROGRAMTIERS,PC_BBT_REB_APL,'');
%GOODBYE_NULL(RP02_BENEFITPROGRAMTIERS,PA_BBT_REB,0);
			
%FINISH(SOURCE=BenefitProgramTiers);
