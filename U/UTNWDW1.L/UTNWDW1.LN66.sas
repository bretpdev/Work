/*TEST*/
/*%LET TESTMSG = - THIS IS A TEST;
%LET RPTLIB = T:\SAS;
%LET LOGLIB = Y:\Batch\Logs;
%LET CODELIB = Y:\Codebase\SAS\CDW;
%LET ODBCFILE = BSYS_TEST;
%LET DB = CDW_test;
%LET ODBCFILE_CSYS = CSYSTest;*/

/*LIVE*/
%LET TESTMSG = - THIS IS LIVE;
%LET RPTLIB = Z:\Batch\FTP;
%LET LOGLIB = Z:\Batch\Logs;
%LET CODELIB = Z:\Codebase\SAS\CDW;
%LET ODBCFILE = BSYS;
%LET DB = CDW;
%LET ODBCFILE_CSYS = CSYS;

%INCLUDE "&CODELIB\UTNWDW1 CDW DAILY UPDATE.FOLDER AND DATABASE.SAS";
%FILECHECK(54);


DATA LN66(drop=trunc);
	INFILE REPORT54 DSD DLM = ',' FIRSTOBS=1 MISSOVER end = eof;
	INPUT 
		BF_SSN :$9.
		LN_SEQ :2.
		LN_RPS_SEQ :2.
		LN_GRD_RPS_SEQ :2.
		LA_RPS_ISL :7.2
		LD_CRT_LON66 :DATE9.
		LN_RPS_TRM :3.0
		LF_LST_DTS_LN66 :DATETIME25.
		LA_PRI_RDC_GRD :8.2
		LN_PRI_RDC_GRD_TRM :3.0
		LA_PRI_ATU_PAY :12.2
		LD_RPYE_FGV :DATE9.;
%TRUNCAT1(54, BF_SSN);
RUN;
%COPYERROR;

DATA LN66;
SET LN66;
	LD_CRT_LON66 = LD_CRT_LON66 * 86400;
	LD_RPYE_FGV = LD_RPYE_FGV * 86400;
RUN;

PROC SORT DATA=LN66; BY BF_SSN LN_SEQ LN_RPS_SEQ LN_GRD_RPS_SEQ; RUN;

%ENCHILADA(
LN66,
LN66_LON_RPS_SPF,
BF_SSN  
LN_SEQ  
LN_RPS_SEQ  
LN_GRD_RPS_SEQ,  
LA_RPS_ISL  
LD_CRT_LON66  
LN_RPS_TRM  
LF_LST_DTS_LN66  
LA_PRI_RDC_GRD  
LN_PRI_RDC_GRD_TRM  
LA_PRI_ATU_PAY  
LD_RPYE_FGV  
);

%FINISH(SOURCE=LN66);
