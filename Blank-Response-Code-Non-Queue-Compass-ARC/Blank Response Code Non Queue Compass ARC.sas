*-------------------------------------------*
| BLANK RESPONSE CODE NON QUEUE COMPASS ARC |
*-------------------------------------------*;
LIBNAME  WORKLOCL  REMOTE  SERVER=CYPRUS  SLIBREF=WORK;
RSUBMIT;
PROC SQL;
CONNECT TO DB2 (DATABASE=DLGSUTWH);
CREATE TABLE BRCNQCA AS
SELECT *
FROM CONNECTION TO DB2 (
SELECT DISTINCT A.BF_SSN
	,A.PF_REQ_ACT
	,A.LD_ATY_REQ_RCV
	,A.LD_ATY_RSP
	,A.PF_RSP_ACT
FROM OLWHRM1.AY10_BR_LON_ATY A
INNER JOIN OLWHRM1.LN10_LON B	
	ON A.BF_SSN = B.BF_SSN
INNER JOIN OLWHRM1.AC10_ACT_REQ C
	ON A.PF_REQ_ACT = C.PF_REQ_ACT
WHERE B.LA_CUR_PRI > 0
AND A.LD_ATY_RSP IS NULL
AND C.WF_QUE IS NULL
FOR READ ONLY WITH UR
);
DISCONNECT FROM DB2;
ENDRSUBMIT;

DATA BRCNQCA;
SET WORKLOCL.BRCNQCA;
RUN;

PROC SORT DATA=BRCNQCA;
BY BF_SSN;
RUN;

DATA _NULL_;
SET  WORK.BRCNQCA;
FILE 'C:\WINDOWS\TEMP\CompRespCode.txt' DELIMITER=',' DSD DROPOVER LRECL=32767;
   FORMAT BF_SSN $9. ;
   FORMAT PF_REQ_ACT $5. ;
   FORMAT LD_ATY_REQ_RCV MMDDYY10. ;
   FORMAT LD_ATY_RSP MMDDYY10. ;
   FORMAT PF_RSP_ACT $5. ;
IF _N_ = 1 THEN        
 DO;
   PUT
   'BF_SSN'
   ','
   'PF_REQ_ACT'
   ','
   'LD_ATY_REQ_RCV'
   ','
   'LD_ATY_RSP'
   ','
   'PF_RSP_ACT'
   ;
 END;
 DO;
   PUT BF_SSN $ @;
   PUT PF_REQ_ACT $ @;
   PUT LD_ATY_REQ_RCV @;
   PUT LD_ATY_RSP @;
   PUT PF_RSP_ACT $ ;
 END;
RUN;
