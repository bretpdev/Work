@model ProjectData
@{
    ViewBag.Title = "Time Tracking";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<link href="~/Content/themes/base/jquery-ui.min.css" rel="stylesheet" />
<link href="../../Content/themes/base/jquery.ui.all.css" rel="stylesheet" />
@section scripts
{
    <script src="~/Scripts/jquery-3.6.0.min.js"></script>
    <script src="~/Scripts/jquery-ui-1.12.1.min.js"></script>
    <script>
        $(document).ready(function () {
            jQuery('input[type="date"]').live('click', function (e) { e.preventDefault(); }).datepicker();
            $('.datepicker').datepicker({
                dateFormat: "mm/dd/yy",
                changemonth: true,
                changeyear: true,
                maxDate: '0'
            });
        });

        $('#startstop').click(function () {
            alert('Stopped');
            alert($(this).val());
            $.ajax({
                URL: '/Home/StartStop',
                data: 'id=' + $(this).val()
            });
        });
    </script>
}


@using (Html.BeginForm("Index", "Home", FormMethod.Post, new { @id = "HomePage" }))
{
    @Html.AntiForgeryToken()
    <div>
        Show Unstopped Time @Html.CheckBox("Unstopped", false, new { id = "Unstopped", name = "Unstopped", onchange = "$('form').submit();" })
    </div>
    <div style="text-align: right; width: 100%">
        @Html.Label("From:")  @Html.EditorFor(model => model.From, new { htmlAttributes = new { @class = "datepicker", onchange = "$('form').submit();" } }) 
        @Html.Label("To:")  @Html.EditorFor(model => model.To, new { htmlAttributes = new { @class = "datepicker", onchange = "$('form').submit();" } })
    </div>

    <br />
    <br />

    <input type="button" class="btn btn-primary btn-lg" value="Add Record &raquo;" onclick="location.href='@Url.Action("AddTime")'" />

    <br />
    <br />

    <table id="uTimes" class="table table-bordered table-responsive">
        <thead>
            <tr>
                <th style="width:8%" class="light-blue-highlight text-center">
                    @Html.ActionLink("Ticket ID", "Index", new { sortOrder = "ticketid" }, new { @class = "sort-link-colored-invariant" })
                </th>
                <th style="width:15%" class="light-blue-highlight text-center" ">
                    @Html.ActionLink("System Type", "Index", new { sortOrder = "systemtype" }, new { @class = "sort-link-colored-invariant" })
                </th>
                <th style="width:15%" class="light-blue-highlight text-center" ">
                    @Html.ActionLink("Start Time", "Index", new { sortOrder = "starttime" }, new { @class = "sort-link-colored-invariant" })
                </th>
                <th style="width:15%" class="light-blue-highlight text-center" ">
                    @Html.ActionLink("End Time", "Index", new { sortOrder = "endtime" }, new { @class = "sort-link-colored-invariant" })
                </th>
                <th style="width:16%" class="light-blue-highlight text-center" ">
                    @Html.ActionLink("Cost Center", "Index", new { sortOrder = "costcenter" }, new { @class = "sort-link-colored-invariant" })
                </th>
                <th style="width:6%" class="light-blue-highlight text-center" ">
                    @Html.ActionLink("Batch", "Index", new { sortOrder = "batch" }, new { @class = "sort-link-colored-invariant" })
                </th>
                <th style="width:25%" class="light-blue-highlight text-center" ">
                    @Html.ActionLink("Generic Meeting", "Index", new { sortOrder = "genericmeeting" }, new { @class = "sort-link-colored-invariant" })
                </th>
                <th></th>
                <th></th>
            </tr>
        </thead>
        @foreach (var item in Model.Times)
        {
            <tr>
                <td class="text-center">
                    @Html.DisplayFor(m => item.TicketID)
                </td>
                <td class="text-center">
                    @Html.DisplayFor(m => item.SystemType)
                </td>
                <td class="text-center">
                    @Html.DisplayFor(m => item.StartTime)
                </td>
                <td class="text-center">
                    @Html.DisplayFor(m => item.EndTime)
                </td>
                <td class="text-center">
                    @Html.DisplayFor(m => item.CostCenter)
                </td>
                <td class="text-center">
                    @Html.DisplayFor(m => item.BatchProcessing)
                </td>
                <td class="text-center">
                    @Html.DisplayFor(m => item.GenericMeeting)
                </td>
                <td class="text-center">
                    <input type="button" value="@(item.EndTime.HasValue ? "Start" : "Stop")" id="startstop" />
                </td>
                <td class="text-center">
                    @Html.ActionLink("Edit", "TrackedTime", new { id = item.TimeTrackingId })
                </td>
            </tr>
        }
    </table>
}