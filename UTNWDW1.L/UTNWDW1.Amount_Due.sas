/*TEST*/
/*%LET TESTMSG = - THIS IS A TEST;
%LET RPTLIB = T:\SAS;
%LET LOGLIB = Y:\Batch\Logs;
%LET CODELIB = Y:\Codebase\SAS\CDW;
%LET ODBCFILE = BSYS_TEST;
%LET DB = CDW_test;
%LET ODBCFILE_CSYS = CSYSTest;*/

/*LIVE*/
%LET TESTMSG = - THIS IS LIVE;
%LET RPTLIB = Z:\Batch\FTP;
%LET LOGLIB = Z:\Batch\Logs;
%LET CODELIB = Z:\Codebase\SAS\CDW;
%LET ODBCFILE = BSYS;
%LET DB = CDW;
%LET ODBCFILE_CSYS = CSYS;

%INCLUDE "&CODELIB\UTNWDW1 CDW DAILY UPDATE.FOLDER AND DATABASE.SAS";
%FILECHECK(31);

options mprint;

DATA CUR_DUE (drop=trunc);
	INFILE REPORT31 DSD DLM = ',' FIRSTOBS=1 MISSOVER end = eof;
	INPUT DF_SPE_ACC_ID :$10. CUR_DUE :9.2 PAST_DUE :9.2 TOT_DUE :9.2 TOT_DUE_FEE :9.2 ;
%TRUNCAT(31);
RUN;
%COPYERROR;
PROC SORT DATA=CUR_DUE ; BY DF_SPE_ACC_ID ; RUN;
DATA CUR_DUE; SET CUR_DUE; BY DF_SPE_ACC_ID ; IF LAST.DF_SPE_ACC_ID; RUN;

%ENCHILADA(CUR_DUE,BORR_AMOUNTDUE,DF_SPE_ACC_ID,CUR_DUE PAST_DUE TOT_DUE TOT_DUE_FEE,);

%GOODBYE_NULL(BORR_AMOUNTDUE,CUR_DUE,0);
%GOODBYE_NULL(BORR_AMOUNTDUE,PAST_DUE,0);
%GOODBYE_NULL(BORR_AMOUNTDUE,TOT_DUE,0);
%GOODBYE_NULL(BORR_AMOUNTDUE,TOT_DUE_FEE,0);

%FINISH(SOURCE=Amount_Due);
