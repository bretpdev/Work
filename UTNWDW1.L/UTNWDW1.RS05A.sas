/*TEST*/
/*%LET TESTMSG = - THIS IS A TEST;
%LET RPTLIB = T:\SAS;
%LET LOGLIB = Y:\Batch\Logs;
%LET CODELIB = Y:\Codebase\SAS\CDW;
%LET ODBCFILE = BSYS_TEST;
%LET DB = CDW_test;
%LET ODBCFILE_CSYS = CSYSTest;*/

/*LIVE*/
%LET TESTMSG = - THIS IS LIVE;
%LET RPTLIB = Z:\Batch\FTP;
%LET LOGLIB = Z:\Batch\Logs;
%LET CODELIB = Z:\Codebase\SAS\CDW;
%LET ODBCFILE = BSYS;
%LET DB = CDW;
%LET ODBCFILE_CSYS = CSYS;

%INCLUDE "&CODELIB\UTNWDW1 CDW DAILY UPDATE.FOLDER AND DATABASE.SAS";
%FILECHECK(55);


DATA RS05A(drop=trunc);
	INFILE REPORT55 DSD DLM = ',' FIRSTOBS=1 MISSOVER end = eof;
	INPUT 
		BF_SSN :$9.
		BD_CRT_RS05 :DATE9.
		BN_IBR_SEQ :2.
		BF_CRT_USR_RS05 :$8.
		BF_CRY_YR :$4.
		BC_ST_IBR :$2.
		BC_STA_RS05 :$1.
		BA_AGI :12.2
		BN_MEM_HSE_HLD :2.0
		BA_PMN_STD_TOT_PAY :12.2
		BC_IBR_INF_SRC_VER :$3.
		BF_LST_DTS_RS05 :DATETIME25.
		BF_SSN_SPO :$9.
		BC_IRS_TAX_FIL_STA :$1.
		BI_JNT_BR_SPO_RPY :$1.
		BD_ANV_QLF_IBR :DATE9.
		BC_DOC_SNT_BR_IDR :$1.
		BC_BR_REQ_PLN_RPYE :$1.
		BC_BR_GDE_LVL_RPYE :$1.
		BI_REQ_DFR_FOR_CUT :$1.
		BC_DFR_FOR_CUT_TYP :$1.;
%TRUNCAT1(55, BF_SSN);
RUN;
%COPYERROR;

DATA RS05A;
SET RS05A;
	BD_CRT_RS05 = BD_CRT_RS05 * 86400;
	BD_ANV_QLF_IBR = BD_ANV_QLF_IBR * 86400;
RUN;

PROC SORT DATA=RS05A; BY BF_SSN BD_CRT_RS05 BN_IBR_SEQ; RUN;

%ENCHILADA(
RS05A,
RS05_IBR_RPS,
BF_SSN  
BD_CRT_RS05  
BN_IBR_SEQ,  
BF_CRT_USR_RS05  
BF_CRY_YR  
BC_ST_IBR  
BC_STA_RS05  
BA_AGI  
BN_MEM_HSE_HLD  
BA_PMN_STD_TOT_PAY  
BC_IBR_INF_SRC_VER  
BF_LST_DTS_RS05  
BF_SSN_SPO  
BC_IRS_TAX_FIL_STA  
BI_JNT_BR_SPO_RPY  
BD_ANV_QLF_IBR  
BC_DOC_SNT_BR_IDR  
BC_BR_REQ_PLN_RPYE  
BC_BR_GDE_LVL_RPYE  
BI_REQ_DFR_FOR_CUT  
BC_DFR_FOR_CUT_TYP   
);

%FINISH(SOURCE=RS05A);
